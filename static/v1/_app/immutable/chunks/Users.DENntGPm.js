import"./disclose-version.BDr9Qe-U.js";import{p as he,w as p,G as ha,u as e,v as t,c as n,s as i,r as v,ap as Y,t as J,a as ge,O as Me,f as le}from"./runtime.BONl2e88.js";import{s as ee}from"./render.AqJWcVDb.js";import{i as A}from"./if.DS90EFHs.js";import{e as Ne,i as ga}from"./each.Bce--_O8.js";import{d as D,a as l,t as I,e as ye}from"./template.B7ldVCvc.js";import{p as r}from"./proxy.0BECmVET.js";import{o as Te}from"./index-client.Bjp_k6xO.js";import{O as Ke,T as Qe,U as ya,V as wa,W as $a,l as ba,X as _a,Y as Ea,Z as Ia,_ as xa,u as ka,q as Sa,$ as Je}from"./OptionSelect.TkTfcdPh.js";import{b as Ie,a as ve,c as ne}from"./index.BJiFQ8Di.js";import{p as $e}from"./props.BlbrNjWf.js";import{r as Ue}from"./legacy-client.D71ZcBDy.js";import{E as ea}from"./ExpandContainer.2O3yvOBK.js";import{T as aa}from"./Tooltip.BZNUXfH5.js";import{c as Ae,a as fe,b as La}from"./index.esm.B2KJ0uBO.js";import{z as Se,a3 as Re,a4 as qa,a5 as Ta,a6 as Ma,a7 as Na,a8 as ta,Z as sa,y as ra,l as Ge,A as ja,w as Pa}from"./helpers.CQGRRstl.js";import{S as je}from"./Switch.DtMymIQe.js";import{g as Ye,a as Ve,b as za,c as Ca}from"./admin.Ca8NwkBI.js";import{B as we,L as Fa}from"./Button.JPJkNEUa.js";import{C as Oa}from"./CheckIcon.CqUmlXj7.js";import{I as ie}from"./Input.KbCPDMgh.js";import{I as Pe}from"./ItemTiles.6wBDc_SZ.js";import{T as Da}from"./TabBar.u0W3le5w.js";import{P as la}from"./PasswordInput.gsJfcUzM.js";import{P as Ua}from"./PasswordPolicy.Difs7H-Z.js";import{d as Aa,e as Ra,w as Ga,f as Ya}from"./dataFetching.CUoxx_U8.js";import{D as Va}from"./Devices.By3h8XHs.js";import{O as Xa}from"./OrderSearchBar.DcBjpUC6.js";import{P as Ba}from"./Pagination.DjghmVzr.js";import{P as Ha}from"./PaginationServer.DmVnT-Wx.js";var Za=I('<div class="success svelte-tl4x7h">Success</div>'),Wa=I('<div class="err svelte-tl4x7h"> </div>'),Ka=I('<div class="container svelte-tl4x7h"><div class="unit svelte-tl4x7h"><div class="label font-label svelte-tl4x7h">USER ID</div> <div class="value font-mono svelte-tl4x7h"> </div></div> <div class="row svelte-tl4x7h"><div class="unit svelte-tl4x7h"><div class="label font-label svelte-tl4x7h">ENABLED</div> <div class="value svelte-tl4x7h"><!></div></div> <div class="unit svelte-tl4x7h"><div class="label font-label svelte-tl4x7h">E-MAIL VERIFIED</div> <div class="value svelte-tl4x7h"><!></div></div></div> <!> <!> <!> <div class="unit language svelte-tl4x7h"><div class="label svelte-tl4x7h">LANGUAGE</div> <div style="margin-top: .085rem"><!></div></div> <!> <!> <!> <!> <!> <!> <div class="unit svelte-tl4x7h"><div class="label svelte-tl4x7h">ROLES</div> <!></div> <div class="unit svelte-tl4x7h"><div class="label svelte-tl4x7h">GROUPS</div> <!></div> <div class="unit svelte-tl4x7h"><div class="label font-label svelte-tl4x7h">LIMIT LIFETIME</div> <div class="value svelte-tl4x7h"><!></div></div> <!> <div class="unit svelte-tl4x7h"><div class="label font-label svelte-tl4x7h">CREATED</div> <div class="value svelte-tl4x7h"> </div></div> <div class="unit svelte-tl4x7h"><div class="label font-label svelte-tl4x7h">LAST LOGIN</div> <div class="value svelte-tl4x7h"><!></div></div> <div class="unit svelte-tl4x7h"><div class="label font-label svelte-tl4x7h">PASSWORD EXPIRES</div> <div class="value svelte-tl4x7h"><!></div></div> <div class="unit svelte-tl4x7h"><div class="label font-label svelte-tl4x7h">MFA ACTIVE</div> <div class="value svelte-tl4x7h"><!></div></div> <div class="unit svelte-tl4x7h"><!> <!> <!></div></div>');function Qa(K,T){he(T,!0);let s=$e(T,"user",31,()=>r({}));s().roles===void 0&&s(s().roles=[],!0),s().groups===void 0&&s(s().groups=[],!0);let _=p(""),f=p(!1),b=p(void 0),S=p(r(s().language.toUpperCase())),N=p(!!s().user_expires),x=p(r(ha(()=>e(N))?Se(s().user_expires,!0):void 0)),j=p(r([]));Ye.subscribe(a=>{t(j,r(a))});let y=p(r([]));Ve.subscribe(a=>{t(y,r(a))}),Ue(()=>{e(f)&&t(b,r(setTimeout(()=>{t(f,!1),T.onSave()},3e3)))});let g=p(r({}));const E=Ae().shape({email:fe().required("E-Mail is required").email("Bad E-Mail format"),given_name:fe().trim().required("Given Name is required").matches(Re,"Invalid characters"),family_name:fe().nullable().trim().matches(qa,"Invalid characters")});let u=p(r({}));const w=Ae().shape({birthdate:fe().nullable().trim().matches(Ta,"Invalid characters"),phone:fe().nullable().trim().matches(Ma,"Format: +..."),street:fe().nullable().trim().matches(Na,"Invalid characters"),zip:La().nullable().min(1e3).max(999999),city:fe().nullable().trim().matches(ta,"Invalid characters"),country:fe().nullable().trim().matches(ta,"Invalid characters")});Te(()=>()=>clearTimeout(e(b)));function m(a){a.code==="Enter"&&C()}async function C(){if(!await c())return;t(_,""),console.log(s().user_values);const a={email:s().email,given_name:s().given_name,family_name:s().family_name||null,language:e(S).toLowerCase(),roles:s().roles,groups:s().groups,enabled:s().enabled,email_verified:s().email_verified,user_expires:null,user_values:s().user_values};if(a.user_values.phone&&(a.user_values.phone=a.user_values.phone.replaceAll(" ","")),a.user_values.zip&&(a.user_values.zip=Number.parseInt(a.user_values.zip)),e(N)){let U=ra(e(x));if(!U){t(_,"Invalid Date Input: User Expires");return}a.user_expires=U}let z=await Qe(s().id,a);if(z.ok)t(f,!0);else{let U=await z.json();t(_,r(U.message))}}async function c(){let a=!0;try{await E.validate(s(),{abortEarly:!1}),t(g,r({}))}catch(z){t(g,r(Ge(z))),a=!1}try{await w.validate(s().user_values,{abortEarly:!1}),t(u,r({}))}catch(z){t(u,r(Ge(z))),a=!1}return a}var L=Ka(),M=n(L),P=i(n(M),2),O=n(P,!0);v(P),v(M);var B=i(M,2);Ie(B,"margin-top","-5px");var Z=n(B);Ie(Z,"width","107px");var oe=i(n(Z),2),X=n(oe);je(X,{get selected(){return s().enabled},set selected(a){s(s().enabled=a,!0)}}),v(oe),v(Z);var H=i(Z,2);Ie(H,"width","135px");var te=i(n(H),2),se=n(te);je(se,{get selected(){return s().email_verified},set selected(a){s(s().email_verified=a,!0)}}),v(te),v(H),v(B);var k=i(B,2);ie(k,{type:"email",autocomplete:"off",placeholder:"E-Mail",get value(){return s().email},set value(a){s(s().email=a,!0)},get error(){return e(g).email},set error(a){e(g).email=a},$$events:{keypress:m,input:c},children:(a,z)=>{Y();var U=D("E-MAIL");l(a,U)},$$slots:{default:!0}});var $=i(k,2);ie($,{autocomplete:"off",placeholder:"Given Name",get value(){return s().given_name},set value(a){s(s().given_name=a,!0)},get error(){return e(g).given_name},set error(a){e(g).given_name=a},$$events:{keypress:m,input:c},children:(a,z)=>{Y();var U=D("GIVEN NAME");l(a,U)},$$slots:{default:!0}});var R=i($,2);ie(R,{autocomplete:"off",placeholder:"Family Name",get value(){return s().family_name},set value(a){s(s().family_name=a,!0)},get error(){return e(g).family_name},set error(a){e(g).family_name=a},$$events:{keypress:m,input:c},children:(a,z)=>{Y();var U=D("FAMILY NAME");l(a,U)},$$slots:{default:!0}});var Q=i(R,2),o=i(n(Q),2),h=n(o);Ke(h,{options:sa,get value(){return e(S)},set value(a){t(S,r(a))}}),v(o),v(Q);var G=i(Q,2);ie(G,{autocomplete:"off",placeholder:"Street",get value(){return s().user_values.street},set value(a){s(s().user_values.street=a,!0)},get error(){return e(u).street},set error(a){e(u).street=a},$$events:{keypress:m,input:c},children:(a,z)=>{Y();var U=D("STREET");l(a,U)},$$slots:{default:!0}});var d=i(G,2);ie(d,{type:"number",autocomplete:"off",placeholder:"ZIP",min:1e3,max:999999,get value(){return s().user_values.zip},set value(a){s(s().user_values.zip=a,!0)},get error(){return e(u).zip},set error(a){e(u).zip=a},$$events:{keypress:m,input:c},children:(a,z)=>{Y();var U=D("ZIP");l(a,U)},$$slots:{default:!0}});var q=i(d,2);ie(q,{autocomplete:"off",placeholder:"City",get value(){return s().user_values.city},set value(a){s(s().user_values.city=a,!0)},get error(){return e(u).city},set error(a){e(u).city=a},$$events:{keypress:m,input:c},children:(a,z)=>{Y();var U=D("CITY");l(a,U)},$$slots:{default:!0}});var F=i(q,2);ie(F,{autocomplete:"off",placeholder:"Country",get value(){return s().user_values.country},set value(a){s(s().user_values.country=a,!0)},get error(){return e(u).country},set error(a){e(u).country=a},$$events:{keypress:m,input:c},children:(a,z)=>{Y();var U=D("COUNTRY");l(a,U)},$$slots:{default:!0}});var ue=i(F,2);ie(ue,{autocomplete:"off",placeholder:"Phone",get value(){return s().user_values.phone},set value(a){s(s().user_values.phone=a,!0)},get error(){return e(u).phone},set error(a){e(u).phone=a},$$events:{keypress:m,input:c},children:(a,z)=>{Y();var U=D("PHONE");l(a,U)},$$slots:{default:!0}});var de=i(ue,2);ie(de,{type:"date",autocomplete:"off",placeholder:"Birthdate",get value(){return s().user_values.birthdate},set value(a){s(s().user_values.birthdate=a,!0)},get error(){return e(u).birthdate},set error(a){e(u).birthdate=a},$$events:{keypress:m,input:c},children:(a,z)=>{Y();var U=D("BIRTHDATE");l(a,U)},$$slots:{default:!0}});var re=i(de,2);Ie(re,"margin-top","-3px");var be=i(n(re),2);Pe(be,{get options(){return e(j)},searchThreshold:4,get items(){return s().roles},set items(a){s(s().roles=a,!0)}}),v(re);var ce=i(re,2),V=i(n(ce),2);Pe(V,{get options(){return e(y)},searchThreshold:4,get items(){return s().groups},set items(a){s(s().groups=a,!0)}}),v(ce);var ae=i(ce,2);Ie(ae,"margin-top","12px");var W=i(n(ae),2),Le=n(W);je(Le,{get selected(){return e(N)},set selected(a){t(N,r(a))}}),v(W),v(ae);var xe=i(ae,2);{var ze=a=>{var z=Me(()=>ja(new Date));ie(a,{type:"datetime-local",step:"60",width:"16rem",get min(){return e(z)},max:"2099-01-01T00:00",get value(){return e(x)},set value(U){t(x,r(U))},$$events:{input:c},children:(U,Xt)=>{Y();var fa=D("USER EXPIRES");l(U,fa)},$$slots:{default:!0}})};A(xe,a=>{e(N)&&a(ze)})}var me=i(xe,2);Ie(me,"margin-top","12px");var pe=i(n(me),2),qe=n(pe,!0);J(()=>ee(qe,Se(s().created_at))),v(pe),v(me);var _e=i(me,2),ke=i(n(_e),2),Ee=n(ke);{var Ce=a=>{var z=D();J(()=>ee(z,Se(s().last_login))),l(a,z)},Fe=a=>{var z=D("Never");l(a,z)};A(Ee,a=>{s().last_login?a(Ce):a(Fe,!1)})}v(ke),v(_e);var Oe=i(_e,2),Xe=i(n(Oe),2),va=n(Xe);{var na=a=>{var z=D();J(()=>ee(z,Se(s().password_expires))),l(a,z)},oa=a=>{var z=D("Never");l(a,z)};A(va,a=>{s().password_expires?a(na):a(oa,!1)})}v(Xe),v(Oe);var De=i(Oe,2),Be=i(n(De),2),ua=n(Be),da=Me(()=>!!s().webauthn_user_id);Oa(ua,{get check(){return e(da)}}),v(Be),v(De);var He=i(De,2),Ze=n(He);we(Ze,{level:1,width:"4rem",$$events:{click:C},children:(a,z)=>{Y();var U=D("SAVE");l(a,U)},$$slots:{default:!0}});var We=i(Ze,2);{var ca=a=>{var z=Za();l(a,z)};A(We,a=>{e(f)&&a(ca)})}var ma=i(We,2);{var pa=a=>{var z=Wa(),U=n(z,!0);v(z),J(()=>ee(U,e(_))),l(a,z)};A(ma,a=>{e(_)&&a(pa)})}v(He),v(L),J(()=>ee(O,s().id)),l(K,L),ge()}var Ja=I('<div class="desc svelte-8ppjyk"><p><b>The user has not initialized this account yet.</b></p> <p>You may send out a new Reset E-Mail, if the user has not received one.</p></div> <!>',1),et=I(`<div class="desc svelte-8ppjyk"><p><b>This is a passkey only account type.</b></p> <p>This means, that this user is using the passwordless login flow only and does not have any password.</p> <p>If the user has lost all his keys and you have verified everything, you may reset his account type and
                send out a new reset E-Mail, so the user can get access again.</p> <p>To reset the account, navigate to 'MFA' and delete all registered keys for this user.</p></div>`),at=I(`<!> <!> <!> <!> <div class="desc svelte-8ppjyk">You can either set and reset a user's password<br> or send out a new reset E-Mail for self-service.</div> <!> <!>`,1),tt=I('<div class="success svelte-8ppjyk">Success</div>'),st=I('<div class="err svelte-8ppjyk"> </div>'),rt=I('<div class="err svelte-8ppjyk"> </div>'),lt=I('<div class="container svelte-8ppjyk"><!> <!> <!> <!></div>');function it(K,T){he(T,!0);let s=$e(T,"user",27,()=>r({}));const _="inherit";let f=p(!1),b=p(""),S=p(""),N=p(!1),x=p(!1),j=p(void 0),y="330px",g=p(void 0),E=p(!1),u=r({new:"",verify:""});Ue(()=>{e(x)&&t(j,r(setTimeout(()=>{t(x,!1),T.onSave()},3e3)))}),Te(async()=>{if(!e(g)){let k=await Aa(),$=await k.json();k.ok?t(g,r($)):t(S,r($.message))}});async function w(){return t(S,""),await m()?e(E)?!0:(t(S,"You must follow the password policy"),!1):!1}async function m(){return t(S,""),u.new.length>256?(t(S,"max 256 characters"),!1):u.new!==u.verify?(t(S,"New passwords do not match"),!1):!0}async function C(){let k={email:s().email};t(b,""),t(f,!0);let $=await ya(k);if($.ok)t(N,!0);else{let R=await $.json();t(b,r(R.message))}t(f,!1)}async function c(){let k={email:s().email,given_name:s().given_name,family_name:s().family_name,roles:s().roles,groups:s().groups,enabled:s().enabled,email_verified:s().email_verified};if(u.new.length>0){if(!(await m()&&await w()))return;k.password=u.new}t(S,""),t(f,!0);let $=await Qe(s().id,k);if($.ok)t(x,!0);else{let R=await $.json();t(S,r(R.message))}t(f,!1)}function L(){const k=e(g).length_min>24?e(g).length_min:24;let $=Pa(k,e(g).include_lower_case,e(g).include_upper_case,e(g).include_digits,e(g).include_special);u.new=$,u.verify=$}var M=lt(),P=n(M);{var O=k=>{var $=Ja(),R=i(le($),2);we(R,{width:_,level:2,get isLoading(){return e(f)},set isLoading(Q){t(f,r(Q))},$$events:{click:C},children:(Q,o)=>{Y();var h=D("SEND RESET E-MAIL");l(Q,h)},$$slots:{default:!0}}),l(k,$)},B=k=>{var $=ye(),R=le($);{var Q=h=>{var G=et();l(h,G)},o=h=>{var G=at(),d=le(G);{var q=V=>{Ua(V,{get password(){return u.new},get policy(){return e(g)},get accepted(){return e(E)},set accepted(ae){t(E,r(ae))}})};A(d,V=>{e(g)&&V(q)})}var F=i(d,2),ue=Me(()=>u.new.length>0&&u.new===u.verify);la(F,{type:"password",get width(){return y},autocomplete:"off",get showCopy(){return e(ue)},get value(){return u.new},set value(V){u.new=V},$$events:{blur:m},children:(V,ae)=>{Y();var W=D("New Password");l(V,W)},$$slots:{default:!0}});var de=i(F,2);la(de,{type:"password",get width(){return y},autocomplete:"off",get value(){return u.verify},set value(V){u.verify=V},$$events:{blur:m},children:(V,ae)=>{Y();var W=D("New Password");l(V,W)},$$slots:{default:!0}});var re=i(de,2);we(re,{width:_,level:3,$$events:{click:L},children:(V,ae)=>{Y();var W=D("GENERATE RANDOM");l(V,W)},$$slots:{default:!0}});var be=i(re,4);we(be,{width:_,level:1,get isLoading(){return e(f)},set isLoading(V){t(f,r(V))},$$events:{click:C},children:(V,ae)=>{Y();var W=D("SEND RESET E-MAIL");l(V,W)},$$slots:{default:!0}});var ce=i(be,2);we(ce,{width:_,get isLoading(){return e(f)},set isLoading(V){t(f,r(V))},$$events:{click:c},children:(V,ae)=>{Y();var W=D("SAVE PASSWORD");l(V,W)},$$slots:{default:!0}}),l(h,G)};A(R,h=>{s().account_type==="passkey"?h(Q):h(o,!1)},!0)}l(k,$)};A(P,k=>{s().account_type==="new"?k(O):k(B,!1)})}var Z=i(P,2);{var oe=k=>{var $=tt();l(k,$)};A(Z,k=>{(e(x)||e(N))&&k(oe)})}var X=i(Z,2);{var H=k=>{var $=st(),R=n($,!0);v($),J(()=>ee(R,e(S))),l(k,$)};A(X,k=>{e(S)&&k(H)})}var te=i(X,2);{var se=k=>{var $=rt(),R=n($,!0);v($),J(()=>ee(R,e(b))),l(k,$)};A(te,k=>{e(b)&&k(se)})}v(M),l(K,M),ge()}var vt=I('<div class="err svelte-1jljqe9"> </div>'),nt=I('<div class="container svelte-1jljqe9"><div class="label svelte-1jljqe9">Are you sure, you want to delete this user?</div> <!> <!></div>');function ot(K,T){he(T,!0);let s=$e(T,"user",27,()=>r({})),_=p(!1),f=p("");async function b(){t(f,""),t(_,!0);let y=await wa(s().id);if(y.ok)T.onSave();else{let g=await y.json();t(f,r(g.message))}t(_,!1)}var S=nt(),N=i(n(S),2);we(N,{level:1,width:"5rem",get isLoading(){return e(_)},set isLoading(y){t(_,r(y))},$$events:{click:b},children:(y,g)=>{Y();var E=D("DELETE");l(y,E)},$$slots:{default:!0}});var x=i(N,2);{var j=y=>{var g=vt(),E=n(g,!0);v(g),J(()=>ee(E,e(f))),l(y,g)};A(x,y=>{e(f)&&y(j)})}v(S),l(K,S),ge()}var ut=I('<div class="err svelte-1ofwsjt"> </div>'),dt=I('<div class="success svelte-1ofwsjt">Success</div>'),ct=I('<div class="container svelte-1ofwsjt"><div class="label svelte-1ofwsjt">Invalidate all existing sessions and refresh tokens for this user?</div> <!> <!></div>');function mt(K,T){he(T,!0);let s=$e(T,"user",27,()=>r({})),_=p(!1),f=p(""),b=p(!1);async function S(){t(f,""),t(_,!0);let E=await $a(s().id);if(E.ok)t(b,!0);else{let u=await E.json();t(f,r(u.message))}t(_,!1)}var N=ct(),x=i(n(N),2);we(x,{level:1,get isLoading(){return e(_)},set isLoading(E){t(_,r(E))},$$events:{click:S},children:(E,u)=>{Y();var w=D("LOGOUT");l(E,w)},$$slots:{default:!0}});var j=i(x,2);{var y=E=>{var u=ut(),w=n(u,!0);v(u),J(()=>ee(w,e(f))),l(E,u)},g=E=>{var u=ye(),w=le(u);{var m=C=>{var c=dt();l(C,c)};A(w,C=>{e(b)&&C(m)},!0)}l(E,u)};A(j,E=>{e(f)?E(y):E(g,!1)})}v(N),l(K,N),ge()}var pt=I('<div class="success svelte-iv4fzr">Success</div>'),ft=I('<div class="err svelte-iv4fzr"> </div>'),ht=I('<div class="container svelte-iv4fzr"><div class="desc svelte-iv4fzr">Set custom user attributes.<br> All Key / Value pairs will be handled as String / String.</div> <!> <!> <!> <!></div>');function gt(K,T){he(T,!0);let s=p(""),_=p(r([])),f=p(!1),b=p(!1);Te(()=>{x()});async function S(){let c=await ba();if(!c.ok)t(s,"Error fetching attr: "+c.body.message);else return await c.json()}async function N(){let c=await _a(T.user.id);if(!c.ok)t(s,"Error fetching user attr: "+c.body.message);else return await c.json()}async function x(){let c=await S(),L=c.values;if(c){let M=await N();if(M){let P=new Map;for(let O of M.values)P.set(O.key,O.value||"");for(let O of L){let B=P.get(O.name);B?O.value=B:O.value=""}t(_,r([...L]))}}}async function j(){t(s,""),t(b,!0);let c=[];for(let O of e(_)){let B={key:O.name,value:O.value};c.push(B)}let L={values:c},M=await Ea(T.user.id,L),P=await M.json();M.ok?t(f,!0):t(s,r(P.message)),T.onSave(),t(b,!1)}var y=ht(),g=i(n(y),2);Ne(g,17,()=>e(_),ga,(c,L,M)=>{var P=Me(()=>e(L).desc||"JSON Value");ie(c,{style:"width: 350px",autocomplete:"off",get placeholder(){return e(P)},get value(){return e(L).value},set value(O){e(L).value=O},children:(O,B)=>{Y();var Z=D();J(()=>ee(Z,e(L).name)),l(O,Z)},$$slots:{default:!0}})});var E=i(g,2);we(E,{get isLoading(){return e(b)},level:1,width:"4rem",$$events:{click:j},children:(c,L)=>{Y();var M=D("SAVE");l(c,M)},$$slots:{default:!0}});var u=i(E,2);{var w=c=>{var L=pt();l(c,L)};A(u,c=>{e(f)&&c(w)})}var m=i(u,2);{var C=c=>{var L=ft(),M=n(L,!0);v(L),J(()=>ee(M,e(s))),l(c,L)};A(m,c=>{e(s)&&c(C)})}v(y),l(K,y),ge()}var yt=I('<div class="desc svelte-1a9qw6n">This user does not have any active MFA keys.</div>'),wt=I('<div class="keyContainer svelte-1a9qw6n"><div class="row svelte-1a9qw6n"><div class="label svelte-1a9qw6n">Passkey Name:</div> <b> </b></div> <div class="row svelte-1a9qw6n"><div class="label svelte-1a9qw6n">Key Registered:</div> <span class="font-mono"> </span></div> <div class="row svelte-1a9qw6n"><div class="label svelte-1a9qw6n">Last Usage:</div> <span class="font-mono"> </span></div> <div class="row svelte-1a9qw6n"><div class="label svelte-1a9qw6n"></div> <div class="deleteBtn svelte-1a9qw6n"><!></div></div></div>'),$t=I('<div class="desc svelte-1a9qw6n">You can delete the users MFA / Security Keys.<br> Be careful though, since this <b>cannot be reverted</b> without user interaction.<br> This is useful, if a user lost his keys and he is not able to log in any more.</div> <div class="keysContainer svelte-1a9qw6n"></div>',1),bt=I('<div class="err svelte-1a9qw6n"> </div>'),_t=I('<div class="container svelte-1a9qw6n"><!> <!></div>');function Et(K,T){he(T,!0);let s=$e(T,"user",27,()=>r({})),_=p(""),f=p(r([]));Te(async()=>{await b()});async function b(){let u=await Ra(s().id),w=await u.json();u.ok?t(f,r(w)):console.error("error fetching passkeys: "+w.message)}async function S(u){let w=e(f).length===1,m=await Ga(s().id,u);if(m.status===200)return await b(),w&&T.onSave(),!0;{let C=await m.json();return t(_,r(C.message)),!1}}var N=_t(),x=n(N);{var j=u=>{var w=yt();l(u,w)},y=u=>{var w=$t(),m=i(le(w),2);Ne(m,21,()=>e(f),C=>C.name,(C,c)=>{var L=wt(),M=n(L),P=i(n(M),2),O=n(P,!0);v(P),v(M);var B=i(M,2),Z=i(n(B),2),oe=n(Z,!0);J(()=>ee(oe,Se(e(c).registered))),v(Z),v(B);var X=i(B,2),H=i(n(X),2),te=n(H,!0);J(()=>ee(te,Se(e(c).last_used))),v(H),v(X);var se=i(X,2),k=i(n(se),2),$=n(k);we($,{level:4,$$events:{click:()=>S(e(c).name)},children:(R,Q)=>{Y();var o=D("DELETE");l(R,o)},$$slots:{default:!0}}),v(k),v(se),v(L),J(()=>ee(O,e(c).name)),l(C,L)}),v(m),l(u,w)};A(x,u=>{e(f).length<1?u(j):u(y,!1)})}var g=i(x,2);{var E=u=>{var w=bt(),m=n(w,!0);v(w),J(()=>ee(m,e(_))),l(u,w)};A(g,u=>{e(_)&&u(E)})}v(N),l(K,N),ge()}var It=I('<div class="container svelte-nw2ucx"><!></div>');function xt(K,T){he(T,!0);var s=It(),_=n(s);Va(_,{get userId(){return T.user.id}}),v(s),l(K,s),ge()}var kt=I('<div class="data font-mono svelte-115hohv"> </div>'),St=I('<div class="data svelte-115hohv"> </div>'),Lt=I('<div class="header svelte-115hohv"><!> <!></div>'),qt=I("<div><!></div>"),Tt=I("<div><!></div>"),Mt=I("<div><!></div>"),Nt=I("<div><!></div>"),jt=I("<div><!></div>"),Pt=I("<div><!></div>"),zt=I("<div><!></div>"),Ct=I("<!> <!>",1),Ft=I("<div><!></div>");function ia(K,T){he(T,!0);let s=$e(T,"userEmail",3,""),_=$e(T,"userId",3,""),f=$e(T,"onSave",15),b=p(void 0),S=p(!0),N=p(void 0);const x=["Info","Attributes","Password","MFA","Devices","Logout","Delete"];let j=p(r(x[0]));const y=200,g=y/2;async function E(){const w=await Ya(_());if(w.ok)t(b,r(await w.json()));else{let m=await w.json();console.error(m)}t(S,!1)}function u(){t(N,!1),f()()}Ue(()=>{e(N)&&E()}),ea(K,{get show(){return e(N)},set show(w){t(N,r(w))},header:w=>{var m=Lt(),C=n(m);aa(C,{text:"User ID",children:(L,M)=>{var P=kt(),O=n(P,!0);v(P),J(()=>ee(O,_())),l(L,P)},$$slots:{default:!0}});var c=i(C,2);aa(c,{text:"E-Mail",children:(L,M)=>{var P=St(),O=n(P,!0);v(P),J(()=>ee(O,s())),l(L,P)},$$slots:{default:!0}}),v(m),l(w,m)},body:w=>{var m=Ft(),C=n(m);{var c=M=>{Fa(M,{})},L=M=>{var P=Ct(),O=le(P);Da(O,{labels:x,get selected(){return e(j)},set selected(X){t(j,r(X))}});var B=i(O,2);{var Z=X=>{var H=qt(),te=n(H);Qa(te,{get user(){return e(b)},set user(se){t(b,r(se))},get onSave(){return f()},set onSave(se){f(se)}}),v(H),ve(5,H,()=>ne,()=>({delay:g,duration:y})),ve(6,H,()=>ne,()=>({duration:y})),l(X,H)},oe=X=>{var H=ye(),te=le(H);{var se=$=>{var R=Tt(),Q=n(R);gt(Q,{get user(){return e(b)},set user(o){t(b,r(o))},get onSave(){return f()},set onSave(o){f(o)}}),v(R),ve(5,R,()=>ne,()=>({delay:g,duration:y})),ve(6,R,()=>ne,()=>({duration:y})),l($,R)},k=$=>{var R=ye(),Q=le(R);{var o=G=>{var d=Mt(),q=n(d);it(q,{get user(){return e(b)},set user(F){t(b,r(F))},get onSave(){return f()},set onSave(F){f(F)}}),v(d),ve(5,d,()=>ne,()=>({delay:g,duration:y})),ve(6,d,()=>ne,()=>({duration:y})),l(G,d)},h=G=>{var d=ye(),q=le(d);{var F=de=>{var re=Nt(),be=n(re);Et(be,{get user(){return e(b)},set user(ce){t(b,r(ce))},get onSave(){return f()},set onSave(ce){f(ce)}}),v(re),ve(5,re,()=>ne,()=>({delay:g,duration:y})),ve(6,re,()=>ne,()=>({duration:y})),l(de,re)},ue=de=>{var re=ye(),be=le(re);{var ce=ae=>{var W=jt(),Le=n(W);xt(Le,{get user(){return e(b)},set user(xe){t(b,r(xe))}}),v(W),ve(5,W,()=>ne,()=>({delay:g,duration:y})),ve(6,W,()=>ne,()=>({duration:y})),l(ae,W)},V=ae=>{var W=ye(),Le=le(W);{var xe=me=>{var pe=Pt(),qe=n(pe);mt(qe,{get user(){return e(b)},set user(_e){t(b,r(_e))}}),v(pe),ve(5,pe,()=>ne,()=>({delay:g,duration:y})),ve(6,pe,()=>ne,()=>({duration:y})),l(me,pe)},ze=me=>{var pe=ye(),qe=le(pe);{var _e=ke=>{var Ee=zt(),Ce=n(Ee);ot(Ce,{onSave:u,get user(){return e(b)},set user(Fe){t(b,r(Fe))}}),v(Ee),ve(5,Ee,()=>ne,()=>({delay:g,duration:y})),ve(6,Ee,()=>ne,()=>({duration:y})),l(ke,Ee)};A(qe,ke=>{e(j)==="Delete"&&ke(_e)},!0)}l(me,pe)};A(Le,me=>{e(j)==="Logout"?me(xe):me(ze,!1)},!0)}l(ae,W)};A(be,ae=>{e(j)==="Devices"?ae(ce):ae(V,!1)},!0)}l(de,re)};A(q,de=>{e(j)==="MFA"?de(F):de(ue,!1)},!0)}l(G,d)};A(Q,G=>{e(j)==="Password"?G(o):G(h,!1)},!0)}l($,R)};A(te,$=>{e(j)==="Attributes"?$(se):$(k,!1)},!0)}l(X,H)};A(B,X=>{e(j)==="Info"?X(Z):X(oe,!1)})}l(M,P)};A(C,M=>{e(S)?M(c):M(L,!1)})}v(m),l(w,m)},$$slots:{header:!0,body:!0}}),ge()}var Ot=I('<div class="header font-label svelte-1y7ceqm">ADD NEW USER</div>'),Dt=I('<div class="err svelte-1y7ceqm"> </div>'),Ut=I('<div class="container svelte-1y7ceqm"><!> <!> <!> <div class="language svelte-1y7ceqm"><div class="label svelte-1y7ceqm">LANGUAGE</div> <div style="margin-top: .4rem"><!></div></div> <div class="tiles svelte-1y7ceqm"><div class="label font-label svelte-1y7ceqm">ROLES</div> <!></div> <div class="tiles svelte-1y7ceqm"><div class="label font-label svelte-1y7ceqm">GROUPS</div> <!></div> <div class="unit svelte-1y7ceqm"><div class="label font-label svelte-1y7ceqm">LIMIT LIFETIME</div> <div class="value"><!></div></div> <!> <div class="btn svelte-1y7ceqm"><!> <!></div></div>');function At(K,T){he(T,!0);let s=$e(T,"idx",31,()=>-1),_=p(""),f=p(void 0),b=p("EN"),S=p(!1),N=p(void 0),x=p(r({email:"",family_name:"",given_name:"",roles:[],groups:[]})),j=p(r({}));const y=Ae().shape({email:fe().required("E-Mail is required").email("Bad E-Mail format"),given_name:fe().trim().required("Given Name is required").matches(Re,"Invalid characters"),family_name:fe().trim().required("Family Name is required").matches(Re,"Invalid characters")});let g=p(void 0);Ye.subscribe(m=>{t(g,r(m))});let E=p(void 0);Ve.subscribe(m=>{t(E,r(m))});async function u(){if(!await w())return;t(_,"");let m=e(x);if(m.language=e(b).toLowerCase(),e(S)){let c=ra(e(N));if(!c){t(_,"Invalid Date Input: User Expires");return}m.user_expires=c}let C=await Ia(e(x));if(C.ok)t(x,r({})),t(f,!1),t(x,r({email:"",family_name:"",given_name:"",roles:[],groups:[]})),T.onSave();else{let c=await C.json();t(_,r(c.message))}}async function w(){try{return await y.validate(e(x),{abortEarly:!1}),t(j,r({})),!0}catch(m){return t(j,r(Ge(m))),!1}}ea(K,{get idx(){return s()},set idx(m){s(m)},get show(){return e(f)},set show(m){t(f,r(m))},header:m=>{var C=Ot();l(m,C)},body:m=>{var C=Ut(),c=n(C);ie(c,{type:"email",autocomplete:"off",placeholder:"E-Mail",get value(){return e(x).email},set value(d){e(x).email=d},get error(){return e(j).email},set error(d){e(j).email=d},$$events:{input:w},children:(d,q)=>{Y();var F=D("E-MAIL");l(d,F)},$$slots:{default:!0}});var L=i(c,2);ie(L,{autocomplete:"off",placeholder:"Given Name",get value(){return e(x).given_name},set value(d){e(x).given_name=d},get error(){return e(j).given_name},set error(d){e(j).given_name=d},$$events:{input:w},children:(d,q)=>{Y();var F=D("GIVEN NAME");l(d,F)},$$slots:{default:!0}});var M=i(L,2);ie(M,{autocomplete:"off",placeholder:"Family Name",get value(){return e(x).family_name},set value(d){e(x).family_name=d},get error(){return e(j).family_name},set error(d){e(j).family_name=d},$$events:{input:w},children:(d,q)=>{Y();var F=D("FAMILY NAME");l(d,F)},$$slots:{default:!0}});var P=i(M,2),O=i(n(P),2),B=n(O);Ke(B,{options:sa,get value(){return e(b)},set value(d){t(b,r(d))}}),v(O),v(P);var Z=i(P,2),oe=i(n(Z),2);Pe(oe,{get options(){return e(g)},searchThreshold:4,get items(){return e(x).roles},set items(d){e(x).roles=d}}),v(Z);var X=i(Z,2),H=i(n(X),2);Pe(H,{get options(){return e(E)},searchThreshold:4,get items(){return e(x).groups},set items(d){e(x).groups=d}}),v(X);var te=i(X,2);Ie(te,"margin-top","12px");var se=i(n(te),2),k=n(se);je(k,{get selected(){return e(S)},set selected(d){t(S,r(d))}}),v(se),v(te);var $=i(te,2);{var R=d=>{ie(d,{type:"datetime-local",step:"60",width:"18rem",get min(){return new Date().toISOString().split(".")[0]},max:"2099-01-01T00:00",get value(){return e(N)},set value(q){t(N,r(q))},$$events:{input:w},children:(q,F)=>{Y();var ue=D("USER EXPIRES");l(q,ue)},$$slots:{default:!0}})};A($,d=>{e(S)&&d(R)})}var Q=i($,2),o=n(Q);we(o,{level:1,$$events:{click:u},children:(d,q)=>{Y();var F=D("SAVE");l(d,F)},$$slots:{default:!0}});var h=i(o,2);{var G=d=>{var q=Dt(),F=n(q,!0);v(q),J(()=>ee(F,e(_))),l(d,q)};A(h,d=>{e(_)&&d(G)})}v(Q),v(C),l(m,C)},$$slots:{header:!0,body:!0}}),ge()}var Rt=I('<div class="svelte-1n3c0ep"><!></div>'),Gt=I('<div class="svelte-1n3c0ep"><!></div>'),Yt=I(' <div class="content"><!> <!> <div id="users" class="svelte-1n3c0ep"><!></div> <!></div>',1);function Vt(K,T){he(T,!0);let s=p(""),_=p(r([])),f=p(r([])),b=p(r([])),S=p(""),N=p(!1),x=p(""),j=p(0),y=p(15),g=p(""),E=p(1),u=p(r([{label:"E-Mail",callback:(o,h)=>o.email.toLowerCase().includes(h.toLowerCase())},{label:"ID",callback:(o,h)=>o.id.toLowerCase().includes(h.toLowerCase())}])),w=p(r([{label:"E-Mail",callback:(o,h)=>o.email.localeCompare(h.email)},{label:"ID",callback:(o,h)=>o.id.localeCompare(h.id)},{label:"Created",callback:(o,h)=>o.created_at<h.created_at},{label:"Last Login",callback:(o,h)=>{let G=o.last_login||9999999999,d=h.last_login||9999999999;return G<d}}]));Te(async()=>{m(),L(),M()});async function m(o,h,G,d){let q;if(o===!0?G&&e(E)===2?q=await Je(d||e(y),h,void 0,!1):q=await Je(d||e(y),h,e(g),G):q=await xa(),!q.ok)t(s,"Error fetching users: "+q.body.message);else{q.status===206?(t(y,r(Number.parseInt(q.headers.get("x-page-size"),10))),t(S,"user"),q.headers.get("x-continuation-token"),t(g,r(q.headers.get("x-continuation-token")))):t(S,""),t(j,r(q.headers.get("x-user-count")));let F=await q.json();t(_,r([...F])),t(f,r([...F]))}}async function C(o,h){await m(!0,o,h),h?t(E,e(E)-1):t(E,e(E)+1)}async function c(o){t(g,""),await m(!0,0,!1,o),t(E,1)}async function L(){let o=await ka();if(!o.ok)t(s,"Error fetching roles: "+o.body.message);else{let h=await o.json();za.set(h),Ye.set(h.map(G=>G.name))}}async function M(){let o=await Sa();if(!o.ok)t(s,"Error fetching groups: "+o.body.message);else{let h=await o.json();Ca.set(h),Ve.set(h.map(G=>G.name))}}function P(){m(),L(),M(),t(x,"")}Y();var O=Yt(),B=le(O),Z=i(B),oe=n(Z);Xa(oe,{get items(){return e(_)},get resItems(){return e(f)},set resItems(o){t(f,r(o))},get searchOptions(){return e(u)},set searchOptions(o){t(u,r(o))},get orderOptions(){return e(w)},set orderOptions(o){t(w,r(o))},get useServerSideIdx(){return e(S)},set useServerSideIdx(o){t(S,r(o))},get isSearchFiltered(){return e(N)},set isSearchFiltered(o){t(N,r(o))},get search(){return e(x)},set search(o){t(x,r(o))}});var X=i(oe,2);At(X,{onSave:P});var H=i(X,2),te=n(H);{var se=o=>{var h=ye(),G=le(h);Ne(G,17,()=>e(f),d=>d.id,(d,q)=>{var F=Rt(),ue=n(F);ia(ue,{get userId(){return e(q).id},get userEmail(){return e(q).email},onSave:P}),v(F),l(d,F)}),l(o,h)},k=o=>{var h=ye(),G=le(h);Ne(G,17,()=>e(b),d=>d.id,(d,q)=>{var F=Gt(),ue=n(F);ia(ue,{get userId(){return e(q).id},get userEmail(){return e(q).email},onSave:P}),v(F),l(d,F)}),l(o,h)};A(te,o=>{e(S)&&!e(N)?o(se):o(k,!1)})}v(H);var $=i(H,2);{var R=o=>{Ha(o,{get itemsTotal(){return e(j)},fetchPageCallback:C,sspPageSizeChange:c,get sspPage(){return e(E)},set sspPage(h){t(E,r(h))},get sspPageSize(){return e(y)},set sspPageSize(h){t(y,r(h))},get sspContinuationToken(){return e(g)},set sspContinuationToken(h){t(g,r(h))}})},Q=o=>{Ba(o,{get items(){return e(f)},set items(h){t(f,r(h))},get resItems(){return e(b)},set resItems(h){t(b,r(h))}})};A($,o=>{e(S)&&!e(N)?o(R):o(Q,!1)})}v(Z),J(()=>ee(B,`${e(s)??""} `)),l(K,O),ge()}export{Vt as U};

var y={};Object.defineProperty(y,"__esModule",{value:!0});function C(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function T(e,a){e||(e=43);for(var r=typeof window<"u"&&window.msCrypto||crypto,t=C(Array.prototype.map.call(r.getRandomValues(new Uint8Array(e)),function(n){return String.fromCharCode(n)}).join("")).substring(0,e),o=new Uint8Array(t.length),l=0;l<t.length;l++)o[l]=t.charCodeAt(l);var i=r.subtle.digest("SHA-256",o);typeof window<"u"&&window.CryptoOperation?(i.onerror=a,i.oncomplete=function(n){A(a,t,n.target.result)}):i.then(function(n){A(a,t,n)}).catch(a)}var S=y.default=T;function A(e,a,r){e(null,{verifier:a,challenge:C(String.fromCharCode.apply(null,new Uint8Array(r)))})}const p="pkce_verifier",_="pkce_verifier_upstream",f="csrf_token",$="access_token",I="id_token",w="provider_token",R="/auth/v1/oidc/authorize",U="rauthy",M="/auth/v1/oidc/logout",D="/auth/v1/oidc/callback",N="/auth/v1/admin",P="/auth/v1/account",j="/auth/v1/",B=["info","notice","warning","critical"],O=["-","InvalidLogins","IpBlacklisted","IpBlacklistRemoved","JwksRotated","NewUserRegistered","NewRauthyAdmin","NewRauthyVersion","PossibleBruteForce","RauthyStarted","RauthyHealthy","RauthyUnhealthy","SecretsMigrated","UserEmailChange","UserPasswordReset","Test"],z=["de","en","zh","ko"],F=["de","en"],H="tpl_auth_providers",x="tpl_client_name",E="tpl_client_url",J="tpl_csrf_token",L="tpl_email_old",V="tpl_email_new",q="tpl_error_text",G="tpl_device_user_code_length",K="tpl_is_reg_open",Q="tpl_login_action",Y="tpl_password_reset",W="tpl_status_code",X="tpl_restricted_email_domain";for(var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=typeof Uint8Array>"u"?[]:new Uint8Array(256),m=0;m<d.length;m++)h[d.charCodeAt(m)]=m;var b=function(e){var a=new Uint8Array(e),r,t=a.length,o="";for(r=0;r<t;r+=3)o+=d[a[r]>>2],o+=d[(a[r]&3)<<4|a[r+1]>>4],o+=d[(a[r+1]&15)<<2|a[r+2]>>6],o+=d[a[r+2]&63];return t%3===2?o=o.substring(0,o.length-1)+"=":t%3===1&&(o=o.substring(0,o.length-2)+"=="),o},Z=function(e){var a=e.length*.75,r=e.length,t,o=0,l,i,n,c;e[e.length-1]==="="&&(a--,e[e.length-2]==="="&&a--);var u=new ArrayBuffer(a),g=new Uint8Array(u);for(t=0;t<r;t+=4)l=h[e.charCodeAt(t)],i=h[e.charCodeAt(t+1)],n=h[e.charCodeAt(t+2)],c=h[e.charCodeAt(t+3)],g[o++]=l<<2|i>>4,g[o++]=(i&15)<<4|n>>2,g[o++]=(n&3)<<6|c&63;return u};function ee(e){return`${window.location.origin}/auth/${e}/profile#me`}function te(){return typeof window<"u"}function re(e){return e==="openid"||e==="profile"||e==="email"||e==="groups"||e==="address"||e==="phone"}const ae=e=>{S(64,(a,{challenge:r,verifier:t})=>{if(!a){localStorage.setItem(p,t);const o=k(24),l=e||"admin",i=`${window.location.origin}${D}`.replaceAll(":","%3A").replaceAll("/","%2F");window.location.href=`${R}?client_id=${U}&redirect_uri=${i}&response_type=code&code_challenge=${r}&code_challenge_method=S256&scope=openid+profile+email&nonce=${o}&state=${l}`}})},oe=()=>{const e=`${M}?post_logout_redirect_uri=${window.location.origin}${j}`;window.location.href=e},ne=e=>{console.log("saving csrf token in local storage",f,e),localStorage.setItem(f,e)},le=e=>{localStorage.setItem(I,e)},ie=e=>{localStorage.setItem($,e)},se=e=>{localStorage.setItem(w,e)},ce=()=>localStorage.getItem(w)||"",ue=()=>localStorage.getItem(p)||"",ge=()=>localStorage.getItem(_)||"",de=()=>{localStorage.removeItem(p)},he=()=>{localStorage.removeItem(f),localStorage.removeItem(I),localStorage.removeItem($),localStorage.removeItem(p),localStorage.removeItem(_),localStorage.removeItem(w)};function pe(e){let a=b(e);const r={"+":"-","/":"_","=":""};return a.replace(/[+/=]/g,t=>r[t])}function fe(e){switch(e){case"info":return"rgba(52,255,109,0.7)";case"notice":return"rgba(51,69,255,0.7)";case"warning":return"rgba(255,211,51,0.7)";case"critical":return"rgba(255,46,46,0.7)"}}const me=(e,a)=>{let r;if(a?r=Date.parse(`${e}T${a}`):r=Date.parse(e),!isNaN(r))return r/1e3},_e=(e,a)=>{const r=-new Date().getTimezoneOffset(),t=new Date((e+r*60)*1e3);let o=t.getUTCDate();o<10&&(o="0"+o);let l=t.getUTCMonth()+1;l<10&&(l="0"+l);const i=t.getUTCFullYear();let n=t.getUTCHours();n<10&&(n="0"+n);let c=t.getUTCMinutes();c<10&&(c="0"+c);let u=t.getUTCSeconds();return u<10&&(u="0"+u),`${i}/${l}/${o} ${n}:${c}:${u}`},we=e=>{const a=e.length_min>20?e.length_min:20,r=e.include_lower_case||1,t=e.include_upper_case||1,o=e.include_digits||1,l=e.include_digits||1;for(;;){let i=0,n=0,c=0,u=0,g=[];for(let v=0;v<a;v+=1){let s=60;for(;s>57&&s<65||s>90&&s<97;)s=Math.floor(Math.random()*74)+33;s>=91&&s<=122&&(i+=1),s>=65&&s<=90&&(n+=1),s>=48&&s<=57&&(c+=1),s>=33&&s<=47&&(u+=1),g.push(String.fromCharCode(s))}if(!(i<r||n<t||u<l||c<o))return g.join("")}},k=e=>{let a=[];e=e||8;for(let r=0;r<e;r+=1){let t=95;for(;t>90&&t<97;)t=Math.floor(Math.random()*57)+65;a.push(String.fromCharCode(t))}return a.join("")};function ve(e){let a=e+"=",r=decodeURIComponent(document.cookie).split(";");for(let t=0;t<r.length;t++){let o=r[t];for(;o.charAt(0)===" ";)o=o.substring(1);if(o.indexOf(a)===0)return o.substring(a.length,o.length)}return""}function ye(e,a){let r;return Promise.race([e,new Promise((t,o)=>{r=setTimeout(o,a,"timeout")})]).finally(()=>clearTimeout(r))}export{we as A,me as B,f as C,B as D,O as E,Z as F,b as G,pe as H,H as I,x as J,E as K,F as L,Q as M,se as N,re as O,_ as P,ee as Q,N as R,oe as S,W as T,S as _,q as a,U as b,ue as c,le as d,ne as e,de as f,k as g,P as h,te as i,K as j,_e as k,fe as l,G as m,ve as n,z as o,ye as p,he as q,ae as r,ie as s,J as t,ge as u,ce as v,X as w,L as x,V as y,Y as z};

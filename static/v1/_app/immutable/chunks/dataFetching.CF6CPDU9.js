const m="pkce_verifier",w="pkce_verifier_upstream",p="csrf_token",A="access_token",O="id_token",v="provider_token",z="/auth/v1/oidc/authorize",C="rauthy",j="/auth/v1/oidc/logout",U="/auth/v1/oidc/callback",J="/auth/v1/admin",D="/auth/v1/account",R="/auth/v1/",B=/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/gm,G=/^\+[0-9\s]{0,32}$/gm,q=/^[a-zA-Z0-9À-ÿ-.\s]{0,48}$/gm,Z=/^[a-zA-Z0-9À-ÿ-]{0,48}$/gm,M=/^[a-zA-Z0-9_/-]{2,24}$/gm,x=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{1,32}$/gm,L=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{0,32}$/gm,H=/^[a-zA-Z0-9\-_/\s]{0,128}$/gm,V=/^[a-zA-Z0-9\-_/]{2,32}$/gm,K=/^[a-zA-Z0-9\-_/]{2,128}$/gm,W=/^[a-zA-Z0-9À-ſ\-\s\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{0,128}$/m,Y=/^[a-zA-Z0-9+.@/:]{0,48}$/gm,Q=/^[a-z0-9-_\/:\s]{0,128}$/gm,X=/^[a-z0-9.:-]+:\/\/[a-z0-9.:-]+$/m,ee=/^(-----BEGIN CERTIFICATE-----)[a-zA-Z0-9+/=\n]+(-----END CERTIFICATE-----)$/gm,ae=/^[a-z0-9\-_/:*]{2,64}$/gm,te=/^[a-zA-Z0-9,.:/_\-&?=~#!$'()*+%]*$/gm,re=/^(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}$/gm,ne=/(#(?:[0-9a-f]{2}){2,4}$|(#[0-9a-f]{3}$)|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\)$|black$|silver$|gray$|whitesmoke$|maroon$|red$|purple$|fuchsia$|green$|lime$|olivedrab$|yellow$|navy$|blue$|teal$|aquamarine$|orange$|aliceblue$|antiquewhite$|aqua$|azure$|beige$|bisque$|blanchedalmond$|blueviolet$|brown$|burlywood$|cadetblue$|chartreuse$|chocolate$|coral$|cornflowerblue$|cornsilk$|crimson$|currentcolor$|darkblue$|darkcyan$|darkgoldenrod$|darkgray$|darkgreen$|darkgrey$|darkkhaki$|darkmagenta$|darkolivegreen$|darkorange$|darkorchid$|darkred$|darksalmon$|darkseagreen$|darkslateblue$|darkslategray$|darkslategrey$|darkturquoise$|darkviolet$|deeppink$|deepskyblue$|dimgray$|dimgrey$|dodgerblue$|firebrick$|floralwhite$|forestgreen$|gainsboro$|ghostwhite$|goldenrod$|gold$|greenyellow$|grey$|honeydew$|hotpink$|indianred$|indigo$|ivory$|khaki$|lavenderblush$|lavender$|lawngreen$|lemonchiffon$|lightblue$|lightcoral$|lightcyan$|lightgoldenrodyellow$|lightgray$|lightgreen$|lightgrey$|lightpink$|lightsalmon$|lightseagreen$|lightskyblue$|lightslategray$|lightslategrey$|lightsteelblue$|lightyellow$|limegreen$|linen$|mediumaquamarine$|mediumblue$|mediumorchid$|mediumpurple$|mediumseagreen$|mediumslateblue$|mediumspringgreen$|mediumturquoise$|mediumvioletred$|midnightblue$|mintcream$|mistyrose$|moccasin$|navajowhite$|oldlace$|olive$|orangered$|orchid$|palegoldenrod$|palegreen$|paleturquoise$|palevioletred$|papayawhip$|peachpuff$|peru$|pink$|plum$|powderblue$|rosybrown$|royalblue$|saddlebrown$|salmon$|sandybrown$|seagreen$|seashell$|sienna$|skyblue$|slateblue$|slategray$|slategrey$|snow$|springgreen$|steelblue$|tan$|thistle$|tomato$|transparent$|turquoise$|violet$|wheat$|white$|yellowgreen$|rebeccapurple$)/i,oe=3,se=["Info","Notice","Warning","Critical"],ie=["InvalidLogins","IpBlacklisted","IpBlacklistRemoved","JwksRotated","NewUserRegistered","NewRauthyAdmin","NewRauthyVersion","PossibleBruteForce","RauthyStarted","RauthyHealthy","RauthyUnhealthy","SecretsMigrated","UserEmailChange","UserPasswordReset","Test"],ue=["de","en","zh","ko"],ce=["RS256","RS384","RS512","EdDSA"],le=[{label:"authorization_code",value:!1},{label:"client_credentials",value:!1},{label:"password",value:!1},{label:"refresh_token",value:!1},{label:"device_code",value:!1}],de=[{label:"S256",value:!1},{label:"plain",value:!1}],he="tpl_auth_providers",$e="tpl_client_name",fe="tpl_client_url",ge="tpl_csrf_token",me="tpl_error_text",ye="tpl_device_user_code_length",we="tpl_is_reg_open",pe="tpl_login_action",ve="tpl_status_code";var E={};Object.defineProperty(E,"__esModule",{value:!0});function P(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function be(e,a){e||(e=43);for(var t=typeof window<"u"&&window.msCrypto||crypto,n=P(Array.prototype.map.call(t.getRandomValues(new Uint8Array(e)),function(i){return String.fromCharCode(i)}).join("")).substring(0,e),r=new Uint8Array(n.length),s=0;s<n.length;s++)r[s]=n.charCodeAt(s);var c=t.subtle.digest("SHA-256",r);typeof window<"u"&&window.CryptoOperation?(c.onerror=a,c.oncomplete=function(i){N(a,n,i.target.result)}):c.then(function(i){N(a,n,i)}).catch(a)}var I=E.default=be;function N(e,a,t){e(null,{verifier:a,challenge:P(String.fromCharCode.apply(null,new Uint8Array(t)))})}for(var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=typeof Uint8Array>"u"?[]:new Uint8Array(256),y=0;y<f.length;y++)g[f.charCodeAt(y)]=y;var Se=function(e){var a=new Uint8Array(e),t,n=a.length,r="";for(t=0;t<n;t+=3)r+=f[a[t]>>2],r+=f[(a[t]&3)<<4|a[t+1]>>4],r+=f[(a[t+1]&15)<<2|a[t+2]>>6],r+=f[a[t+2]&63];return n%3===2?r=r.substring(0,r.length-1)+"=":n%3===1&&(r=r.substring(0,r.length-2)+"=="),r},Fe=function(e){var a=e.length*.75,t=e.length,n,r=0,s,c,i,d;e[e.length-1]==="="&&(a--,e[e.length-2]==="="&&a--);var h=new ArrayBuffer(a),$=new Uint8Array(h);for(n=0;n<t;n+=4)s=g[e.charCodeAt(n)],c=g[e.charCodeAt(n+1)],i=g[e.charCodeAt(n+2)],d=g[e.charCodeAt(n+3)],$[r++]=s<<2|c>>4,$[r++]=(c&15)<<4|i>>2,$[r++]=(i&3)<<6|d&63;return h};function _e(e){return`${window.location.origin}/auth/${e}/profile#me`}function ke(e){return e.inner.reduce((a,t)=>({...a,[t.path]:t.message}),{})}function Te(e){return e==="openid"||e==="profile"||e==="email"||e==="groups"||e==="address"||e==="phone"}const Ae=e=>{I(64,(a,{challenge:t,verifier:n})=>{if(!a){localStorage.setItem(m,n);const r=xe(24),s=e||"admin",c=`${window.location.origin}${U}`.replaceAll(":","%3A").replaceAll("/","%2F");window.location.href=`${z}?client_id=${C}&redirect_uri=${c}&response_type=code&code_challenge=${t}&code_challenge_method=S256&scope=openid+profile+email&nonce=${r}&state=${s}`}})},Oe=()=>{const e=`${j}?post_logout_redirect_uri=${window.location.origin}${R}`;window.location.href=e},Ce=e=>{localStorage.setItem(p,e)},b=()=>localStorage.getItem(p)||"",Ee=e=>{localStorage.setItem(O,e)},Pe=e=>{localStorage.setItem(A,e)},Ie=e=>{localStorage.setItem(v,e)},Ne=()=>localStorage.getItem(v)||"",ze=()=>localStorage.getItem(m)||"",je=()=>localStorage.getItem(w)||"",Ue=()=>{localStorage.removeItem(m)},Je=()=>{localStorage.removeItem(p),localStorage.removeItem(O),localStorage.removeItem(A),localStorage.removeItem(m),localStorage.removeItem(w),localStorage.removeItem(v)};function De(e){let a=Se(e);const t={"+":"-","/":"_","=":""};return a.replace(/[+/=]/g,n=>t[n])}function Re(e){const a={"-":"+",_:"/",".":"="},t=e.replace(/[-_.]/g,n=>a[n]);return Fe(t)}function Be(e){switch(e){case"test":return"#b2b2b2";case"info":return"#388c51";case"notice":return"#3d5d99";case"warning":return"#c29a4f";case"critical":return"#993d49"}}const Ge=e=>e.toISOString().slice(0,16),qe=e=>{let a=Date.parse(e);if(!isNaN(a))return a/1e3},Ze=(e,a)=>{const t=-new Date().getTimezoneOffset(),n=new Date((e+t*60)*1e3);let r=n.getUTCDate();r<10&&(r="0"+r);let s=n.getUTCMonth()+1;s<10&&(s="0"+s);const c=n.getUTCFullYear();let i=n.getUTCHours();i<10&&(i="0"+i);let d=n.getUTCMinutes();d<10&&(d="0"+d);let h=n.getUTCSeconds();return h<10&&(h="0"+h),a?`${c}-${s}-${r}T${i}:${d}:${h}`:`${c}/${s}/${r} ${i}:${d}:${h}`},Me=(e,a,t,n,r)=>{const s=a||1,c=t||1,i=n||1,d=r||1;for(;;){let h=e||16,$=0,S=0,F=0,_=0,k=[];for(let T=0;T<h;T+=1){let l=60;for(;l>57&&l<65||l>90&&l<97;)l=Math.floor(Math.random()*74)+33;l>=91&&l<=122&&($+=1),l>=65&&l<=90&&(S+=1),l>=48&&l<=57&&(F+=1),l>=33&&l<=47&&(_+=1),k.push(String.fromCharCode(l))}if(!($<s||S<c||_<d||F<i))return k.join("")}},xe=e=>{let a="";const t=e;for(let n=0;n<t;n+=1){let r=60;for(;r>57&&r<65||r>90&&r<97;)r=Math.floor(Math.random()*74)+48;a=a.concat(String.fromCharCode(r))}return a},Le=()=>new Proxy(new URLSearchParams(window.location.search),{get:(e,a)=>e.get(a.toString())}),He=(e,a)=>{let t;return Promise.race([e,new Promise((n,r)=>t=setTimeout(r,a,"timeout"))]).finally(()=>clearTimeout(t))},u={json:{"Content-Type":"application/json",Accept:"application/json"},form:{"Content-type":"application/x-www-form-urlencoded",Accept:"application/json"}};function o(){return{...u.json,"csrf-token":b()}}function Ve(){return{...u.form,"csrf-token":b()}}async function Ke(e){const a=await fetch("/auth/v1/oidc/authorize",{method:"POST",headers:o(),body:JSON.stringify(e)});return a.status===202&&window.location.replace(a.headers.get("location")),a}async function We(e){const a=await fetch("/auth/v1/oidc/authorize/refresh",{method:"POST",headers:o(),body:JSON.stringify(e)});return a.status===202&&window.location.replace(a.headers.get("location")),a}async function Ye(){return await fetch("/auth/v1/version",{method:"GET",headers:u.json})}async function Qe(){return await fetch("/auth/v1/auth_check_admin",{method:"GET",headers:u.json})}async function Xe(e){return await fetch("/auth/v1/oidc/token",{method:"POST",headers:u.form,body:e})}async function ea(){return await fetch("/auth/v1/oidc/sessioninfo",{method:"GET",headers:u.json})}async function aa(e){return await fetch("/auth/v1/oidc/sessioninfo/xsrf",{method:"GET",headers:{...u.json,Authorization:`Bearer ${e}`}})}async function ta(e){let a=new FormData;for(let t in e)a.append(t,e[t]);return await fetch("/auth/v1/oidc/logout",{method:"POST",headers:Ve(),body:a})}async function ra(e){return await fetch("/auth/v1/oidc/device/verify",{method:"POST",headers:o(),body:JSON.stringify(e)})}async function na(){return await fetch("/auth/v1/fed_cm/status",{method:"GET",headers:u.json})}async function oa(){return await fetch("/auth/v1/password_policy",{method:"GET",headers:u.json})}async function sa(){return await fetch("/auth/v1/pow",{method:"POST",headers:u.json})}async function ia(e,a,t){return await fetch(`/auth/v1/users/${e}/reset`,{method:"PUT",headers:{...u.json,"pwd-csrf-token":t},body:JSON.stringify(a)})}async function ua(e){return await fetch("/auth/v1/users/request_reset",{method:"POST",headers:o(),body:JSON.stringify(e)})}async function ca(e){return await fetch("/auth/v1/providers/login",{method:"POST",headers:o(),body:JSON.stringify(e)})}async function la(e){return await fetch("/auth/v1/providers/callback",{method:"POST",headers:o(),body:JSON.stringify(e)})}async function da(){return await fetch("/auth/v1/events/test",{method:"POST",headers:o()})}async function ha(e){return await fetch("/auth/v1/users/register",{method:"POST",headers:u.json,body:JSON.stringify(e)})}async function $a(e){return await fetch(`/auth/v1/users/${e}`,{method:"GET",headers:u.json})}async function fa(e){return await fetch(`/auth/v1/users/${e}/devices`,{method:"GET",headers:o()})}async function ga(e,a){return await fetch(`/auth/v1/users/${e}/devices`,{method:"PUT",headers:o(),body:JSON.stringify(a)})}async function ma(e,a){return await fetch(`/auth/v1/users/${e}/devices`,{method:"DELETE",headers:o(),body:JSON.stringify(a)})}async function ya(e){return await fetch(`/auth/v1/users/${e}/webauthn`,{method:"GET",headers:o()})}async function wa(e,a){return await fetch(`/auth/v1/providers/${e}/link`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function pa(){return await fetch("/auth/v1/providers/link",{method:"DELETE",headers:o()})}async function va(e){return await fetch(`/auth/v1/users/${e}/webid/data`,{method:"GET",headers:o()})}async function ba(e,a){return await fetch(`/auth/v1/users/${e}/webid/data`,{method:"PUT",headers:o(),body:JSON.stringify(a)})}async function Sa(e,a){return await fetch(`/auth/v1/users/${e}/self`,{method:"PUT",headers:o(),body:JSON.stringify(a)})}async function Fa(e){return await fetch(`/auth/v1/users/${e}/self/convert_passkey`,{method:"POST",headers:o()})}async function _a(){return await fetch("/auth/v1/update_language",{method:"POST",headers:o()})}async function ka(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/register/start`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function Ta(e,a,t){return await fetch(`/auth/v1/users/${e}/webauthn/register/start`,{method:"POST",headers:{...u.json,"pwd-csrf-token":t},body:JSON.stringify(a)})}async function Aa(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/register/finish`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function Oa(e,a,t){return await fetch(`/auth/v1/users/${e}/webauthn/register/finish`,{method:"POST",headers:{...u.json,"pwd-csrf-token":t},body:JSON.stringify(a)})}async function Ca(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/auth/start`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function Ea(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/auth/finish`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function Pa(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/delete/${a}`,{method:"DELETE",headers:o()})}export{ye as $,Re as A,De as B,C,Oa as D,he as E,$e as F,fe as G,pe as H,we as I,Ke as J,Ze as K,ue as L,ca as M,Ie as N,We as O,w as P,ua as Q,J as R,je as S,ve as T,Ne as U,la as V,Ea as W,He as X,ea as Y,Ae as Z,I as _,ze as a,ra as a0,fa as a1,ga as a2,W as a3,ma as a4,_e as a5,pa as a6,wa as a7,B as a8,G as a9,V as aA,H as aB,Be as aC,se as aD,da as aE,re as aF,M as aG,ie as aH,Q as aI,ee as aJ,Qe as aK,q as aa,Z as ab,Sa as ac,ya as ad,ka as ae,Aa as af,Pa as ag,oa as ah,Fa as ai,ba as aj,Oe as ak,$a as al,va as am,b as an,oe as ao,qe as ap,Ge as aq,ae as ar,Te as as,le as at,de as au,Y as av,X as aw,ce as ax,ne as ay,K as az,Xe as b,Ee as c,aa as d,Ce as e,Ue as f,Le as g,D as h,sa as i,Ye as j,me as k,te as l,na as m,ke as n,ge as o,ta as p,Je as q,ha as r,Pe as s,x as t,L as u,_a as v,Me as w,Ca as x,ia as y,Ta as z};

const m="pkce_verifier",w="pkce_verifier_upstream",p="csrf_token",A="access_token",O="id_token",v="provider_token",z="/auth/v1/oidc/authorize",C="rauthy",j="/auth/v1/oidc/logout",J="/auth/v1/oidc/callback",U="/auth/v1/admin",D="/auth/v1/account",R="/auth/v1/",B=/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/gm,G=/^\+[0-9\s]{0,32}$/gm,q=/^[a-zA-Z0-9À-ÿ-.\s]{0,48}$/gm,Z=/^[a-zA-Z0-9À-ÿ-]{0,48}$/gm,M=/^[a-zA-Z0-9_/-]{2,24}$/gm,x=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{1,32}$/gm,L=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{0,32}$/gm,H=/^[a-zA-Z0-9\-_/\s]{0,128}$/gm,V=/^[a-zA-Z0-9\-_/]{2,32}$/gm,K=/^[a-zA-Z0-9\-_/]{2,128}$/gm,W=/^[a-zA-Z0-9À-ſ\-\s\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{0,128}$/m,Y=/^[a-zA-Z0-9+.@/:]{0,48}$/gm,Q=/^[a-z0-9-_\/:\s]{0,128}$/gm,X=/^[a-z0-9.:-]+:\/\/[a-z0-9.:-]+$/m,ee=/^(-----BEGIN CERTIFICATE-----)[a-zA-Z0-9+/=\n]+(-----END CERTIFICATE-----)$/gm,ae=/^[a-z0-9\-_/:*]{2,64}$/gm,te=/^[a-zA-Z0-9,.:/_\-&?=~#!$'()*+%]*$/gm,re=/^(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}$/gm,ne=/(#(?:[0-9a-f]{2}){2,4}$|(#[0-9a-f]{3}$)|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\)$|black$|silver$|gray$|whitesmoke$|maroon$|red$|purple$|fuchsia$|green$|lime$|olivedrab$|yellow$|navy$|blue$|teal$|aquamarine$|orange$|aliceblue$|antiquewhite$|aqua$|azure$|beige$|bisque$|blanchedalmond$|blueviolet$|brown$|burlywood$|cadetblue$|chartreuse$|chocolate$|coral$|cornflowerblue$|cornsilk$|crimson$|currentcolor$|darkblue$|darkcyan$|darkgoldenrod$|darkgray$|darkgreen$|darkgrey$|darkkhaki$|darkmagenta$|darkolivegreen$|darkorange$|darkorchid$|darkred$|darksalmon$|darkseagreen$|darkslateblue$|darkslategray$|darkslategrey$|darkturquoise$|darkviolet$|deeppink$|deepskyblue$|dimgray$|dimgrey$|dodgerblue$|firebrick$|floralwhite$|forestgreen$|gainsboro$|ghostwhite$|goldenrod$|gold$|greenyellow$|grey$|honeydew$|hotpink$|indianred$|indigo$|ivory$|khaki$|lavenderblush$|lavender$|lawngreen$|lemonchiffon$|lightblue$|lightcoral$|lightcyan$|lightgoldenrodyellow$|lightgray$|lightgreen$|lightgrey$|lightpink$|lightsalmon$|lightseagreen$|lightskyblue$|lightslategray$|lightslategrey$|lightsteelblue$|lightyellow$|limegreen$|linen$|mediumaquamarine$|mediumblue$|mediumorchid$|mediumpurple$|mediumseagreen$|mediumslateblue$|mediumspringgreen$|mediumturquoise$|mediumvioletred$|midnightblue$|mintcream$|mistyrose$|moccasin$|navajowhite$|oldlace$|olive$|orangered$|orchid$|palegoldenrod$|palegreen$|paleturquoise$|palevioletred$|papayawhip$|peachpuff$|peru$|pink$|plum$|powderblue$|rosybrown$|royalblue$|saddlebrown$|salmon$|sandybrown$|seagreen$|seashell$|sienna$|skyblue$|slateblue$|slategray$|slategrey$|snow$|springgreen$|steelblue$|tan$|thistle$|tomato$|transparent$|turquoise$|violet$|wheat$|white$|yellowgreen$|rebeccapurple$)/i,se=3,oe=["Info","Notice","Warning","Critical"],ie=["InvalidLogins","IpBlacklisted","IpBlacklistRemoved","JwksRotated","NewUserRegistered","NewRauthyAdmin","NewRauthyVersion","PossibleBruteForce","RauthyStarted","RauthyHealthy","RauthyUnhealthy","SecretsMigrated","UserEmailChange","UserPasswordReset","Test"],ue=["de","en","zh","ko"],ce=["RS256","RS384","RS512","EdDSA"],le=[{label:"authorization_code",value:!1},{label:"client_credentials",value:!1},{label:"password",value:!1},{label:"refresh_token",value:!1},{label:"device_code",value:!1}],de=[{label:"S256",value:!1},{label:"plain",value:!1}],he="tpl_auth_providers",$e="tpl_client_name",fe="tpl_client_url",ge="tpl_csrf_token",me="tpl_email_old",ye="tpl_email_new",we="tpl_error_text",pe="tpl_device_user_code_length",ve="tpl_is_reg_open",be="tpl_login_action",Se="tpl_password_reset",_e="tpl_status_code",Fe="tpl_restricted_email_domain";var E={};Object.defineProperty(E,"__esModule",{value:!0});function P(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function ke(e,a){e||(e=43);for(var t=typeof window<"u"&&window.msCrypto||crypto,n=P(Array.prototype.map.call(t.getRandomValues(new Uint8Array(e)),function(i){return String.fromCharCode(i)}).join("")).substring(0,e),r=new Uint8Array(n.length),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);var c=t.subtle.digest("SHA-256",r);typeof window<"u"&&window.CryptoOperation?(c.onerror=a,c.oncomplete=function(i){I(a,n,i.target.result)}):c.then(function(i){I(a,n,i)}).catch(a)}var N=E.default=ke;function I(e,a,t){e(null,{verifier:a,challenge:P(String.fromCharCode.apply(null,new Uint8Array(t)))})}for(var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=typeof Uint8Array>"u"?[]:new Uint8Array(256),y=0;y<f.length;y++)g[f.charCodeAt(y)]=y;var Te=function(e){var a=new Uint8Array(e),t,n=a.length,r="";for(t=0;t<n;t+=3)r+=f[a[t]>>2],r+=f[(a[t]&3)<<4|a[t+1]>>4],r+=f[(a[t+1]&15)<<2|a[t+2]>>6],r+=f[a[t+2]&63];return n%3===2?r=r.substring(0,r.length-1)+"=":n%3===1&&(r=r.substring(0,r.length-2)+"=="),r},Ae=function(e){var a=e.length*.75,t=e.length,n,r=0,o,c,i,d;e[e.length-1]==="="&&(a--,e[e.length-2]==="="&&a--);var h=new ArrayBuffer(a),$=new Uint8Array(h);for(n=0;n<t;n+=4)o=g[e.charCodeAt(n)],c=g[e.charCodeAt(n+1)],i=g[e.charCodeAt(n+2)],d=g[e.charCodeAt(n+3)],$[r++]=o<<2|c>>4,$[r++]=(c&15)<<4|i>>2,$[r++]=(i&3)<<6|d&63;return h};function Oe(e){return`${window.location.origin}/auth/${e}/profile#me`}function Ce(e){return e.inner.reduce((a,t)=>({...a,[t.path]:t.message}),{})}function Ee(e){return e==="openid"||e==="profile"||e==="email"||e==="groups"||e==="address"||e==="phone"}const Pe=e=>{N(64,(a,{challenge:t,verifier:n})=>{if(!a){localStorage.setItem(m,n);const r=Ke(24),o=e||"admin",c=`${window.location.origin}${J}`.replaceAll(":","%3A").replaceAll("/","%2F");window.location.href=`${z}?client_id=${C}&redirect_uri=${c}&response_type=code&code_challenge=${t}&code_challenge_method=S256&scope=openid+profile+email&nonce=${r}&state=${o}`}})},Ne=()=>{const e=`${j}?post_logout_redirect_uri=${window.location.origin}${R}`;window.location.href=e},Ie=e=>{localStorage.setItem(p,e)},b=()=>localStorage.getItem(p)||"",ze=e=>{localStorage.setItem(O,e)},je=e=>{localStorage.setItem(A,e)},Je=e=>{localStorage.setItem(v,e)},Ue=()=>localStorage.getItem(v)||"",De=()=>localStorage.getItem(m)||"",Re=()=>localStorage.getItem(w)||"",Be=()=>{localStorage.removeItem(m)},Ge=()=>{localStorage.removeItem(p),localStorage.removeItem(O),localStorage.removeItem(A),localStorage.removeItem(m),localStorage.removeItem(w),localStorage.removeItem(v)};function qe(e){let a=Te(e);const t={"+":"-","/":"_","=":""};return a.replace(/[+/=]/g,n=>t[n])}function Ze(e){const a={"-":"+",_:"/",".":"="},t=e.replace(/[-_.]/g,n=>a[n]);return Ae(t)}function Me(e){switch(e){case"test":return"#b2b2b2";case"info":return"#388c51";case"notice":return"#3d5d99";case"warning":return"#c29a4f";case"critical":return"#993d49"}}const xe=e=>e.toISOString().slice(0,16),Le=e=>{let a=Date.parse(e);if(!isNaN(a))return a/1e3},He=(e,a)=>{const t=-new Date().getTimezoneOffset(),n=new Date((e+t*60)*1e3);let r=n.getUTCDate();r<10&&(r="0"+r);let o=n.getUTCMonth()+1;o<10&&(o="0"+o);const c=n.getUTCFullYear();let i=n.getUTCHours();i<10&&(i="0"+i);let d=n.getUTCMinutes();d<10&&(d="0"+d);let h=n.getUTCSeconds();return h<10&&(h="0"+h),a?`${c}-${o}-${r}T${i}:${d}:${h}`:`${c}/${o}/${r} ${i}:${d}:${h}`},Ve=(e,a,t,n,r)=>{const o=a||1,c=t||1,i=n||1,d=r||1;for(;;){let h=e||16,$=0,S=0,_=0,F=0,k=[];for(let T=0;T<h;T+=1){let l=60;for(;l>57&&l<65||l>90&&l<97;)l=Math.floor(Math.random()*74)+33;l>=91&&l<=122&&($+=1),l>=65&&l<=90&&(S+=1),l>=48&&l<=57&&(_+=1),l>=33&&l<=47&&(F+=1),k.push(String.fromCharCode(l))}if(!($<o||S<c||F<d||_<i))return k.join("")}},Ke=e=>{let a="";const t=e;for(let n=0;n<t;n+=1){let r=60;for(;r>57&&r<65||r>90&&r<97;)r=Math.floor(Math.random()*74)+48;a=a.concat(String.fromCharCode(r))}return a},We=(e,a)=>{let t;return Promise.race([e,new Promise((n,r)=>t=setTimeout(r,a,"timeout"))]).finally(()=>clearTimeout(t))},u={json:{"Content-Type":"application/json",Accept:"application/json"},form:{"Content-type":"application/x-www-form-urlencoded",Accept:"application/json"}};function s(){return{...u.json,"csrf-token":b()}}function Ye(){return{...u.form,"csrf-token":b()}}async function Qe(e){const a=await fetch("/auth/v1/oidc/authorize",{method:"POST",headers:s(),body:JSON.stringify(e)});return a.status===202&&window.location.replace(a.headers.get("location")),a}async function Xe(e){const a=await fetch("/auth/v1/oidc/authorize/refresh",{method:"POST",headers:s(),body:JSON.stringify(e)});return a.status===202&&window.location.replace(a.headers.get("location")),a}async function ea(){return await fetch("/auth/v1/version",{method:"GET",headers:u.json})}async function aa(){return await fetch("/auth/v1/auth_check_admin",{method:"GET",headers:u.json})}async function ta(e){return await fetch("/auth/v1/oidc/token",{method:"POST",headers:u.form,body:e})}async function ra(){return await fetch("/auth/v1/oidc/sessioninfo",{method:"GET",headers:u.json})}async function na(e){return await fetch("/auth/v1/oidc/sessioninfo/xsrf",{method:"GET",headers:{...u.json,Authorization:`Bearer ${e}`}})}async function sa(e){let a=new FormData;for(let t in e)a.append(t,e[t]);return await fetch("/auth/v1/oidc/logout",{method:"POST",headers:Ye(),body:a})}async function oa(e){return await fetch("/auth/v1/oidc/device/verify",{method:"POST",headers:s(),body:JSON.stringify(e)})}async function ia(){return await fetch("/auth/v1/fed_cm/status",{method:"GET",headers:u.json})}async function ua(){return await fetch("/auth/v1/password_policy",{method:"GET",headers:u.json})}async function ca(){return await fetch("/auth/v1/pow",{method:"POST",headers:u.json})}async function la(e,a,t){return await fetch(`/auth/v1/users/${e}/reset`,{method:"PUT",headers:{...u.json,"pwd-csrf-token":t},body:JSON.stringify(a)})}async function da(e){return await fetch("/auth/v1/users/request_reset",{method:"POST",headers:s(),body:JSON.stringify(e)})}async function ha(e){return await fetch("/auth/v1/providers/login",{method:"POST",headers:s(),body:JSON.stringify(e)})}async function $a(e){return await fetch("/auth/v1/providers/callback",{method:"POST",headers:s(),body:JSON.stringify(e)})}async function fa(){return await fetch("/auth/v1/events/test",{method:"POST",headers:s()})}async function ga(e){return await fetch("/auth/v1/users/register",{method:"POST",headers:u.json,body:JSON.stringify(e)})}async function ma(e){return await fetch(`/auth/v1/users/${e}`,{method:"GET",headers:u.json})}async function ya(e){return await fetch(`/auth/v1/users/${e}/devices`,{method:"GET",headers:s()})}async function wa(e,a){return await fetch(`/auth/v1/users/${e}/devices`,{method:"PUT",headers:s(),body:JSON.stringify(a)})}async function pa(e,a){return await fetch(`/auth/v1/users/${e}/devices`,{method:"DELETE",headers:s(),body:JSON.stringify(a)})}async function va(e){return await fetch(`/auth/v1/users/${e}/webauthn`,{method:"GET",headers:s()})}async function ba(e,a){return await fetch(`/auth/v1/providers/${e}/link`,{method:"POST",headers:s(),body:JSON.stringify(a)})}async function Sa(){return await fetch("/auth/v1/providers/link",{method:"DELETE",headers:s()})}async function _a(e){return await fetch(`/auth/v1/users/${e}/webid/data`,{method:"GET",headers:s()})}async function Fa(e,a){return await fetch(`/auth/v1/users/${e}/webid/data`,{method:"PUT",headers:s(),body:JSON.stringify(a)})}async function ka(e,a){return await fetch(`/auth/v1/users/${e}/self`,{method:"PUT",headers:s(),body:JSON.stringify(a)})}async function Ta(e){return await fetch(`/auth/v1/users/${e}/self/convert_passkey`,{method:"POST",headers:s()})}async function Aa(){return await fetch("/auth/v1/update_language",{method:"POST",headers:s()})}async function Oa(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/register/start`,{method:"POST",headers:s(),body:JSON.stringify(a)})}async function Ca(e,a,t){return await fetch(`/auth/v1/users/${e}/webauthn/register/start`,{method:"POST",headers:{...u.json,"pwd-csrf-token":t},body:JSON.stringify(a)})}async function Ea(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/register/finish`,{method:"POST",headers:s(),body:JSON.stringify(a)})}async function Pa(e,a,t){return await fetch(`/auth/v1/users/${e}/webauthn/register/finish`,{method:"POST",headers:{...u.json,"pwd-csrf-token":t},body:JSON.stringify(a)})}async function Na(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/auth/start`,{method:"POST",headers:s(),body:JSON.stringify(a)})}async function Ia(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/auth/finish`,{method:"POST",headers:s(),body:JSON.stringify(a)})}async function za(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/delete/${a}`,{method:"DELETE",headers:s()})}export{We as $,Ve as A,Na as B,C,la as D,Ca as E,Ze as F,qe as G,Pa as H,he as I,$e as J,fe as K,ue as L,be as M,Qe as N,He as O,w as P,ha as Q,U as R,Je as S,ve as T,Xe as U,da as V,Re as W,Ue as X,$a as Y,Ia as Z,N as _,ta as a,ra as a0,Pe as a1,pe as a2,oa as a3,ya as a4,wa as a5,W as a6,pa as a7,Oe as a8,Sa as a9,ce as aA,ne as aB,K as aC,V as aD,H as aE,Me as aF,oe as aG,fa as aH,re as aI,M as aJ,ie as aK,Q as aL,ee as aM,aa as aN,ba as aa,B as ab,G as ac,q as ad,Z as ae,ka as af,va as ag,Oa as ah,Ea as ai,za as aj,ua as ak,Ta as al,Fa as am,Ne as an,ma as ao,_a as ap,b as aq,se as ar,Le as as,xe as at,ae as au,Ee as av,le as aw,de as ax,Y as ay,X as az,ze as b,na as c,Ie as d,Be as e,D as f,De as g,ca as h,ea as i,_e as j,we as k,te as l,ia as m,Ce as n,ge as o,sa as p,Ge as q,Fe as r,je as s,ga as t,x as u,L as v,me as w,ye as x,Aa as y,Se as z};

var v={};Object.defineProperty(v,"__esModule",{value:!0});function $(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function k(e,r){e||(e=43);for(var t=typeof window<"u"&&window.msCrypto||crypto,a=$(Array.prototype.map.call(t.getRandomValues(new Uint8Array(e)),function(n){return String.fromCharCode(n)}).join("")).substring(0,e),o=new Uint8Array(a.length),l=0;l<a.length;l++)o[l]=a.charCodeAt(l);var s=t.subtle.digest("SHA-256",o);typeof window<"u"&&window.CryptoOperation?(s.onerror=r,s.oncomplete=function(n){y(r,a,n.target.result)}):s.then(function(n){y(r,a,n)}).catch(r)}var A=v.default=k;function y(e,r,t){e(null,{verifier:r,challenge:$(String.fromCharCode.apply(null,new Uint8Array(t)))})}const p="pkce_verifier",_="pkce_verifier_upstream",h="csrf_token",C="access_token",S="id_token",w="provider_token",T="/auth/v1/oidc/authorize",I="rauthy",R="/auth/v1/oidc/logout",D="/auth/v1/oidc/callback",B="/auth/v1/admin",M="/auth/v1/account",z="/auth/v1/",E=/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/gm,N=/^\+[0-9\s]{0,32}$/gm,O=/^[a-zA-Z0-9À-ÿ-.\s]{0,48}$/gm,P=/^[a-zA-Z0-9À-ÿ-]{0,48}$/gm,j=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{1,32}$/gm,x=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{0,32}$/gm,H=/^[a-zA-Z0-9,.:/_\-&?=~#!$'()*+%]*$/gm,Z=3,L=["info","notice","warning","critical"],V=["-","InvalidLogins","IpBlacklisted","IpBlacklistRemoved","JwksRotated","NewUserRegistered","NewRauthyAdmin","NewRauthyVersion","PossibleBruteForce","RauthyStarted","RauthyHealthy","RauthyUnhealthy","SecretsMigrated","UserEmailChange","UserPasswordReset","Test"],J=["de","en","zh","ko"],Y=["de","en"],q="tpl_auth_providers",G="tpl_client_name",K="tpl_client_url",Q="tpl_csrf_token",W="tpl_email_old",X="tpl_email_new",ee="tpl_error_text",te="tpl_device_user_code_length",ae="tpl_is_reg_open",re="tpl_login_action",oe="tpl_password_reset",ne="tpl_status_code",le="tpl_restricted_email_domain";for(var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=typeof Uint8Array>"u"?[]:new Uint8Array(256),f=0;f<d.length;f++)m[d.charCodeAt(f)]=f;var U=function(e){var r=new Uint8Array(e),t,a=r.length,o="";for(t=0;t<a;t+=3)o+=d[r[t]>>2],o+=d[(r[t]&3)<<4|r[t+1]>>4],o+=d[(r[t+1]&15)<<2|r[t+2]>>6],o+=d[r[t+2]&63];return a%3===2?o=o.substring(0,o.length-1)+"=":a%3===1&&(o=o.substring(0,o.length-2)+"=="),o},se=function(e){var r=e.length*.75,t=e.length,a,o=0,l,s,n,c;e[e.length-1]==="="&&(r--,e[e.length-2]==="="&&r--);var u=new ArrayBuffer(r),g=new Uint8Array(u);for(a=0;a<t;a+=4)l=m[e.charCodeAt(a)],s=m[e.charCodeAt(a+1)],n=m[e.charCodeAt(a+2)],c=m[e.charCodeAt(a+3)],g[o++]=l<<2|s>>4,g[o++]=(s&15)<<4|n>>2,g[o++]=(n&3)<<6|c&63;return u};function ie(e){return`${window.location.origin}/auth/${e}/profile#me`}function ce(e){return e.inner.reduce((r,t)=>({...r,[t.path]:t.message}),{})}function ue(){return typeof window<"u"}function ge(e){return e==="openid"||e==="profile"||e==="email"||e==="groups"||e==="address"||e==="phone"}const de=e=>{A(64,(r,{challenge:t,verifier:a})=>{if(!r){localStorage.setItem(p,a);const o=b(24),l=e||"admin",s=`${window.location.origin}${D}`.replaceAll(":","%3A").replaceAll("/","%2F");window.location.href=`${T}?client_id=${I}&redirect_uri=${s}&response_type=code&code_challenge=${t}&code_challenge_method=S256&scope=openid+profile+email&nonce=${o}&state=${l}`}})},he=()=>{const e=`${R}?post_logout_redirect_uri=${window.location.origin}${z}`;window.location.href=e},me=e=>{console.log("saving csrf token in local storage",h,e),localStorage.setItem(h,e)},pe=()=>localStorage.getItem(h)||"",fe=e=>{localStorage.setItem(S,e)},_e=e=>{localStorage.setItem(C,e)},we=e=>{localStorage.setItem(w,e)},Fe=()=>localStorage.getItem(w)||"",ve=()=>localStorage.getItem(p)||"",$e=()=>localStorage.getItem(_)||"",Ae=()=>{localStorage.removeItem(p)},ye=()=>{localStorage.removeItem(h),localStorage.removeItem(S),localStorage.removeItem(C),localStorage.removeItem(p),localStorage.removeItem(_),localStorage.removeItem(w)};function Ce(e){let r=U(e);const t={"+":"-","/":"_","=":""};return r.replace(/[+/=]/g,a=>t[a])}function Se(e){switch(e){case"info":return"rgba(52,255,109,0.7)";case"notice":return"rgba(51,69,255,0.7)";case"warning":return"rgba(255,211,51,0.7)";case"critical":return"rgba(255,46,46,0.7)"}}const Ie=e=>e.toISOString().slice(0,16),Ue=(e,r)=>{let t;if(r?t=Date.parse(`${e}T${r}`):t=Date.parse(e),!isNaN(t))return t/1e3},be=(e,r)=>{const t=-new Date().getTimezoneOffset(),a=new Date((e+t*60)*1e3);let o=a.getUTCDate();o<10&&(o="0"+o);let l=a.getUTCMonth()+1;l<10&&(l="0"+l);const s=a.getUTCFullYear();let n=a.getUTCHours();n<10&&(n="0"+n);let c=a.getUTCMinutes();c<10&&(c="0"+c);let u=a.getUTCSeconds();return u<10&&(u="0"+u),r?`${s}-${l}-${o}T${n}:${c}:${u}`:`${s}/${l}/${o} ${n}:${c}:${u}`},ke=e=>{const r=e.length_min>20?e.length_min:20,t=e.include_lower_case||1,a=e.include_upper_case||1,o=e.include_digits||1,l=e.include_digits||1;for(;;){let s=0,n=0,c=0,u=0,g=[];for(let F=0;F<r;F+=1){let i=60;for(;i>57&&i<65||i>90&&i<97;)i=Math.floor(Math.random()*74)+33;i>=91&&i<=122&&(s+=1),i>=65&&i<=90&&(n+=1),i>=48&&i<=57&&(c+=1),i>=33&&i<=47&&(u+=1),g.push(String.fromCharCode(i))}if(!(s<t||n<a||u<l||c<o))return g.join("")}},b=e=>{let r=[];e=e||8;for(let t=0;t<e;t+=1){let a=95;for(;a>90&&a<97;)a=Math.floor(Math.random()*57)+65;r.push(String.fromCharCode(a))}return r.join("")};function Te(e){let r=e+"=",t=decodeURIComponent(document.cookie).split(";");for(let a=0;a<t.length;a++){let o=t[a];for(;o.charAt(0)===" ";)o=o.substring(1);if(o.indexOf(r)===0)return o.substring(r.length,o.length)}return""}function Re(e,r){let t;return Promise.race([e,new Promise((a,o)=>{t=setTimeout(o,r,"timeout")})]).finally(()=>clearTimeout(t))}export{E as $,oe as A,ke as B,h as C,Ue as D,V as E,L as F,$e as G,Fe as H,se as I,U as J,Ce as K,Y as L,q as M,G as N,K as O,re as P,_ as Q,B as R,we as S,ne as T,ge as U,ie as V,he as W,Z as X,j as Y,x as Z,A as _,b as a,N as a0,O as a1,P as a2,Ie as a3,ee as b,I as c,ve as d,fe as e,me as f,pe as g,Ae as h,ue as i,M as j,ae as k,be as l,Se as m,te as n,H as o,Re as p,ce as q,de as r,_e as s,Te as t,J as u,ye as v,Q as w,le as x,W as y,X as z};

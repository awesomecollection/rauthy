import"./disclose-version.BDr9Qe-U.js";import{p as Y,P as Z,Q as B,a as D,j as F,U as o,W as n,R as u,T as y,g}from"./index-client.CzqVbBUo.js";import{s as v}from"./render.DOFZNw8l.js";import{p as Q,i as w}from"./if.BnegfJmL.js";import{c as G,a as f,b as $}from"./template.C3U8HW1x.js";import{t as b}from"./helpers.BvaXa0cv.js";import{p as T}from"./props.C_MHtC74.js";import{r as I}from"./legacy-client.DtCljIS0.js";import{u as J}from"./i18n.svelte.C_qSL0ZA.js";var ii=$('<li class="li svelte-1f8mmbi"> </li>'),li=$('<li class="li svelte-1f8mmbi"> </li>'),ei=$('<li class="li svelte-1f8mmbi"> </li>'),si=$('<li class="li svelte-1f8mmbi"> </li>'),ai=$('<li class="li svelte-1f8mmbi"> </li>'),ri=$('<div class="policyContainer svelte-1f8mmbi"><span style="margin-left: 20px"><b> </b></span> <ul class="svelte-1f8mmbi"><li class="li svelte-1f8mmbi"> </li> <li class="li svelte-1f8mmbi"> </li> <!> <!> <!> <!> <!></ul></div>');function ci(U,h){Y(h,!0);let i=T(h,"policy",19,()=>({})),k=T(h,"accepted",15,!1),m=J(),_=Z(Q([!1,!1,!1,!1,!1,!1]));const q=d=>{if(!i())return!1;let r=[!1,!1,!1,!1,!1,!1],c=!1;d.length<i().length_min&&(r[0]=!0,c=!0),d.length>i().length_max&&(r[1]=!0,c=!0);let s=[0,0,0,0];for(let E=0;E<d.length;E++){let t=d.charCodeAt(E);if(t>=97&&t<=122){s[0]=s[0]+1;continue}if(t>=65&&t<=90){s[1]=s[1]+1;continue}if(t>=48&&t<=57){s[2]=s[2]+1;continue}s[3]=s[3]+1}i().include_lower_case!==-1&&i().include_lower_case>s[0]&&(r[2]=!0,c=!0),i().include_upper_case!==-1&&i().include_upper_case>s[1]&&(r[3]=!0,c=!0),i().include_digits!==-1&&i().include_digits>s[2]&&(r[4]=!0,c=!0),i().include_special!==-1&&i().include_special>s[3]&&(r[5]=!0,c=!0),F(_,Q(r)),k(!c)};I(()=>{h.password&&q(h.password)});var x=G(),z=B(x);{var H=d=>{var r=ri(),c=o(r),s=o(c),E=o(s,!0);n(s),n(c);var t=u(c,2),M=o(t),K=o(M);n(M);var P=u(M,2),L=o(P);n(P);var C=u(P,2);{var N=e=>{var l=ii(),p=o(l);n(l),y(()=>{var a;b(l,"policyErr",!!g(_)[2]),v(p,`${m.passwordPolicy.lowercaseMin??""}
                    ${(((a=i())==null?void 0:a.include_lower_case)||0)??""}`)}),f(e,l)};w(C,e=>{i().include_lower_case!==-1&&e(N)})}var R=u(C,2);{var O=e=>{var l=li(),p=o(l);n(l),y(()=>{var a;b(l,"policyErr",!!g(_)[3]),v(p,`${m.passwordPolicy.uppercaseMin??""}
                    ${(((a=i())==null?void 0:a.include_upper_case)||0)??""}`)}),f(e,l)};w(R,e=>{i().include_upper_case!==-1&&e(O)})}var j=u(R,2);{var S=e=>{var l=ei(),p=o(l);n(l),y(()=>{var a;b(l,"policyErr",!!g(_)[4]),v(p,`${m.passwordPolicy.digitsMin??""}
                    ${(((a=i())==null?void 0:a.include_digits)||0)??""}`)}),f(e,l)};w(j,e=>{i().include_digits!==-1&&e(S)})}var A=u(j,2);{var V=e=>{var l=si(),p=o(l);n(l),y(()=>{var a;b(l,"policyErr",!!g(_)[5]),v(p,`${m.passwordPolicy.specialMin??""}
                    ${(((a=i())==null?void 0:a.include_special)||0)??""}`)}),f(e,l)};w(A,e=>{i().include_special!==-1&&e(V)})}var W=u(A,2);{var X=e=>{var l=ai(),p=o(l);n(l),y(()=>{var a;return v(p,`${m.passwordPolicy.notRecent??""}
                    ${(((a=i())==null?void 0:a.not_recently_used)||0)??""}`)}),f(e,l)};w(W,e=>{i().not_recently_used!==-1&&e(X)})}n(t),n(r),y(()=>{var e;v(E,m.passwordPolicy.passwordPolicy),b(M,"policyErr",!!g(_)[0]),v(K,`${m.passwordPolicy.lengthMin??""}
                ${i().length_min??""}`),b(P,"policyErr",!!g(_)[1]),v(L,`${m.passwordPolicy.lengthMax??""}
                ${(((e=i())==null?void 0:e.length_max)||0)??""}`)}),f(d,r)};w(z,d=>{i()&&d(H)})}f(U,x),D()}export{ci as P};

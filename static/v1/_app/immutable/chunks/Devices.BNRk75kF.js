import"./disclose-version.BDr9Qe-U.js";import{t as b,p as X,c as l,r as v,s as N,a as z,i as O,G as V,ap as j,g as x,h as Q,f as T,O as W}from"./runtime.BsghBUX9.js";import{s as _}from"./render.CTp9lacC.js";import{i as L}from"./if.6Ov_EDLa.js";import{e as Y}from"./each.URXtkKAp.js";import{a as n,n as Z,t as k,d as M,e as ee}from"./template.jENAUvUX.js";import{p as A}from"./proxy.YH42NwLs.js";import{o as ae}from"./index-client.ClP8y9aT.js";import{u as H}from"./i18n.svelte.D8rR00qK.js";import{u as re}from"./session.svelte.DJ5oIUdF.js";import{B as J,c as se,d as ie,f as te}from"./fetch.BvIeF4JA.js";import{s as g,b as oe,c as le,g as ve,h as ne}from"./index.G5lyZbma.js";import{p as S}from"./props.CslUVmW_.js";import{u as U,j as K}from"./helpers.CBl6QeM5.js";import{I as de}from"./IconStop.OvZMk6DH.js";import{I as ce}from"./Input.luLa8YQi.js";import{s as F}from"./snippet.C6jUNrz1.js";import{b as ue}from"./patterns.BdncpE46.js";var me=Z('<svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5"></path></svg>');function fe(C,a){let e=S(a,"opacity",3,.9),i=S(a,"width",3,"1.5rem"),u=S(a,"color",3,"currentColor");var s=me();g(s,"stroke-width",2),b(()=>{g(s,"width",i()),g(s,"color",u()),g(s,"opacity",e())}),n(C,s)}var pe=k('<div class="chevron svelte-li3f92"><!></div>'),he=k("<div><!></div>"),be=k('<div class="container svelte-li3f92"><div class="header svelte-li3f92"><!> <div class="summary svelte-li3f92"><!></div></div> <div class="details svelte-li3f92"><!></div></div>');function ge(C,a){X(a,!0);let e=H();const i=U(),u=U();let s=S(a,"expand",15,!1);function I(h){h.preventDefault(),s(!s())}var c=be(),r=l(c),$=l(r);J($,{get ariaLabel(){return e.common.expandContent},ariaControls:u,invisible:!0,onclick:h=>I(h),children:(h,w)=>{var D=pe(),E=l(D);fe(E,{}),v(D),n(h,D)},$$slots:{default:!0}});var t=N($,2);g(t,"id",i);var m=l(t);F(m,()=>a.summary),v(t),v(r);var f=N(r,2);g(f,"id",u),g(f,"aria-labelledby",i);var p=l(f);{var P=h=>{var w=he(),D=l(w);F(D,()=>a.details),v(w),oe(3,w,()=>le,()=>({duration:150})),n(h,w)};L(p,h=>{s()&&h(P)})}v(f),v(c),b(()=>{g(c,"aria-expanded",s()),g(t,"aria-label",e.common.summary),g(f,"aria-label",e.common.details),g(f,"aria-hidden",!s())}),n(C,c),z()}var $e=k('<div class="label font-label svelte-1n9u417"> </div>'),we=k('<div class="button svelte-1n9u417"><!></div>'),ye=k('<div class="container svelte-1n9u417"><!> <div class="flex gap-05"><div><!></div> <!></div></div>');function q(C,a){X(a,!0);var e=ye(),i=l(e);{var u=t=>{var m=$e(),f=l(m,!0);v(m),b(()=>_(f,a.label)),n(t,m)};L(i,t=>{a.label&&t(u)})}var s=N(i,2),I=l(s),c=l(I);F(c,()=>a.children),v(I);var r=N(I,2);{var $=t=>{var m=we(),f=l(m);F(f,()=>a.button),v(m),n(t,m)};L(r,t=>{a.button&&t($)})}v(s),v(e),b(()=>{g(I,"title",a.title||a.label||""),ve(I,ne(a.mono?"font-mono":""),"svelte-1n9u417")}),n(C,e),z()}var xe=k('<div class="device-header svelte-9n911e"><div class="device-head font-mono svelte-9n911e"> </div></div>'),ke=k('<div class="saveButton svelte-9n911e"><!></div>'),Ie=k("<div><!></div>"),Ne=k("<div> </div>"),_e=k('<div class="device svelte-9n911e"><!> <div class="row svelte-9n911e"><!> <!></div> <!> <!> <!> <!></div>');function Ce(C,a){X(a,!0);let e=S(a,"device",15),i=H(),u=O(A(V(()=>e().name)));async function s(){let c={device_id:e().id,name:x(u)},r=await se(`/auth/v1/users/${a.userId}/devices`,c);r.error?console.error(r.error):e(e().name=x(u),!0)}async function I(){let c={device_id:e().id},r=await ie(`/auth/v1/users/${a.userId}/devices`,c);r.error?console.error(r.error):e(e().refresh_exp=void 0,!0)}ge(C,{summary:c=>{var r=xe(),$=l(r),t=l($,!0);v($),v(r),b(()=>_(t,e().name)),n(c,r)},details:c=>{var r=_e(),$=l(r);q($,{get label(){return i.account.deviceId},mono:!0,children:(o,y)=>{j();var d=M();b(()=>_(d,e().id)),n(o,d)},$$slots:{default:!0}});var t=N($,2),m=l(t);ce(m,{autocomplete:"off",width:"17rem",get label(){return i.account.deviceName},get placeholder(){return i.account.deviceName},onEnter:s,pattern:ue,required:!0,get value(){return x(u)},set value(o){Q(u,A(o))},children:(o,y)=>{j();var d=M();b(()=>_(d,i.account.deviceName)),n(o,d)},$$slots:{default:!0}});var f=N(m,2);{var p=o=>{var y=ke(),d=l(y);J(d,{onclick:s,children:(R,B)=>{j();var G=M();b(()=>_(G,i.common.save)),n(R,G)},$$slots:{default:!0}}),v(y),n(o,y)};L(f,o=>{x(u)!==e().name&&o(p)})}v(t);var P=N(t,2);q(P,{get label(){return i.account.regDate},children:(o,y)=>{j();var d=M();b(()=>_(d,K(e().created))),n(o,d)},$$slots:{default:!0}});var h=N(P,2);q(h,{get label(){return i.account.accessExp},children:(o,y)=>{j();var d=M();b(()=>_(d,K(e().access_exp))),n(o,d)},$$slots:{default:!0}});var w=N(h,2);{var D=o=>{q(o,{get label(){return i.account.accessRenew},button:y=>{J(y,{get ariaLabel(){return i.common.delete},invisible:!0,onclick:I,children:(d,R)=>{var B=Ie(),G=l(B);de(G,{}),v(B),b(()=>g(B,"title",i.common.delete)),n(d,B)},$$slots:{default:!0}})},children:(y,d)=>{var R=Ne(),B=l(R,!0);b(()=>_(B,K(e().refresh_exp))),v(R),n(y,R)},$$slots:{button:!0,default:!0}})};L(w,o=>{e().refresh_exp&&o(D)})}var E=N(w,2);q(E,{get label(){return i.account.regIp},children:(o,y)=>{j();var d=M();b(()=>_(d,e().peer_ip)),n(o,d)},$$slots:{default:!0}}),v(r),n(c,r)},$$slots:{summary:!0,details:!0}}),z()}var De=k('<div class="head svelte-w0g6eh"> </div> <div class="devices svelte-w0g6eh"><!></div>',1);function Pe(C,a){X(a,!0);let e=H(),i=re(a.viewMode),u=W(()=>{var p;return(p=i.get())==null?void 0:p.user_id}),s=O(A([]));ae(()=>{I()});async function I(){let p=await te(`/auth/v1/users/${x(u)}/devices`);p.body?Q(s,A(p.body)):console.error("error fetching devices: "+p.error)}var c=De(),r=T(c),$=l(r,!0);v(r);var t=N(r,2),m=l(t);{var f=p=>{var P=ee(),h=T(P);Y(h,19,()=>x(s),w=>w.id,(w,D,E)=>{Ce(w,{get userId(){return x(u)},get device(){return x(s)[x(E)]},set device(o){x(s)[x(E)]=o}})}),n(p,P)};L(m,p=>{x(u)&&p(f)})}v(t),b(()=>_($,(e==null?void 0:e.account.devicesDesc)||"Devices linked to this account")),n(C,c),z()}export{Pe as D};

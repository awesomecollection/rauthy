import{c as X,a as u,b as y}from"./disclose-version.C0dpEWi_.js";import{p as Y,Z as B,_ as G,a as H,j as J,a2 as o,a4 as n,a0 as f,a1 as w,g}from"./index-client.LkyNpeLM.js";import{s as v}from"./render.D21ACvZ4.js";import{i as $}from"./if.BQqAvi9S.js";import{x as b}from"./dataFetching.C4rEqQY1.js";import{p as k}from"./proxy.bVSoDcUp.js";import{p as q}from"./props.BDzDHVdA.js";import{r as K}from"./legacy-client.yBTdRgtG.js";import{u as N}from"./i18n.svelte.DPkpATkG.js";var ii=y('<li class="li svelte-1f8mmbi"> </li>'),li=y('<li class="li svelte-1f8mmbi"> </li>'),ei=y('<li class="li svelte-1f8mmbi"> </li>'),si=y('<li class="li svelte-1f8mmbi"> </li>'),ai=y('<li class="li svelte-1f8mmbi"> </li>'),ri=y('<div class="policyContainer svelte-1f8mmbi"><span style="margin-left: 20px"><b> </b></span> <ul class="svelte-1f8mmbi"><li class="li svelte-1f8mmbi"> </li> <li class="li svelte-1f8mmbi"> </li> <!> <!> <!> <!> <!></ul></div>');function ci(z,P){Y(P,!0);let i=q(P,"policy",19,()=>({})),D=q(P,"accepted",15,!1),m=N(),_=B(k([!1,!1,!1,!1,!1,!1]));const F=d=>{if(!i())return!1;let r=[!1,!1,!1,!1,!1,!1],c=!1;d.length<i().length_min&&(r[0]=!0,c=!0),d.length>i().length_max&&(r[1]=!0,c=!0);let s=[0,0,0,0];for(let E=0;E<d.length;E++){let t=d.charCodeAt(E);if(t>=97&&t<=122){s[0]=s[0]+1;continue}if(t>=65&&t<=90){s[1]=s[1]+1;continue}if(t>=48&&t<=57){s[2]=s[2]+1;continue}s[3]=s[3]+1}i().include_lower_case!==-1&&i().include_lower_case>s[0]&&(r[2]=!0,c=!0),i().include_upper_case!==-1&&i().include_upper_case>s[1]&&(r[3]=!0,c=!0),i().include_digits!==-1&&i().include_digits>s[2]&&(r[4]=!0,c=!0),i().include_special!==-1&&i().include_special>s[3]&&(r[5]=!0,c=!0),J(_,k(r)),D(!c)};K(()=>{P.password&&F(P.password)});var x=X(),I=G(x);{var L=d=>{var r=ri(),c=o(r),s=o(c),E=o(s,!0);n(s),n(c);var t=f(c,2),M=o(t),O=o(M);n(M);var h=f(M,2),Q=o(h);n(h);var C=f(h,2);{var R=e=>{var l=ii(),p=o(l);n(l),w(()=>{var a;b(l,"policyErr",!!g(_)[2]),v(p,`${m.passwordPolicy.lowercaseMin??""}
                    ${(((a=i())==null?void 0:a.include_lower_case)||0)??""}`)}),u(e,l)};$(C,e=>{i().include_lower_case!==-1&&e(R)})}var j=f(C,2);{var S=e=>{var l=li(),p=o(l);n(l),w(()=>{var a;b(l,"policyErr",!!g(_)[3]),v(p,`${m.passwordPolicy.uppercaseMin??""}
                    ${(((a=i())==null?void 0:a.include_upper_case)||0)??""}`)}),u(e,l)};$(j,e=>{i().include_upper_case!==-1&&e(S)})}var A=f(j,2);{var T=e=>{var l=ei(),p=o(l);n(l),w(()=>{var a;b(l,"policyErr",!!g(_)[4]),v(p,`${m.passwordPolicy.digitsMin??""}
                    ${(((a=i())==null?void 0:a.include_digits)||0)??""}`)}),u(e,l)};$(A,e=>{i().include_digits!==-1&&e(T)})}var Z=f(A,2);{var U=e=>{var l=si(),p=o(l);n(l),w(()=>{var a;b(l,"policyErr",!!g(_)[5]),v(p,`${m.passwordPolicy.specialMin??""}
                    ${(((a=i())==null?void 0:a.include_special)||0)??""}`)}),u(e,l)};$(Z,e=>{i().include_special!==-1&&e(U)})}var V=f(Z,2);{var W=e=>{var l=ai(),p=o(l);n(l),w(()=>{var a;return v(p,`${m.passwordPolicy.notRecent??""}
                    ${(((a=i())==null?void 0:a.not_recently_used)||0)??""}`)}),u(e,l)};$(V,e=>{i().not_recently_used!==-1&&e(W)})}n(t),n(r),w(()=>{var e;v(E,m.passwordPolicy.passwordPolicy),b(M,"policyErr",!!g(_)[0]),v(O,`${m.passwordPolicy.lengthMin??""}
                ${i().length_min??""}`),b(h,"policyErr",!!g(_)[1]),v(Q,`${m.passwordPolicy.lengthMax??""}
                ${(((e=i())==null?void 0:e.length_max)||0)??""}`)}),u(d,r)};$(I,d=>{i()&&d(L)})}u(z,x),H()}export{ci as P};

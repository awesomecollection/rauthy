var y={};Object.defineProperty(y,"__esModule",{value:!0});function S(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function T(e,a){e||(e=43);for(var t=typeof window<"u"&&window.msCrypto||crypto,r=S(Array.prototype.map.call(t.getRandomValues(new Uint8Array(e)),function(n){return String.fromCharCode(n)}).join("")).substring(0,e),o=new Uint8Array(r.length),l=0;l<r.length;l++)o[l]=r.charCodeAt(l);var i=t.subtle.digest("SHA-256",o);typeof window<"u"&&window.CryptoOperation?(i.onerror=a,i.oncomplete=function(n){A(a,r,n.target.result)}):i.then(function(n){A(a,r,n)}).catch(a)}var C=y.default=T;function A(e,a,t){e(null,{verifier:a,challenge:S(String.fromCharCode.apply(null,new Uint8Array(t)))})}const m="pkce_verifier",_="pkce_verifier_upstream",h="csrf_token",$="access_token",I="id_token",w="provider_token",R="/auth/v1/oidc/authorize",U="rauthy",M="/auth/v1/oidc/logout",D="/auth/v1/oidc/callback",N="/auth/v1/admin",P="/auth/v1/account",j="/auth/v1/",B=/^[a-zA-Z0-9,.:/_\-&?=~#!$'()*+%]*$/gm,O=["info","notice","warning","critical"],x=["-","InvalidLogins","IpBlacklisted","IpBlacklistRemoved","JwksRotated","NewUserRegistered","NewRauthyAdmin","NewRauthyVersion","PossibleBruteForce","RauthyStarted","RauthyHealthy","RauthyUnhealthy","SecretsMigrated","UserEmailChange","UserPasswordReset","Test"],z=["de","en","zh","ko"],F=["de","en"],H="tpl_auth_providers",E="tpl_client_name",V="tpl_client_url",J="tpl_csrf_token",L="tpl_email_old",q="tpl_email_new",G="tpl_error_text",K="tpl_device_user_code_length",Q="tpl_is_reg_open",W="tpl_login_action",Y="tpl_password_reset",Z="tpl_status_code",X="tpl_restricted_email_domain";for(var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=typeof Uint8Array>"u"?[]:new Uint8Array(256),f=0;f<d.length;f++)p[d.charCodeAt(f)]=f;var b=function(e){var a=new Uint8Array(e),t,r=a.length,o="";for(t=0;t<r;t+=3)o+=d[a[t]>>2],o+=d[(a[t]&3)<<4|a[t+1]>>4],o+=d[(a[t+1]&15)<<2|a[t+2]>>6],o+=d[a[t+2]&63];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o},ee=function(e){var a=e.length*.75,t=e.length,r,o=0,l,i,n,c;e[e.length-1]==="="&&(a--,e[e.length-2]==="="&&a--);var u=new ArrayBuffer(a),g=new Uint8Array(u);for(r=0;r<t;r+=4)l=p[e.charCodeAt(r)],i=p[e.charCodeAt(r+1)],n=p[e.charCodeAt(r+2)],c=p[e.charCodeAt(r+3)],g[o++]=l<<2|i>>4,g[o++]=(i&15)<<4|n>>2,g[o++]=(n&3)<<6|c&63;return u};function te(e){return`${window.location.origin}/auth/${e}/profile#me`}function re(e){return e.inner.reduce((a,t)=>({...a,[t.path]:t.message}),{})}function ae(){return typeof window<"u"}function oe(e){return e==="openid"||e==="profile"||e==="email"||e==="groups"||e==="address"||e==="phone"}const ne=e=>{C(64,(a,{challenge:t,verifier:r})=>{if(!a){localStorage.setItem(m,r);const o=k(24),l=e||"admin",i=`${window.location.origin}${D}`.replaceAll(":","%3A").replaceAll("/","%2F");window.location.href=`${R}?client_id=${U}&redirect_uri=${i}&response_type=code&code_challenge=${t}&code_challenge_method=S256&scope=openid+profile+email&nonce=${o}&state=${l}`}})},le=()=>{const e=`${M}?post_logout_redirect_uri=${window.location.origin}${j}`;window.location.href=e},ie=e=>{console.log("saving csrf token in local storage",h,e),localStorage.setItem(h,e)},se=()=>localStorage.getItem(h)||"",ce=e=>{localStorage.setItem(I,e)},ue=e=>{localStorage.setItem($,e)},ge=e=>{localStorage.setItem(w,e)},de=()=>localStorage.getItem(w)||"",he=()=>localStorage.getItem(m)||"",pe=()=>localStorage.getItem(_)||"",me=()=>{localStorage.removeItem(m)},fe=()=>{localStorage.removeItem(h),localStorage.removeItem(I),localStorage.removeItem($),localStorage.removeItem(m),localStorage.removeItem(_),localStorage.removeItem(w)};function _e(e){let a=b(e);const t={"+":"-","/":"_","=":""};return a.replace(/[+/=]/g,r=>t[r])}function we(e){switch(e){case"info":return"rgba(52,255,109,0.7)";case"notice":return"rgba(51,69,255,0.7)";case"warning":return"rgba(255,211,51,0.7)";case"critical":return"rgba(255,46,46,0.7)"}}const ve=(e,a)=>{let t;if(a?t=Date.parse(`${e}T${a}`):t=Date.parse(e),!isNaN(t))return t/1e3},ye=(e,a)=>{const t=-new Date().getTimezoneOffset(),r=new Date((e+t*60)*1e3);let o=r.getUTCDate();o<10&&(o="0"+o);let l=r.getUTCMonth()+1;l<10&&(l="0"+l);const i=r.getUTCFullYear();let n=r.getUTCHours();n<10&&(n="0"+n);let c=r.getUTCMinutes();c<10&&(c="0"+c);let u=r.getUTCSeconds();return u<10&&(u="0"+u),`${i}/${l}/${o} ${n}:${c}:${u}`},Se=e=>{const a=e.length_min>20?e.length_min:20,t=e.include_lower_case||1,r=e.include_upper_case||1,o=e.include_digits||1,l=e.include_digits||1;for(;;){let i=0,n=0,c=0,u=0,g=[];for(let v=0;v<a;v+=1){let s=60;for(;s>57&&s<65||s>90&&s<97;)s=Math.floor(Math.random()*74)+33;s>=91&&s<=122&&(i+=1),s>=65&&s<=90&&(n+=1),s>=48&&s<=57&&(c+=1),s>=33&&s<=47&&(u+=1),g.push(String.fromCharCode(s))}if(!(i<t||n<r||u<l||c<o))return g.join("")}},k=e=>{let a=[];e=e||8;for(let t=0;t<e;t+=1){let r=95;for(;r>90&&r<97;)r=Math.floor(Math.random()*57)+65;a.push(String.fromCharCode(r))}return a.join("")};function Ce(e){let a=e+"=",t=decodeURIComponent(document.cookie).split(";");for(let r=0;r<t.length;r++){let o=t[r];for(;o.charAt(0)===" ";)o=o.substring(1);if(o.indexOf(a)===0)return o.substring(a.length,o.length)}return""}function Ae(e,a){let t;return Promise.race([e,new Promise((r,o)=>{t=setTimeout(o,a,"timeout")})]).finally(()=>clearTimeout(t))}export{Y as A,Se as B,h as C,ve as D,x as E,O as F,ee as G,b as H,_e as I,H as J,E as K,F as L,V as M,W as N,ge as O,_ as P,oe as Q,N as R,B as S,Z as T,re as U,te as V,le as W,C as _,G as a,se as b,U as c,he as d,ce as e,ie as f,k as g,me as h,ae as i,P as j,Q as k,ye as l,we as m,K as n,Ce as o,Ae as p,z as q,ne as r,ue as s,fe as t,J as u,pe as v,de as w,X as x,L as y,q as z};

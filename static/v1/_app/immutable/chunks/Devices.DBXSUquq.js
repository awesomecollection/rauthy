import"./disclose-version.BDr9Qe-U.js";import{p as G,i as H,_ as T,a as J,c as m,r as u,t as l,aq as I,s as w,g as d,h as K,ao as U,f as O,a9 as V}from"./index-client.CzvcfCLI.js";import{s as f}from"./render.BJBkrb2f.js";import{i as z}from"./if.Dlf0zx3_.js";import{e as W}from"./each.BtetwUOf.js";import{a as o,d as E,t as _,e as X}from"./template.CQASMEo4.js";import{p as B}from"./proxy.CHyqegA9.js";import{u as P}from"./i18n.svelte.BgTCv98Z.js";import{u as Y}from"./session.svelte.CNTyBeAJ.js";import{c as Z,d as A,f as ee}from"./fetch.DVUNovhB.js";import{s as re}from"./class.DOSp4p8N.js";import{p as ae}from"./props.BRvF51YW.js";import{k as C}from"./helpers.kNqlWGzE.js";import{I as se}from"./IconStop.CJzJMbxy.js";import{I as te}from"./Input.DG9-U8Na.js";import{E as oe,L as k}from"./LabeledValue.bm1VTFAO.js";import{b as ie}from"./patterns.BSnCcuba.js";import{B as Q}from"./Button.CjBmYviZ.js";var ce=_('<div class="device-header svelte-9n911e"><div class="device-head font-mono svelte-9n911e"> </div></div>'),de=_('<div class="saveButton svelte-9n911e"><!></div>'),ve=_("<div><!></div>"),le=_("<div> </div>"),ne=_('<div class="device svelte-9n911e"><!> <div class="row svelte-9n911e"><!> <!></div> <!> <!> <!> <!></div>');function me(R,h){G(h,!0);let r=ae(h,"device",15),t=P(),n=H(B(T(()=>r().name)));async function $(){let v={device_id:r().id,name:d(n)},s=await Z(`/auth/v1/users/${h.userId}/devices`,v);s.error?console.error(s.error):r(r().name=d(n),!0)}async function S(){let v={device_id:r().id},s=await A(`/auth/v1/users/${h.userId}/devices`,v);s.error?console.error(s.error):r(r().refresh_exp=void 0,!0)}oe(R,{summary:v=>{var s=ce(),g=m(s),p=m(g,!0);u(g),u(s),l(()=>f(p,r().name)),o(v,s)},details:v=>{var s=ne(),g=m(s);k(g,{get label(){return t.account.deviceId},mono:!0,children:(e,c)=>{I();var a=E();l(()=>f(a,r().id)),o(e,a)},$$slots:{default:!0}});var p=w(g,2),q=m(p);te(q,{autocomplete:"off",width:"17rem",get label(){return t.account.deviceName},get placeholder(){return t.account.deviceName},onEnter:$,pattern:ie,required:!0,get value(){return d(n)},set value(e){K(n,B(e))},children:(e,c)=>{I();var a=E();l(()=>f(a,t.account.deviceName)),o(e,a)},$$slots:{default:!0}});var j=w(q,2);{var i=e=>{var c=de(),a=m(c);Q(a,{onclick:$,children:(y,b)=>{I();var M=E();l(()=>f(M,t.common.save)),o(y,M)},$$slots:{default:!0}}),u(c),o(e,c)};z(j,e=>{d(n)!==r().name&&e(i)})}u(p);var D=w(p,2);k(D,{get label(){return t.account.regDate},children:(e,c)=>{I();var a=E();l(()=>f(a,C(r().created))),o(e,a)},$$slots:{default:!0}});var L=w(D,2);k(L,{get label(){return t.account.accessExp},children:(e,c)=>{I();var a=E();l(()=>f(a,C(r().access_exp))),o(e,a)},$$slots:{default:!0}});var x=w(L,2);{var F=e=>{k(e,{get label(){return t.account.accessRenew},button:c=>{Q(c,{get ariaLabel(){return t.common.delete},invisible:!0,onclick:S,children:(a,y)=>{var b=ve(),M=m(b);se(M,{}),u(b),l(()=>re(b,"title",t.common.delete)),o(a,b)},$$slots:{default:!0}})},children:(c,a)=>{var y=le(),b=m(y,!0);l(()=>f(b,C(r().refresh_exp))),u(y),o(c,y)},$$slots:{button:!0,default:!0}})};z(x,e=>{r().refresh_exp&&e(F)})}var N=w(x,2);k(N,{get label(){return t.account.regIp},children:(e,c)=>{I();var a=E();l(()=>f(a,r().peer_ip)),o(e,a)},$$slots:{default:!0}}),u(s),o(v,s)},$$slots:{summary:!0,details:!0}}),J()}var ue=_('<div class="head svelte-w0g6eh"> </div> <div class="devices svelte-w0g6eh"><!></div>',1);function fe(R,h){G(h,!0);let r=P(),t=Y(h.viewMode),n=V(()=>{var i;return(i=t.get())==null?void 0:i.user_id}),$=H(B([]));U(()=>{S()});async function S(){let i=await ee(`/auth/v1/users/${d(n)}/devices`);i.body?K($,B(i.body)):console.error("error fetching devices: "+i.error)}var v=ue(),s=O(v),g=m(s,!0);u(s);var p=w(s,2),q=m(p);{var j=i=>{var D=X(),L=O(D);W(L,19,()=>d($),x=>x.id,(x,F,N)=>{me(x,{get userId(){return d(n)},get device(){return d($)[d(N)]},set device(e){d($)[d(N)]=e}})}),o(i,D)};z(q,i=>{d(n)&&i(j)})}u(p),l(()=>f(g,(r==null?void 0:r.account.devicesDesc)||"Devices linked to this account")),o(R,v),J()}export{fe as D};

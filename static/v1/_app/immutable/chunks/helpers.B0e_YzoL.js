var _={};Object.defineProperty(_,"__esModule",{value:!0});function b(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function U(e,t){e||(e=43);for(var a=typeof window<"u"&&window.msCrypto||crypto,r=b(Array.prototype.map.call(a.getRandomValues(new Uint8Array(e)),function(l){return String.fromCharCode(l)}).join("")).substring(0,e),o=new Uint8Array(r.length),n=0;n<r.length;n++)o[n]=r.charCodeAt(n);var i=a.subtle.digest("SHA-256",o);typeof window<"u"&&window.CryptoOperation?(i.onerror=t,i.oncomplete=function(l){v(t,r,l.target.result)}):i.then(function(l){v(t,r,l)}).catch(t)}var F=_.default=U;function v(e,t,a){e(null,{verifier:t,challenge:b(String.fromCharCode.apply(null,new Uint8Array(a)))})}const m="pkce_verifier",f="pkce_verifier_upstream",d="csrf_token",k="access_token",A="id_token",w="provider_token",D="/auth/v1/oidc/authorize",S="rauthy",R="/auth/v1/oidc/logout",z="/auth/v1/oidc/callback",T="/auth/v1/admin",B="/auth/v1/account",q="/auth/v1/",E=/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/gm,M=/^\+[0-9\s]{0,32}$/gm,N=/^[a-zA-Z0-9À-ÿ-.\s]{0,48}$/gm,O=/^[a-zA-Z0-9À-ÿ-]{0,48}$/gm,P=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{1,32}$/gm,Z=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{0,32}$/gm,j=/^[a-zA-Z0-9\-_/]{2,128}$/gm,x=/^[a-zA-Z0-9À-ſ\-\s\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{0,128}$/m,H=/^[a-zA-Z0-9+.@/:]{0,48}$/gm,L=/^[a-z0-9.:-]+:\/\/[a-z0-9.:-]+$/m,V=/^[a-zA-Z0-9,.:/_\-&?=~#!$'()*+%]*$/gm,G=/(#(?:[0-9a-f]{2}){2,4}$|(#[0-9a-f]{3}$)|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\)$|black$|silver$|gray$|whitesmoke$|maroon$|red$|purple$|fuchsia$|green$|lime$|olivedrab$|yellow$|navy$|blue$|teal$|aquamarine$|orange$|aliceblue$|antiquewhite$|aqua$|azure$|beige$|bisque$|blanchedalmond$|blueviolet$|brown$|burlywood$|cadetblue$|chartreuse$|chocolate$|coral$|cornflowerblue$|cornsilk$|crimson$|currentcolor$|darkblue$|darkcyan$|darkgoldenrod$|darkgray$|darkgreen$|darkgrey$|darkkhaki$|darkmagenta$|darkolivegreen$|darkorange$|darkorchid$|darkred$|darksalmon$|darkseagreen$|darkslateblue$|darkslategray$|darkslategrey$|darkturquoise$|darkviolet$|deeppink$|deepskyblue$|dimgray$|dimgrey$|dodgerblue$|firebrick$|floralwhite$|forestgreen$|gainsboro$|ghostwhite$|goldenrod$|gold$|greenyellow$|grey$|honeydew$|hotpink$|indianred$|indigo$|ivory$|khaki$|lavenderblush$|lavender$|lawngreen$|lemonchiffon$|lightblue$|lightcoral$|lightcyan$|lightgoldenrodyellow$|lightgray$|lightgreen$|lightgrey$|lightpink$|lightsalmon$|lightseagreen$|lightskyblue$|lightslategray$|lightslategrey$|lightsteelblue$|lightyellow$|limegreen$|linen$|mediumaquamarine$|mediumblue$|mediumorchid$|mediumpurple$|mediumseagreen$|mediumslateblue$|mediumspringgreen$|mediumturquoise$|mediumvioletred$|midnightblue$|mintcream$|mistyrose$|moccasin$|navajowhite$|oldlace$|olive$|orangered$|orchid$|palegoldenrod$|palegreen$|paleturquoise$|palevioletred$|papayawhip$|peachpuff$|peru$|pink$|plum$|powderblue$|rosybrown$|royalblue$|saddlebrown$|salmon$|sandybrown$|seagreen$|seashell$|sienna$|skyblue$|slateblue$|slategray$|slategrey$|snow$|springgreen$|steelblue$|tan$|thistle$|tomato$|transparent$|turquoise$|violet$|wheat$|white$|yellowgreen$|rebeccapurple$)/i,J=3,Y=["info","notice","warning","critical"],K=["-","InvalidLogins","IpBlacklisted","IpBlacklistRemoved","JwksRotated","NewUserRegistered","NewRauthyAdmin","NewRauthyVersion","PossibleBruteForce","RauthyStarted","RauthyHealthy","RauthyUnhealthy","SecretsMigrated","UserEmailChange","UserPasswordReset","Test"],Q=["de","en","zh","ko"],W=["de","en"],X=["RS256","RS384","RS512","EdDSA"],ee=[{label:"authorization_code",value:!1},{label:"client_credentials",value:!1},{label:"password",value:!1},{label:"refresh_token",value:!1},{label:"device_code",value:!1}],ae=[{label:"S256",value:!1},{label:"plain",value:!1}],re="tpl_auth_providers",te="tpl_client_name",oe="tpl_client_url",le="tpl_csrf_token",ne="tpl_email_old",ie="tpl_email_new",se="tpl_error_text",ue="tpl_device_user_code_length",$e="tpl_is_reg_open",ce="tpl_login_action",ge="tpl_password_reset",de="tpl_status_code",he="tpl_restricted_email_domain";for(var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=typeof Uint8Array>"u"?[]:new Uint8Array(256),p=0;p<g.length;p++)h[g.charCodeAt(p)]=p;var C=function(e){var t=new Uint8Array(e),a,r=t.length,o="";for(a=0;a<r;a+=3)o+=g[t[a]>>2],o+=g[(t[a]&3)<<4|t[a+1]>>4],o+=g[(t[a+1]&15)<<2|t[a+2]>>6],o+=g[t[a+2]&63];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o},me=function(e){var t=e.length*.75,a=e.length,r,o=0,n,i,l,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var $=new ArrayBuffer(t),c=new Uint8Array($);for(r=0;r<a;r+=4)n=h[e.charCodeAt(r)],i=h[e.charCodeAt(r+1)],l=h[e.charCodeAt(r+2)],u=h[e.charCodeAt(r+3)],c[o++]=n<<2|i>>4,c[o++]=(i&15)<<4|l>>2,c[o++]=(l&3)<<6|u&63;return $};function pe(e){return`${window.location.origin}/auth/${e}/profile#me`}function fe(e){return e.inner.reduce((t,a)=>({...t,[a.path]:a.message}),{})}function we(){return typeof window<"u"}function ye(e){return e==="openid"||e==="profile"||e==="email"||e==="groups"||e==="address"||e==="phone"}const _e=e=>{F(64,(t,{challenge:a,verifier:r})=>{if(!t){localStorage.setItem(m,r);const o=I(24),n=e||"admin",i=`${window.location.origin}${z}`.replaceAll(":","%3A").replaceAll("/","%2F");window.location.href=`${D}?client_id=${S}&redirect_uri=${i}&response_type=code&code_challenge=${a}&code_challenge_method=S256&scope=openid+profile+email&nonce=${o}&state=${n}`}})},be=()=>{const e=`${R}?post_logout_redirect_uri=${window.location.origin}${q}`;window.location.href=e},Fe=e=>{console.log("saving csrf token in local storage",d,e),localStorage.setItem(d,e)},ve=()=>localStorage.getItem(d)||"",ke=e=>{localStorage.setItem(A,e)},Ae=e=>{localStorage.setItem(k,e)},Se=e=>{localStorage.setItem(w,e)},Ce=()=>localStorage.getItem(w)||"",Ie=()=>localStorage.getItem(m)||"",Ue=()=>localStorage.getItem(f)||"",De=()=>{localStorage.removeItem(m)},Re=()=>{localStorage.removeItem(d),localStorage.removeItem(A),localStorage.removeItem(k),localStorage.removeItem(m),localStorage.removeItem(f),localStorage.removeItem(w)};function ze(e){let t=C(e);const a={"+":"-","/":"_","=":""};return t.replace(/[+/=]/g,r=>a[r])}function Te(e){switch(e){case"info":return"rgba(52,255,109,0.7)";case"notice":return"rgba(51,69,255,0.7)";case"warning":return"rgba(255,211,51,0.7)";case"critical":return"rgba(255,46,46,0.7)"}}const Be=e=>e.toISOString().slice(0,16),qe=(e,t)=>{let a;if(t?a=Date.parse(`${e}T${t}`):a=Date.parse(e),!isNaN(a))return a/1e3},Ee=(e,t)=>{const a=-new Date().getTimezoneOffset(),r=new Date((e+a*60)*1e3);let o=r.getUTCDate();o<10&&(o="0"+o);let n=r.getUTCMonth()+1;n<10&&(n="0"+n);const i=r.getUTCFullYear();let l=r.getUTCHours();l<10&&(l="0"+l);let u=r.getUTCMinutes();u<10&&(u="0"+u);let $=r.getUTCSeconds();return $<10&&($="0"+$),t?`${i}-${n}-${o}T${l}:${u}:${$}`:`${i}/${n}/${o} ${l}:${u}:${$}`},Me=e=>{const t=e.length_min>20?e.length_min:20,a=e.include_lower_case||1,r=e.include_upper_case||1,o=e.include_digits||1,n=e.include_digits||1;for(;;){let i=0,l=0,u=0,$=0,c=[];for(let y=0;y<t;y+=1){let s=60;for(;s>57&&s<65||s>90&&s<97;)s=Math.floor(Math.random()*74)+33;s>=91&&s<=122&&(i+=1),s>=65&&s<=90&&(l+=1),s>=48&&s<=57&&(u+=1),s>=33&&s<=47&&($+=1),c.push(String.fromCharCode(s))}if(!(i<a||l<r||$<n||u<o))return c.join("")}},I=e=>{let t=[];e=e||8;for(let a=0;a<e;a+=1){let r=95;for(;r>90&&r<97;)r=Math.floor(Math.random()*57)+65;t.push(String.fromCharCode(r))}return t.join("")};function Ne(e){let t=e+"=",a=decodeURIComponent(document.cookie).split(";");for(let r=0;r<a.length;r++){let o=a[r];for(;o.charAt(0)===" ";)o=o.substring(1);if(o.indexOf(t)===0)return o.substring(t.length,o.length)}return""}function Oe(e,t){let a;return Promise.race([e,new Promise((r,o)=>{a=setTimeout(o,t,"timeout")})]).finally(()=>clearTimeout(a))}export{M as $,qe as A,Y as B,d as C,re as D,K as E,te as F,oe as G,ce as H,Se as I,Ue as J,Ce as K,Ne as L,W as M,Q as N,me as O,f as P,C as Q,T as R,ze as S,de as T,ye as U,pe as V,be as W,P as X,Z as Y,E as Z,F as _,I as a,N as a0,O as a1,Be as a2,J as a3,ee as a4,ae as a5,x as a6,H as a7,L as a8,X as a9,G as aa,j as ab,se as b,S as c,Ie as d,ke as e,Fe as f,ve as g,De as h,we as i,B as j,$e as k,Ee as l,Te as m,ue as n,V as o,Oe as p,fe as q,_e as r,Ae as s,Re as t,le as u,he as v,ne as w,ie as x,ge as y,Me as z};

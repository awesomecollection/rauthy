import{d as V,a as _,t as g}from"./disclose-version.BP4T4xdV.js";import{a as W,l as X,aa as Y,k as Z,f as z,p as F,c as p,r as e,s as v,t as h,j as m}from"./index-client.hxMyB_b4.js";import{s as d}from"./render.yNX9q8-B.js";import{i as w}from"./if.BeBa1Kxb.js";import{t as f}from"./class.CF2J4YCf.js";import{p as k}from"./proxy.DaVNR9vk.js";import{p as G}from"./props.DNAkfByl.js";import{u as H}from"./i18n.svelte.Ci9wvqOq.js";var J=g('<li class="li svelte-u5h3xg"> </li>'),L=g('<li class="li svelte-u5h3xg"> </li>'),ll=g('<li class="li svelte-u5h3xg"> </li>'),il=g('<li class="li svelte-u5h3xg"> </li>'),cl=g('<li class="li svelte-u5h3xg"> </li>'),sl=g('<div class="policyContainer svelte-u5h3xg"><b class="svelte-u5h3xg"> </b> <ul class="svelte-u5h3xg"><li class="li svelte-u5h3xg"> </li> <li class="li svelte-u5h3xg"> </li> <!> <!> <!> <!> <!></ul></div>');function al(R,l){W(l,!0);let q=G(l,"accepted",15,!1),u=H(),y=X(k([!1,!1,!1,!1,!1,!1]));Y(()=>{A()});function A(){if(!l.policy)return!1;let o=[!1,!1,!1,!1,!1,!1],r=!1;l.password.length<l.policy.length_min&&(o[0]=!0,r=!0),l.password.length>l.policy.length_max&&(o[1]=!0,r=!0);let s=[0,0,0,0];for(let x=0;x<l.password.length;x++){let t=l.password.charCodeAt(x);if(t>=97&&t<=122){s[0]=s[0]+1;continue}if(t>=65&&t<=90){s[1]=s[1]+1;continue}if(t>=48&&t<=57){s[2]=s[2]+1;continue}s[3]=s[3]+1}l.policy.include_lower_case&&l.policy.include_lower_case!==-1&&l.policy.include_lower_case>s[0]&&(o[2]=!0,r=!0),l.policy.include_upper_case&&l.policy.include_upper_case!==-1&&l.policy.include_upper_case>s[1]&&(o[3]=!0,r=!0),l.policy.include_digits&&l.policy.include_digits!==-1&&l.policy.include_digits>s[2]&&(o[4]=!0,r=!0),l.policy.include_special&&l.policy.include_special!==-1&&l.policy.include_special>s[3]&&(o[5]=!0,r=!0),Z(y,k(o)),q(!r)}var E=V(),B=z(E);{var D=o=>{var r=sl(),s=p(r),x=p(s,!0);e(s);var t=v(s,2),$=p(t),I=p($);e($);var P=v($,2),K=p(P);e(P);var M=v(P,2);{var N=c=>{var i=J(),n=p(i);e(i),h(()=>{var a;f(i,"policyErr",!!m(y)[2]),d(n,`${u.passwordPolicy.lowercaseMin??""}
                    ${(((a=l.policy)==null?void 0:a.include_lower_case)||0)??""}`)}),_(c,i)};w(M,c=>{l.policy.include_lower_case!==-1&&c(N)})}var b=v(M,2);{var O=c=>{var i=L(),n=p(i);e(i),h(()=>{var a;f(i,"policyErr",!!m(y)[3]),d(n,`${u.passwordPolicy.uppercaseMin??""}
                    ${(((a=l.policy)==null?void 0:a.include_upper_case)||0)??""}`)}),_(c,i)};w(b,c=>{l.policy.include_upper_case!==-1&&c(O)})}var C=v(b,2);{var Q=c=>{var i=ll(),n=p(i);e(i),h(()=>{var a;f(i,"policyErr",!!m(y)[4]),d(n,`${u.passwordPolicy.digitsMin??""}
                    ${(((a=l.policy)==null?void 0:a.include_digits)||0)??""}`)}),_(c,i)};w(C,c=>{l.policy.include_digits!==-1&&c(Q)})}var j=v(C,2);{var S=c=>{var i=il(),n=p(i);e(i),h(()=>{var a;f(i,"policyErr",!!m(y)[5]),d(n,`${u.passwordPolicy.specialMin??""}
                    ${(((a=l.policy)==null?void 0:a.include_special)||0)??""}`)}),_(c,i)};w(j,c=>{l.policy.include_special!==-1&&c(S)})}var T=v(j,2);{var U=c=>{var i=cl(),n=p(i);e(i),h(()=>{var a;return d(n,`${u.passwordPolicy.notRecent??""}
                    ${(((a=l.policy)==null?void 0:a.not_recently_used)||0)??""}`)}),_(c,i)};w(T,c=>{l.policy.not_recently_used!==-1&&c(U)})}e(t),e(r),h(()=>{var c;d(x,u.passwordPolicy.passwordPolicy),f($,"policyErr",!!m(y)[0]),d(I,`${u.passwordPolicy.lengthMin??""}
                ${l.policy.length_min??""}`),f(P,"policyErr",!!m(y)[1]),d(K,`${u.passwordPolicy.lengthMax??""}
                ${(((c=l.policy)==null?void 0:c.length_max)||0)??""}`)}),_(o,r)};w(B,o=>{l.policy&&o(D)})}_(R,E),F()}export{al as P};

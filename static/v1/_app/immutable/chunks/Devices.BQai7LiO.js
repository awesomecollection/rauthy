import"./disclose-version.BDr9Qe-U.js";import{p as H,w as J,_ as T,a as K,c as m,r as u,t as l,aq as I,s as w,u as d,v as O,ao as U,f as P,a9 as V}from"./index-client.ChFmlJin.js";import{s as f}from"./render.D821es-0.js";import{i as C}from"./if.DhkeN2Rc.js";import{e as W}from"./each.QTCItWz3.js";import{a as o,d as N,t as _,e as X}from"./template.DOaMAhd6.js";import{p as B}from"./proxy.DVTQVrWW.js";import{u as Q}from"./i18n.svelte.CKzx-KOG.js";import{u as Y}from"./session.svelte.Cl_wUjiT.js";import{d as Z,c as A,f as ee}from"./fetch.BnpwKXAn.js";import{s as re}from"./class.CSTj5U-k.js";import{p as ae}from"./props.B17NqqFW.js";import{l as F}from"./helpers.BweJi6s8.js";import{I as se}from"./IconStop.Bd6MwChf.js";import{I as te}from"./Input.1-DRzlwb.js";import{E as oe}from"./Expandable.mM16xP9C.js";import{c as ie}from"./patterns.C8SwZZE-.js";import{L as D}from"./LabeledValue.CC-TygYe.js";import{B as S}from"./Button.DAsYf-wl.js";var ce=_('<div class="device-header svelte-9n911e"><div class="device-head font-mono svelte-9n911e"> </div></div>'),de=_('<div class="saveButton svelte-9n911e"><!></div>'),ve=_("<div><!></div>"),le=_("<div> </div>"),ne=_('<div class="device svelte-9n911e"><!> <div class="row svelte-9n911e"><!> <!></div> <!> <!> <!> <!></div>');function me(R,h){H(h,!0);let r=ae(h,"device",15),t=Q(),n=J(B(T(()=>r().name)));async function $(){let v={device_id:r().id,name:d(n)},s=await Z(`/auth/v1/users/${h.userId}/devices`,v);s.error?console.error(s.error):r(r().name=d(n),!0)}async function j(){let v={device_id:r().id},s=await A(`/auth/v1/users/${h.userId}/devices`,v);s.error?console.error(s.error):r(r().refresh_exp=void 0,!0)}oe(R,{summary:v=>{var s=ce(),g=m(s),p=m(g,!0);u(g),u(s),l(()=>f(p,r().name)),o(v,s)},details:v=>{var s=ne(),g=m(s);D(g,{get label(){return t.account.deviceId},mono:!0,children:(e,c)=>{I();var a=N();l(()=>f(a,r().id)),o(e,a)},$$slots:{default:!0}});var p=w(g,2),k=m(p);te(k,{autocomplete:"off",width:"17rem",get label(){return t.account.deviceName},get placeholder(){return t.account.deviceName},onEnter:$,pattern:ie,required:!0,get value(){return d(n)},set value(e){O(n,B(e))},children:(e,c)=>{I();var a=N();l(()=>f(a,t.account.deviceName)),o(e,a)},$$slots:{default:!0}});var z=w(k,2);{var i=e=>{var c=de(),a=m(c);S(a,{onclick:$,children:(y,b)=>{I();var M=N();l(()=>f(M,t.common.save)),o(y,M)},$$slots:{default:!0}}),u(c),o(e,c)};C(z,e=>{d(n)!==r().name&&e(i)})}u(p);var q=w(p,2);D(q,{get label(){return t.account.regDate},children:(e,c)=>{I();var a=N();l(()=>f(a,F(r().created))),o(e,a)},$$slots:{default:!0}});var L=w(q,2);D(L,{get label(){return t.account.accessExp},children:(e,c)=>{I();var a=N();l(()=>f(a,F(r().access_exp))),o(e,a)},$$slots:{default:!0}});var x=w(L,2);{var G=e=>{D(e,{get label(){return t.account.accessRenew},button:c=>{S(c,{get ariaLabel(){return t.common.delete},invisible:!0,onclick:j,children:(a,y)=>{var b=ve(),M=m(b);se(M,{}),u(b),l(()=>re(b,"title",t.common.delete)),o(a,b)},$$slots:{default:!0}})},children:(c,a)=>{var y=le(),b=m(y,!0);l(()=>f(b,F(r().refresh_exp))),u(y),o(c,y)},$$slots:{button:!0,default:!0}})};C(x,e=>{r().refresh_exp&&e(G)})}var E=w(x,2);D(E,{get label(){return t.account.regIp},children:(e,c)=>{I();var a=N();l(()=>f(a,r().peer_ip)),o(e,a)},$$slots:{default:!0}}),u(s),o(v,s)},$$slots:{summary:!0,details:!0}}),K()}var ue=_('<div class="head svelte-w0g6eh"> </div> <div class="devices svelte-w0g6eh"><!></div>',1);function fe(R,h){H(h,!0);let r=Q(),t=Y(h.viewMode),n=V(()=>{var i;return(i=t.get())==null?void 0:i.user_id}),$=J(B([]));U(()=>{j()});async function j(){let i=await ee(`/auth/v1/users/${d(n)}/devices`);i.body?O($,B(i.body)):console.error("error fetching devices: "+i.error)}var v=ue(),s=P(v),g=m(s,!0);u(s);var p=w(s,2),k=m(p);{var z=i=>{var q=X(),L=P(q);W(L,19,()=>d($),x=>x.id,(x,G,E)=>{me(x,{get userId(){return d(n)},get device(){return d($)[d(E)]},set device(e){d($)[d(E)]=e}})}),o(i,q)};C(k,i=>{d(n)&&i(z)})}u(p),l(()=>f(g,(r==null?void 0:r.account.devicesDesc)||"Devices linked to this account")),o(R,v),K()}export{fe as D};

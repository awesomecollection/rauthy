import{a as h,t as b}from"./disclose-version.BP4T4xdV.js";import{a as ee,O as N,l as x,a5 as te,k as c,aa as ae,c as r,j as a,r as n,t as $,s as m,p as se,a9 as B}from"./index-client.hxMyB_b4.js";import{s as S}from"./render.yNX9q8-B.js";import{i as ie}from"./if.BeBa1Kxb.js";import{s as y}from"./class.CF2J4YCf.js";import{p as f}from"./proxy.DaVNR9vk.js";import{p as oe}from"./props.DNAkfByl.js";import{I as A}from"./IconChevronRight.OodA6O68.js";import{u as re}from"./i18n.svelte.Ci9wvqOq.js";import{B as E}from"./Button.BR1gOfNn.js";import{O as ne}from"./Options.CjsqRicG.js";import{f as le}from"./fetch.Bq59EV_b.js";const P=20;var ce=b('<div class="iconLeft svelte-1eyqa5j"><!></div>'),de=b('<div class="iconRight svelte-1eyqa5j"><!></div>'),fe=b('<div class="font-label total svelte-1eyqa5j"> </div>'),ve=b('<div class="container svelte-1eyqa5j"><div class="flex"><!> <ul class="svelte-1eyqa5j"><li class="svelte-1eyqa5j"> </li></ul> <!></div> <div class="flex gap-10"><div class="flex gap-05 chunkSize noselect"><div> </div> <div><!></div></div> <!></div></div>');function pe(d,s){ee(s,!0);const G=[5,10,20,30,50,100];let l=oe(s,"pageSize",31,()=>f(P)),p=re();const C="1rem";l(Number.parseInt(s.firstFetchHeaders.get("x-page-size")||P.toString()));let u=x(void 0),T=N(()=>l()),w=x(f(Number.parseInt(s.firstFetchHeaders.get("x-page-count")||"1"))),g=x(f(s.firstFetchHeaders.get("x-continuation-token"))),o=x(1),H=B(()=>a(o)>=a(w));te(()=>{if(s.idxTotalCount){let e=s.firstFetchHeaders.get(s.idxTotalCount);e&&c(u,f(Number.parseInt(e)))}}),ae(()=>{J()});async function J(){if(l()!==T){T=l(),c(g,void 0);let[e,t]=await s.sspFetch(`page_size=${l()}`);k(e,t),c(o,1)}}function D(e){let t=`page_size=${N(()=>l())}`;if(e){if(a(o)===2)return t;t+=`&backwards=${e}&offset=${s.itemsLength-1}`}return a(g)&&(t+=`&continuation_token=${N(()=>a(g))}`),t}async function K(){if(a(o)>1){let[e,t]=await s.sspFetch(D(!0));k(e,t),c(o,a(o)-1)}}async function M(){if(a(o)<a(w)){let[e,t]=await s.sspFetch(D(!1));k(e,t),c(o,a(o)+1)}}function k(e,t){if(e===206){let i=t.get("x-page-size");if(!i){console.error("Did not receive x-page-size with SSP");return}l(Number.parseInt(i)),c(w,f(Number.parseInt(t.get("x-page-count")||"1"))),c(g,f(t.get("x-continuation-token")));let v=s.idxTotalCount?t.get(s.idxTotalCount):void 0;v?c(u,f(Number.parseInt(v))):c(u,void 0)}else console.error("Received non 206 status with SSP")}var q=ve(),I=r(q),L=r(I),Q=B(()=>a(o)<2);E(L,{onclick:K,invisible:!0,get isDisabled(){return a(Q)},children:(e,t)=>{var i=ce(),v=r(i);A(v,{width:C}),n(i),$(()=>{y(i,"aria-label",p.pagination.gotoPagePrev),y(i,"data-disabled",a(o)===1)}),h(e,i)},$$slots:{default:!0}});var j=m(L,2),_=r(j),U=r(_,!0);n(_),n(j);var V=m(j,2);E(V,{onclick:M,invisible:!0,get isDisabled(){return a(H)},children:(e,t)=>{var i=de(),v=r(i);A(v,{width:C}),n(i),$(()=>{y(i,"aria-label",p.pagination.gotoPageNext),y(i,"data-disabled",a(H))}),h(e,i)},$$slots:{default:!0}}),n(I);var O=m(I,2),z=r(O),F=r(z),W=r(F,!0);n(F);var R=m(F,2),X=r(R);ne(X,{get ariaLabel(){return p.pagination.showCount},options:G,offsetTop:"-14rem",borderless:!0,get value(){return l()},set value(e){l(e)}}),n(R),n(z);var Y=m(z,2);{var Z=e=>{var t=fe(),i=r(t);n(t),$(()=>S(i,`${p.pagination.total??""}: ${a(u)??""}`)),h(e,t)};ie(Y,e=>{a(u)&&e(Z)})}n(O),n(q),$(()=>{S(U,a(o)),S(W,p.pagination.entries)}),h(d,q),se()}async function ue(d){let s=`/auth/v1/search?ty=${d.ty}&idx=${d.idx}&q=${d.q}`;return d.limit&&(s+=`$limit=${d.limit}`),await le(s)}export{P,pe as a,ue as f};

const m="pkce_verifier",w="pkce_verifier_upstream",p="csrf_token",A="access_token",O="id_token",v="provider_token",z="/auth/v1/oidc/authorize",C="rauthy",U="/auth/v1/oidc/logout",j="/auth/v1/oidc/callback",J="/auth/v1/admin",D="/auth/v1/account",R="/auth/v1/",B=/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/gm,G=/^\+[0-9\s]{0,32}$/gm,q=/^[a-zA-Z0-9À-ÿ-.\s]{0,48}$/gm,Z=/^[a-zA-Z0-9À-ÿ-]{0,48}$/gm,M=/^[a-zA-Z0-9_/-]{2,24}$/gm,x=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{1,32}$/gm,L=/^[\w\sÀ-ſ\-\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{0,32}$/gm,H=/^[a-zA-Z0-9\-_/\s]{0,128}$/gm,V=/^[a-zA-Z0-9\-_/]{2,32}$/gm,K=/^[a-zA-Z0-9\-_/]{2,128}$/gm,W=/^[a-zA-Z0-9À-ſ\-\s\u3041-\u3096\u30A0-\u30FF\u3400-\u4DB5\u4E00-\u9FCB\uF900-\uFA6A\u2E80-\u2FD5\uFF66-\uFF9F\uFFA1-\uFFDC\u31F0-\u31FF]{0,128}$/m,Y=/^[a-zA-Z0-9+.@/:]{0,48}$/gm,Q=/^[a-z0-9-_\/:\s]{0,128}$/gm,X=/^[a-z0-9.:-]+:\/\/[a-z0-9.:-]+$/m,ee=/^(-----BEGIN CERTIFICATE-----)[a-zA-Z0-9+/=\n]+(-----END CERTIFICATE-----)$/gm,ae=/^[a-z0-9\-_/:*]{2,64}$/gm,te=/^[a-zA-Z0-9,.:/_\-&?=~#!$'()*+%]*$/gm,re=/^(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}$/gm,ne=/(#(?:[0-9a-f]{2}){2,4}$|(#[0-9a-f]{3}$)|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\)$|black$|silver$|gray$|whitesmoke$|maroon$|red$|purple$|fuchsia$|green$|lime$|olivedrab$|yellow$|navy$|blue$|teal$|aquamarine$|orange$|aliceblue$|antiquewhite$|aqua$|azure$|beige$|bisque$|blanchedalmond$|blueviolet$|brown$|burlywood$|cadetblue$|chartreuse$|chocolate$|coral$|cornflowerblue$|cornsilk$|crimson$|currentcolor$|darkblue$|darkcyan$|darkgoldenrod$|darkgray$|darkgreen$|darkgrey$|darkkhaki$|darkmagenta$|darkolivegreen$|darkorange$|darkorchid$|darkred$|darksalmon$|darkseagreen$|darkslateblue$|darkslategray$|darkslategrey$|darkturquoise$|darkviolet$|deeppink$|deepskyblue$|dimgray$|dimgrey$|dodgerblue$|firebrick$|floralwhite$|forestgreen$|gainsboro$|ghostwhite$|goldenrod$|gold$|greenyellow$|grey$|honeydew$|hotpink$|indianred$|indigo$|ivory$|khaki$|lavenderblush$|lavender$|lawngreen$|lemonchiffon$|lightblue$|lightcoral$|lightcyan$|lightgoldenrodyellow$|lightgray$|lightgreen$|lightgrey$|lightpink$|lightsalmon$|lightseagreen$|lightskyblue$|lightslategray$|lightslategrey$|lightsteelblue$|lightyellow$|limegreen$|linen$|mediumaquamarine$|mediumblue$|mediumorchid$|mediumpurple$|mediumseagreen$|mediumslateblue$|mediumspringgreen$|mediumturquoise$|mediumvioletred$|midnightblue$|mintcream$|mistyrose$|moccasin$|navajowhite$|oldlace$|olive$|orangered$|orchid$|palegoldenrod$|palegreen$|paleturquoise$|palevioletred$|papayawhip$|peachpuff$|peru$|pink$|plum$|powderblue$|rosybrown$|royalblue$|saddlebrown$|salmon$|sandybrown$|seagreen$|seashell$|sienna$|skyblue$|slateblue$|slategray$|slategrey$|snow$|springgreen$|steelblue$|tan$|thistle$|tomato$|transparent$|turquoise$|violet$|wheat$|white$|yellowgreen$|rebeccapurple$)/i,oe=3,se=["Info","Notice","Warning","Critical"],ie=["InvalidLogins","IpBlacklisted","IpBlacklistRemoved","JwksRotated","NewUserRegistered","NewRauthyAdmin","NewRauthyVersion","PossibleBruteForce","RauthyStarted","RauthyHealthy","RauthyUnhealthy","SecretsMigrated","UserEmailChange","UserPasswordReset","Test"],ue=["de","en","zh","ko"],ce=["RS256","RS384","RS512","EdDSA"],le=[{label:"authorization_code",value:!1},{label:"client_credentials",value:!1},{label:"password",value:!1},{label:"refresh_token",value:!1},{label:"device_code",value:!1}],de=[{label:"S256",value:!1},{label:"plain",value:!1}],he="tpl_auth_providers",$e="tpl_client_name",fe="tpl_client_url",ge="tpl_csrf_token",me="tpl_email_old",ye="tpl_email_new",we="tpl_error_text",pe="tpl_device_user_code_length",ve="tpl_is_reg_open",be="tpl_login_action",Se="tpl_password_reset",_e="tpl_status_code",Fe="tpl_restricted_email_domain";var E={};Object.defineProperty(E,"__esModule",{value:!0});function P(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function ke(e,a){e||(e=43);for(var t=typeof window<"u"&&window.msCrypto||crypto,n=P(Array.prototype.map.call(t.getRandomValues(new Uint8Array(e)),function(i){return String.fromCharCode(i)}).join("")).substring(0,e),r=new Uint8Array(n.length),s=0;s<n.length;s++)r[s]=n.charCodeAt(s);var c=t.subtle.digest("SHA-256",r);typeof window<"u"&&window.CryptoOperation?(c.onerror=a,c.oncomplete=function(i){I(a,n,i.target.result)}):c.then(function(i){I(a,n,i)}).catch(a)}var N=E.default=ke;function I(e,a,t){e(null,{verifier:a,challenge:P(String.fromCharCode.apply(null,new Uint8Array(t)))})}for(var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=typeof Uint8Array>"u"?[]:new Uint8Array(256),y=0;y<f.length;y++)g[f.charCodeAt(y)]=y;var Te=function(e){var a=new Uint8Array(e),t,n=a.length,r="";for(t=0;t<n;t+=3)r+=f[a[t]>>2],r+=f[(a[t]&3)<<4|a[t+1]>>4],r+=f[(a[t+1]&15)<<2|a[t+2]>>6],r+=f[a[t+2]&63];return n%3===2?r=r.substring(0,r.length-1)+"=":n%3===1&&(r=r.substring(0,r.length-2)+"=="),r},Ae=function(e){var a=e.length*.75,t=e.length,n,r=0,s,c,i,d;e[e.length-1]==="="&&(a--,e[e.length-2]==="="&&a--);var h=new ArrayBuffer(a),$=new Uint8Array(h);for(n=0;n<t;n+=4)s=g[e.charCodeAt(n)],c=g[e.charCodeAt(n+1)],i=g[e.charCodeAt(n+2)],d=g[e.charCodeAt(n+3)],$[r++]=s<<2|c>>4,$[r++]=(c&15)<<4|i>>2,$[r++]=(i&3)<<6|d&63;return h};function Oe(e){return`${window.location.origin}/auth/${e}/profile#me`}function Ce(e){return e.inner.reduce((a,t)=>({...a,[t.path]:t.message}),{})}function Ee(e){return e==="openid"||e==="profile"||e==="email"||e==="groups"||e==="address"||e==="phone"}const Pe=e=>{N(64,(a,{challenge:t,verifier:n})=>{if(!a){localStorage.setItem(m,n);const r=Ke(24),s=e||"admin",c=`${window.location.origin}${j}`.replaceAll(":","%3A").replaceAll("/","%2F");window.location.href=`${z}?client_id=${C}&redirect_uri=${c}&response_type=code&code_challenge=${t}&code_challenge_method=S256&scope=openid+profile+email&nonce=${r}&state=${s}`}})},Ne=()=>{const e=`${U}?post_logout_redirect_uri=${window.location.origin}${R}`;window.location.href=e},Ie=e=>{localStorage.setItem(p,e)},b=()=>localStorage.getItem(p)||"",ze=e=>{localStorage.setItem(O,e)},Ue=e=>{localStorage.setItem(A,e)},je=e=>{localStorage.setItem(v,e)},Je=()=>localStorage.getItem(v)||"",De=()=>localStorage.getItem(m)||"",Re=()=>localStorage.getItem(w)||"",Be=()=>{localStorage.removeItem(m)},Ge=()=>{localStorage.removeItem(p),localStorage.removeItem(O),localStorage.removeItem(A),localStorage.removeItem(m),localStorage.removeItem(w),localStorage.removeItem(v)};function qe(e){let a=Te(e);const t={"+":"-","/":"_","=":""};return a.replace(/[+/=]/g,n=>t[n])}function Ze(e){const a={"-":"+",_:"/",".":"="},t=e.replace(/[-_.]/g,n=>a[n]);return Ae(t)}function Me(e){switch(e){case"test":return"#b2b2b2";case"info":return"#388c51";case"notice":return"#3d5d99";case"warning":return"#c29a4f";case"critical":return"#993d49"}}const xe=e=>e.toISOString().slice(0,16),Le=e=>{let a=Date.parse(e);if(!isNaN(a))return a/1e3},He=(e,a)=>{const t=-new Date().getTimezoneOffset(),n=new Date((e+t*60)*1e3);let r=n.getUTCDate();r<10&&(r="0"+r);let s=n.getUTCMonth()+1;s<10&&(s="0"+s);const c=n.getUTCFullYear();let i=n.getUTCHours();i<10&&(i="0"+i);let d=n.getUTCMinutes();d<10&&(d="0"+d);let h=n.getUTCSeconds();return h<10&&(h="0"+h),a?`${c}-${s}-${r}T${i}:${d}:${h}`:`${c}/${s}/${r} ${i}:${d}:${h}`},Ve=(e,a,t,n,r)=>{const s=a||1,c=t||1,i=n||1,d=r||1;for(;;){let h=e||16,$=0,S=0,_=0,F=0,k=[];for(let T=0;T<h;T+=1){let l=60;for(;l>57&&l<65||l>90&&l<97;)l=Math.floor(Math.random()*74)+33;l>=91&&l<=122&&($+=1),l>=65&&l<=90&&(S+=1),l>=48&&l<=57&&(_+=1),l>=33&&l<=47&&(F+=1),k.push(String.fromCharCode(l))}if(!($<s||S<c||F<d||_<i))return k.join("")}},Ke=e=>{let a="";const t=e;for(let n=0;n<t;n+=1){let r=60;for(;r>57&&r<65||r>90&&r<97;)r=Math.floor(Math.random()*74)+48;a=a.concat(String.fromCharCode(r))}return a},We=()=>new Proxy(new URLSearchParams(window.location.search),{get:(e,a)=>e.get(a.toString())}),Ye=(e,a)=>{let t;return Promise.race([e,new Promise((n,r)=>t=setTimeout(r,a,"timeout"))]).finally(()=>clearTimeout(t))},u={json:{"Content-Type":"application/json",Accept:"application/json"},form:{"Content-type":"application/x-www-form-urlencoded",Accept:"application/json"}};function o(){return{...u.json,"csrf-token":b()}}function Qe(){return{...u.form,"csrf-token":b()}}async function Xe(e){const a=await fetch("/auth/v1/oidc/authorize",{method:"POST",headers:o(),body:JSON.stringify(e)});return a.status===202&&window.location.replace(a.headers.get("location")),a}async function ea(e){const a=await fetch("/auth/v1/oidc/authorize/refresh",{method:"POST",headers:o(),body:JSON.stringify(e)});return a.status===202&&window.location.replace(a.headers.get("location")),a}async function aa(){return await fetch("/auth/v1/version",{method:"GET",headers:u.json})}async function ta(){return await fetch("/auth/v1/auth_check_admin",{method:"GET",headers:u.json})}async function ra(e){return await fetch("/auth/v1/oidc/token",{method:"POST",headers:u.form,body:e})}async function na(){return await fetch("/auth/v1/oidc/sessioninfo",{method:"GET",headers:u.json})}async function oa(e){return await fetch("/auth/v1/oidc/sessioninfo/xsrf",{method:"GET",headers:{...u.json,Authorization:`Bearer ${e}`}})}async function sa(e){let a=new FormData;for(let t in e)a.append(t,e[t]);return await fetch("/auth/v1/oidc/logout",{method:"POST",headers:Qe(),body:a})}async function ia(e){return await fetch("/auth/v1/oidc/device/verify",{method:"POST",headers:o(),body:JSON.stringify(e)})}async function ua(){return await fetch("/auth/v1/fed_cm/status",{method:"GET",headers:u.json})}async function ca(){return await fetch("/auth/v1/password_policy",{method:"GET",headers:u.json})}async function la(){return await fetch("/auth/v1/pow",{method:"POST",headers:u.json})}async function da(e,a,t){return await fetch(`/auth/v1/users/${e}/reset`,{method:"PUT",headers:{...u.json,"pwd-csrf-token":t},body:JSON.stringify(a)})}async function ha(e){return await fetch("/auth/v1/users/request_reset",{method:"POST",headers:o(),body:JSON.stringify(e)})}async function $a(e){return await fetch("/auth/v1/providers/login",{method:"POST",headers:o(),body:JSON.stringify(e)})}async function fa(e){return await fetch("/auth/v1/providers/callback",{method:"POST",headers:o(),body:JSON.stringify(e)})}async function ga(){return await fetch("/auth/v1/events/test",{method:"POST",headers:o()})}async function ma(e){return await fetch("/auth/v1/users/register",{method:"POST",headers:u.json,body:JSON.stringify(e)})}async function ya(e){return await fetch(`/auth/v1/users/${e}`,{method:"GET",headers:u.json})}async function wa(e){return await fetch(`/auth/v1/users/${e}/devices`,{method:"GET",headers:o()})}async function pa(e,a){return await fetch(`/auth/v1/users/${e}/devices`,{method:"PUT",headers:o(),body:JSON.stringify(a)})}async function va(e,a){return await fetch(`/auth/v1/users/${e}/devices`,{method:"DELETE",headers:o(),body:JSON.stringify(a)})}async function ba(e){return await fetch(`/auth/v1/users/${e}/webauthn`,{method:"GET",headers:o()})}async function Sa(e,a){return await fetch(`/auth/v1/providers/${e}/link`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function _a(){return await fetch("/auth/v1/providers/link",{method:"DELETE",headers:o()})}async function Fa(e){return await fetch(`/auth/v1/users/${e}/webid/data`,{method:"GET",headers:o()})}async function ka(e,a){return await fetch(`/auth/v1/users/${e}/webid/data`,{method:"PUT",headers:o(),body:JSON.stringify(a)})}async function Ta(e,a){return await fetch(`/auth/v1/users/${e}/self`,{method:"PUT",headers:o(),body:JSON.stringify(a)})}async function Aa(e){return await fetch(`/auth/v1/users/${e}/self/convert_passkey`,{method:"POST",headers:o()})}async function Oa(){return await fetch("/auth/v1/update_language",{method:"POST",headers:o()})}async function Ca(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/register/start`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function Ea(e,a,t){return await fetch(`/auth/v1/users/${e}/webauthn/register/start`,{method:"POST",headers:{...u.json,"pwd-csrf-token":t},body:JSON.stringify(a)})}async function Pa(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/register/finish`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function Na(e,a,t){return await fetch(`/auth/v1/users/${e}/webauthn/register/finish`,{method:"POST",headers:{...u.json,"pwd-csrf-token":t},body:JSON.stringify(a)})}async function Ia(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/auth/start`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function za(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/auth/finish`,{method:"POST",headers:o(),body:JSON.stringify(a)})}async function Ua(e,a){return await fetch(`/auth/v1/users/${e}/webauthn/delete/${a}`,{method:"DELETE",headers:o()})}export{za as $,Se as A,Ve as B,C,Ia as D,da as E,Ea as F,Ze as G,qe as H,Na as I,he as J,$e as K,ue as L,fe as M,be as N,Xe as O,He as P,w as Q,J as R,$a as S,ve as T,je as U,ea as V,ha as W,Re as X,Je as Y,fa as Z,N as _,De as a,Ye as a0,na as a1,Pe as a2,pe as a3,ia as a4,wa as a5,pa as a6,W as a7,va as a8,Oe as a9,X as aA,ce as aB,ne as aC,K as aD,V as aE,H as aF,Me as aG,se as aH,ga as aI,re as aJ,M as aK,ie as aL,Q as aM,ee as aN,ta as aO,_a as aa,Sa as ab,B as ac,G as ad,q as ae,Z as af,Ta as ag,ba as ah,Ca as ai,Pa as aj,Ua as ak,ca as al,Aa as am,ka as an,Ne as ao,ya as ap,Fa as aq,b as ar,oe as as,Le as at,xe as au,ae as av,Ee as aw,le as ax,de as ay,Y as az,ra as b,ze as c,oa as d,Ie as e,Be as f,We as g,D as h,la as i,aa as j,_e as k,we as l,te as m,ua as n,Ce as o,ge as p,sa as q,Ge as r,Ue as s,Fe as t,ma as u,x as v,L as w,me as x,ye as y,Oa as z};

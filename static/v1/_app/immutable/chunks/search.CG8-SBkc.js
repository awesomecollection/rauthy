import"./disclose-version.BDr9Qe-U.js";import{p as ee,$ as S,o as b,ap as te,m as c,a6 as ae,c as r,l as a,r as n,t as h,s as m,a as se,ab as O}from"./index-client.Ds4XgiuL.js";import{s as j}from"./render.Bq2-eTRf.js";import{i as ie}from"./if.Du7BDhAX.js";import{a as x,t as $}from"./template.DXIK6jcH.js";import{s as y}from"./class.Ik0ma2JO.js";import{p as f}from"./proxy.Bsf9UJbk.js";import{p as oe}from"./props.CpDInb2-.js";import{I as A}from"./IconChevronRight.VeFLbKE9.js";import{u as re}from"./i18n.svelte.CB3BpIrt.js";import{B as E}from"./Button.C_IpvWJY.js";import{O as ne}from"./Options.DccTdWl1.js";import{f as le}from"./fetch.DFmyLr06.js";const P=20;var ce=$('<div class="iconLeft svelte-1eyqa5j"><!></div>'),de=$('<div class="iconRight svelte-1eyqa5j"><!></div>'),fe=$('<div class="font-label total svelte-1eyqa5j"> </div>'),pe=$('<div class="container svelte-1eyqa5j"><div class="flex"><!> <ul class="svelte-1eyqa5j"><li class="svelte-1eyqa5j"> </li></ul> <!></div> <div class="flex gap-10"><div class="flex gap-05 chunkSize noselect"><div> </div> <div><!></div></div> <!></div></div>');function ve(d,s){ee(s,!0);const G=[5,10,20,30,50,100];let l=oe(s,"pageSize",31,()=>f(P)),v=re();const C="1rem";l(Number.parseInt(s.firstFetchHeaders.get("x-page-size")||P.toString()));let u=b(void 0),T=S(()=>l()),w=b(f(Number.parseInt(s.firstFetchHeaders.get("x-page-count")||"1"))),g=b(f(s.firstFetchHeaders.get("x-continuation-token"))),o=b(1),H=O(()=>a(o)>=a(w));te(()=>{if(s.idxTotalCount){let e=s.firstFetchHeaders.get(s.idxTotalCount);e&&c(u,f(Number.parseInt(e)))}}),ae(()=>{J()});async function J(){if(l()!==T){T=l(),c(g,void 0);let[e,t]=await s.sspFetch(`page_size=${l()}`);k(e,t),c(o,1)}}function D(e){let t=`page_size=${S(()=>l())}`;if(e){if(a(o)===2)return t;t+=`&backwards=${e}&offset=${s.itemsLength-1}`}return a(g)&&(t+=`&continuation_token=${S(()=>a(g))}`),t}async function K(){if(a(o)>1){let[e,t]=await s.sspFetch(D(!0));k(e,t),c(o,a(o)-1)}}async function M(){if(a(o)<a(w)){let[e,t]=await s.sspFetch(D(!1));k(e,t),c(o,a(o)+1)}}function k(e,t){if(e===206){let i=t.get("x-page-size");if(!i){console.error("Did not receive x-page-size with SSP");return}l(Number.parseInt(i)),c(w,f(Number.parseInt(t.get("x-page-count")||"1"))),c(g,f(t.get("x-continuation-token")));let p=s.idxTotalCount?t.get(s.idxTotalCount):void 0;p?c(u,f(Number.parseInt(p))):c(u,void 0)}else console.error("Received non 206 status with SSP")}var q=pe(),z=r(q),L=r(z),Q=O(()=>a(o)<2);E(L,{onclick:K,invisible:!0,get isDisabled(){return a(Q)},children:(e,t)=>{var i=ce(),p=r(i);A(p,{width:C}),n(i),h(()=>{y(i,"aria-label",v.pagination.gotoPagePrev),y(i,"data-disabled",a(o)===1)}),x(e,i)},$$slots:{default:!0}});var F=m(L,2),_=r(F),U=r(_,!0);n(_),n(F);var V=m(F,2);E(V,{onclick:M,invisible:!0,get isDisabled(){return a(H)},children:(e,t)=>{var i=de(),p=r(i);A(p,{width:C}),n(i),h(()=>{y(i,"aria-label",v.pagination.gotoPageNext),y(i,"data-disabled",a(H))}),x(e,i)},$$slots:{default:!0}}),n(z);var R=m(z,2),I=r(R),N=r(I),W=r(N,!0);n(N);var B=m(N,2),X=r(B);ne(X,{get ariaLabel(){return v.pagination.showCount},options:G,offsetTop:"-14rem",borderless:!0,get value(){return l()},set value(e){l(e)}}),n(B),n(I);var Y=m(I,2);{var Z=e=>{var t=fe(),i=r(t);n(t),h(()=>j(i,`${v.pagination.total??""}: ${a(u)??""}`)),x(e,t)};ie(Y,e=>{a(u)&&e(Z)})}n(R),n(q),h(()=>{j(U,a(o)),j(W,v.pagination.entries)}),x(d,q),se()}async function ue(d){let s=`/auth/v1/search?ty=${d.ty}&idx=${d.idx}&q=${d.q}`;return d.limit&&(s+=`$limit=${d.limit}`),await le(s)}export{P,ve as a,ue as f};

import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.Dn68_YLB.js";import{p as H,c as r,r as l,t as P,a as J,s as v,i as $,h as t,g as a,ap as oe,f as K}from"../chunks/runtime.BsghBUX9.js";import{s as S}from"../chunks/render.CTp9lacC.js";import{i as Q}from"../chunks/if.6Ov_EDLa.js";import{e as V}from"../chunks/each.URXtkKAp.js";import{a as b,t as _,d as ve,e as W}from"../chunks/template.jENAUvUX.js";import{t as ne,a as ce}from"../chunks/index.G5lyZbma.js";import{p as d}from"../chunks/proxy.YH42NwLs.js";import{o as pe}from"../chunks/index-client.ClP8y9aT.js";import{a as me,b as be,c as Y}from"../chunks/OptionSelect.Cn2sqgid.js";import{j as U,r as ge}from"../chunks/helpers.CBl6QeM5.js";import{B as ue}from"../chunks/Button.CHwcFOJ-.js";import{O as fe,P as he}from"../chunks/Pagination.C52gIDzw.js";import{P as we}from"../chunks/PaginationServer.Bu5waYfq.js";import{p as Z}from"../chunks/props.CslUVmW_.js";import{C as xe}from"../chunks/CheckIcon.CMbYrOAg.js";import{E as Ie}from"../chunks/ExpandContainer.BAZSCBeT.js";import{T as X}from"../chunks/Tooltip.D8Tbt6Nb.js";var $e=_('<div class="uid svelte-psgb3d"> </div>'),Se=_('<div class="ip svelte-psgb3d"> </div>'),ke=_('<div class="date svelte-psgb3d"> </div>'),_e=_('<div class="header svelte-psgb3d"><!> <div class="header svelte-psgb3d"><!> <!></div></div>'),Ce=_('<div class="details svelte-psgb3d"><div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">Session ID:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">User ID:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">Expires:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">Last Seen:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">State:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">IP:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">MFA:</div> <!></div></div>'),Pe=_('<div class="container svelte-psgb3d"><!></div>');function ee(F,B){H(B,!0);let n=Z(B,"session",27,()=>d({})),y=Z(B,"now",11,0);var h=Pe(),D=r(h);Ie(D,{header:w=>{var c=_e(),g=r(c);X(g,{text:"User ID",children:(u,A)=>{var o=$e(),k=r(o,!0);l(o),P(()=>S(k,n().user_id)),b(u,o)},$$slots:{default:!0}});var x=v(g,2),p=r(x);X(p,{text:"Peer IP",children:(u,A)=>{var o=Se(),k=r(o,!0);l(o),P(()=>S(k,n().remote_ip)),b(u,o)},$$slots:{default:!0}});var m=v(p,2);X(m,{text:"Last Seen",children:(u,A)=>{var o=ke(),k=r(o,!0);P(()=>S(k,U(n().last_seen))),l(o),b(u,o)},$$slots:{default:!0}}),l(x),l(c),b(w,c)},body:w=>{var c=Ce(),g=r(c),x=v(r(g));l(g);var p=v(g,2),m=v(r(p));l(p);var u=v(p,2),A=v(r(u));P(()=>S(A,` ${U(n().exp)??""}`)),l(u);var o=v(u,2),k=v(r(o));P(()=>S(k,` ${U(n().last_seen)??""}`)),l(o);var M=v(o,2),T=v(r(M));l(M);var j=v(M,2),N=v(r(j));l(j);var O=v(j,2),R=v(r(O),2);xe(R,{get check(){return n().is_mfa}}),l(O),l(c),P(()=>{S(x,` ${n().id??""}`),S(m,` ${n().user_id??""}`),S(T,` ${n().state??""}`),S(N,` ${n().remote_ip??""}`)}),b(w,c)},$$slots:{header:!0,body:!0}}),l(h),P(()=>ne(h,"expired",n().exp<y())),b(F,h),J()}var ye=_('<div class="svelte-1rjd8yh"><!></div>'),De=_('<div class="svelte-1rjd8yh"><!></div>'),je=_('<div class="content"><div class="row svelte-1rjd8yh"><!> <div class="button svelte-1rjd8yh"><!></div></div> <div id="sessions" class="svelte-1rjd8yh"><!></div> <!></div>');function Le(F,B){H(B,!0);let n=$(""),y=$(d([])),h=$(d([])),D=$(d([])),w=$(Date.now()/1e3),c=$(""),g=$(!1),x=$(15),p=$(""),m=$(1),u=[{label:"User ID",callback:(e,s)=>{var i;return(i=e.user_id)==null?void 0:i.toLowerCase().includes(s.toLowerCase())}},{label:"Session ID",callback:(e,s)=>e.id.toLowerCase().includes(s.toLowerCase())},{label:"IP",callback:(e,s)=>{var i;return(i=e.remote_ip)==null?void 0:i.toLowerCase().includes(s.toLowerCase())}}],A=[{label:"Expires",callback:(e,s)=>e.exp-s.exp},{label:"Last Seen",callback:(e,s)=>e.last_seen-s.last_seen},{label:"Session ID",callback:(e,s)=>e.id.localeCompare(s.id)},{label:"User ID",callback:(e,s)=>{var i;return(i=e.user_id)==null?void 0:i.localeCompare(s.user_id)}},{label:"State",callback:(e,s)=>e.state.localeCompare(s.state)},{label:"IP",callback:(e,s)=>{var i;return(i=e.remote_ip)==null?void 0:i.localeCompare(s.remote_ip)}}];pe(()=>{o()});async function o(e,s,i,I){let f;if(e===!0?i&&a(m)===2?f=await Y(I||a(x),s,void 0,!1):f=await Y(I||a(x),s,a(p),i):f=await me(),!f.ok)t(n,"Error fetching sessions: "+f.body.message);else{f.status===206?(t(x,d(Number.parseInt(f.headers.get("x-page-size"),10))),t(p,d(f.headers.get("x-continuation-token"))),t(c,"session")):t(c,"");let C=await f.json();t(y,d([...C])),t(h,d([...C])),t(w,Date.now()/1e3)}}async function k(e,s){await o(!0,e,s),s?t(m,a(m)-1):t(m,a(m)+1)}async function M(e){t(p,""),await o(!0,0,!1,e),t(m,1)}async function T(){let e=await be();if(e.ok)ge();else{let s=await e.json();t(n,d(s.message))}t(w,d(new Date))}var j=je(),N=r(j),O=r(N);fe(O,{get items(){return a(y)},searchOptions:u,orderOptions:A,firstDirReverse:!0,get resItems(){return a(h)},set resItems(e){t(h,d(e))},get useServerSideIdx(){return a(c)},set useServerSideIdx(e){t(c,d(e))},get isSearchFiltered(){return a(g)},set isSearchFiltered(e){t(g,d(e))}});var R=v(O,2);ce(R,"margin-top","-10px");var se=r(R);ue(se,{level:3,$$events:{click:T},children:(e,s)=>{oe();var i=ve("Invalidate All Sessions");b(e,i)},$$slots:{default:!0}}),l(R),l(N);var q=v(N),z=v(q),ae=r(z);{var te=e=>{var s=W(),i=K(s);V(i,19,()=>a(y),I=>I.id,(I,f,C)=>{var L=ye(),G=r(L);ee(G,{get session(){return a(y)[a(C)]},set session(E){a(y)[a(C)]=E},get now(){return a(w)},set now(E){t(w,d(E))}}),l(L),b(I,L)}),b(e,s)},ie=e=>{var s=W(),i=K(s);V(i,19,()=>a(D),I=>I.id,(I,f,C)=>{var L=De(),G=r(L);ee(G,{get session(){return a(D)[a(C)]},set session(E){a(D)[a(C)]=E},get now(){return a(w)},set now(E){t(w,d(E))}}),l(L),b(I,L)}),b(e,s)};Q(ae,e=>{a(c)&&!a(g)?e(te):e(ie,!1)})}l(z);var re=v(z,2);{var le=e=>{we(e,{fetchPageCallback:k,sspPageSizeChange:M,get sspPage(){return a(m)},set sspPage(s){t(m,d(s))},get sspPageSize(){return a(x)},set sspPageSize(s){t(x,d(s))},get sspContinuationToken(){return a(p)},set sspContinuationToken(s){t(p,d(s))}})},de=e=>{he(e,{get items(){return a(h)},set items(s){t(h,d(s))},get resItems(){return a(D)},set resItems(s){t(D,d(s))}})};Q(re,e=>{a(c)&&!a(g)?e(le):e(de,!1)})}l(j),P(()=>S(q,` ${a(n)??""} `)),b(F,j),J()}function Ee(F){Le(F,{})}export{Ee as component};

import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.C93jtn63.js";import{p as d,ao as m,a as f,ap as l}from"../chunks/index-client.ijM6xFk7.js";import{h as _}from"../chunks/svelte-head.JypCq_Qi.js";import{i as u}from"../chunks/lifecycle.Dc8lG2vb.js";import{b as w,c as h,s as k,d as g,e as v,f as b,R as j,h as y}from"../chunks/helpers.DMpx17S8.js";import{a as C,b as L}from"../chunks/dataFetching.B_dCHvwF.js";import{u as i}from"../chunks/param.svelte.BZ3eYfLX.js";function R(S,n){d(n,!1);let c=i("code"),p=i("state");m(async()=>{const a=new URLSearchParams;let t=j,o=p.get();o&&(o==="account"?t=y:o.startsWith("device")&&(t=`/auth/v1/${o}`));let s=c.get();if(!s){console.error("no `code` given");return}a.append("grant_type","authorization_code"),a.append("code",s),a.append("redirect_uri",t),a.append("client_id",w),a.append("code_verifier",h());let r=await C(a),e=await r.json();k(e.access_token),g(e.id_token),r=await L(e.access_token),e=await r.json(),v(e.csrf_token),b(),window.location.replace(t)}),u(),_(a=>{l.title="Callback"}),f()}export{R as component};

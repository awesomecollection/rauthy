import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DvmPJwhI.js";import{p as U,o as v,ap as W,f as ee,t as f,a as ae,m as t,s,l as p,c as o,r as a,ar as re}from"../chunks/index-client.Ds4XgiuL.js";import{s as i}from"../chunks/render.Bq2-eTRf.js";import{i as F}from"../chunks/if.Du7BDhAX.js";import{e as se,i as oe}from"../chunks/each.MnMr4iw5.js";import{a as u,t as I,d as te}from"../chunks/template.DXIK6jcH.js";import{p as m}from"../chunks/proxy.CB6KOiNf.js";import{B as ie}from"../chunks/Button.nDjAKZm4.js";import{I as pe}from"../chunks/IconCheck.CzEyprnz.js";import{f as ce,b as ne}from"../chunks/fetch.DFmyLr06.js";import{u as me}from"../chunks/i18n_admin.svelte.B9VY-ZfA.js";import{O as ve}from"../chunks/Options.Bth8pjCB.js";var le=I('<li class="font-mono"> </li>'),ye=I('<div class="err"> </div>'),de=I('<h3> </h3> <p> </p> <p> </p> <p><span class="font-label"> </span> <span class="active font-mono svelte-lxghyr"> </span></p> <p> </p> <ul></ul> <p> </p> <p> </p> <!> <div class="btn svelte-lxghyr"><!></div> <!> <!>',1);function fe(g,G){U(G,!0);let c=me(),l=v(""),y=v(!0),O=v(""),d=v(""),K=v(m([])),b=v(!1);W(async()=>{var r;let e=await ce("/auth/v1/encryption/keys");e.body?(t(K,m(e.body.keys)),t(O,m(e.body.active)),t(d,m(e.body.active))):t(l,m(((r=e.error)==null?void 0:r.message)||"Error")),t(y,!1)});async function H(){t(y,!0);let e={key_id:p(d)},r=await ne("/auth/v1/encryption/migrate",e);r.error?t(l,m(r.error.message)):(t(b,!0),setTimeout(()=>{t(b,!1)},4e3)),t(y,!1)}var q=de(),h=ee(q),J=o(h,!0);a(h);var k=s(h,2),M=o(k,!0);a(k);var $=s(k,2),N=o($,!0);a($);var w=s($,2),x=o(w),P=o(x);a(x);var z=s(x,2),Q=o(z,!0);a(z),a(w);var T=s(w,2),R=o(T);a(T);var A=s(T,2);se(A,21,()=>p(K),oe,(e,r)=>{var n=le(),j=o(n,!0);a(n),f(()=>i(j,p(r))),u(e,n)}),a(A);var L=s(A,2),S=o(L,!0);a(L);var B=s(L,2),V=o(B);a(B);var C=s(B,2);ve(C,{get ariaLabel(){return c.docs.encKeys.migrateToKey},get options(){return p(K)},get value(){return p(d)},set value(e){t(d,m(e))}});var E=s(C,2),X=o(E);ie(X,{onclick:H,get isLoading(){return p(y)},children:(e,r)=>{re();var n=te();f(()=>i(n,c.docs.encKeys.migrate)),u(e,n)},$$slots:{default:!0}}),a(E);var D=s(E,2);{var Y=e=>{var r=ye(),n=o(r,!0);a(r),f(()=>i(n,p(l))),u(e,r)};F(D,e=>{p(l)&&e(Y)})}var Z=s(D,2);{var _=e=>{pe(e,{})};F(Z,e=>{p(b)&&e(_)})}f(()=>{i(J,c.docs.encKeys.header),i(M,c.docs.encKeys.p1),i(N,c.docs.encKeys.p2),i(P,`${c.docs.encKeys.keyActive??""}:`),i(Q,p(O)),i(R,`${c.docs.encKeys.keysAvailable??""}:`),i(S,c.docs.encKeys.p3),i(V,`${c.docs.encKeys.migrateToKey??""}:`)}),u(g,q),ae()}function ue(g){fe(g,{})}export{ue as component};

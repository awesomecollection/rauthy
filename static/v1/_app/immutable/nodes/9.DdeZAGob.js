import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DtyiMpWz.js";import{p as ce,i as u,ao as de,f as G,t as B,a as ne,h as r,s as v,g as t,aq as w,c as l,r as o}from"../chunks/index-client.DAoU_hDn.js";import{d as me,e as fe,s as D}from"../chunks/render.mNhspeV3.js";import{i as T}from"../chunks/if.BANCODOf.js";import{e as ue}from"../chunks/each.DTG73tix.js";import{a as p,t as k,d as N,e as he}from"../chunks/template.DcxtE4ym.js";import{t as we,a as Ie}from"../chunks/index.DER1jHiU.js";import{p as i}from"../chunks/proxy.D3ASEzk3.js";import{r as ge}from"../chunks/legacy-client.rYJ80fHr.js";import{O as xe,P as $e}from"../chunks/Pagination.DF9sn7Vj.js";import{g as ke,p as ye,d as Pe}from"../chunks/dataFetchingAdmin.D7RWqeRL.js";import{B as H}from"../chunks/Button.CKHLXer8.js";import{c as be,a as Se,I as J}from"../chunks/Input.C04-Kl2S.js";import{A as Ee,B as Oe,o as Be,k as De}from"../chunks/helpers.BV-akmwW.js";import{I as Ne}from"../chunks/IconStop.D3wKU0RX.js";import{T as qe}from"../chunks/OptionSelect.CBlj_bre.js";var Ae=k('<div class="addNewInputs svelte-1fhw572"><!> <!> <div class="saveBtn svelte-1fhw572"><!></div> <div class="err svelte-1fhw572"> </div></div>'),_e=k('<div class="svelte-1fhw572">No blacklisted IPs</div>'),je=(y,q,P)=>q(t(P).ip),Ce=k('<div role="button" tabindex="0" class="delete svelte-1fhw572"><!></div>'),Le=k('<div class="blacklisted svelte-1fhw572"><div class="ip svelte-1fhw572"> </div> <div class="exp svelte-1fhw572"> </div> <!></div>'),Te=k(' <div class="content"><div class="top svelte-1fhw572"><!> <div class="addNew svelte-1fhw572"><!></div></div> <!> <div id="blacklist" class="svelte-1fhw572"><!></div> <!> <div style="height: 20px"></div></div>',1);function Ve(y,q){ce(q,!0);let P=u(""),I=u(""),b=u(i([])),S=u(i([])),A=u(i([])),g=u(!1),c=i({ip:"",exp:""}),E=u(i({}));const M=be().shape({ip:Se().required("IP is required").matches(Ee,"Invalid IPv4")}),Q=new Date().toISOString().split(".")[0],W=[{label:"IP",callback:(e,a)=>e.ip.includes(a)}];let Y=[{label:"IP",callback:(e,a)=>e.ip.localeCompare(a.ip)}];ge(()=>{t(g)&&(r(I,""),c.exp=new Date().toISOString().split(".")[0])}),de(()=>{_()});async function _(){let e=await ke(),a=await e.json();e.ok?r(b,i(a.ips)):r(P,i(a.message))}async function Z(){if(r(I,""),!await ee())return;let e=Oe(c.exp);if(!e){r(I,"Invalid Date Input: User Expires");return}let a={ip:c.ip,exp:e},d=await ye(a);if(d.ok)r(g,!1),c.ip="",await _();else{let n=await d.json();r(I,i(n.message))}}async function V(e){(await Pe(e)).ok&&await _()}async function ee(){try{return await M.validate(c,{abortEarly:!1}),r(E,i({})),!0}catch(e){return r(E,i(Be(e))),!1}}w();var F=Te(),K=G(F),R=v(K),j=l(R),U=l(j);xe(U,{get items(){return t(b)},searchOptions:W,orderOptions:Y,get resItems(){return t(S)},set resItems(e){r(S,i(e))}});var X=v(U,2),ae=l(X);H(ae,{level:3,$$events:{click:()=>r(g,!t(g))},children:(e,a)=>{w();var d=N("BLACKLIST IP");p(e,d)},$$slots:{default:!0}}),o(X),o(j);var z=v(j,2);{var te=e=>{var a=Ae(),d=l(a);J(d,{width:"9.5rem",autocomplete:"off",placeholder:"IP",get value(){return c.ip},set value(s){c.ip=s},get error(){return t(E).ip},set error(s){t(E).ip=s},children:(s,O)=>{w();var f=N("IP");p(s,f)},$$slots:{default:!0}});var n=v(d,2);J(n,{type:"datetime-local",step:"60",width:"18rem",min:Q,max:"2099-01-01T00:00",get value(){return c.exp},set value(s){c.exp=s},children:(s,O)=>{w();var f=N("EXPIRES");p(s,f)},$$slots:{default:!0}});var m=v(n,2),x=l(m);H(x,{level:1,$$events:{click:Z},children:(s,O)=>{w();var f=N("SAVE");p(s,f)},$$slots:{default:!0}}),o(m);var h=v(m,2),L=l(h,!0);o(h),o(a),B(()=>D(L,t(I))),we(3,a,()=>Ie),p(e,a)};T(z,e=>{t(g)&&e(te)})}var C=v(z,2),se=l(C);{var re=e=>{var a=_e();p(e,a)},ie=e=>{var a=he(),d=G(a);ue(d,17,()=>t(A),n=>n.ip,(n,m)=>{var x=Le(),h=l(x),L=l(h,!0);o(h);var s=v(h,2),O=l(s,!0);B(()=>D(O,De(t(m).exp))),o(s);var f=v(s,2);qe(f,{text:"Delete IP",children:(ve,Ke)=>{var $=Ce();$.__click=[je,V,m];var pe=l($);Ne(pe,{color:"var(--col-err)"}),o($),fe("keypress",$,()=>V(t(m).ip)),p(ve,$)},$$slots:{default:!0}}),o(x),B(()=>D(L,t(m).ip)),p(n,x)}),p(e,a)};T(se,e=>{t(b).length===0?e(re):e(ie,!1)})}o(C);var le=v(C,2);{var oe=e=>{$e(e,{get items(){return t(S)},set items(a){r(S,i(a))},get resItems(){return t(A)},set resItems(a){r(A,i(a))}})};T(le,e=>{t(b).length>0&&e(oe)})}w(2),o(R),B(()=>D(K,`${t(P)??""} `)),p(y,F),ne()}me(["click"]);function Fe(y){Ve(y,{})}export{Fe as component};

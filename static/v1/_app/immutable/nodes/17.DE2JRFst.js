import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DUFkTaXF.js";import{p as q,i as y,ao as M,a as O,g as a,h as t,c as b,aq as N,s as S,r as j,t as _,f as B}from"../chunks/index-client.CzvcfCLI.js";import{s as L}from"../chunks/render.BJBkrb2f.js";import{e as ee}from"../chunks/each.BtetwUOf.js";import{a as d,d as P,t as k,e as ae}from"../chunks/template.CQASMEo4.js";import{p as s}from"../chunks/proxy.CHyqegA9.js";import{k as te,l as re,m as se,n as oe}from"../chunks/dataFetchingAdmin.D6QJ_imf.js";import{i as T}from"../chunks/if.Dlf0zx3_.js";import{p as R}from"../chunks/props.BRvF51YW.js";import{r as K}from"../chunks/legacy-client.CQT_jR_Y.js";import{E as W}from"../chunks/ExpandContainer.96GzOZVL.js";import{c as X,a as F,I as H}from"../chunks/Input.BmqIhqeF.js";import{X as J,o as Q}from"../chunks/helpers.kNqlWGzE.js";import{B as V}from"../chunks/Button.BMVss8ej.js";import{t as U,a as z}from"../chunks/index.CqGLefLa.js";import{T as Y,a as ie,P as ne}from"../chunks/Pagination.B865uVVG.js";import{T as le}from"../chunks/TabBar.DO8vwRCx.js";var ve=k('<div class="header font-label svelte-r30xs6">ADD NEW GROUP</div>'),de=k('<div class="success svelte-r30xs6">Success</div>'),ce=k('<div class="err svelte-r30xs6"> </div>'),ue=k('<div class="container svelte-r30xs6"><!> <!> <!> <!></div>');function me(C,h){q(h,!0);let u=R(h,"idx",31,()=>-1),m=y(void 0),l=y(s({group:""})),p=y(""),f=y(!1),x=y(void 0),E=y(s({}));const D=X().shape({group:F().trim().matches(J,"Can only contain: 'a-z0-9-_/:*', length: 2-64")});K(()=>{a(f)&&t(x,s(setTimeout(()=>{h.onSave(),t(f,!1),t(l,s({group:""})),t(m,!1)},1500)))}),M(()=>()=>clearTimeout(a(x)));async function o(){if(t(p,""),!await c()){t(p,"Invalid input");return}a(l).group=a(l).group.trim();let i=await te(a(l));if(i.ok)t(f,!0);else{let w=await i.json();t(p,s(w.message))}}async function c(){try{return await D.validate(a(l),{abortEarly:!1}),t(E,s({})),!0}catch(i){return t(E,s(Q(i))),!1}}W(C,{get idx(){return u()},set idx(i){u(i)},get show(){return a(m)},set show(i){t(m,s(i))},header:i=>{var w=ve();d(i,w)},body:i=>{var w=ue(),G=b(w);H(G,{autocomplete:"off",placeholder:"Group Name",get value(){return a(l).group},set value(e){a(l).group=e},get error(){return a(E).group},set error(e){a(E).group=e},$$events:{input:c},children:(e,v)=>{N();var I=P("GROUP NAME");d(e,I)},$$slots:{default:!0}});var n=S(G,2);V(n,{level:1,width:"4rem",$$events:{click:o},children:(e,v)=>{N();var I=P("SAVE");d(e,I)},$$slots:{default:!0}});var g=S(n,2);{var r=e=>{var v=de();d(e,v)};T(g,e=>{a(f)&&e(r)})}var $=S(g,2);{var A=e=>{var v=ce(),I=b(v,!0);j(v),_(()=>L(I,a(p))),d(e,v)};T($,e=>{a(p)&&e(A)})}j(w),d(i,w)},$$slots:{header:!0,body:!0}}),O()}var pe=k('<div class="success svelte-17in7jd">Success</div>'),fe=k('<div class="mainErr err svelte-17in7jd"> </div>'),ge=k('<div class="container svelte-17in7jd"><div class="unit svelte-17in7jd"><div class="label font-label svelte-17in7jd">ID</div> <div class="value font-mono svelte-17in7jd"> </div></div> <!> <!> <!> <!></div>');function $e(C,h){q(h,!0);let u=R(h,"group",31,()=>s({})),m=y(""),l=y(!1),p=y(void 0);K(()=>{a(l)&&t(p,s(setTimeout(()=>{t(l,!1),h.onSave()},2e3)))}),M(()=>()=>clearTimeout(a(p)));let f=y(s({}));const x=X().shape({name:F().trim().matches(J,"Can only contain: 'a-z0-9-_/:*', length: 2-64")});async function E(){if(t(m,""),!await D()){t(m,"Invalid input");return}let e={group:u().name.trim()},v=await re(u().id,e);if(v.ok)t(l,!0);else{let I=await v.json();t(m,s(I.message))}}async function D(){try{return await x.validate(u(),{abortEarly:!1}),t(f,s({})),!0}catch(e){return t(f,s(Q(e))),!1}}var o=ge(),c=b(o),i=S(b(c),2),w=b(i,!0);j(i),j(c);var G=S(c,2);H(G,{autocomplete:"off",placeholder:"Group Name",get value(){return u().name},set value(e){u(u().name=e,!0)},get error(){return a(f).name},set error(e){a(f).name=e},$$events:{input:D},children:(e,v)=>{N();var I=P("GROUP NAME");d(e,I)},$$slots:{default:!0}});var n=S(G,2);V(n,{level:1,width:"4rem",$$events:{click:E},children:(e,v)=>{N();var I=P("SAVE");d(e,I)},$$slots:{default:!0}});var g=S(n,2);{var r=e=>{var v=pe();d(e,v)};T(g,e=>{a(l)&&e(r)})}var $=S(g,2);{var A=e=>{var v=fe(),I=b(v,!0);j(v),_(()=>L(I,a(m))),d(e,v)};T($,e=>{a(m)&&e(A)})}j(o),_(()=>L(w,u().id)),d(C,o),O()}var he=k('<div class="err svelte-1jljqe9"> </div>'),we=k('<div class="container svelte-1jljqe9"><div class="label svelte-1jljqe9">Are you sure, you want to delete this group?</div> <!> <!></div>');function ye(C,h){q(h,!0);let u=R(h,"group",19,()=>({})),m=y(!1),l=y("");async function p(){t(l,""),t(m,!0);let o=await se(u().id);if(o.ok)h.onSave();else{let c=await o.json();t(l,s(c.message))}t(m,!1)}var f=we(),x=S(b(f),2);V(x,{level:1,get isLoading(){return a(m)},set isLoading(o){t(m,s(o))},$$events:{click:p},children:(o,c)=>{N();var i=P("DELETE");d(o,i)},$$slots:{default:!0}});var E=S(x,2);{var D=o=>{var c=he(),i=b(c,!0);j(c),_(()=>L(i,a(l))),d(o,c)};T(E,o=>{a(l)&&o(D)})}j(f),d(C,f),O()}var je=k('<div class="data font-mono svelte-115hohv"> </div>'),ke=k('<div class="data svelte-115hohv"> </div>'),be=k('<div class="header svelte-115hohv"><!> <!></div>'),Se=k("<div><!></div>"),De=k("<div><!></div>"),Ie=k("<div><!> <!></div>");function Ee(C,h){q(h,!0);let u=R(h,"group",31,()=>s({})),m=y(void 0);const l=["Config","Delete"];let p=y(s(l[0]));const f=200,x=f/2;function E(){t(m,!1),h.onSave()}W(C,{get show(){return a(m)},set show(D){t(m,s(D))},header:D=>{var o=be(),c=b(o);Y(c,{text:"Group ID",children:(w,G)=>{var n=je(),g=b(n,!0);j(n),_(()=>L(g,u().id)),d(w,n)},$$slots:{default:!0}});var i=S(c,2);Y(i,{text:"Group Name",children:(w,G)=>{var n=ke(),g=b(n,!0);j(n),_(()=>L(g,u().name)),d(w,n)},$$slots:{default:!0}}),j(o),d(D,o)},body:D=>{var o=Ie(),c=b(o);le(c,{labels:l,get selected(){return a(p)},set selected(n){t(p,s(n))}});var i=S(c,2);{var w=n=>{var g=Se(),r=b(g);$e(r,{get onSave(){return h.onSave},get group(){return u()},set group($){u($)}}),j(g),U(5,g,()=>z,()=>({delay:x,duration:f})),U(6,g,()=>z,()=>({duration:f})),d(n,g)},G=n=>{var g=ae(),r=B(g);{var $=A=>{var e=De(),v=b(e);ye(v,{get group(){return u()},onSave:E}),j(e),U(5,e,()=>z,()=>({delay:x,duration:f})),U(6,e,()=>z,()=>({duration:f})),d(A,e)};T(r,A=>{a(p)==="Delete"&&A($)},!0)}d(n,g)};T(i,n=>{a(p)==="Config"?n(w):n(G,!1)})}j(o),d(D,o)},$$slots:{header:!0,body:!0}}),O()}var xe=k('<div class="svelte-10dkaqk"><!></div>'),Ge=k(' <div class="content"><!> <!> <div id="groups" class="svelte-10dkaqk"></div> <!> <div style="height: 20px"></div></div>',1);function Ce(C,h){q(h,!0);let u=y(""),m=y(s([])),l=y(s([])),p=y(s([])),f=[{label:"Name",callback:(r,$)=>r.name.toLowerCase().includes($.toLowerCase())},{label:"ID",callback:(r,$)=>r.id.toLowerCase().includes($.toLowerCase())}],x=[{label:"Name",callback:(r,$)=>r.name.localeCompare($.name)},{label:"ID",callback:(r,$)=>r.id.localeCompare($.id)}];M(async()=>{E()});async function E(){let r=await oe(),$=await r.json();r.ok?t(m,s([...$])):t(u,s($.message))}function D(){E()}N();var o=Ge(),c=B(o),i=S(c),w=b(i);ie(w,{get items(){return a(m)},searchOptions:f,orderOptions:x,get resItems(){return a(l)},set resItems(r){t(l,s(r))}});var G=S(w,2);me(G,{onSave:D});var n=S(G,2);ee(n,23,()=>a(p),r=>r.id,(r,$,A)=>{let e=A;var v=xe(),I=b(v);Ee(I,{onSave:D,get group(){return a(p)[a(e)]},set group(Z){a(p)[a(e)]=Z}}),j(v),d(r,v)}),j(n);var g=S(n,2);ne(g,{get items(){return a(l)},set items(r){t(l,s(r))},get resItems(){return a(p)},set resItems(r){t(p,s(r))}}),N(2),j(i),_(()=>L(c,`${a(u)??""} `)),d(C,o),O()}function Ae(C){Ce(C,{})}export{Ae as component};

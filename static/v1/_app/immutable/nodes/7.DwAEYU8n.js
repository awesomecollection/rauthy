import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.Dn68_YLB.js";import{p as q,i as $,a as V,g as r,h as s,s as y,c as j,ap as k,r as A,t as L,f as Z}from"../chunks/runtime.BsghBUX9.js";import{s as O}from"../chunks/render.CTp9lacC.js";import{e as X}from"../chunks/each.URXtkKAp.js";import{a as d,d as _,t as b,e as ee}from"../chunks/template.jENAUvUX.js";import{p as o}from"../chunks/proxy.YH42NwLs.js";import{o as U}from"../chunks/index-client.ClP8y9aT.js";import{h as te,i as ae,j as re,k as se}from"../chunks/OptionSelect.Cn2sqgid.js";import{O as ie,P as oe}from"../chunks/Pagination.C52gIDzw.js";import{i as x}from"../chunks/if.6Ov_EDLa.js";import{p as z}from"../chunks/props.CslUVmW_.js";import{E as K}from"../chunks/ExpandContainer.BAZSCBeT.js";import{c as Y,a as M,I as P}from"../chunks/Input.B4ccwD4n.js";import{V as F,W as G,n as H}from"../chunks/helpers.CBl6QeM5.js";import{B as W}from"../chunks/Button.CHwcFOJ-.js";import{b as R,c as B}from"../chunks/index.G5lyZbma.js";import{T as ne}from"../chunks/Tooltip.D8Tbt6Nb.js";import{T as le}from"../chunks/TabBar.g4Oe_bq5.js";import{r as ve}from"../chunks/legacy-client.DY3VEcT0.js";var ce=b('<div class="header font-label svelte-1mi5990">ADD NEW USER ATTRIBUTE</div>'),de=b('<div class="mainErr err svelte-1mi5990"> </div>'),me=b('<div class="container svelte-1mi5990"><div class="desc svelte-1mi5990">You can add a new custom user attribute.<br> These attributes can be set for every user and mapped to an existing scope.<br> They are simple Key / JsonValue pairs.</div> <!> <!> <!> <!> <!></div>');function ue(C,p){q(p,!0);let w=z(p,"idx",31,()=>-1),v=$(""),c=$(void 0),u=o({name:"",desc:""}),n=$(o({}));const m=Y().shape({name:M().trim().required("Name is required").matches(F,"Invalid characters: [a-z0-9-_/]{2,32}"),desc:M().trim().matches(G,"Invalid characters: [a-zA-Z0-9\\-_/\\s]{0,128}")});async function N(){if(!await T())return;s(v,"");let a=await te(u);if(a.ok)s(c,!1),p.onSave();else{let i=await a.json();s(v,o(i.message))}}async function T(){try{return await m.validate(u,{abortEarly:!1}),s(n,o({})),!0}catch(a){return s(n,o(H(a))),!1}}K(C,{get idx(){return w()},set idx(a){w(a)},get show(){return r(c)},set show(a){s(c,o(a))},header:a=>{var i=ce();d(a,i)},body:a=>{var i=me(),g=y(j(i),2);P(g,{autocomplete:"off",placeholder:"Name",get value(){return u.name},set value(e){u.name=e},get error(){return r(n).name},set error(e){r(n).name=e},$$events:{input:T},children:(e,t)=>{k();var l=_("NAME");d(e,l)},$$slots:{default:!0}});var I=y(g,2);P(I,{autocomplete:"off",placeholder:"Description",get value(){return u.desc},set value(e){u.desc=e},get error(){return r(n).desc},set error(e){r(n).desc=e},$$events:{input:T},children:(e,t)=>{k();var l=_("DESCRIPTION");d(e,l)},$$slots:{default:!0}});var D=y(I,2);W(D,{level:1,$$events:{click:N},children:(e,t)=>{k();var l=_("SAVE");d(e,l)},$$slots:{default:!0}});var E=y(D,2);x(E,e=>{});var h=y(E,2);{var S=e=>{var t=de(),l=j(t,!0);A(t),L(()=>O(l,r(v))),d(e,t)};x(h,e=>{r(v)&&e(S)})}A(i),d(a,i)},$$slots:{header:!0,body:!0}}),V()}var fe=b('<div class="success svelte-2o3w7i">Success</div>'),he=b('<div class="mainErr err svelte-2o3w7i"> </div>'),pe=b('<div class="container svelte-2o3w7i"><!> <!> <!> <!> <!></div>');function ge(C,p){q(p,!0);let w=z(p,"attr",19,()=>({})),v=$(""),c=$(!1),u=$(void 0);ve(()=>{r(c)&&s(u,o(setTimeout(()=>{s(c,!1),p.onSave()},2e3)))}),U(()=>()=>clearTimeout(r(u)));let n=$(o({})),m=o({});const N=Y().shape({name:M().trim().required("Name is required").matches(F,"Valid characters: [a-z0-9-_/]{2,32}"),desc:M().nullable().trim().matches(G,"Valid characters: [a-zA-Z0-9\\-_/\\s]{0,128}")});U(()=>{m.name=w().name,m.desc=w().desc});async function T(){if(s(v,""),!await a()){s(v,"Invalid input");return}let t={name:m.name,desc:m.desc},l=await ae(w().name,t);if(l.ok)s(c,!0);else{let f=await l.json();s(v,o(f.message))}}async function a(){try{return await N.validate(m,{abortEarly:!1}),s(n,o({})),!0}catch(t){return s(n,o(H(t))),!1}}var i=pe(),g=j(i);P(g,{autocomplete:"off",placeholder:"Name",get value(){return m.name},set value(t){m.name=t},get error(){return r(n).name},set error(t){r(n).name=t},$$events:{input:a},children:(t,l)=>{k();var f=_("NAME");d(t,f)},$$slots:{default:!0}});var I=y(g,2);P(I,{autocomplete:"off",placeholder:"Description",get value(){return m.desc},set value(t){m.desc=t},get error(){return r(n).desc},set error(t){r(n).desc=t},$$events:{input:a},children:(t,l)=>{k();var f=_("DESCRIPTION");d(t,f)},$$slots:{default:!0}});var D=y(I,2);W(D,{level:1,width:"4rem",$$events:{click:T},children:(t,l)=>{k();var f=_("SAVE");d(t,f)},$$slots:{default:!0}});var E=y(D,2);{var h=t=>{var l=fe();d(t,l)};x(E,t=>{r(c)&&t(h)})}var S=y(E,2);{var e=t=>{var l=he(),f=j(l,!0);A(l),L(()=>O(f,r(v))),d(t,l)};x(S,t=>{r(v)&&t(e)})}A(i),d(C,i),V()}var $e=b('<div class="err svelte-1jljqe9"> </div>'),ye=b('<div class="container svelte-1jljqe9"><div class="label svelte-1jljqe9">Are you sure, you want to delete this custom attribute?</div> <!> <!></div>');function we(C,p){q(p,!0);let w=z(p,"attr",19,()=>({})),v=$(!1),c=$("");async function u(){s(c,""),s(v,!0);let a=await re(w().name);if(a.ok)p.onSave();else{let i=await a.json();s(c,o(i.message))}s(v,!1)}var n=ye(),m=y(j(n),2);W(m,{level:1,get isLoading(){return r(v)},set isLoading(a){s(v,o(a))},$$events:{click:u},children:(a,i)=>{k();var g=_("DELETE");d(a,g)},$$slots:{default:!0}});var N=y(m,2);{var T=a=>{var i=$e(),g=j(i,!0);A(i),L(()=>O(g,r(c))),d(a,i)};x(N,a=>{r(c)&&a(T)})}A(n),d(C,n),V()}var be=b('<div class="data svelte-115hohv"> </div>'),Ee=b('<div class="header svelte-115hohv"><!></div>'),Se=b("<div><!></div>"),Ae=b("<div><!></div>"),je=b("<div><!> <!></div>");function Te(C,p){q(p,!0);let w=z(p,"attr",27,()=>o({})),v=z(p,"onSave",15),c=$(void 0);const u=["Config","Delete"];let n=$(o(u[0]));const m=200,N=m/2;function T(){s(c,!1),v()()}K(C,{get show(){return r(c)},set show(a){s(c,o(a))},header:a=>{var i=Ee(),g=j(i);ne(g,{text:"Custom Attribute Name",children:(I,D)=>{var E=be(),h=j(E,!0);A(E),L(()=>O(h,w().name)),d(I,E)},$$slots:{default:!0}}),A(i),d(a,i)},body:a=>{var i=je(),g=j(i);le(g,{labels:u,get selected(){return r(n)},set selected(h){s(n,o(h))}});var I=y(g,2);{var D=h=>{var S=Se(),e=j(S);ge(e,{get attr(){return w()},get onSave(){return v()},set onSave(t){v(t)}}),A(S),R(5,S,()=>B,()=>({delay:N,duration:m})),R(6,S,()=>B,()=>({duration:m})),d(h,S)},E=h=>{var S=ee(),e=Z(S);{var t=l=>{var f=Ae(),J=j(f);we(J,{get attr(){return w()},onSave:T}),A(f),R(5,f,()=>B,()=>({delay:N,duration:m})),R(6,f,()=>B,()=>({duration:m})),d(l,f)};x(e,l=>{r(n)==="Delete"&&l(t)},!0)}d(h,S)};x(I,h=>{r(n)==="Config"?h(D):h(E,!1)})}A(i),d(a,i)},$$slots:{header:!0,body:!0}}),V()}var Ie=b('<div class="svelte-mjg702"><!></div>'),Ce=b(' <div class="content"><!> <!> <div id="attrs" class="svelte-mjg702"></div> <!> <div style="height: 20px"></div></div>',1);function De(C,p){q(p,!0);let w=$(""),v=$(o([])),c=$(o([])),u=$(o([])),n=$(""),m=[{label:"NAME",callback:(e,t)=>e.name.toLowerCase().includes(t.toLowerCase())}],N=[{label:"NAME",callback:(e,t)=>e.name.localeCompare(t.name)}];U(()=>{T()});async function T(){let e=await se();if(!e.ok)s(w,"Error fetching user attr: "+e.body.message);else{let t=await e.json();s(v,o([...t.values]))}}function a(){r(v).length<2&&(s(v,o([])),s(c,o([])),s(u,o([]))),T(),s(n,"")}k();var i=Ce(),g=Z(i),I=y(g),D=j(I);ie(D,{get items(){return r(v)},searchOptions:m,orderOptions:N,get resItems(){return r(c)},set resItems(e){s(c,o(e))},get search(){return r(n)},set search(e){s(n,o(e))}});var E=y(D,2);ue(E,{onSave:a});var h=y(E,2);X(h,23,()=>r(u),e=>e.name,(e,t,l)=>{var f=Ie(),J=j(f);Te(J,{onSave:a,get attr(){return r(u)[r(l)]},set attr(Q){r(u)[r(l)]=Q}}),A(f),d(e,f)}),A(h);var S=y(h,2);oe(S,{get items(){return r(c)},set items(e){s(c,o(e))},get resItems(){return r(u)},set resItems(e){s(u,o(e))}}),k(2),A(I),L(()=>O(g,`${r(w)??""} `)),d(C,i),V()}function Ne(C){De(C,{})}export{Ne as component};

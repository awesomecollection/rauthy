import{a as m,t as f,d as se,e as ie}from"../chunks/disclose-version.BP4T4xdV.js";import{a5 as oe,f as R,t as b,p as ne,a as ce,k as u,s,j as e,l as T,c as o,r as n,a7 as de}from"../chunks/index-client.hxMyB_b4.js";import{s as v}from"../chunks/render.yNX9q8-B.js";import{i as k}from"../chunks/if.BeBa1Kxb.js";import{p as J}from"../chunks/proxy.DaVNR9vk.js";import{B as ue}from"../chunks/Button.BR1gOfNn.js";import{I as c}from"../chunks/pow.BMnvYon0.js";import{f as pe,d as _e}from"../chunks/fetch.Bq59EV_b.js";import{F as me}from"../chunks/Form.BnvI_UPN.js";import{u as ve}from"../chunks/i18n_admin.svelte.lt3dD7TQ.js";import{u as ge}from"../chunks/i18n.svelte.Ci9wvqOq.js";var ye=f('<div class="success svelte-maj8s4">Success</div>'),we=f('<div class="err"> </div>'),he=f('<div class="row svelte-maj8s4"><!> <!></div> <div class="row svelte-maj8s4"><!> <!></div> <div class="row svelte-maj8s4"><!> <!></div> <p> <br> </p> <div class="row svelte-maj8s4"><!> <!></div> <!> <!> <!>',1),fe=f("<h2> </h2> <p> </p> <!>",1);function be(P,O){ce(O,!0);const i="160px";let l=ge(),g=ve(),p=T(""),x=T(!1),a=T(void 0);oe(async()=>{let d=await pe("/auth/v1/password_policy");if(d.body){let t=d.body;t.include_lower_case||(t.include_lower_case=0),t.include_upper_case||(t.include_upper_case=0),t.include_digits||(t.include_digits=0),t.include_special||(t.include_special=0),t.not_recently_used||(t.not_recently_used=0),t.valid_days||(t.valid_days=0),u(a,J(t))}else console.error(d.error)});async function Q(d,t){if(u(p,""),!e(a))return;if(e(a).length_max<e(a).length_min)return u(p,"Max Length cannot be lower than Min Length"),!1;if((e(a).include_digits||0)+(e(a).include_lower_case||0)+(e(a).include_upper_case||0)+(e(a).include_special||0)>e(a).length_max)return u(p,"The sum of all includes does not fit into Max Length"),!1;let y={length_min:e(a).length_min,length_max:e(a).length_max,not_recently_used:e(a).not_recently_used?e(a).not_recently_used:void 0,valid_days:e(a).valid_days?e(a).valid_days:void 0,include_digits:e(a).include_digits?e(a).include_digits:void 0,include_lower_case:e(a).include_lower_case?e(a).include_lower_case:void 0,include_upper_case:e(a).include_upper_case?e(a).include_upper_case:void 0,include_special:e(a).include_special?e(a).include_special:void 0},w=await _e(d.action,y);w.error?u(p,J(w.error.message)):(u(x,!0),setTimeout(()=>{u(x,!1)},3e3))}var B=fe(),M=R(B),U=o(M,!0);n(M);var j=s(M,2),V=o(j,!0);n(j);var W=s(j,2);me(W,{action:"/auth/v1/password_policy",onSubmit:Q,children:(d,t)=>{var y=se(),w=R(y);{var X=$=>{var I=he(),q=R(I),N=o(q);c(N,{typ:"number",get label(){return l.passwordPolicy.lengthMin},get placeholder(){return l.passwordPolicy.lengthMin},autocomplete:"off",min:"8",max:"128",required:!0,width:i,get value(){return e(a).length_min},set value(r){e(a).length_min=r}});var Y=s(N,2);c(Y,{typ:"number",get label(){return l.passwordPolicy.lengthMax},get placeholder(){return l.passwordPolicy.lengthMax},autocomplete:"off",min:"8",max:"128",required:!0,width:i,get value(){return e(a).length_max},set value(r){e(a).length_max=r}}),n(q);var D=s(q,2),z=o(D);c(z,{typ:"number",get label(){return l.passwordPolicy.lowercaseMin},get placeholder(){return l.passwordPolicy.lowercaseMin},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).include_lower_case},set value(r){e(a).include_lower_case=r}});var Z=s(z,2);c(Z,{typ:"number",get label(){return l.passwordPolicy.uppercaseMin},get placeholder(){return l.passwordPolicy.uppercaseMin},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).include_upper_case},set value(r){e(a).include_upper_case=r}}),n(D);var L=s(D,2),A=o(L);c(A,{typ:"number",get label(){return l.passwordPolicy.digitsMin},get placeholder(){return l.passwordPolicy.digitsMin},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).include_digits},set value(r){e(a).include_digits=r}});var K=s(A,2);c(K,{typ:"number",get label(){return l.passwordPolicy.specialMin},get placeholder(){return l.passwordPolicy.specialMin},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).include_special},set value(r){e(a).include_special=r}}),n(L);var S=s(L,2),C=o(S,!0),ee=s(C,2);n(S);var F=s(S,2),E=o(F);c(E,{typ:"number",get label(){return l.passwordPolicy.notRecent},get placeholder(){return l.passwordPolicy.notRecent},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).not_recently_used},set value(r){e(a).not_recently_used=r}});var ae=s(E,2);c(ae,{typ:"number",get label(){return g.passwordPolicy.validForDays},get placeholder(){return g.passwordPolicy.validForDays},autocomplete:"off",min:"0",max:"3650",width:i,get value(){return e(a).valid_days},set value(r){e(a).valid_days=r}}),n(F);var G=s(F,2);ue(G,{type:"submit",children:(r,_)=>{de();var h=ie();b(()=>v(h,l.common.save)),m(r,h)},$$slots:{default:!0}});var H=s(G,2);{var re=r=>{var _=ye();m(r,_)};k(H,r=>{e(x)&&r(re)})}var le=s(H,2);{var te=r=>{var _=we(),h=o(_,!0);n(_),b(()=>v(h,e(p))),m(r,_)};k(le,r=>{e(p)&&r(te)})}b(()=>{v(C,g.passwordPolicy.validityNew),v(ee,` ${g.passwordPolicy.resetSet0??""}`)}),m($,I)};k(w,$=>{e(a)&&$(X)})}m(d,y)},$$slots:{default:!0}}),b(()=>{v(U,l.passwordPolicy.passwordPolicy),v(V,g.passwordPolicy.configDesc)}),m(P,B),ne()}function Pe(P){be(P,{})}export{Pe as component};

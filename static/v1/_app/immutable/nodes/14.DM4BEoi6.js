import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DvmPJwhI.js";import{p as ie,ap as se,f as F,t as f,a as oe,m as u,s as i,l as e,o as R,c as o,r as n,ar as ne}from"../chunks/index-client.Ds4XgiuL.js";import{s as m}from"../chunks/render.Bq2-eTRf.js";import{i as B}from"../chunks/if.Du7BDhAX.js";import{a as v,t as b,e as ce,d as de}from"../chunks/template.DXIK6jcH.js";import{p as J}from"../chunks/proxy.Bsf9UJbk.js";import{B as ue}from"../chunks/Button.C_IpvWJY.js";import{I as c}from"../chunks/pow.CCs-o8yN.js";import{f as pe,d as _e}from"../chunks/fetch.DFmyLr06.js";import{F as me}from"../chunks/Form.t2_rDZ40.js";import{u as ve}from"../chunks/i18n_admin.svelte.B_OuiPaR.js";import{u as ge}from"../chunks/i18n.svelte.CB3BpIrt.js";var ye=b('<div class="success svelte-maj8s4">Success</div>'),we=b('<div class="err"> </div>'),he=b('<div class="row svelte-maj8s4"><!> <!></div> <div class="row svelte-maj8s4"><!> <!></div> <div class="row svelte-maj8s4"><!> <!></div> <p> <br> </p> <div class="row svelte-maj8s4"><!> <!></div> <!> <!> <!>',1),fe=b("<h2> </h2> <p> </p> <!>",1);function be(P,O){ie(O,!0);const s="160px";let l=ge(),g=ve(),p=R(""),x=R(!1),a=R(void 0);se(async()=>{let d=await pe("/auth/v1/password_policy");if(d.body){let t=d.body;t.include_lower_case||(t.include_lower_case=0),t.include_upper_case||(t.include_upper_case=0),t.include_digits||(t.include_digits=0),t.include_special||(t.include_special=0),t.not_recently_used||(t.not_recently_used=0),t.valid_days||(t.valid_days=0),u(a,J(t))}else console.error(d.error)});async function Q(d,t){if(u(p,""),!e(a))return;if(e(a).length_max<e(a).length_min)return u(p,"Max Length cannot be lower than Min Length"),!1;if((e(a).include_digits||0)+(e(a).include_lower_case||0)+(e(a).include_upper_case||0)+(e(a).include_special||0)>e(a).length_max)return u(p,"The sum of all includes does not fit into Max Length"),!1;let y={length_min:e(a).length_min,length_max:e(a).length_max,not_recently_used:e(a).not_recently_used?e(a).not_recently_used:void 0,valid_days:e(a).valid_days?e(a).valid_days:void 0,include_digits:e(a).include_digits?e(a).include_digits:void 0,include_lower_case:e(a).include_lower_case?e(a).include_lower_case:void 0,include_upper_case:e(a).include_upper_case?e(a).include_upper_case:void 0,include_special:e(a).include_special?e(a).include_special:void 0},w=await _e(d.action,y);w.error?u(p,J(w.error.message)):(u(x,!0),setTimeout(()=>{u(x,!1)},3e3))}var I=fe(),M=F(I),U=o(M,!0);n(M);var j=i(M,2),V=o(j,!0);n(j);var W=i(j,2);me(W,{action:"/auth/v1/password_policy",onSubmit:Q,children:(d,t)=>{var y=ce(),w=F(y);{var X=$=>{var N=he(),D=F(N),k=o(D);c(k,{typ:"number",get label(){return l.passwordPolicy.lengthMin},get placeholder(){return l.passwordPolicy.lengthMin},autocomplete:"off",min:"8",max:"128",required:!0,width:s,get value(){return e(a).length_min},set value(r){e(a).length_min=r}});var Y=i(k,2);c(Y,{typ:"number",get label(){return l.passwordPolicy.lengthMax},get placeholder(){return l.passwordPolicy.lengthMax},autocomplete:"off",min:"8",max:"128",required:!0,width:s,get value(){return e(a).length_max},set value(r){e(a).length_max=r}}),n(D);var L=i(D,2),z=o(L);c(z,{typ:"number",get label(){return l.passwordPolicy.lowercaseMin},get placeholder(){return l.passwordPolicy.lowercaseMin},autocomplete:"off",min:"0",max:"32",width:s,get value(){return e(a).include_lower_case},set value(r){e(a).include_lower_case=r}});var Z=i(z,2);c(Z,{typ:"number",get label(){return l.passwordPolicy.uppercaseMin},get placeholder(){return l.passwordPolicy.uppercaseMin},autocomplete:"off",min:"0",max:"32",width:s,get value(){return e(a).include_upper_case},set value(r){e(a).include_upper_case=r}}),n(L);var S=i(L,2),A=o(S);c(A,{typ:"number",get label(){return l.passwordPolicy.digitsMin},get placeholder(){return l.passwordPolicy.digitsMin},autocomplete:"off",min:"0",max:"32",width:s,get value(){return e(a).include_digits},set value(r){e(a).include_digits=r}});var K=i(A,2);c(K,{typ:"number",get label(){return l.passwordPolicy.specialMin},get placeholder(){return l.passwordPolicy.specialMin},autocomplete:"off",min:"0",max:"32",width:s,get value(){return e(a).include_special},set value(r){e(a).include_special=r}}),n(S);var T=i(S,2),C=o(T,!0),ee=i(C,2);n(T);var q=i(T,2),E=o(q);c(E,{typ:"number",get label(){return l.passwordPolicy.notRecent},get placeholder(){return l.passwordPolicy.notRecent},autocomplete:"off",min:"0",max:"32",width:s,get value(){return e(a).not_recently_used},set value(r){e(a).not_recently_used=r}});var ae=i(E,2);c(ae,{typ:"number",get label(){return g.passwordPolicy.validForDays},get placeholder(){return g.passwordPolicy.validForDays},autocomplete:"off",min:"0",max:"3650",width:s,get value(){return e(a).valid_days},set value(r){e(a).valid_days=r}}),n(q);var G=i(q,2);ue(G,{type:"submit",children:(r,_)=>{ne();var h=de();f(()=>m(h,l.common.save)),v(r,h)},$$slots:{default:!0}});var H=i(G,2);{var re=r=>{var _=ye();v(r,_)};B(H,r=>{e(x)&&r(re)})}var le=i(H,2);{var te=r=>{var _=we(),h=o(_,!0);n(_),f(()=>m(h,e(p))),v(r,_)};B(le,r=>{e(p)&&r(te)})}f(()=>{m(C,g.passwordPolicy.validityNew),m(ee,` ${g.passwordPolicy.resetSet0??""}`)}),v($,N)};B(w,$=>{e(a)&&$(X)})}v(d,y)},$$slots:{default:!0}}),f(()=>{m(U,l.passwordPolicy.passwordPolicy),m(V,g.passwordPolicy.configDesc)}),v(P,I),oe()}function Pe(P){be(P,{})}export{Pe as component};

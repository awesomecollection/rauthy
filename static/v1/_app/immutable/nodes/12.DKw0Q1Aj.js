import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DUFkTaXF.js";import{p as U,i as v,ao as W,f as ee,t as f,a as ae,h as t,s,g as c,c as o,r as a,aq as re}from"../chunks/index-client.CzvcfCLI.js";import{s as i}from"../chunks/render.BJBkrb2f.js";import{i as D}from"../chunks/if.Dlf0zx3_.js";import{e as se,i as oe}from"../chunks/each.BtetwUOf.js";import{a as u,t as E,d as te}from"../chunks/template.CQASMEo4.js";import{p as m}from"../chunks/proxy.CHyqegA9.js";import{B as ie}from"../chunks/Button.CjBmYviZ.js";import{I as ce}from"../chunks/IconCheck.kaTN2egQ.js";import{f as ne,b as pe}from"../chunks/fetch.DVUNovhB.js";import{u as me}from"../chunks/i18n_admin.svelte.BJXwhDH_.js";import{O as ve}from"../chunks/Options.BADoqzxk.js";var le=E('<li class="font-mono"> </li>'),ye=E('<div class="err"> </div>'),de=E('<h3> </h3> <p> </p> <p> </p> <p><span class="font-label"> </span> <span class="active font-mono svelte-lxghyr"> </span></p> <p> </p> <ul></ul> <p> </p> <p> </p> <!> <div class="btn svelte-lxghyr"><!></div> <!> <!>',1);function fe(g,F){U(F,!0);let n=me(),l=v(""),y=v(!0),I=v(""),d=v(""),K=v(m([])),b=v(!1);W(async()=>{var r;let e=await ne("/auth/v1/encryption/keys");e.body?(t(K,m(e.body.keys)),t(I,m(e.body.active)),t(d,m(e.body.active))):t(l,m(((r=e.error)==null?void 0:r.message)||"Error")),t(y,!1)});async function G(){t(y,!0);let e={key_id:c(d)},r=await pe("/auth/v1/encryption/migrate",e);r.error?t(l,m(r.error.message)):(t(b,!0),setTimeout(()=>{t(b,!1)},4e3)),t(y,!1)}var O=de(),h=ee(O),H=o(h,!0);a(h);var k=s(h,2),J=o(k,!0);a(k);var $=s(k,2),N=o($,!0);a($);var w=s($,2),x=o(w),P=o(x);a(x);var j=s(x,2),Q=o(j,!0);a(j),a(w);var T=s(w,2),R=o(T);a(T);var A=s(T,2);se(A,21,()=>c(K),oe,(e,r)=>{var p=le(),M=o(p,!0);a(p),f(()=>i(M,c(r))),u(e,p)}),a(A);var L=s(A,2),S=o(L,!0);a(L);var q=s(L,2),V=o(q);a(q);var z=s(q,2);ve(z,{get ariaLabel(){return n.docs.encKeys.migrateToKey},get options(){return c(K)},get value(){return c(d)},set value(e){t(d,m(e))}});var B=s(z,2),X=o(B);ie(X,{onclick:G,get isLoading(){return c(y)},children:(e,r)=>{re();var p=te();f(()=>i(p,n.docs.encKeys.migrate)),u(e,p)},$$slots:{default:!0}}),a(B);var C=s(B,2);{var Y=e=>{var r=ye(),p=o(r,!0);a(r),f(()=>i(p,c(l))),u(e,r)};D(C,e=>{c(l)&&e(Y)})}var Z=s(C,2);{var _=e=>{ce(e,{})};D(Z,e=>{c(b)&&e(_)})}f(()=>{i(H,n.docs.encKeys.header),i(J,n.docs.encKeys.p1),i(N,n.docs.encKeys.p2),i(P,`${n.docs.encKeys.keyActive??""}:`),i(Q,c(I)),i(R,`${n.docs.encKeys.keysAvailable??""}:`),i(S,n.docs.encKeys.p3),i(V,`${n.docs.encKeys.migrateToKey??""}:`)}),u(g,O),ae()}function ue(g){fe(g,{})}export{ue as component};

import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DvmPJwhI.js";import{p as ye,o as d,ap as Ie,a6 as le,f as k,t as C,a as ke,l as e,m as t,s as h,ar as Y,c as g,ab as Ce,r as b,a4 as Te}from"../chunks/index-client.Ds4XgiuL.js";import{s as T}from"../chunks/render.Bq2-eTRf.js";import{i as Z}from"../chunks/if.Du7BDhAX.js";import{e as me}from"../chunks/each.MnMr4iw5.js";import{a as o,t as P,d as ve,e as _}from"../chunks/template.DXIK6jcH.js";import{a as Be}from"../chunks/index.L0FyJ7Re.js";import{p as r}from"../chunks/proxy.Bsf9UJbk.js";import{O as Ee}from"../chunks/OrderSearchBar.B8p4xeqT.js";import{B as J}from"../chunks/Button.C_IpvWJY.js";import{I as Me}from"../chunks/pow.CCs-o8yN.js";import{D as Se,l as De}from"../chunks/helpers.BTvs6bnN.js";import{u as Le}from"../chunks/i18n.svelte.CB3BpIrt.js";import{u as Oe}from"../chunks/i18n_admin.svelte.B_OuiPaR.js";import{I as Ve}from"../chunks/InputDateTimeCombo.ChsxchP0.js";import{f as ne,a as qe}from"../chunks/form.DekAF1-C.js";import{I as ze}from"../chunks/IconStop.BmVwxLbP.js";import{f as Ae,b as Fe,c as He}from"../chunks/fetch.DFmyLr06.js";import{C as Ne}from"../chunks/ContentAdmin.COLOikfe.js";import{B as Ue}from"../chunks/ButtonAddModal.brPC44dh.js";import{b as We}from"../chunks/patterns.D9HtGhEC.js";import{F as je}from"../chunks/Form.t2_rDZ40.js";import{T as pe}from"../chunks/Tooltip.Dz7xpDMg.js";import{P as Ge}from"../chunks/Pagination.BQ2iTIIn.js";var Ke=P('<!> <!> <div></div> <!> <div class="err"> </div>',1),Qe=P('<div class="addNew svelte-1v7phw9"><!></div>'),Re=P("<div> </div>"),Xe=P('<div class="ip svelte-1v7phw9"><!></div>'),Ye=P('<div class="delete svelte-1v7phw9"><!></div>'),Ze=P('<div class="blacklisted svelte-1v7phw9"><!> <div class="date svelte-1v7phw9"> </div> <!></div>'),_e=P('<div class="top svelte-1v7phw9"><!> <!></div> <div id="blacklist"><!></div> <!>',1),Je=P(" <!>",1);function er(z,de){ye(de,!0);let A=Le(),ce=Oe();const ee=30;let F=d(void 0),H=d(void 0),N=d(""),D=d(""),y=d(r([])),B=d(r([])),U=d(r([])),L=d(""),W=d(r(ne())),j=d(r(qe())),G=d(""),re=["IP"];Ie(()=>{K()}),le(()=>{var a;(a=e(F))==null||a.focus()}),le(()=>{let a=e(G).toLowerCase();a?t(B,r(e(y).filter(m=>{var c;return(c=m.ip)==null?void 0:c.includes(a)}))):t(B,r(e(y)))});async function K(){var m;let a=await Ae("/auth/v1/blacklist");a.body?t(y,r(a.body.ips)):t(N,r(((m=a.error)==null?void 0:m.message)||"Error"))}async function fe(a,m){var O;t(D,"");let c=Se(e(W),e(j));if(!c){t(D,"Invalid Date Input: User Expires");return}let w={ip:e(L),exp:c},$=await Fe(a.action,w);$.error?t(D,r($.error.message)):(t(L,""),(O=e(H))==null||O(),await K())}async function ue(a){let m=await He(`/auth/v1/blacklist/${a}`);m.error?t(N,r(m.error.message)):await K()}function he(a,m){let c=m==="up";a===re[0]&&e(y).sort((w,$)=>c?w.ip.localeCompare($.ip):$.ip.localeCompare(w.ip))}Y();var ae=Je(),te=k(ae),ge=h(te);Ne(ge,{children:(a,m)=>{var c=_e(),w=k(c),$=g(w);Ee($,{orderOptions:re,onChangeOrder:he,searchWidth:"min(15.75rem, calc(100dvw - 1rem))",get value(){return e(G)},set value(i){t(G,r(i))}});var O=h($,2);Ue(O,{level:1,get closeModal(){return e(H)},set closeModal(i){t(H,r(i))},children:(i,v)=>{var x=Qe(),R=g(x);je(R,{action:"/auth/v1/blacklist",onSubmit:fe,children:(X,ie)=>{var n=Ke(),s=k(n);Me(s,{autocomplete:"off",label:"IP",placeholder:"IPv4",errMsg:"IPv4",required:!0,maxLength:15,pattern:We,get ref(){return e(F)},set ref(p){t(F,r(p))},get value(){return e(L)},set value(p){t(L,r(p))}});var f=h(s,2),l=Ce(ne);Ve(f,{label:"Expiry",get min(){return e(l)},withTime:!0,get value(){return e(W)},set value(p){t(W,r(p))},get timeValue(){return e(j)},set timeValue(p){t(j,r(p))}});var u=h(f,2);Be(u,"height",".5rem");var V=h(u,2);J(V,{type:"submit",children:(p,I)=>{Y();var M=ve();C(()=>T(M,A.common.save)),o(p,M)},$$slots:{default:!0}});var q=h(V,2),E=g(q,!0);b(q),C(()=>T(E,e(D))),o(X,n)},$$slots:{default:!0}}),b(x),o(i,x)},$$slots:{default:!0}}),b(w);var Q=h(w,2),be=g(Q);{var we=i=>{var v=Re(),x=g(v,!0);b(v),C(()=>T(x,ce.common.noEntries)),o(i,v)},$e=i=>{var v=_();const x=(n,s=Te)=>{var f=Ze(),l=g(f);J(l,{invisible:!0,onclick:()=>navigator.clipboard.writeText(s().ip),children:(E,p)=>{var I=Xe(),M=g(I);pe(M,{get text(){return A.common.copyToClip},children:(S,se)=>{Y();var oe=ve();C(()=>T(oe,s().ip)),o(S,oe)},$$slots:{default:!0}}),b(I),o(E,I)},$$slots:{default:!0}});var u=h(l,2),V=g(u,!0);C(()=>T(V,De(s().exp))),b(u);var q=h(u,2);J(q,{invisible:!0,onclick:()=>ue(s().ip),children:(E,p)=>{pe(E,{get text(){return A.common.delete},children:(I,M)=>{var S=Ye(),se=g(S);ze(se,{width:"1.25rem"}),b(S),o(I,S)},$$slots:{default:!0}})},$$slots:{default:!0}}),b(f),o(n,f)};var R=k(v);{var X=n=>{var s=_(),f=k(s);me(f,17,()=>e(U),l=>l.ip,(l,u)=>{x(l,()=>e(u))}),o(n,s)},ie=n=>{var s=_(),f=k(s);me(f,17,()=>e(B),l=>l.ip,(l,u)=>{x(l,()=>e(u))}),o(n,s)};Z(R,n=>{e(y).length>ee?n(X):n(ie,!1)})}o(i,v)};Z(be,i=>{e(y).length===0?i(we):i($e,!1)})}b(Q);var xe=h(Q,2);{var Pe=i=>{Ge(i,{pageSize:30,get items(){return e(B)},set items(v){t(B,r(v))},get itemsPaginated(){return e(U)},set itemsPaginated(v){t(U,r(v))}})};Z(xe,i=>{e(y).length>ee&&i(Pe)})}o(a,c)},$$slots:{default:!0}}),C(()=>T(te,`${e(N)??""} `)),o(z,ae),ke()}function rr(z){er(z,{})}export{rr as component};

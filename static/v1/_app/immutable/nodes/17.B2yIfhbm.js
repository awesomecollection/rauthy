import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DJEB66nf.js";import{p as Y,a6 as _,y as e,f as D,z as n,s as x,t as A,a as j,A as b,c as G,ar as H,r as N,ab as V,ap as oe}from"../chunks/index-client.Di99sPv0.js";import{s as F}from"../chunks/render.Cjc4CIr8.js";import{i as M}from"../chunks/if.DgeUjMU2.js";import{e as te}from"../chunks/each.DxtmCefA.js";import{d as J,a as c,t as C,e as ae}from"../chunks/template.BEKX6jgL.js";import{a as se}from"../chunks/index.BnJsthXQ.js";import{p as i}from"../chunks/proxy.BQ2dmY0t.js";import{u as K}from"../chunks/i18n_admin.svelte.DI6l2V4l.js";import{B as ne}from"../chunks/ButtonAddModal.DLvLHw-v.js";import{C as ie}from"../chunks/ContentAdmin.BWiTVMIY.js";import{N as me}from"../chunks/NavButtonTile.BjzIPqLk.js";import{N as ue}from"../chunks/NavSub.D01RyWn2.js";import{O as le}from"../chunks/OrderSearchBar.CS_Hs5DC.js";import{b as ve,d as de,c as ce,f as pe}from"../chunks/fetch.DxJS_Pk_.js";import{u as fe}from"../chunks/param.svelte.CXpV4U96.js";import{B as X}from"../chunks/Button.D-14suAe.js";import{I as Z}from"../chunks/Input.-lhBsjDF.js";import{f as P}from"../chunks/patterns.BDQXnG3O.js";import{F as ee}from"../chunks/Form.C0Yvca1O.js";import{u as U}from"../chunks/i18n.svelte.Bc6aINkd.js";import{T as ge}from"../chunks/Tabs.CTmGp6-A.js";import{I as he}from"../chunks/IconCheck.K_67dytm.js";import{L as be}from"../chunks/LabeledValue.D0BXhgF2.js";var $e=C('<div class="err"> </div>'),ye=C("<!> <!> <!>",1),we=C('<div class="container svelte-s1196z"><!></div>');function Se(E,t){Y(t,!0);let I=U(),g=K(),v=b(void 0),a=b(""),m=b("");_(()=>{requestAnimationFrame(()=>{var f;(f=e(v))==null||f.focus()})});async function y(f,w){var d;if(t.groups.find(O=>O.name===e(m))){n(a,i(g.common.nameExistsAlready));return}n(a,"");let s={group:e(m)},r=await ve(f.action,s);r.body?t.onSave(r.body.id):n(a,i(((d=r.error)==null?void 0:d.message)||"Error"))}var h=we(),$=G(h);ee($,{action:"/auth/v1/groups",onSubmit:y,children:(f,w)=>{var s=ye(),r=D(s);Z(r,{autocomplete:"off",get label(){return g.groups.name},get placeholder(){return g.groups.name},required:!0,pattern:P,get ref(){return e(v)},set ref(p){n(v,i(p))},get value(){return e(m)},set value(p){n(m,i(p))}});var d=x(r,2);X(d,{type:"submit",children:(p,q)=>{H();var k=J();A(()=>F(k,I.common.save)),c(p,k)},$$slots:{default:!0}});var O=x(d,2);{var R=p=>{var q=$e(),k=G(q,!0);N(q),A(()=>F(k,e(a))),c(p,q)};M(O,p=>{e(a)&&p(R)})}c(f,s)},$$slots:{default:!0}}),N(h),c(E,h),j()}var Te=C('<div class="err"> </div>'),xe=C('<!> <!> <div class="flex gap-05"><!> <!></div> <!>',1);function Ce(E,t){Y(t,!0);let I=U(),g=K(),v=b(""),a=b(!1),m=b(i(t.group.name));_(()=>{t.group.id&&n(m,i(t.group.name))});async function y($,f){if(n(v,""),e(m)!==t.group.name&&t.groups.find(r=>r.name===e(m))){n(v,i(g.common.nameExistsAlready));return}let w={group:e(m)},s=await de($.action,w);s.error?n(v,i(s.error.message)):(n(a,!0),t.onSave(),setTimeout(()=>{n(a,!1)},2e3))}var h=V(()=>`/auth/v1/groups/${t.group.id}`);ee(E,{get action(){return e(h)},onSubmit:y,children:($,f)=>{var w=xe(),s=D(w);be(s,{label:"ID",mono:!0,children:(o,u)=>{H();var l=J();A(()=>F(l,t.group.id)),c(o,l)},$$slots:{default:!0}});var r=x(s,2);Z(r,{autocomplete:"off",get label(){return g.groups.name},get placeholder(){return g.groups.name},width:"14.5rem",required:!0,pattern:P,get value(){return e(m)},set value(o){n(m,i(o))}});var d=x(r,2),O=G(d);X(O,{type:"submit",children:(o,u)=>{H();var l=J();A(()=>F(l,I.common.save)),c(o,l)},$$slots:{default:!0}});var R=x(O,2);{var p=o=>{he(o,{})};M(R,o=>{e(a)&&o(p)})}N(d);var q=x(d,2);{var k=o=>{var u=Te(),l=G(u,!0);N(u),A(()=>F(l,e(v))),c(o,u)};M(q,o=>{e(v)&&o(k)})}c($,w)},$$slots:{default:!0}}),j()}var Ee=C('<div class="err"> </div>'),Ie=C("<p> </p> <!> <!>",1);function Le(E,t){Y(t,!0);let I=U(),g=K(),v=b("");async function a(){n(v,"");let s=await ce(`/auth/v1/groups/${t.group.id}`);s.error?n(v,i(s.error.message)):t.onSave()}var m=Ie(),y=D(m),h=G(y,!0);N(y);var $=x(y,2);X($,{level:-1,onclick:a,children:(s,r)=>{H();var d=J();A(()=>F(d,I.common.delete)),c(s,d)},$$slots:{default:!0}});var f=x($,2);{var w=s=>{var r=Ee(),d=G(r,!0);N(r),A(()=>F(d,e(v))),c(s,r)};M(f,s=>{e(v)&&s(w)})}A(()=>F(h,g.groups.delete1)),c(E,m),j()}var Oe=C('<div class="flex"><!></div> <!>',1);function Ae(E,t){Y(t,!0);let I=U(),g=K();const v=[g.nav.config,I.common.delete];let a=b(i(v[0])),m=b(void 0);_(()=>{t.group.id&&requestAnimationFrame(()=>{var r;(r=e(m))==null||r()})});var y=Oe(),h=D(y),$=G(h);ge($,{tabs:v,get selected(){return e(a)},set selected(r){n(a,i(r))},get focusFirst(){return e(m)},set focusFirst(r){n(m,i(r))}}),N(h);var f=x(h,2);{var w=r=>{Ce(r,{get group(){return t.group},get groups(){return t.groups},get onSave(){return t.onSave}})},s=r=>{var d=ae(),O=D(d);{var R=p=>{Le(p,{get group(){return t.group},get onSave(){return t.onSave}})};M(O,p=>{e(a)===I.common.delete&&p(R)},!0)}c(r,d)};M(f,r=>{e(a)===g.nav.config?r(w):r(s,!1)})}c(E,y),j()}var Fe=C("<div></div> <!>",1),qe=C("<!> <!>",1),De=C('<div class="err"> </div>'),Ge=C('<!> <div id="groups"><!></div>',1),Ne=C("<!> <!>",1);function ke(E,t){Y(t,!0);let I=K(),g=b(void 0),v=b(""),a=b(i([])),m=b(i([])),y=b(void 0),h=fe("gid");const $=[I.common.name,"ID"];let f=b(i($[0])),w=b("");const s=[I.common.name,"ID"];oe(()=>{r()}),_(()=>{n(y,i(e(a).find(o=>o.id===h.get())))}),_(()=>{let o=e(w).toLowerCase();o?e(f)===$[0]?n(m,i(e(a).filter(u=>{var l;return(l=u.name)==null?void 0:l.toLowerCase().includes(o)}))):e(f)===$[1]&&n(m,i(e(a).filter(u=>u.id.toLowerCase().includes(o)))):n(m,i(e(a)))});async function r(){var u;let o=await pe("/auth/v1/groups");o.body?n(a,i(o.body)):n(v,i(((u=o.error)==null?void 0:u.message)||"Error"))}function d(o,u){let l=u==="up";o===s[0]?e(a).sort((S,T)=>l?S.name.localeCompare(T.name):T.name.localeCompare(S.name)):o===s[1]&&e(a).sort((S,T)=>l?S.id.localeCompare(T.id):T.id.localeCompare(S.id))}function O(){r()}async function R(o){var u;(u=e(g))==null||u(),await r(),h.set(o)}var p=Ne(),q=D(p);ue(q,{paddingTop:"2.1rem",buttonTilesAriaControls:"groups",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:o=>{var u=Fe(),l=D(u);se(l,"height",".5rem");var S=x(l,2);te(S,17,()=>e(m),T=>T.id,(T,B)=>{var L=V(()=>h.get()===e(B).id);me(T,{onclick:()=>h.set(e(B).id),get selected(){return e(L)},children:(Q,z)=>{H();var W=J();A(()=>F(W,e(B).name)),c(Q,W)},$$slots:{default:!0}})}),c(o,u)},children:(o,u)=>{var l=qe(),S=D(l),T=V(()=>e(a).length===0?1:2);ne(S,{get level(){return e(T)},alignRight:!0,get closeModal(){return e(g)},set closeModal(L){n(g,i(L))},children:(L,Q)=>{Se(L,{onSave:R,get groups(){return e(a)}})},$$slots:{default:!0}});var B=x(S,2);le(B,{searchOptions:$,orderOptions:s,onChangeOrder:d,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(f)},set searchOption(L){n(f,i(L))},get value(){return e(w)},set value(L){n(w,i(L))}}),c(o,l)},$$slots:{buttonTiles:!0,default:!0}});var k=x(q,2);ie(k,{children:(o,u)=>{var l=Ge(),S=D(l);{var T=z=>{var W=De(),re=G(W,!0);N(W),A(()=>F(re,e(v))),c(z,W)};M(S,z=>{e(v)&&z(T)})}var B=x(S,2),L=G(B);{var Q=z=>{Ae(z,{get group(){return e(y)},get groups(){return e(a)},onSave:O})};M(L,z=>{e(y)&&z(Q)})}N(B),c(o,l)},$$slots:{default:!0}}),c(E,p),j()}function Be(E){ke(E,{})}export{Be as component};

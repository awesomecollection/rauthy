import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.Dmu0D13_.js";import{p as rt,c as s,r as a,ar as E,s as t,t as U,y as o,a as it,A as N,f as nt,z as n,ab as ht,ap as At}from"../chunks/index-client.CVQra9Cu.js";import{s as r}from"../chunks/render.CkKFmY3E.js";import{i as ot}from"../chunks/if._4yhN2kP.js";import{h as k}from"../chunks/html.DBwFzVLh.js";import{a as V,t as I,d as Lt}from"../chunks/template.4ZWi6dE6.js";import{p as _}from"../chunks/proxy.Dc6q2r8X.js";import{a as qt}from"../chunks/window.jqEf7WoA.js";import{B as Dt}from"../chunks/Button.B6DffihK.js";import{e as Et,i as Ut}from"../chunks/each.D7w_Y1pv.js";import{u as vt}from"../chunks/i18n_admin.svelte.DBF4IRUg.js";import{I as lt}from"../chunks/Input.E2qlCEoO.js";import{F as Ft}from"../chunks/Form.BiuDxuNH.js";import{b as jt,f as Gt}from"../chunks/fetch.BnpwKXAn.js";var Jt=I('<div class="row svelte-1v63e3g"><div class="svelte-1v63e3g"> </div> <div class="svelte-1v63e3g"> </div> <div class="svelte-1v63e3g"> </div> <div class="svelte-1v63e3g"> </div></div>'),Kt=I('<div><div class="row header font-label svelte-1v63e3g"><div class="svelte-1v63e3g"> </div> <div class="svelte-1v63e3g">t_cost</div> <div class="svelte-1v63e3g">m_cost</div> <div class="svelte-1v63e3g">p_cost</div></div> <!> <div style="height: 1.5rem"></div></div>');function Mt(z,x){rt(x,!0);let e=vt();var v=Kt(),h=s(v),g=s(h),y=s(g);a(g),E(6),a(h);var C=t(h,2);Et(C,17,()=>x.res,Ut,(l,u)=>{var m=Jt(),w=s(m),L=s(w,!0);a(w);var b=t(w,2),q=s(b,!0);a(b);var T=t(b,2),B=s(T,!0);a(T);var i=t(T,2),d=s(i,!0);a(i),a(m),U(()=>{r(L,o(u).time_taken),r(q,o(u).t_cost),r(B,o(u).m_cost),r(d,o(u).p_cost)}),V(l,m)}),E(2),a(v),U(()=>r(y,`${e.common.time??""} (ms)`)),V(z,v),it()}var Ot=I("<!> <!> <!> <!>",1),Pt=I('<div class="result svelte-d61iiz"><!></div>'),Rt=I('<div class="err"> </div>'),Wt=I('<div class="wrapper svelte-d61iiz"><div class="container svelte-d61iiz"><!></div> <!> <!></div>');function Yt(z,x){rt(x,!0);const e="10rem";let v=vt(),h=N(!1),g=N(""),y=N(_([])),C=N(void 0),l=_({targetTime:"1000",mCost:x.params.m_cost.toString()||"32768",pCost:x.params.p_cost.toString()||"2"});async function u(i,d){var H;n(h,!0),n(y,_([]));const c={target_time:Number.parseInt(l.targetTime),m_cost:Number.parseInt(l.mCost),p_cost:Number.parseInt(l.pCost)};let $=await jt(i.action,c);$.body?(n(y,_($.body.results)),n(g,""),setTimeout(()=>{n(C,_(window.innerHeight))},50)):n(g,_(((H=$.error)==null?void 0:H.message)||"Error")),n(h,!1)}var m=Wt(),w=s(m),L=s(w);Ft(L,{action:"/auth/v1/password_hash_times",onSubmit:u,children:(i,d)=>{var c=Ot(),$=nt(c),H=ht(()=>`${v.docs.hashing.targetTime} (ms)`),F=ht(()=>`${v.docs.hashing.targetTime} (ms)`);lt($,{typ:"number",autocomplete:"off",get label(){return o(H)},get placeholder(){return o(F)},min:"500",max:"99999",required:!0,width:e,get value(){return l.targetTime},set value(f){l.targetTime=f}});var S=t($,2);lt(S,{typ:"number",autocomplete:"off",label:"m_cost (kB)",placeholder:"m_cost (kB)",min:"32768",width:e,get value(){return l.mCost},set value(f){l.mCost=f}});var A=t(S,2);lt(A,{typ:"number",autocomplete:"off",label:"p_cost",placeholder:"p_cost",min:"2",max:"256",width:e,get value(){return l.pCost},set value(f){l.pCost=f}});var j=t(A,2);Dt(j,{type:"submit",get isLoading(){return o(h)},children:(f,dt)=>{E();var D=Lt();U(()=>r(D,v.docs.hashing.calculate)),V(f,D)},$$slots:{default:!0}}),V(i,c)},$$slots:{default:!0}}),a(w);var b=t(w,2);{var q=i=>{var d=Pt(),c=s(d);Mt(c,{get res(){return o(y)}}),a(d),V(i,d)};ot(b,i=>{o(y).length>0&&i(q)})}var T=t(b,2);{var B=i=>{var d=Rt(),c=s(d,!0);a(d),U(()=>r(c,o(g))),V(i,d)};ot(T,i=>{o(g)&&i(B)})}a(m),qt("y",()=>o(C),i=>n(C,_(i))),V(z,m),it()}var Qt=I('<h3>Argon2ID - Password Hashing</h3> <p> </p><p></p><p><b> </b><br> </p> <p> </p> <ul><li><b>m_cost</b> <p><!></p> <p><!></p> <p><!></p></li> <li><b>p_cost</b> <p><!></p> <p><!></p></li> <li><b>t_cost</b> <p><!></p> <p><!></p></li></ul> <br> <h3> </h3> <p> </p> <p> </p> <br> <h3> </h3> <p> </p> <div><div class="flex"><div class="label svelte-klhp01">m_cost:</div> </div> <div class="flex"><div class="label svelte-klhp01">p_cost:</div> </div> <div class="flex"><div class="label svelte-klhp01">t_cost:</div> </div> <br> <div class="flex"><div class="label svelte-klhp01">Login Time:</div> </div> <p> </p> <b> </b> <br></div> <br> <h3> </h3> <p> </p> <p><!></p> <!> <div style="height: 1.5rem"></div>',1);function Xt(z,x){rt(x,!0);let e=vt(),v=N(void 0),h=N(void 0),g=N(void 0);At(async()=>{let p=await Gt("/auth/v1/login_time");p.body?(n(v,_(p.body.argon2_params)),n(h,_(p.body.login_time)),n(g,_(p.body.num_cpus))):console.error(p.error)});var y=Qt(),C=t(nt(y),2),l=s(C,!0);a(C);var u=t(C,2),m=s(u),w=s(m,!0);a(m);var L=t(m,2);a(u);var b=t(u,2),q=s(b,!0);a(b);var T=t(b,2),B=s(T),i=t(s(B),2),d=s(i);k(d,()=>e.docs.hashing.mCost1),a(i);var c=t(i,2),$=s(c);k($,()=>e.docs.hashing.mCost2),a(c);var H=t(c,2),F=s(H);k(F,()=>e.docs.hashing.mCost3),a(H),a(B);var S=t(B,2),A=t(s(S),2),j=s(A);k(j,()=>e.docs.hashing.pCost1),a(A);var f=t(A,2),dt=s(f);k(dt,()=>e.docs.hashing.pCost2),a(f),a(S);var D=t(S,2),G=t(s(D),2),gt=s(G);k(gt,()=>e.docs.hashing.tCost1),a(G);var ct=t(G,2),ut=s(ct);k(ut,()=>e.docs.hashing.tCost2),a(ct),a(D),a(T);var J=t(T,4),bt=s(J,!0);a(J);var K=t(J,2),ft=s(K,!0);a(K);var M=t(K,2),_t=s(M,!0);a(M);var O=t(M,4),yt=s(O,!0);a(O);var P=t(O,2),Ct=s(P,!0);a(P);var R=t(P,2),W=s(R),wt=t(s(W));a(W);var Y=t(W,2),Tt=t(s(Y));a(Y);var Q=t(Y,2),xt=t(s(Q));a(Q);var X=t(Q,4),$t=t(s(X));a(X);var Z=t(X,2),kt=s(Z,!0);a(Z);var tt=t(Z,2),Vt=s(tt,!0);a(tt);var zt=t(tt);E(),a(R);var st=t(R,4),Bt=s(st,!0);a(st);var at=t(st,2),Ht=s(at,!0);a(at);var et=t(at,2),Nt=s(et);k(Nt,()=>e.docs.hashing.utility2),a(et);var It=t(et,2);{var St=p=>{Yt(p,{get params(){return o(v)}})};ot(It,p=>{o(v)&&p(St)})}E(2),U(()=>{var p,pt,mt;r(l,e.docs.hashing.pUtility),r(w,e.docs.hashing.tune),r(L,` ${e.docs.hashing.pTune??""}`),r(q,e.docs.hashing.pDetials),r(bt,e.docs.hashing.loginTimeHead),r(ft,e.docs.hashing.loginTime1),r(_t,e.docs.hashing.loginTime2),r(yt,e.docs.hashing.currValuesHead),r(Ct,e.docs.hashing.currValues1),r(wt,` ${((p=o(v))==null?void 0:p.m_cost)??""} kB`),r(Tt,` ${((pt=o(v))==null?void 0:pt.p_cost)??""} threads`),r(xt,` ${((mt=o(v))==null?void 0:mt.t_cost)??""}`),r($t,` ${o(h)??""} ms`),r(kt,e.docs.hashing.currValuesNote),r(Vt,e.docs.hashing.currValuesThreadsAccess),r(zt,`: ${o(g)??""}`),r(Bt,e.docs.hashing.utilityHead),r(Ht,e.docs.hashing.utility1)}),V(z,y),it()}function Zt(z){Xt(z,{})}export{Zt as component};

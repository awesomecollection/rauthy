import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.BVESbwbj.js";import{p as V,w as $,a as L,u as r,v as s,s as y,c as j,ap as k,r as A,t as O,f as Q}from"../chunks/runtime.BONl2e88.js";import{s as z}from"../chunks/render.AqJWcVDb.js";import{e as _}from"../chunks/each.Bce--_O8.js";import{a as d,d as x,t as b,e as ee}from"../chunks/template.B7ldVCvc.js";import{p as o}from"../chunks/proxy.0BECmVET.js";import{o as J}from"../chunks/index-client.Bjp_k6xO.js";import{i as te,j as ae,k as re,l as se}from"../chunks/OptionSelect.TkTfcdPh.js";import{O as ie}from"../chunks/OrderSearchBar.DcBjpUC6.js";import{i as q}from"../chunks/if.DS90EFHs.js";import{p as M}from"../chunks/props.BlbrNjWf.js";import{E as W}from"../chunks/ExpandContainer.2O3yvOBK.js";import{c as Y,a as P}from"../chunks/index.esm.B2KJ0uBO.js";import{U as F,V as G,l as H}from"../chunks/helpers.CQGRRstl.js";import{B as K}from"../chunks/Button.JPJkNEUa.js";import{I as R}from"../chunks/Input.KbCPDMgh.js";import{a as U,c as B}from"../chunks/index.BJiFQ8Di.js";import{T as oe}from"../chunks/Tooltip.BZNUXfH5.js";import{T as ne}from"../chunks/TabBar.u0W3le5w.js";import{r as le}from"../chunks/legacy-client.D71ZcBDy.js";import{P as ve}from"../chunks/Pagination.DjghmVzr.js";var ce=b('<div class="header font-label svelte-1mi5990">ADD NEW USER ATTRIBUTE</div>'),de=b('<div class="mainErr err svelte-1mi5990"> </div>'),me=b('<div class="container svelte-1mi5990"><div class="desc svelte-1mi5990">You can add a new custom user attribute.<br> These attributes can be set for every user and mapped to an existing scope.<br> They are simple Key / JsonValue pairs.</div> <!> <!> <!> <!> <!></div>');function ue(C,h){V(h,!0);let w=M(h,"idx",31,()=>-1),v=$(""),c=$(void 0),u=o({name:"",desc:""}),n=$(o({}));const m=Y().shape({name:P().trim().required("Name is required").matches(F,"Invalid characters: [a-z0-9-_/]{2,32}"),desc:P().trim().matches(G,"Invalid characters: [a-zA-Z0-9\\-_/\\s]{0,128}")});async function N(){if(!await T())return;s(v,"");let a=await te(u);if(a.ok)s(c,!1),h.onSave();else{let i=await a.json();s(v,o(i.message))}}async function T(){try{return await m.validate(u,{abortEarly:!1}),s(n,o({})),!0}catch(a){return s(n,o(H(a))),!1}}W(C,{get idx(){return w()},set idx(a){w(a)},get show(){return r(c)},set show(a){s(c,o(a))},header:a=>{var i=ce();d(a,i)},body:a=>{var i=me(),g=y(j(i),2);R(g,{autocomplete:"off",placeholder:"Name",get value(){return u.name},set value(e){u.name=e},get error(){return r(n).name},set error(e){r(n).name=e},$$events:{input:T},children:(e,t)=>{k();var l=x("NAME");d(e,l)},$$slots:{default:!0}});var I=y(g,2);R(I,{autocomplete:"off",placeholder:"Description",get value(){return u.desc},set value(e){u.desc=e},get error(){return r(n).desc},set error(e){r(n).desc=e},$$events:{input:T},children:(e,t)=>{k();var l=x("DESCRIPTION");d(e,l)},$$slots:{default:!0}});var D=y(I,2);K(D,{level:1,$$events:{click:N},children:(e,t)=>{k();var l=x("SAVE");d(e,l)},$$slots:{default:!0}});var E=y(D,2);q(E,e=>{});var p=y(E,2);{var S=e=>{var t=de(),l=j(t,!0);A(t),O(()=>z(l,r(v))),d(e,t)};q(p,e=>{r(v)&&e(S)})}A(i),d(a,i)},$$slots:{header:!0,body:!0}}),L()}var fe=b('<div class="success svelte-2o3w7i">Success</div>'),pe=b('<div class="mainErr err svelte-2o3w7i"> </div>'),he=b('<div class="container svelte-2o3w7i"><!> <!> <!> <!> <!></div>');function ge(C,h){V(h,!0);let w=M(h,"attr",19,()=>({})),v=$(""),c=$(!1),u=$(void 0);le(()=>{r(c)&&s(u,o(setTimeout(()=>{s(c,!1),h.onSave()},2e3)))}),J(()=>()=>clearTimeout(r(u)));let n=$(o({})),m=o({});const N=Y().shape({name:P().trim().required("Name is required").matches(F,"Valid characters: [a-z0-9-_/]{2,32}"),desc:P().nullable().trim().matches(G,"Valid characters: [a-zA-Z0-9\\-_/\\s]{0,128}")});J(()=>{m.name=w().name,m.desc=w().desc});async function T(){if(s(v,""),!await a()){s(v,"Invalid input");return}let t={name:m.name,desc:m.desc},l=await ae(w().name,t);if(l.ok)s(c,!0);else{let f=await l.json();s(v,o(f.message))}}async function a(){try{return await N.validate(m,{abortEarly:!1}),s(n,o({})),!0}catch(t){return s(n,o(H(t))),!1}}var i=he(),g=j(i);R(g,{autocomplete:"off",placeholder:"Name",get value(){return m.name},set value(t){m.name=t},get error(){return r(n).name},set error(t){r(n).name=t},$$events:{input:a},children:(t,l)=>{k();var f=x("NAME");d(t,f)},$$slots:{default:!0}});var I=y(g,2);R(I,{autocomplete:"off",placeholder:"Description",get value(){return m.desc},set value(t){m.desc=t},get error(){return r(n).desc},set error(t){r(n).desc=t},$$events:{input:a},children:(t,l)=>{k();var f=x("DESCRIPTION");d(t,f)},$$slots:{default:!0}});var D=y(I,2);K(D,{level:1,width:"4rem",$$events:{click:T},children:(t,l)=>{k();var f=x("SAVE");d(t,f)},$$slots:{default:!0}});var E=y(D,2);{var p=t=>{var l=fe();d(t,l)};q(E,t=>{r(c)&&t(p)})}var S=y(E,2);{var e=t=>{var l=pe(),f=j(l,!0);A(l),O(()=>z(f,r(v))),d(t,l)};q(S,t=>{r(v)&&t(e)})}A(i),d(C,i),L()}var $e=b('<div class="err svelte-1jljqe9"> </div>'),ye=b('<div class="container svelte-1jljqe9"><div class="label svelte-1jljqe9">Are you sure, you want to delete this custom attribute?</div> <!> <!></div>');function we(C,h){V(h,!0);let w=M(h,"attr",19,()=>({})),v=$(!1),c=$("");async function u(){s(c,""),s(v,!0);let a=await re(w().name);if(a.ok)h.onSave();else{let i=await a.json();s(c,o(i.message))}s(v,!1)}var n=ye(),m=y(j(n),2);K(m,{level:1,get isLoading(){return r(v)},set isLoading(a){s(v,o(a))},$$events:{click:u},children:(a,i)=>{k();var g=x("DELETE");d(a,g)},$$slots:{default:!0}});var N=y(m,2);{var T=a=>{var i=$e(),g=j(i,!0);A(i),O(()=>z(g,r(c))),d(a,i)};q(N,a=>{r(c)&&a(T)})}A(n),d(C,n),L()}var be=b('<div class="data svelte-115hohv"> </div>'),Ee=b('<div class="header svelte-115hohv"><!></div>'),Se=b("<div><!></div>"),Ae=b("<div><!></div>"),je=b("<div><!> <!></div>");function Te(C,h){V(h,!0);let w=M(h,"attr",27,()=>o({})),v=M(h,"onSave",15),c=$(void 0);const u=["Config","Delete"];let n=$(o(u[0]));const m=200,N=m/2;function T(){s(c,!1),v()()}W(C,{get show(){return r(c)},set show(a){s(c,o(a))},header:a=>{var i=Ee(),g=j(i);oe(g,{text:"Custom Attribute Name",children:(I,D)=>{var E=be(),p=j(E,!0);A(E),O(()=>z(p,w().name)),d(I,E)},$$slots:{default:!0}}),A(i),d(a,i)},body:a=>{var i=je(),g=j(i);ne(g,{labels:u,get selected(){return r(n)},set selected(p){s(n,o(p))}});var I=y(g,2);{var D=p=>{var S=Se(),e=j(S);ge(e,{get attr(){return w()},get onSave(){return v()},set onSave(t){v(t)}}),A(S),U(5,S,()=>B,()=>({delay:N,duration:m})),U(6,S,()=>B,()=>({duration:m})),d(p,S)},E=p=>{var S=ee(),e=Q(S);{var t=l=>{var f=Ae(),Z=j(f);we(Z,{get attr(){return w()},onSave:T}),A(f),U(5,f,()=>B,()=>({delay:N,duration:m})),U(6,f,()=>B,()=>({duration:m})),d(l,f)};q(e,l=>{r(n)==="Delete"&&l(t)},!0)}d(p,S)};q(I,p=>{r(n)==="Config"?p(D):p(E,!1)})}A(i),d(a,i)},$$slots:{header:!0,body:!0}}),L()}var Ie=b('<div class="svelte-mjg702"><!></div>'),Ce=b(' <div class="content"><!> <!> <div id="attrs" class="svelte-mjg702"></div> <!> <div style="height: 20px"></div></div>',1);function De(C,h){V(h,!0);let w=$(""),v=$(o([])),c=$(o([])),u=$(o([])),n=$(""),m=[{label:"NAME",callback:(e,t)=>e.name.toLowerCase().includes(t.toLowerCase())}],N=[{label:"NAME",callback:(e,t)=>e.name.localeCompare(t.name)}];J(()=>{T()});async function T(){let e=await se();if(!e.ok)s(w,"Error fetching user attr: "+e.body.message);else{let t=await e.json();s(v,o([...t.values]))}}function a(){r(v).length<2&&(s(v,o([])),s(c,o([])),s(u,o([]))),T(),s(n,"")}k();var i=Ce(),g=Q(i),I=y(g),D=j(I);ie(D,{get items(){return r(v)},searchOptions:m,orderOptions:N,get resItems(){return r(c)},set resItems(e){s(c,o(e))},get search(){return r(n)},set search(e){s(n,o(e))}});var E=y(D,2);ue(E,{onSave:a});var p=y(E,2);_(p,23,()=>r(u),e=>e.name,(e,t,l)=>{var f=Ie(),Z=j(f);Te(Z,{onSave:a,get attr(){return r(u)[r(l)]},set attr(X){r(u)[r(l)]=X}}),A(f),d(e,f)}),A(p);var S=y(p,2);ve(S,{get items(){return r(c)},set items(e){s(c,o(e))},get resItems(){return r(u)},set resItems(e){s(u,o(e))}}),k(2),A(I),O(()=>z(g,`${r(w)??""} `)),d(C,i),L()}function Ne(C){De(C,{})}export{Ne as component};

import{e as J,a as p,t as O,d as re}from"../chunks/disclose-version.BP4T4xdV.js";import{a as D,aa as W,j as e,f as q,k as o,s as C,t as P,p as Z,l as g,c as _,a7 as K,r as B,a9 as V,a5 as se}from"../chunks/index-client.hxMyB_b4.js";import{s as I}from"../chunks/render.yNX9q8-B.js";import{i as L}from"../chunks/if.BeBa1Kxb.js";import{e as oe}from"../chunks/each.BUp7aLCc.js";import{B as X,a as ne}from"../chunks/Button.BR1gOfNn.js";import{p as s}from"../chunks/proxy.DaVNR9vk.js";import{u as G}from"../chunks/i18n_admin.svelte.lt3dD7TQ.js";import{B as ie}from"../chunks/ButtonAddModal.DsDc6nUh.js";import{C as me}from"../chunks/ContentAdmin.YSUtpxca.js";import{N as le}from"../chunks/NavButtonTile.DRctQzgA.js";import{N as ve}from"../chunks/NavSub.DILgx03i.js";import{O as ue}from"../chunks/OrderSearchBar.wIdu7A5l.js";import{b as ce,d as de,c as fe,f as pe}from"../chunks/fetch.Bq59EV_b.js";import{u as ge}from"../chunks/param.svelte.BbzO27-O.js";import{I as Q}from"../chunks/pow.BMnvYon0.js";import{d as Y,e as ee}from"../chunks/patterns.BRCxk8by.js";import{F as te}from"../chunks/Form.BnvI_UPN.js";import{u as U}from"../chunks/i18n.svelte.Ci9wvqOq.js";import{T as he}from"../chunks/Tabs.DUIpSMWU.js";import{I as be}from"../chunks/IconCheck.C6tGCpWy.js";var $e=O('<div class="err"> </div>'),ye=O("<!> <!> <!> <!>",1),we=O('<div class="container svelte-s1196z"><!></div>');function Ce(x,r){D(r,!0);let F=U(),u=G(),l=g(void 0),n=g(""),m=g(""),d=g("");W(()=>{requestAnimationFrame(()=>{var h;(h=e(l))==null||h.focus()})});async function y(h,c){var S;if(r.attrs.find(A=>A.name===e(m))){o(n,s(u.common.nameExistsAlready));return}o(n,"");let t={name:e(m),desc:e(d)||void 0},v=await ce(h.action,t);v.body?r.onSave(v.body.name):o(n,s(((S=v.error)==null?void 0:S.message)||"Error"))}var w=we(),T=_(w);te(T,{action:"/auth/v1/users/attr",onSubmit:y,children:(h,c)=>{var t=ye(),v=q(t);Q(v,{autocomplete:"off",get label(){return u.attrs.name},get placeholder(){return u.attrs.name},required:!0,pattern:Y,get ref(){return e(l)},set ref(b){o(l,s(b))},get value(){return e(m)},set value(b){o(m,s(b))}});var S=C(v,2);Q(S,{autocomplete:"off",get label(){return u.attrs.desc},get placeholder(){return u.attrs.desc},pattern:ee,get value(){return e(d)},set value(b){o(d,s(b))}});var A=C(S,2);X(A,{type:"submit",children:(b,i)=>{K();var a=J();P(()=>I(a,F.common.save)),p(b,a)},$$slots:{default:!0}});var E=C(A,2);{var R=b=>{var i=$e(),a=_(i,!0);B(i),P(()=>I(a,e(n))),p(b,i)};L(E,b=>{e(n)&&b(R)})}p(h,t)},$$slots:{default:!0}}),B(w),p(x,w),Z()}var Te=O('<div class="err"> </div>'),Se=O('<!> <!> <div class="flex gap-05"><!> <!></div> <!>',1);function Oe(x,r){D(r,!0);let F=U(),u=G(),l=g(""),n=g(!1),m=g(s(r.attr.name)),d=g(s(r.attr.desc));W(()=>{r.attr.name&&(o(m,s(r.attr.name)),o(d,s(r.attr.desc)))});async function y(T,h){if(o(l,""),e(m)!==r.attr.name&&r.attrs.find(v=>v.name===e(m))){o(l,s(u.common.nameExistsAlready));return}let c={name:e(m),desc:e(d)||void 0},t=await de(T.action,c);t.error?o(l,s(t.error.message)):(o(n,!0),r.onSave(),setTimeout(()=>{o(n,!1)},2e3))}var w=V(()=>`/auth/v1/users/attr/${r.attr.name}`);te(x,{get action(){return e(w)},onSubmit:y,children:(T,h)=>{var c=Se(),t=q(c);Q(t,{autocomplete:"off",get label(){return u.attrs.name},get placeholder(){return u.attrs.name},width:"14.5rem",required:!0,pattern:Y,get value(){return e(m)},set value(a){o(m,s(a))}});var v=C(t,2);Q(v,{autocomplete:"off",get label(){return u.attrs.desc},get placeholder(){return u.attrs.desc},width:"14.5rem",pattern:ee,get value(){return e(d)},set value(a){o(d,s(a))}});var S=C(v,2),A=_(S);X(A,{type:"submit",children:(a,f)=>{K();var $=J();P(()=>I($,F.common.save)),p(a,$)},$$slots:{default:!0}});var E=C(A,2);{var R=a=>{be(a,{})};L(E,a=>{e(n)&&a(R)})}B(S);var b=C(S,2);{var i=a=>{var f=Te(),$=_(f,!0);B(f),P(()=>I($,e(l))),p(a,f)};L(b,a=>{e(l)&&a(i)})}p(T,c)},$$slots:{default:!0}}),Z()}var xe=O('<div class="err"> </div>'),Fe=O("<p> </p> <!> <!>",1);function Ae(x,r){D(r,!0);let F=U(),u=G(),l=g("");async function n(){o(l,"");let c=await fe(`/auth/v1/users/attr/${r.attr.name}`);c.error?o(l,s(c.error.message)):r.onSave()}var m=Fe(),d=q(m),y=_(d,!0);B(d);var w=C(d,2);X(w,{level:-1,onclick:n,children:(c,t)=>{K();var v=J();P(()=>I(v,F.common.delete)),p(c,v)},$$slots:{default:!0}});var T=C(w,2);{var h=c=>{var t=xe(),v=_(t,!0);B(t),P(()=>I(v,e(l))),p(c,t)};L(T,c=>{e(l)&&c(h)})}P(()=>I(y,u.attrs.delete1)),p(x,m),Z()}var Ne=O('<div class="flex"><!></div> <!>',1);function Ee(x,r){D(r,!0);let F=U(),u=G();const l=[u.nav.config,F.common.delete];let n=g(s(l[0])),m=g(void 0);W(()=>{r.attr.name&&requestAnimationFrame(()=>{var t;(t=e(m))==null||t()})});var d=Ne(),y=q(d),w=_(y);he(w,{tabs:l,get selected(){return e(n)},set selected(t){o(n,s(t))},get focusFirst(){return e(m)},set focusFirst(t){o(m,s(t))}}),B(y);var T=C(y,2);{var h=t=>{Oe(t,{get attr(){return r.attr},get attrs(){return r.attrs},get onSave(){return r.onSave}})},c=t=>{var v=re(),S=q(v);{var A=E=>{Ae(E,{get attr(){return r.attr},get onSave(){return r.onSave}})};L(S,E=>{e(n)===F.common.delete&&E(A)},!0)}p(t,v)};L(T,t=>{e(n)===u.nav.config?t(h):t(c,!1)})}p(x,d),Z()}var ke=O("<div></div> <!>",1),qe=O("<!> <!>",1),Pe=O('<div class="err"> </div>'),_e=O('<!> <div id="groups"><!></div>',1),Be=O("<!> <!>",1);function Ie(x,r){D(r,!0);let F=G(),u=g(void 0),l=g(""),n=g(s([])),m=g(s([])),d=g(void 0),y=ge("an");const w=[F.common.name];let T=g(s(w[0])),h=g("");const c=[F.common.name];se(()=>{t()}),W(()=>{o(d,s(e(n).find(i=>i.name===y.get())))}),W(()=>{let i=e(h).toLowerCase();i?e(T)===w[0]&&o(m,s(e(n).filter(a=>{var f;return(f=a.name)==null?void 0:f.toLowerCase().includes(i)}))):o(m,s(e(n)))});async function t(){var a;let i=await pe("/auth/v1/users/attr");i.body?o(n,s(i.body.values)):o(l,s(((a=i.error)==null?void 0:a.message)||"Error"))}function v(i,a){let f=a==="up";i===c[0]&&e(n).sort(($,k)=>f?$.name.localeCompare(k.name):k.name.localeCompare($.name))}function S(){t()}async function A(i){var a;(a=e(u))==null||a(),await t(),y.set(i)}var E=Be(),R=q(E);ve(R,{paddingTop:"2.1rem",buttonTilesAriaControls:"groups",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:i=>{var a=ke(),f=q(a);ne(f,"height",".5rem");var $=C(f,2);oe($,17,()=>e(m),k=>k.name,(k,M)=>{var N=V(()=>y.get()===e(M).name);le(k,{onclick:()=>y.set(e(M).name),get selected(){return e(N)},children:(H,j)=>{K();var z=J();P(()=>I(z,e(M).name)),p(H,z)},$$slots:{default:!0}})}),p(i,a)},children:(i,a)=>{var f=qe(),$=q(f),k=V(()=>e(n).length===0?1:2);ie($,{get level(){return e(k)},alignRight:!0,get closeModal(){return e(u)},set closeModal(N){o(u,s(N))},children:(N,H)=>{Ce(N,{onSave:A,get attrs(){return e(n)}})},$$slots:{default:!0}});var M=C($,2);ue(M,{searchOptions:w,orderOptions:c,onChangeOrder:v,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(T)},set searchOption(N){o(T,s(N))},get value(){return e(h)},set value(N){o(h,s(N))}}),p(i,f)},$$slots:{buttonTiles:!0,default:!0}});var b=C(R,2);me(b,{children:(i,a)=>{var f=_e(),$=q(f);{var k=j=>{var z=Pe(),ae=_(z,!0);B(z),P(()=>I(ae,e(l))),p(j,z)};L($,j=>{e(l)&&j(k)})}var M=C($,2),N=_(M);{var H=j=>{Ee(j,{get attr(){return e(d)},get attrs(){return e(n)},onSave:S})};L(N,j=>{e(d)&&j(H)})}B(M),p(i,f)},$$slots:{default:!0}}),p(x,E),Z()}function Me(x){Ie(x,{})}export{Me as component};

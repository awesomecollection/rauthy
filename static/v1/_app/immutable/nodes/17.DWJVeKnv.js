import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DvmPJwhI.js";import{p as Y,a6 as _,l as e,f as D,m as n,s as x,t as F,a as j,o as b,c as G,ar as H,r as N,ab as V,ap as oe}from"../chunks/index-client.Ds4XgiuL.js";import{s as q}from"../chunks/render.Bq2-eTRf.js";import{i as R}from"../chunks/if.Du7BDhAX.js";import{e as te}from"../chunks/each.MnMr4iw5.js";import{d as J,a as c,t as C,e as ae}from"../chunks/template.DXIK6jcH.js";import{a as se}from"../chunks/index.L0FyJ7Re.js";import{p as i}from"../chunks/proxy.CB6KOiNf.js";import{u as K}from"../chunks/i18n_admin.svelte.B9VY-ZfA.js";import{B as ne}from"../chunks/ButtonAddModal.mDcrP-vd.js";import{C as ie}from"../chunks/ContentAdmin.COLOikfe.js";import{N as me}from"../chunks/NavButtonTile.ClPY4kTr.js";import{N as ue}from"../chunks/NavSub.9PtxGldh.js";import{O as le}from"../chunks/OrderSearchBar.LuMLhfeB.js";import{b as ve,d as de,c as ce,f as pe}from"../chunks/fetch.DFmyLr06.js";import{u as ge}from"../chunks/param.svelte.D0F_0zrI.js";import{B as X}from"../chunks/Button.nDjAKZm4.js";import{I as Z}from"../chunks/pow.C3ENfqN0.js";import{e as P}from"../chunks/patterns.D9HtGhEC.js";import{F as ee}from"../chunks/Form.JHjwURkX.js";import{u as U}from"../chunks/i18n.svelte.CgUwCKxn.js";import{T as fe}from"../chunks/Tabs.Cqg7xZCh.js";import{I as he}from"../chunks/IconCheck.CzEyprnz.js";import{L as be}from"../chunks/LabeledValue.CfdJ335t.js";var $e=C('<div class="err"> </div>'),ye=C("<!> <!> <!>",1),we=C('<div class="container svelte-s1196z"><!></div>');function Se(E,t){Y(t,!0);let I=U(),f=K(),v=b(void 0),a=b(""),m=b("");_(()=>{requestAnimationFrame(()=>{var g;(g=e(v))==null||g.focus()})});async function y(g,w){var d;if(t.groups.find(O=>O.name===e(m))){n(a,i(f.common.nameExistsAlready));return}n(a,"");let s={group:e(m)},r=await ve(g.action,s);r.body?t.onSave(r.body.id):n(a,i(((d=r.error)==null?void 0:d.message)||"Error"))}var h=we(),$=G(h);ee($,{action:"/auth/v1/groups",onSubmit:y,children:(g,w)=>{var s=ye(),r=D(s);Z(r,{autocomplete:"off",get label(){return f.groups.name},get placeholder(){return f.groups.name},required:!0,pattern:P,get ref(){return e(v)},set ref(p){n(v,i(p))},get value(){return e(m)},set value(p){n(m,i(p))}});var d=x(r,2);X(d,{type:"submit",children:(p,A)=>{H();var k=J();F(()=>q(k,I.common.save)),c(p,k)},$$slots:{default:!0}});var O=x(d,2);{var z=p=>{var A=$e(),k=G(A,!0);N(A),F(()=>q(k,e(a))),c(p,A)};R(O,p=>{e(a)&&p(z)})}c(g,s)},$$slots:{default:!0}}),N(h),c(E,h),j()}var Te=C('<div class="err"> </div>'),xe=C('<!> <!> <div class="flex gap-05"><!> <!></div> <!>',1);function Ce(E,t){Y(t,!0);let I=U(),f=K(),v=b(""),a=b(!1),m=b(i(t.group.name));_(()=>{t.group.id&&n(m,i(t.group.name))});async function y($,g){if(n(v,""),e(m)!==t.group.name&&t.groups.find(r=>r.name===e(m))){n(v,i(f.common.nameExistsAlready));return}let w={group:e(m)},s=await de($.action,w);s.error?n(v,i(s.error.message)):(n(a,!0),t.onSave(),setTimeout(()=>{n(a,!1)},2e3))}var h=V(()=>`/auth/v1/groups/${t.group.id}`);ee(E,{get action(){return e(h)},onSubmit:y,children:($,g)=>{var w=xe(),s=D(w);be(s,{label:"ID",mono:!0,children:(o,u)=>{H();var l=J();F(()=>q(l,t.group.id)),c(o,l)},$$slots:{default:!0}});var r=x(s,2);Z(r,{autocomplete:"off",get label(){return f.groups.name},get placeholder(){return f.groups.name},width:"14.5rem",required:!0,pattern:P,get value(){return e(m)},set value(o){n(m,i(o))}});var d=x(r,2),O=G(d);X(O,{type:"submit",children:(o,u)=>{H();var l=J();F(()=>q(l,I.common.save)),c(o,l)},$$slots:{default:!0}});var z=x(O,2);{var p=o=>{he(o,{})};R(z,o=>{e(a)&&o(p)})}N(d);var A=x(d,2);{var k=o=>{var u=Te(),l=G(u,!0);N(u),F(()=>q(l,e(v))),c(o,u)};R(A,o=>{e(v)&&o(k)})}c($,w)},$$slots:{default:!0}}),j()}var Ee=C('<div class="err"> </div>'),Ie=C("<p> </p> <!> <!>",1);function Le(E,t){Y(t,!0);let I=U(),f=K(),v=b("");async function a(){n(v,"");let s=await ce(`/auth/v1/groups/${t.group.id}`);s.error?n(v,i(s.error.message)):t.onSave()}var m=Ie(),y=D(m),h=G(y,!0);N(y);var $=x(y,2);X($,{level:-1,onclick:a,children:(s,r)=>{H();var d=J();F(()=>q(d,I.common.delete)),c(s,d)},$$slots:{default:!0}});var g=x($,2);{var w=s=>{var r=Ee(),d=G(r,!0);N(r),F(()=>q(d,e(v))),c(s,r)};R(g,s=>{e(v)&&s(w)})}F(()=>q(h,f.groups.delete1)),c(E,m),j()}var Oe=C('<div class="flex"><!></div> <!>',1);function Fe(E,t){Y(t,!0);let I=U(),f=K();const v=[f.nav.config,I.common.delete];let a=b(i(v[0])),m=b(void 0);_(()=>{t.group.id&&requestAnimationFrame(()=>{var r;(r=e(m))==null||r()})});var y=Oe(),h=D(y),$=G(h);fe($,{tabs:v,get selected(){return e(a)},set selected(r){n(a,i(r))},get focusFirst(){return e(m)},set focusFirst(r){n(m,i(r))}}),N(h);var g=x(h,2);{var w=r=>{Ce(r,{get group(){return t.group},get groups(){return t.groups},get onSave(){return t.onSave}})},s=r=>{var d=ae(),O=D(d);{var z=p=>{Le(p,{get group(){return t.group},get onSave(){return t.onSave}})};R(O,p=>{e(a)===I.common.delete&&p(z)},!0)}c(r,d)};R(g,r=>{e(a)===f.nav.config?r(w):r(s,!1)})}c(E,y),j()}var qe=C("<div></div> <!>",1),Ae=C("<!> <!>",1),De=C('<div class="err"> </div>'),Ge=C('<!> <div id="groups"><!></div>',1),Ne=C("<!> <!>",1);function ke(E,t){Y(t,!0);let I=K(),f=b(void 0),v=b(""),a=b(i([])),m=b(i([])),y=b(void 0),h=ge("gid");const $=[I.common.name,"ID"];let g=b(i($[0])),w=b("");const s=[I.common.name,"ID"];oe(()=>{r()}),_(()=>{n(y,i(e(a).find(o=>o.id===h.get())))}),_(()=>{let o=e(w).toLowerCase();o?e(g)===$[0]?n(m,i(e(a).filter(u=>{var l;return(l=u.name)==null?void 0:l.toLowerCase().includes(o)}))):e(g)===$[1]&&n(m,i(e(a).filter(u=>u.id.toLowerCase().includes(o)))):n(m,i(e(a)))});async function r(){var u;let o=await pe("/auth/v1/groups");o.body?n(a,i(o.body)):n(v,i(((u=o.error)==null?void 0:u.message)||"Error"))}function d(o,u){let l=u==="up";o===s[0]?e(a).sort((S,T)=>l?S.name.localeCompare(T.name):T.name.localeCompare(S.name)):o===s[1]&&e(a).sort((S,T)=>l?S.id.localeCompare(T.id):T.id.localeCompare(S.id))}function O(){r()}async function z(o){var u;(u=e(f))==null||u(),await r(),h.set(o)}var p=Ne(),A=D(p);ue(A,{paddingTop:"2.1rem",buttonTilesAriaControls:"groups",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:o=>{var u=qe(),l=D(u);se(l,"height",".5rem");var S=x(l,2);te(S,17,()=>e(m),T=>T.id,(T,B)=>{var L=V(()=>h.get()===e(B).id);me(T,{onclick:()=>h.set(e(B).id),get selected(){return e(L)},children:(Q,M)=>{H();var W=J();F(()=>q(W,e(B).name)),c(Q,W)},$$slots:{default:!0}})}),c(o,u)},children:(o,u)=>{var l=Ae(),S=D(l),T=V(()=>e(a).length===0?1:2);ne(S,{get level(){return e(T)},alignRight:!0,get closeModal(){return e(f)},set closeModal(L){n(f,i(L))},children:(L,Q)=>{Se(L,{onSave:z,get groups(){return e(a)}})},$$slots:{default:!0}});var B=x(S,2);le(B,{searchOptions:$,orderOptions:s,onChangeOrder:d,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(g)},set searchOption(L){n(g,i(L))},get value(){return e(w)},set value(L){n(w,i(L))}}),c(o,l)},$$slots:{buttonTiles:!0,default:!0}});var k=x(A,2);ie(k,{children:(o,u)=>{var l=Ge(),S=D(l);{var T=M=>{var W=De(),re=G(W,!0);N(W),F(()=>q(re,e(v))),c(M,W)};R(S,M=>{e(v)&&M(T)})}var B=x(S,2),L=G(B);{var Q=M=>{Fe(M,{get group(){return e(y)},get groups(){return e(a)},onSave:O})};R(L,M=>{e(y)&&M(Q)})}N(B),c(o,l)},$$slots:{default:!0}}),c(E,p),j()}function Be(E){ke(E,{})}export{Be as component};

import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.BVESbwbj.js";import{p as K,w as m,a as X,u as t,v as a,c as E,ap as W,s as g,r as y,t as q,f as Y}from"../chunks/runtime.BONl2e88.js";import{s as G}from"../chunks/render.AqJWcVDb.js";import{e as ue}from"../chunks/each.Bce--_O8.js";import{a as l,d as F,t as p,e as me}from"../chunks/template.B7ldVCvc.js";import{p as r}from"../chunks/proxy.0BECmVET.js";import{o as Z}from"../chunks/index-client.Bjp_k6xO.js";import{v as pe,w as fe,x as he,l as ge,y as we}from"../chunks/OptionSelect.TkTfcdPh.js";import{i as N}from"../chunks/if.DS90EFHs.js";import{p as M}from"../chunks/props.BlbrNjWf.js";import{r as ee}from"../chunks/legacy-client.D71ZcBDy.js";import{E as ae}from"../chunks/ExpandContainer.2O3yvOBK.js";import{c as se,a as re}from"../chunks/index.esm.B2KJ0uBO.js";import{W as oe,l as ie,X as ve}from"../chunks/helpers.CQGRRstl.js";import{B as te}from"../chunks/Button.JPJkNEUa.js";import{I as le}from"../chunks/Input.KbCPDMgh.js";import{b as ne,a as R,c as U}from"../chunks/index.BJiFQ8Di.js";import{T as ce}from"../chunks/Tooltip.BZNUXfH5.js";import{T as be}from"../chunks/TabBar.u0W3le5w.js";import{I as de}from"../chunks/ItemTiles.6wBDc_SZ.js";import{O as $e}from"../chunks/OrderSearchBar.DcBjpUC6.js";import{P as ye}from"../chunks/Pagination.DjghmVzr.js";var _e=p('<div class="header font-label svelte-r30xs6">ADD NEW SCOPE</div>'),Se=p('<div class="success svelte-r30xs6">Success</div>'),Ee=p('<div class="err svelte-r30xs6"> </div>'),Ce=p('<div class="container svelte-r30xs6"><!> <!> <!> <!></div>');function De(P,$){K($,!0);let j=M($,"idx",31,()=>-1),s=m(void 0),c=m(r({scope:""})),f=m(""),w=m(!1),_=m(void 0),S=m(r({}));const k=se().shape({scope:re().trim().matches(oe,"Can only contain: 'a-z0-9-_/:*', length: 2-64")});ee(()=>{t(w)&&a(_,r(setTimeout(()=>{$.onSave(),a(w,!1),a(c,r({scope:""})),a(s,!1)},1500)))}),Z(()=>()=>clearTimeout(t(_)));async function C(){if(a(f,""),!await b()){a(f,"Invalid input");return}t(c).scope=t(c).scope.trim();let i=await pe(t(c));if(i.ok)a(w,!0);else{let d=await i.json();a(f,r(d.message))}}async function b(){try{return await k.validate(t(c),{abortEarly:!1}),a(S,r({})),!0}catch(i){return a(S,r(ie(i))),!1}}ae(P,{get idx(){return j()},set idx(i){j(i)},get show(){return t(s)},set show(i){a(s,r(i))},header:i=>{var d=_e();l(i,d)},body:i=>{var d=Ce(),x=E(d);le(x,{autocomplete:"off",placeholder:"Scope Name",get value(){return t(c).scope},set value(e){t(c).scope=e},get error(){return t(S).scope},set error(e){t(S).scope=e},$$events:{input:b},children:(e,n)=>{W();var I=F("SCOPE NAME");l(e,I)},$$slots:{default:!0}});var u=g(x,2);te(u,{level:1,width:"4rem",$$events:{click:C},children:(e,n)=>{W();var I=F("SAVE");l(e,I)},$$slots:{default:!0}});var D=g(u,2);{var v=e=>{var n=Se();l(e,n)};N(D,e=>{t(w)&&e(v)})}var h=g(D,2);{var O=e=>{var n=Ee(),I=E(n,!0);y(n),q(()=>G(I,t(f))),l(e,n)};N(h,e=>{t(f)&&e(O)})}y(d),l(i,d)},$$slots:{header:!0,body:!0}}),X()}var Ie=p('<div class="desc svelte-guvobw"><p>Custom mappings cannot be done for OpenID default scopes and their names cannot be changed.</p></div>'),je=p('<div class="desc svelte-guvobw"><p>You can map custom scopes to attributes.<br> All additional attributes, that were configured, can have a custom value for each user.<br> When they are mapped to a scope, they can be included in the Access and / or ID Tokens.</p></div> <div class="unit svelte-guvobw"><div class="label svelte-guvobw">ACCESS TOKEN MAPPINGS</div> <!></div> <div class="unit svelte-guvobw"><div class="label svelte-guvobw">ID TOKEN MAPPINGS</div> <!></div>',1),xe=p('<div class="success svelte-guvobw">Success</div>'),Te=p('<div class="mainErr err svelte-guvobw"> </div>'),ke=p("<!> <!> <!>",1),Ae=p('<div class="container svelte-guvobw"><div class="unit svelte-guvobw"><div class="label font-label svelte-guvobw">ID</div> <div class="value font-mono svelte-guvobw"> </div></div> <!> <div class="separator"></div> <!> <!></div>');function Pe(P,$){K($,!0);let j=M($,"attrs",27,()=>r([])),s=M($,"scope",31,()=>r({})),c=m(""),f=m(!1),w=m(void 0),_=m(!1),S=m(r([]));ee(()=>{t(f)&&a(w,r(setTimeout(()=>{a(f,!1),$.onSave()},2e3)))}),ee(()=>{j()&&a(S,r(j().map(o=>o.name)))}),Z(()=>(a(_,r(ve(s().name))),()=>clearTimeout(t(w))));let k=m(r({}));const C=se().shape({name:re().trim().matches(oe,"Can only contain: 'a-z0-9-_/:*', length: 2-64")});async function b(){if(a(c,""),!await i()){a(c,"Invalid input");return}let o={scope:s().name.trim()};s().attr_include_access.length>0&&(o.attr_include_access=s().attr_include_access),s().attr_include_id.length>0&&(o.attr_include_id=s().attr_include_id);let A=await fe(s().id,o);if(A.ok)a(f,!0);else{let T=await A.json();a(c,r(T.message))}}async function i(){try{return await C.validate(s(),{abortEarly:!1}),a(k,r({})),!0}catch(o){return a(k,r(ie(o))),!1}}var d=Ae(),x=E(d),u=g(E(x),2),D=E(u,!0);y(u),y(x);var v=g(x,2);le(v,{autocomplete:"off",placeholder:"Scope Name",get disabled(){return t(_)},get value(){return s().name},set value(o){s(s().name=o,!0)},get error(){return t(k).name},set error(o){t(k).name=o},$$events:{input:i},children:(o,A)=>{W();var T=F("SCOPE NAME");l(o,T)},$$slots:{default:!0}});var h=g(v,4);{var O=o=>{var A=Ie();l(o,A)},e=o=>{var A=je(),T=g(Y(A),2);ne(T,"margin-top","-3px");var Q=g(E(T),2);de(Q,{get options(){return t(S)},searchThreshold:4,get items(){return s().attr_include_access},set items(B){s(s().attr_include_access=B,!0)}}),y(T);var V=g(T,2);ne(V,"margin-top","-3px");var H=g(E(V),2);de(H,{get options(){return t(S)},searchThreshold:4,get items(){return s().attr_include_id},set items(B){s(s().attr_include_id=B,!0)}}),y(V),l(o,A)};N(h,o=>{t(_)?o(O):o(e,!1)})}var n=g(h,2);{var I=o=>{var A=ke(),T=Y(A);te(T,{level:1,width:"4rem",$$events:{click:b},children:(L,z)=>{W();var J=F("SAVE");l(L,J)},$$slots:{default:!0}});var Q=g(T,2);{var V=L=>{var z=xe();l(L,z)};N(Q,L=>{t(f)&&L(V)})}var H=g(Q,2);{var B=L=>{var z=Te(),J=E(z,!0);y(z),q(()=>G(J,t(c))),l(L,z)};N(H,L=>{t(c)&&L(B)})}l(o,A)};N(n,o=>{t(_)||o(I)})}y(d),q(()=>G(D,s().id)),l(P,d),X()}var Ne=p('<div class="label svelte-1jljqe9">OpenID default scopes cannot be deleted</div>'),Oe=p('<div class="err svelte-1jljqe9"> </div>'),Le=p('<div class="label svelte-1jljqe9">Are you sure, you want to delete this scope?</div> <!> <!>',1),We=p('<div class="container svelte-1jljqe9"><!></div>');function qe(P,$){K($,!0);let j=M($,"scope",19,()=>({})),s=m(!1),c=m("");async function f(){a(c,""),a(s,!0);let C=await he(j().id);if(C.ok)$.onSave();else{let b=await C.json();a(c,r(b.message))}a(s,!1)}var w=We(),_=E(w);{var S=C=>{var b=Ne();l(C,b)},k=C=>{var b=Le(),i=g(Y(b),2);te(i,{level:1,get isLoading(){return t(s)},set isLoading(u){a(s,r(u))},$$events:{click:f},children:(u,D)=>{W();var v=F("DELETE");l(u,v)},$$slots:{default:!0}});var d=g(i,2);{var x=u=>{var D=Oe(),v=E(D,!0);y(D),q(()=>G(v,t(c))),l(u,D)};N(d,u=>{t(c)&&u(x)})}l(C,b)};N(_,C=>{ve(j().name)?C(S):C(k,!1)})}y(w),l(P,w),X()}var Ge=p('<div class="data font-mono svelte-115hohv"> </div>'),Me=p('<div class="data svelte-115hohv"> </div>'),ze=p('<div class="header svelte-115hohv"><!> <!></div>'),Ve=p("<div><!></div>"),Be=p("<div><!></div>"),Ke=p("<div><!> <!></div>");function Xe(P,$){K($,!0);let j=M($,"attrs",15),s=M($,"scope",31,()=>r({})),c=M($,"onSave",15),f=m(void 0);const w=["Config","Delete"];let _=m(r(w[0]));const S=200,k=S/2;function C(){a(f,!1),c()()}ae(P,{get show(){return t(f)},set show(b){a(f,r(b))},header:b=>{var i=ze(),d=E(i);ce(d,{text:"Scope ID",children:(u,D)=>{var v=Ge(),h=E(v,!0);y(v),q(()=>G(h,s().id)),l(u,v)},$$slots:{default:!0}});var x=g(d,2);ce(x,{text:"Scope Name",children:(u,D)=>{var v=Me(),h=E(v,!0);y(v),q(()=>G(h,s().name)),l(u,v)},$$slots:{default:!0}}),y(i),l(b,i)},body:b=>{var i=Ke(),d=E(i);be(d,{labels:w,get selected(){return t(_)},set selected(v){a(_,r(v))}});var x=g(d,2);{var u=v=>{var h=Ve(),O=E(h);Pe(O,{get attrs(){return j()},set attrs(e){j(e)},get scope(){return s()},set scope(e){s(e)},get onSave(){return c()},set onSave(e){c(e)}}),y(h),R(5,h,()=>U,()=>({delay:k,duration:S})),R(6,h,()=>U,()=>({duration:S})),l(v,h)},D=v=>{var h=me(),O=Y(h);{var e=n=>{var I=Be(),o=E(I);qe(o,{get scope(){return s()},onSave:C}),y(I),R(5,I,()=>U,()=>({delay:k,duration:S})),R(6,I,()=>U,()=>({duration:S})),l(n,I)};N(O,n=>{t(_)==="Delete"&&n(e)},!0)}l(v,h)};N(x,v=>{t(_)==="Config"?v(u):v(D,!1)})}y(i),l(b,i)},$$slots:{header:!0,body:!0}}),X()}var Ye=p('<div class="svelte-15sc49d"><!></div>'),Fe=p(' <div class="content"><!> <!> <div id="scopes" class="svelte-15sc49d"></div> <!> <div style="height: 20px"></div></div>',1);function Qe(P,$){K($,!0);let j=m(r([])),s=m(""),c=m(r([])),f=m(r([])),w=m(r([])),_=m(""),S=[{label:"Name",callback:(e,n)=>e.name.toLowerCase().includes(n.toLowerCase())},{label:"ID",callback:(e,n)=>e.id.toLowerCase().includes(n.toLowerCase())}],k=[{label:"Name",callback:(e,n)=>e.name.localeCompare(n.name)},{label:"ID",callback:(e,n)=>e.id.localeCompare(n.id)}];Z(()=>{b(),C(),a(_,"")});async function C(){let e=await ge();if(!e.ok)a(s,"Error fetching attributes: "+e.body.message);else{let n=await e.json();a(j,r([...n.values]))}}async function b(){let e=await we(),n=await e.json();e.ok?a(c,r([...n])):a(s,r(n.message))}function i(){b()}W();var d=Fe(),x=Y(d),u=g(x),D=E(u);$e(D,{get items(){return t(c)},searchOptions:S,orderOptions:k,get resItems(){return t(f)},set resItems(e){a(f,r(e))},get search(){return t(_)},set search(e){a(_,r(e))}});var v=g(D,2);De(v,{onSave:i});var h=g(v,2);ue(h,23,()=>t(w),e=>e.id,(e,n,I)=>{var o=Ye(),A=E(o);Xe(A,{onSave:i,get attrs(){return t(j)},set attrs(T){a(j,r(T))},get scope(){return t(w)[t(I)]},set scope(T){t(w)[t(I)]=T}}),y(o),l(e,o)}),y(h);var O=g(h,2);ye(O,{get items(){return t(f)},set items(e){a(f,r(e))},get resItems(){return t(w)},set resItems(e){a(w,r(e))}}),W(2),y(u),q(()=>G(x,`${t(s)??""} `)),l(P,d),X()}function Re(P){Qe(P,{})}export{Re as component};

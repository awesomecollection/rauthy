import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.BVESbwbj.js";import{p as H,c as i,r as l,t as _,a as J,s as v,w as $,v as t,u as a,ap as oe,f as K}from"../chunks/runtime.BONl2e88.js";import{s as S}from"../chunks/render.AqJWcVDb.js";import{i as Q}from"../chunks/if.DS90EFHs.js";import{e as V}from"../chunks/each.Bce--_O8.js";import{a as b,t as C,d as ve,e as W}from"../chunks/template.B7ldVCvc.js";import{t as ne,b as ce}from"../chunks/index.BJiFQ8Di.js";import{p as d}from"../chunks/proxy.0BECmVET.js";import{o as pe}from"../chunks/index-client.Bjp_k6xO.js";import{b as me,c as be,e as X}from"../chunks/OptionSelect.TkTfcdPh.js";import{z as Y,r as ge}from"../chunks/helpers.CQGRRstl.js";import{B as ue}from"../chunks/Button.JPJkNEUa.js";import{O as fe}from"../chunks/OrderSearchBar.DcBjpUC6.js";import{P as he}from"../chunks/Pagination.DjghmVzr.js";import{P as we}from"../chunks/PaginationServer.DmVnT-Wx.js";import{p as Z}from"../chunks/props.BlbrNjWf.js";import{C as xe}from"../chunks/CheckIcon.CqUmlXj7.js";import{E as Ie}from"../chunks/ExpandContainer.2O3yvOBK.js";import{T as q}from"../chunks/Tooltip.BZNUXfH5.js";var $e=C('<div class="uid svelte-psgb3d"> </div>'),Se=C('<div class="ip svelte-psgb3d"> </div>'),ke=C('<div class="date svelte-psgb3d"> </div>'),Ce=C('<div class="header svelte-psgb3d"><!> <div class="header svelte-psgb3d"><!> <!></div></div>'),Pe=C('<div class="details svelte-psgb3d"><div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">Session ID:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">User ID:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">Expires:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">Last Seen:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">State:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">IP:</div> </div> <div class="flex svelte-psgb3d"><div class="label svelte-psgb3d">MFA:</div> <!></div></div>'),_e=C('<div class="container svelte-psgb3d"><!></div>');function ee(A,B){H(B,!0);let n=Z(B,"session",27,()=>d({})),y=Z(B,"now",11,0);var h=_e(),D=i(h);Ie(D,{header:w=>{var c=Ce(),g=i(c);q(g,{text:"User ID",children:(u,E)=>{var o=$e(),k=i(o,!0);l(o),_(()=>S(k,n().user_id)),b(u,o)},$$slots:{default:!0}});var x=v(g,2),p=i(x);q(p,{text:"Peer IP",children:(u,E)=>{var o=Se(),k=i(o,!0);l(o),_(()=>S(k,n().remote_ip)),b(u,o)},$$slots:{default:!0}});var m=v(p,2);q(m,{text:"Last Seen",children:(u,E)=>{var o=ke(),k=i(o,!0);_(()=>S(k,Y(n().last_seen))),l(o),b(u,o)},$$slots:{default:!0}}),l(x),l(c),b(w,c)},body:w=>{var c=Pe(),g=i(c),x=v(i(g));l(g);var p=v(g,2),m=v(i(p));l(p);var u=v(p,2),E=v(i(u));_(()=>S(E,` ${Y(n().exp)??""}`)),l(u);var o=v(u,2),k=v(i(o));_(()=>S(k,` ${Y(n().last_seen)??""}`)),l(o);var M=v(o,2),T=v(i(M));l(M);var L=v(M,2),N=v(i(L));l(L);var O=v(L,2),R=v(i(O),2);xe(R,{get check(){return n().is_mfa}}),l(O),l(c),_(()=>{S(x,` ${n().id??""}`),S(m,` ${n().user_id??""}`),S(T,` ${n().state??""}`),S(N,` ${n().remote_ip??""}`)}),b(w,c)},$$slots:{header:!0,body:!0}}),l(h),_(()=>ne(h,"expired",n().exp<y())),b(A,h),J()}var ye=C('<div class="svelte-1rjd8yh"><!></div>'),De=C('<div class="svelte-1rjd8yh"><!></div>'),Le=C('<div class="content"><div class="row svelte-1rjd8yh"><!> <div class="button svelte-1rjd8yh"><!></div></div> <div id="sessions" class="svelte-1rjd8yh"><!></div> <!></div>');function je(A,B){H(B,!0);let n=$(""),y=$(d([])),h=$(d([])),D=$(d([])),w=$(Date.now()/1e3),c=$(""),g=$(!1),x=$(15),p=$(""),m=$(1),u=[{label:"User ID",callback:(e,s)=>{var r;return(r=e.user_id)==null?void 0:r.toLowerCase().includes(s.toLowerCase())}},{label:"Session ID",callback:(e,s)=>e.id.toLowerCase().includes(s.toLowerCase())},{label:"IP",callback:(e,s)=>{var r;return(r=e.remote_ip)==null?void 0:r.toLowerCase().includes(s.toLowerCase())}}],E=[{label:"Expires",callback:(e,s)=>e.exp-s.exp},{label:"Last Seen",callback:(e,s)=>e.last_seen-s.last_seen},{label:"Session ID",callback:(e,s)=>e.id.localeCompare(s.id)},{label:"User ID",callback:(e,s)=>{var r;return(r=e.user_id)==null?void 0:r.localeCompare(s.user_id)}},{label:"State",callback:(e,s)=>e.state.localeCompare(s.state)},{label:"IP",callback:(e,s)=>{var r;return(r=e.remote_ip)==null?void 0:r.localeCompare(s.remote_ip)}}];pe(()=>{o()});async function o(e,s,r,I){let f;if(e===!0?r&&a(m)===2?f=await X(I||a(x),s,void 0,!1):f=await X(I||a(x),s,a(p),r):f=await me(),!f.ok)t(n,"Error fetching sessions: "+f.body.message);else{f.status===206?(t(x,d(Number.parseInt(f.headers.get("x-page-size"),10))),t(p,d(f.headers.get("x-continuation-token"))),t(c,"session")):t(c,"");let P=await f.json();t(y,d([...P])),t(h,d([...P])),t(w,Date.now()/1e3)}}async function k(e,s){await o(!0,e,s),s?t(m,a(m)-1):t(m,a(m)+1)}async function M(e){t(p,""),await o(!0,0,!1,e),t(m,1)}async function T(){let e=await be();if(e.ok)ge();else{let s=await e.json();t(n,d(s.message))}t(w,d(new Date))}var L=Le(),N=i(L),O=i(N);fe(O,{get items(){return a(y)},searchOptions:u,orderOptions:E,firstDirReverse:!0,get resItems(){return a(h)},set resItems(e){t(h,d(e))},get useServerSideIdx(){return a(c)},set useServerSideIdx(e){t(c,d(e))},get isSearchFiltered(){return a(g)},set isSearchFiltered(e){t(g,d(e))}});var R=v(O,2);ce(R,"margin-top","-10px");var se=i(R);ue(se,{level:3,$$events:{click:T},children:(e,s)=>{oe();var r=ve("Invalidate All Sessions");b(e,r)},$$slots:{default:!0}}),l(R),l(N);var F=v(N),G=v(F),ae=i(G);{var te=e=>{var s=W(),r=K(s);V(r,19,()=>a(y),I=>I.id,(I,f,P)=>{var j=ye(),U=i(j);ee(U,{get session(){return a(y)[a(P)]},set session(z){a(y)[a(P)]=z},get now(){return a(w)},set now(z){t(w,d(z))}}),l(j),b(I,j)}),b(e,s)},re=e=>{var s=W(),r=K(s);V(r,19,()=>a(D),I=>I.id,(I,f,P)=>{var j=De(),U=i(j);ee(U,{get session(){return a(D)[a(P)]},set session(z){a(D)[a(P)]=z},get now(){return a(w)},set now(z){t(w,d(z))}}),l(j),b(I,j)}),b(e,s)};Q(ae,e=>{a(c)&&!a(g)?e(te):e(re,!1)})}l(G);var ie=v(G,2);{var le=e=>{we(e,{fetchPageCallback:k,sspPageSizeChange:M,get sspPage(){return a(m)},set sspPage(s){t(m,d(s))},get sspPageSize(){return a(x)},set sspPageSize(s){t(x,d(s))},get sspContinuationToken(){return a(p)},set sspContinuationToken(s){t(p,d(s))}})},de=e=>{he(e,{get items(){return a(h)},set items(s){t(h,d(s))},get resItems(){return a(D)},set resItems(s){t(D,d(s))}})};Q(ie,e=>{a(c)&&!a(g)?e(le):e(de,!1)})}l(L),_(()=>S(F,` ${a(n)??""} `)),b(A,L),J()}function ze(A){je(A,{})}export{ze as component};

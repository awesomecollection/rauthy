import{e as W,a as c,t as x,d as oe}from"../chunks/disclose-version.BP4T4xdV.js";import{a as Y,aa as _,j as e,f as D,k as n,s as C,t as F,p as H,l as $,c as G,a7 as J,r as L,a9 as V,a5 as te}from"../chunks/index-client.hxMyB_b4.js";import{s as q}from"../chunks/render.yNX9q8-B.js";import{i as R}from"../chunks/if.BeBa1Kxb.js";import{e as ae}from"../chunks/each.BUp7aLCc.js";import{B as X,a as se}from"../chunks/Button.BR1gOfNn.js";import{p as i}from"../chunks/proxy.DaVNR9vk.js";import{u as K}from"../chunks/i18n_admin.svelte.lt3dD7TQ.js";import{B as ne}from"../chunks/ButtonAddModal.DsDc6nUh.js";import{C as ie}from"../chunks/ContentAdmin.YSUtpxca.js";import{N as ue}from"../chunks/NavButtonTile.DRctQzgA.js";import{N as le}from"../chunks/NavSub.DILgx03i.js";import{O as me}from"../chunks/OrderSearchBar.wIdu7A5l.js";import{b as ve,d as de,c as ce,f as pe}from"../chunks/fetch.Bq59EV_b.js";import{u as ge}from"../chunks/param.svelte.BbzO27-O.js";import{I as Z}from"../chunks/pow.BMnvYon0.js";import{f as P}from"../chunks/patterns.BRCxk8by.js";import{F as ee}from"../chunks/Form.BnvI_UPN.js";import{u as U}from"../chunks/i18n.svelte.Ci9wvqOq.js";import{T as fe}from"../chunks/Tabs.DUIpSMWU.js";import{I as he}from"../chunks/IconCheck.C6tGCpWy.js";import{L as $e}from"../chunks/LabeledValue.CxxfjE_4.js";var be=x('<div class="err"> </div>'),ye=x("<!> <!> <!>",1),we=x('<div class="container svelte-s1196z"><!></div>');function Se(k,t){Y(t,!0);let E=U(),f=K(),v=$(void 0),a=$(""),u=$("");_(()=>{requestAnimationFrame(()=>{var g;(g=e(v))==null||g.focus()})});async function y(g,w){var d;if(t.groups.find(O=>O.name===e(u))){n(a,i(f.common.nameExistsAlready));return}n(a,"");let s={group:e(u)},r=await ve(g.action,s);r.body?t.onSave(r.body.id):n(a,i(((d=r.error)==null?void 0:d.message)||"Error"))}var h=we(),b=G(h);ee(b,{action:"/auth/v1/groups",onSubmit:y,children:(g,w)=>{var s=ye(),r=D(s);Z(r,{autocomplete:"off",get label(){return f.groups.name},get placeholder(){return f.groups.name},required:!0,pattern:P,get ref(){return e(v)},set ref(p){n(v,i(p))},get value(){return e(u)},set value(p){n(u,i(p))}});var d=C(r,2);X(d,{type:"submit",children:(p,A)=>{J();var N=W();F(()=>q(N,E.common.save)),c(p,N)},$$slots:{default:!0}});var O=C(d,2);{var j=p=>{var A=be(),N=G(A,!0);L(A),F(()=>q(N,e(a))),c(p,A)};R(O,p=>{e(a)&&p(j)})}c(g,s)},$$slots:{default:!0}}),L(h),c(k,h),H()}var Te=x('<div class="err"> </div>'),xe=x('<!> <!> <div class="flex gap-05"><!> <!></div> <!>',1);function Ce(k,t){Y(t,!0);let E=U(),f=K(),v=$(""),a=$(!1),u=$(i(t.group.name));_(()=>{t.group.id&&n(u,i(t.group.name))});async function y(b,g){if(n(v,""),e(u)!==t.group.name&&t.groups.find(r=>r.name===e(u))){n(v,i(f.common.nameExistsAlready));return}let w={group:e(u)},s=await de(b.action,w);s.error?n(v,i(s.error.message)):(n(a,!0),t.onSave(),setTimeout(()=>{n(a,!1)},2e3))}var h=V(()=>`/auth/v1/groups/${t.group.id}`);ee(k,{get action(){return e(h)},onSubmit:y,children:(b,g)=>{var w=xe(),s=D(w);$e(s,{label:"ID",mono:!0,children:(o,l)=>{J();var m=W();F(()=>q(m,t.group.id)),c(o,m)},$$slots:{default:!0}});var r=C(s,2);Z(r,{autocomplete:"off",get label(){return f.groups.name},get placeholder(){return f.groups.name},width:"14.5rem",required:!0,pattern:P,get value(){return e(u)},set value(o){n(u,i(o))}});var d=C(r,2),O=G(d);X(O,{type:"submit",children:(o,l)=>{J();var m=W();F(()=>q(m,E.common.save)),c(o,m)},$$slots:{default:!0}});var j=C(O,2);{var p=o=>{he(o,{})};R(j,o=>{e(a)&&o(p)})}L(d);var A=C(d,2);{var N=o=>{var l=Te(),m=G(l,!0);L(l),F(()=>q(m,e(v))),c(o,l)};R(A,o=>{e(v)&&o(N)})}c(b,w)},$$slots:{default:!0}}),H()}var ke=x('<div class="err"> </div>'),Ee=x("<p> </p> <!> <!>",1);function Ie(k,t){Y(t,!0);let E=U(),f=K(),v=$("");async function a(){n(v,"");let s=await ce(`/auth/v1/groups/${t.group.id}`);s.error?n(v,i(s.error.message)):t.onSave()}var u=Ee(),y=D(u),h=G(y,!0);L(y);var b=C(y,2);X(b,{level:-1,onclick:a,children:(s,r)=>{J();var d=W();F(()=>q(d,E.common.delete)),c(s,d)},$$slots:{default:!0}});var g=C(b,2);{var w=s=>{var r=ke(),d=G(r,!0);L(r),F(()=>q(d,e(v))),c(s,r)};R(g,s=>{e(v)&&s(w)})}F(()=>q(h,f.groups.delete1)),c(k,u),H()}var Oe=x('<div class="flex"><!></div> <!>',1);function Fe(k,t){Y(t,!0);let E=U(),f=K();const v=[f.nav.config,E.common.delete];let a=$(i(v[0])),u=$(void 0);_(()=>{t.group.id&&requestAnimationFrame(()=>{var r;(r=e(u))==null||r()})});var y=Oe(),h=D(y),b=G(h);fe(b,{tabs:v,get selected(){return e(a)},set selected(r){n(a,i(r))},get focusFirst(){return e(u)},set focusFirst(r){n(u,i(r))}}),L(h);var g=C(h,2);{var w=r=>{Ce(r,{get group(){return t.group},get groups(){return t.groups},get onSave(){return t.onSave}})},s=r=>{var d=oe(),O=D(d);{var j=p=>{Ie(p,{get group(){return t.group},get onSave(){return t.onSave}})};R(O,p=>{e(a)===E.common.delete&&p(j)},!0)}c(r,d)};R(g,r=>{e(a)===f.nav.config?r(w):r(s,!1)})}c(k,y),H()}var qe=x("<div></div> <!>",1),Ae=x("<!> <!>",1),De=x('<div class="err"> </div>'),Ge=x('<!> <div id="groups"><!></div>',1),Le=x("<!> <!>",1);function Ne(k,t){Y(t,!0);let E=K(),f=$(void 0),v=$(""),a=$(i([])),u=$(i([])),y=$(void 0),h=ge("gid");const b=[E.common.name,"ID"];let g=$(i(b[0])),w=$("");const s=[E.common.name,"ID"];te(()=>{r()}),_(()=>{n(y,i(e(a).find(o=>o.id===h.get())))}),_(()=>{let o=e(w).toLowerCase();o?e(g)===b[0]?n(u,i(e(a).filter(l=>{var m;return(m=l.name)==null?void 0:m.toLowerCase().includes(o)}))):e(g)===b[1]&&n(u,i(e(a).filter(l=>l.id.toLowerCase().includes(o)))):n(u,i(e(a)))});async function r(){var l;let o=await pe("/auth/v1/groups");o.body?n(a,i(o.body)):n(v,i(((l=o.error)==null?void 0:l.message)||"Error"))}function d(o,l){let m=l==="up";o===s[0]?e(a).sort((S,T)=>m?S.name.localeCompare(T.name):T.name.localeCompare(S.name)):o===s[1]&&e(a).sort((S,T)=>m?S.id.localeCompare(T.id):T.id.localeCompare(S.id))}function O(){r()}async function j(o){var l;(l=e(f))==null||l(),await r(),h.set(o)}var p=Le(),A=D(p);le(A,{paddingTop:"2.1rem",buttonTilesAriaControls:"groups",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:o=>{var l=qe(),m=D(l);se(m,"height",".5rem");var S=C(m,2);ae(S,17,()=>e(u),T=>T.id,(T,B)=>{var I=V(()=>h.get()===e(B).id);ue(T,{onclick:()=>h.set(e(B).id),get selected(){return e(I)},children:(Q,M)=>{J();var z=W();F(()=>q(z,e(B).name)),c(Q,z)},$$slots:{default:!0}})}),c(o,l)},children:(o,l)=>{var m=Ae(),S=D(m),T=V(()=>e(a).length===0?1:2);ne(S,{get level(){return e(T)},alignRight:!0,get closeModal(){return e(f)},set closeModal(I){n(f,i(I))},children:(I,Q)=>{Se(I,{onSave:j,get groups(){return e(a)}})},$$slots:{default:!0}});var B=C(S,2);me(B,{searchOptions:b,orderOptions:s,onChangeOrder:d,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(g)},set searchOption(I){n(g,i(I))},get value(){return e(w)},set value(I){n(w,i(I))}}),c(o,m)},$$slots:{buttonTiles:!0,default:!0}});var N=C(A,2);ie(N,{children:(o,l)=>{var m=Ge(),S=D(m);{var T=M=>{var z=De(),re=G(z,!0);L(z),F(()=>q(re,e(v))),c(M,z)};R(S,M=>{e(v)&&M(T)})}var B=C(S,2),I=G(B);{var Q=M=>{Fe(M,{get group(){return e(y)},get groups(){return e(a)},onSave:O})};R(I,M=>{e(y)&&M(Q)})}L(B),c(o,m)},$$slots:{default:!0}}),c(k,p),H()}function Be(k){Ne(k,{})}export{Be as component};

import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.Dmu0D13_.js";import{t as j,p as X,c as z,r as x,s as C,z as o,y as e,f as q,ar as H,a as ee,A as E,ab as ae,a6 as re,ap as Ce}from"../chunks/index-client.CVQra9Cu.js";import{s as F}from"../chunks/render.CkKFmY3E.js";import{i as D}from"../chunks/if._4yhN2kP.js";import{e as ce}from"../chunks/each.D7w_Y1pv.js";import{a as s,n as xe,d as J,t as S,e as de}from"../chunks/template.4ZWi6dE6.js";import{a as fe}from"../chunks/index.CkVfMYgG.js";import{p as n}from"../chunks/proxy.Dc6q2r8X.js";import{u as te}from"../chunks/i18n_admin.svelte.CtFnAESg.js";import{O as Se}from"../chunks/OrderSearchBar.BAXBsyAw.js";import{d as Me,c as Ee,b as Ie,f as he}from"../chunks/fetch.B_P4c8fm.js";import{C as Le}from"../chunks/ContentAdmin.p5jUo2m-.js";import{N as Te}from"../chunks/NavButtonTile.B87bIUim.js";import{B as Oe}from"../chunks/ButtonAddModal.W1tXC5iJ.js";import{N as Ae}from"../chunks/NavSub.BqNuX9Je.js";import{u as ze}from"../chunks/param.svelte.CY-AzddN.js";import{U as ie}from"../chunks/helpers.B0e_YzoL.js";import{B as ne}from"../chunks/Button.B6DffihK.js";import{I as ge}from"../chunks/Input.kE1yFgI6.js";import{I as Re}from"../chunks/IconCheck.jhQYM7vu.js";import{u as le}from"../chunks/i18n.svelte.DVZudxvm.js";import{F as be}from"../chunks/Form.9PZRDz5w.js";import{L as Ve}from"../chunks/LabeledValue.DfaotEKr.js";import{s as $e}from"../chunks/snippet.BBxd9sB6.js";import{b as je}from"../chunks/window.jqEf7WoA.js";import{p as ve}from"../chunks/props.BVYR8gU-.js";import{s as me}from"../chunks/class.BnbJV1WX.js";import{T as Fe}from"../chunks/Tooltip.Q92keWA_.js";import{M as Ke}from"../chunks/Modal.BoPoPiDZ.js";import{I as ue}from"../chunks/InputCheckbox.DJbEwO1k.js";import{f as we}from"../chunks/patterns.DpOwmcHv.js";import{T as De}from"../chunks/Tabs.BGGYqHwk.js";var Ne=xe(`<svg fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6
            18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75
            21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg>`);function qe(B,a){let G=ve(a,"opacity",3,.9),w=ve(a,"width",3,"1.5rem"),g=ve(a,"color",3,"currentColor");var d=Ne();me(d,"stroke-width",2),j(()=>{me(d,"stroke",g()),me(d,"width",w()),me(d,"opacity",G())}),s(B,d)}var Be=S('<div class="compact svelte-vpfafb"></div>'),Ge=S('<div class="boxes svelte-vpfafb"><div class="svelte-vpfafb"></div> <div class="svelte-vpfafb"></div></div>'),We=S("<h3><!></h3> <!> <!>",1),Ye=S('<div class="container svelte-vpfafb"><div class="items svelte-vpfafb"><div class="joined svelte-vpfafb"> </div> <div class="edit svelte-vpfafb"><!></div> <!></div> <div class="label font-label svelte-vpfafb"><!></div></div>');function ye(B,a){X(a,!0);let G=ve(a,"maxWidth",3,"467pt"),w=le(),g=te(),d=E(void 0),M=E(!1),u=E(void 0),y=ae(()=>e(d)&&e(d)<800),R=ae(()=>a.items.filter(f=>f.selected).map(f=>f.name).join(", "));var m=Ye(),I=z(m),l=z(I),t=z(l,!0);x(l);var k=C(l,2),V=z(k);ne(V,{invisible:!0,onclick:()=>o(M,!0),children:(f,_)=>{Fe(f,{get text(){return g.common.edit},children:(U,r)=>{qe(U,{width:"1.2rem"})},$$slots:{default:!0}})},$$slots:{default:!0}}),x(k);var O=C(k,2);Ke(O,{get showModal(){return e(M)},set showModal(f){o(M,n(f))},get closeModal(){return e(u)},set closeModal(f){o(u,n(f))},children:(f,_)=>{var U=We(),r=q(U),c=z(r);$e(c,()=>a.children),x(r);var p=C(r,2);{var A=h=>{var K=Be();ce(K,21,()=>a.items,v=>v.name,(v,T,b)=>{ue(v,{get ariaLabel(){return e(T).name},get checked(){return e(T).selected},set checked($){e(T).selected=$},children:($,Q)=>{H();var N=J();j(()=>F(N,e(T).name)),s($,N)},$$slots:{default:!0}})}),x(K),s(h,K)},L=h=>{var K=Ge(),v=z(K);ce(v,21,()=>a.items,b=>b.name,(b,$,Q)=>{var N=de(),se=q(N);{var pe=Z=>{ue(Z,{get ariaLabel(){return e($).name},get checked(){return e($).selected},set checked(P){e($).selected=P},children:(P,ke)=>{H();var oe=J();j(()=>F(oe,e($).name)),s(P,oe)},$$slots:{default:!0}})};D(se,Z=>{e($).selected||Z(pe)})}s(b,N)}),x(v);var T=C(v,2);ce(T,21,()=>a.items,b=>b.name,(b,$,Q)=>{var N=de(),se=q(N);{var pe=Z=>{ue(Z,{get ariaLabel(){return e($).name},get checked(){return e($).selected},set checked(P){e($).selected=P},children:(P,ke)=>{H();var oe=J();j(()=>F(oe,e($).name)),s(P,oe)},$$slots:{default:!0}})};D(se,Z=>{e($).selected&&Z(pe)})}s(b,N)}),x(T),x(K),s(h,K)};D(p,h=>{e(y)?h(A):h(L,!1)})}var Y=C(p,2);ne(Y,{onclick:()=>{var h;return(h=e(u))==null?void 0:h()},children:(h,K)=>{H();var v=J();j(()=>F(v,w.common.close)),s(h,v)},$$slots:{default:!0}}),s(f,U)},$$slots:{default:!0}}),x(I);var i=C(I,2),W=z(i);$e(W,()=>a.children),x(i),x(m),j(()=>{fe(m,"max-width",G()),F(t,e(R))}),je("innerWidth",f=>o(d,n(f))),s(B,m),ee()}var He=S("<p> </p>"),Je=S("<p> </p> <p> </p> <!> <!>",1),Ue=S('<div class="err"> </div>'),Ze=S('<div class="flex gap-05"><!> <!></div> <!>',1),Pe=S("<!> <!> <!> <!>",1);function _e(B,a){X(a,!0);let G=le(),w=te(),g=E(""),d=E(!1),M=ae(()=>ie(a.scope.name)),u=E(n(a.scope.name)),y=E(void 0),R=E(void 0);re(()=>{a.scope.id&&o(u,n(a.scope.name))}),re(()=>{ie(a.scope.name)?(o(y,void 0),o(R,void 0)):(o(y,n(a.attrs.map(l=>{var t;return{name:l.name,selected:((t=a.scope.attr_include_access)==null?void 0:t.includes(l.name))||!1}}).toSorted((l,t)=>l.name.localeCompare(t.name)))),o(R,n(a.attrs.map(l=>{var t;return{name:l.name,selected:((t=a.scope.attr_include_id)==null?void 0:t.includes(l.name))||!1}}).toSorted((l,t)=>l.name.localeCompare(t.name)))))});async function m(l,t){if(o(g,""),ie(e(u))||a.scopes.find(O=>O.name===e(u))){o(g,n(w.common.nameExistsAlready));return}let k={scope:e(u)};if(e(y)){let O=e(y).filter(i=>i.selected).map(i=>i.name);O.length>0&&(k.attr_include_access=O)}if(e(R)){let O=e(R).filter(i=>i.selected).map(i=>i.name);O.length>0&&(k.attr_include_id=O)}let V=await Me(l.action,k);V.error?o(g,n(V.error.message)):(o(d,!0),a.onSave(),setTimeout(()=>{o(d,!1)},2e3))}var I=ae(()=>`/auth/v1/scopes/${a.scope.id}`);be(B,{get action(){return e(I)},onSubmit:m,children:(l,t)=>{var k=Pe(),V=q(k);Ve(V,{label:"ID",mono:!0,children:(r,c)=>{H();var p=J();j(()=>F(p,a.scope.id)),s(r,p)},$$slots:{default:!0}});var O=C(V,2);ge(O,{autocomplete:"off",get label(){return w.scopes.name},get placeholder(){return w.scopes.name},get disabled(){return e(M)},width:"14.5rem",required:!0,pattern:we,get value(){return e(u)},set value(r){o(u,n(r))}});var i=C(O,2);{var W=r=>{var c=He(),p=z(c,!0);x(c),j(()=>F(p,w.scopes.defaultNoMod)),s(r,c)},f=r=>{var c=Je(),p=q(c),A=z(p,!0);x(p);var L=C(p,2),Y=z(L,!0);x(L);var h=C(L,2);{var K=b=>{ye(b,{get items(){return e(y)},set items($){o(y,n($))},children:($,Q)=>{H();var N=J("Access Token Mappings");s($,N)},$$slots:{default:!0}})};D(h,b=>{e(y)&&b(K)})}var v=C(h,2);{var T=b=>{ye(b,{get items(){return e(R)},set items($){o(R,n($))},children:($,Q)=>{H();var N=J("Id Token Mappings");s($,N)},$$slots:{default:!0}})};D(v,b=>{e(R)&&b(T)})}j(()=>{F(A,w.scopes.mapping1),F(Y,w.scopes.mapping2)}),s(r,c)};D(i,r=>{e(M)?r(W):r(f,!1)})}var _=C(i,2);{var U=r=>{var c=Ze(),p=q(c),A=z(p);ne(A,{type:"submit",children:(v,T)=>{H();var b=J();j(()=>F(b,G.common.save)),s(v,b)},$$slots:{default:!0}});var L=C(A,2);{var Y=v=>{Re(v,{})};D(L,v=>{e(d)&&v(Y)})}x(p);var h=C(p,2);{var K=v=>{var T=Ue(),b=z(T,!0);x(T),j(()=>F(b,e(g))),s(v,T)};D(h,v=>{e(g)&&v(K)})}s(r,c)};D(_,r=>{e(M)||r(U)})}s(l,k)},$$slots:{default:!0}}),ee()}var Qe=S("<p> </p>"),Xe=S('<div class="err"> </div>'),ea=S("<p> </p> <!> <!>",1);function aa(B,a){X(a,!0);let G=le(),w=te(),g=E("");async function d(){o(g,"");let m=await Ee(`/auth/v1/scopes/${a.scope.id}`);m.error?o(g,n(m.error.message)):a.onSave()}var M=de(),u=q(M);{var y=m=>{var I=Qe(),l=z(I,!0);x(I),j(()=>F(l,w.scopes.deleteDefault)),s(m,I)},R=m=>{var I=ea(),l=q(I),t=z(l,!0);x(l);var k=C(l,2);ne(k,{level:-1,onclick:d,children:(i,W)=>{H();var f=J();j(()=>F(f,G.common.delete)),s(i,f)},$$slots:{default:!0}});var V=C(k,2);{var O=i=>{var W=Xe(),f=z(W,!0);x(W),j(()=>F(f,e(g))),s(i,W)};D(V,i=>{e(g)&&i(O)})}j(()=>F(t,w.scopes.delete1)),s(m,I)};D(u,m=>{ie(a.scope.name)?m(y):m(R,!1)})}s(B,M),ee()}var ra=S('<div class="flex"><!></div> <!>',1);function ta(B,a){X(a,!0);let G=le(),w=te();const g=[w.nav.config,G.common.delete];let d=E(n(g[0])),M=E(void 0);re(()=>{a.scope.id&&requestAnimationFrame(()=>{var t;(t=e(M))==null||t()})});var u=ra(),y=q(u),R=z(y);De(R,{tabs:g,get selected(){return e(d)},set selected(t){o(d,n(t))},get focusFirst(){return e(M)},set focusFirst(t){o(M,n(t))}}),x(y);var m=C(y,2);{var I=t=>{_e(t,{get attrs(){return a.attrs},get scope(){return a.scope},get scopes(){return a.scopes},get onSave(){return a.onSave}})},l=t=>{var k=de(),V=q(k);{var O=i=>{aa(i,{get scope(){return a.scope},get onSave(){return a.onSave}})};D(V,i=>{e(d)===G.common.delete&&i(O)},!0)}s(t,k)};D(m,t=>{e(d)===w.nav.config?t(I):t(l,!1)})}s(B,u),ee()}var sa=S('<div class="err"> </div>'),oa=S("<!> <!> <!>",1),ia=S('<div class="container svelte-s1196z"><!></div>');function na(B,a){X(a,!0);let G=le(),w=te(),g=E(void 0),d=E(""),M=E("");re(()=>{requestAnimationFrame(()=>{var m;(m=e(g))==null||m.focus()})});async function u(m,I){var k;if(a.scopes.find(V=>V.name===e(M))){o(d,n(w.common.nameExistsAlready));return}o(d,"");let l={scope:e(M)},t=await Ie(m.action,l);t.body?a.onSave(t.body.id):o(d,n(((k=t.error)==null?void 0:k.message)||"Error"))}var y=ia(),R=z(y);be(R,{action:"/auth/v1/scopes",onSubmit:u,children:(m,I)=>{var l=oa(),t=q(l);ge(t,{autocomplete:"off",get label(){return w.scopes.name},get placeholder(){return w.scopes.name},required:!0,pattern:we,get ref(){return e(g)},set ref(i){o(g,n(i))},get value(){return e(M)},set value(i){o(M,n(i))}});var k=C(t,2);ne(k,{type:"submit",children:(i,W)=>{H();var f=J();j(()=>F(f,G.common.save)),s(i,f)},$$slots:{default:!0}});var V=C(k,2);{var O=i=>{var W=sa(),f=z(W,!0);x(W),j(()=>F(f,e(d))),s(i,W)};D(V,i=>{e(d)&&i(O)})}s(m,l)},$$slots:{default:!0}}),x(y),s(B,y),ee()}var la=S('<span class="default svelte-1bjjcss"><i>default</i></span>'),ca=S(" <!>",1),da=S("<div></div> <!>",1),va=S("<!> <!>",1),ma=S('<div class="err"> </div>'),pa=S('<!> <div id="scopes"><!></div>',1),ua=S("<!> <!>",1);function fa(B,a){X(a,!0);let G=te(),w=E(void 0),g=E(""),d=ze("sid"),M=E(n([])),u=E(n([])),y=E(n([])),R=E(void 0);const m=[G.common.name,"ID"];let I=E(n(m[0])),l=E("");const t=[G.common.name,"ID"];Ce(()=>{V(),k()}),re(()=>{o(R,n(e(u).find(r=>r.id===d.get())))}),re(()=>{let r=e(l).toLowerCase();r?e(I)===m[0]?o(y,n(e(u).filter(c=>{var p;return(p=c.name)==null?void 0:p.toLowerCase().includes(r)}))):e(I)===m[1]&&o(y,n(e(u).filter(c=>c.id.toLowerCase().includes(r)))):o(y,n(e(u)))});async function k(){var c;let r=await he("/auth/v1/users/attr");r.body?o(M,n(r.body.values)):o(g,n(((c=r.error)==null?void 0:c.message)||"Error"))}async function V(){var c;let r=await he("/auth/v1/scopes");r.body?o(u,n(r.body)):o(g,n(((c=r.error)==null?void 0:c.message)||"Error"))}function O(r,c){let p=c==="up";r===t[0]?e(u).sort((A,L)=>p?A.name.localeCompare(L.name):L.name.localeCompare(A.name)):r===t[1]&&e(u).sort((A,L)=>p?A.id.localeCompare(L.id):L.id.localeCompare(A.id))}function i(){V()}async function W(r){var c;(c=e(w))==null||c(),await V(),d.set(r)}var f=ua(),_=q(f);Ae(_,{paddingTop:"2.1rem",buttonTilesAriaControls:"scopes",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:r=>{var c=da(),p=q(c);fe(p,"height",".5rem");var A=C(p,2);ce(A,17,()=>e(y),L=>L.id,(L,Y)=>{var h=ae(()=>d.get()===e(Y).id);Te(L,{onclick:()=>d.set(e(Y).id),get selected(){return e(h)},children:(K,v)=>{H();var T=ca(),b=q(T),$=C(b);{var Q=N=>{var se=la();s(N,se)};D($,N=>{ie(e(Y).name)&&N(Q)})}j(()=>F(b,`${e(Y).name??""} `)),s(K,T)},$$slots:{default:!0}})}),s(r,c)},children:(r,c)=>{var p=va(),A=q(p),L=ae(()=>e(u).length===0?1:2);Oe(A,{get level(){return e(L)},alignRight:!0,get closeModal(){return e(w)},set closeModal(h){o(w,n(h))},children:(h,K)=>{na(h,{onSave:W,get scopes(){return e(u)}})},$$slots:{default:!0}});var Y=C(A,2);Se(Y,{searchOptions:m,orderOptions:t,onChangeOrder:O,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(I)},set searchOption(h){o(I,n(h))},get value(){return e(l)},set value(h){o(l,n(h))}}),s(r,p)},$$slots:{buttonTiles:!0,default:!0}});var U=C(_,2);Le(U,{children:(r,c)=>{var p=pa(),A=q(p);{var L=v=>{var T=ma(),b=z(T,!0);x(T),j(()=>F(b,e(g))),s(v,T)};D(A,v=>{e(g)&&v(L)})}var Y=C(A,2),h=z(Y);{var K=v=>{ta(v,{get attrs(){return e(M)},get scope(){return e(R)},get scopes(){return e(u)},onSave:i})};D(h,v=>{e(R)&&v(K)})}x(Y),s(r,p)},$$slots:{default:!0}}),s(B,f),ee()}function ha(B){fa(B,{})}export{ha as component};

import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.CyS2OsSI.js";import{p as d,o as m,a as f,$ as l}from"../chunks/index-client.Bsb9hq-M.js";import{h as _}from"../chunks/svelte-head.YbFS2hoE.js";import{i as g}from"../chunks/lifecycle.p6g1zolU.js";import{C as u,g as w,s as h,a as k,b as v,d as j,R as y,c as L}from"../chunks/helpers.Cfg4Q1a_.js";import{g as R,a as S}from"../chunks/dataFetching.D_YOETHp.js";import{u as s}from"../chunks/param.svelte.CjFurolb.js";function $(b,n){d(n,!1);let c=s("code"),p=s("state");m(async()=>{const a=new URLSearchParams;let t=y,o=p.get();o&&(o==="account"?t=L:o.startsWith("device")&&(t=`/auth/v1/${o}`));let i=c.get();if(!i){console.error("no `code` given");return}a.append("grant_type","authorization_code"),a.append("code",i),a.append("redirect_uri",t),a.append("client_id",u),a.append("code_verifier",w());let r=await R(a),e=await r.json();h(e.access_token),k(e.id_token),r=await S(e.access_token),e=await r.json(),v(e.csrf_token),j(),window.location.replace(t)}),g(),_(a=>{l.title="Login"}),f()}export{$ as component};

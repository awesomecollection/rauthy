import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.Dn68_YLB.js";import{p as Y,i as m,a as B,g as a,h as t,c as E,ap as q,s as g,r as y,t as z,f as X}from"../chunks/runtime.BsghBUX9.js";import{s as G}from"../chunks/render.CTp9lacC.js";import{e as ue}from"../chunks/each.URXtkKAp.js";import{a as v,d as F,t as p,e as me}from"../chunks/template.jENAUvUX.js";import{p as r}from"../chunks/proxy.YH42NwLs.js";import{o as Z}from"../chunks/index-client.ClP8y9aT.js";import{u as pe,v as fe,w as he,k as ge,x as we}from"../chunks/OptionSelect.Cn2sqgid.js";import{i as N}from"../chunks/if.6Ov_EDLa.js";import{p as M}from"../chunks/props.CslUVmW_.js";import{r as ee}from"../chunks/legacy-client.DY3VEcT0.js";import{E as te}from"../chunks/ExpandContainer.BAZSCBeT.js";import{c as se,a as re,I as oe}from"../chunks/Input.B4ccwD4n.js";import{X as ie,n as ne,Y as ve}from"../chunks/helpers.CBl6QeM5.js";import{B as ae}from"../chunks/Button.CHwcFOJ-.js";import{a as le,b as U,c as H}from"../chunks/index.G5lyZbma.js";import{T as ce}from"../chunks/Tooltip.D8Tbt6Nb.js";import{T as be}from"../chunks/TabBar.g4Oe_bq5.js";import{I as de}from"../chunks/ItemTiles.DWts52A9.js";import{O as $e,P as ye}from"../chunks/Pagination.C52gIDzw.js";var _e=p('<div class="header font-label svelte-r30xs6">ADD NEW SCOPE</div>'),Se=p('<div class="success svelte-r30xs6">Success</div>'),Ee=p('<div class="err svelte-r30xs6"> </div>'),Ce=p('<div class="container svelte-r30xs6"><!> <!> <!> <!></div>');function De(P,$){Y($,!0);let j=M($,"idx",31,()=>-1),s=m(void 0),c=m(r({scope:""})),f=m(""),w=m(!1),_=m(void 0),S=m(r({}));const T=se().shape({scope:re().trim().matches(ie,"Can only contain: 'a-z0-9-_/:*', length: 2-64")});ee(()=>{a(w)&&t(_,r(setTimeout(()=>{$.onSave(),t(w,!1),t(c,r({scope:""})),t(s,!1)},1500)))}),Z(()=>()=>clearTimeout(a(_)));async function C(){if(t(f,""),!await b()){t(f,"Invalid input");return}a(c).scope=a(c).scope.trim();let i=await pe(a(c));if(i.ok)t(w,!0);else{let d=await i.json();t(f,r(d.message))}}async function b(){try{return await T.validate(a(c),{abortEarly:!1}),t(S,r({})),!0}catch(i){return t(S,r(ne(i))),!1}}te(P,{get idx(){return j()},set idx(i){j(i)},get show(){return a(s)},set show(i){t(s,r(i))},header:i=>{var d=_e();v(i,d)},body:i=>{var d=Ce(),k=E(d);oe(k,{autocomplete:"off",placeholder:"Scope Name",get value(){return a(c).scope},set value(e){a(c).scope=e},get error(){return a(S).scope},set error(e){a(S).scope=e},$$events:{input:b},children:(e,l)=>{q();var I=F("SCOPE NAME");v(e,I)},$$slots:{default:!0}});var u=g(k,2);ae(u,{level:1,width:"4rem",$$events:{click:C},children:(e,l)=>{q();var I=F("SAVE");v(e,I)},$$slots:{default:!0}});var D=g(u,2);{var n=e=>{var l=Se();v(e,l)};N(D,e=>{a(w)&&e(n)})}var h=g(D,2);{var O=e=>{var l=Ee(),I=E(l,!0);y(l),z(()=>G(I,a(f))),v(e,l)};N(h,e=>{a(f)&&e(O)})}y(d),v(i,d)},$$slots:{header:!0,body:!0}}),B()}var Ie=p('<div class="desc svelte-guvobw"><p>Custom mappings cannot be done for OpenID default scopes and their names cannot be changed.</p></div>'),je=p('<div class="desc svelte-guvobw"><p>You can map custom scopes to attributes.<br> All additional attributes, that were configured, can have a custom value for each user.<br> When they are mapped to a scope, they can be included in the Access and / or ID Tokens.</p></div> <div class="unit svelte-guvobw"><div class="label svelte-guvobw">ACCESS TOKEN MAPPINGS</div> <!></div> <div class="unit svelte-guvobw"><div class="label svelte-guvobw">ID TOKEN MAPPINGS</div> <!></div>',1),ke=p('<div class="success svelte-guvobw">Success</div>'),xe=p('<div class="mainErr err svelte-guvobw"> </div>'),Te=p("<!> <!> <!>",1),Ae=p('<div class="container svelte-guvobw"><div class="unit svelte-guvobw"><div class="label font-label svelte-guvobw">ID</div> <div class="value font-mono svelte-guvobw"> </div></div> <!> <div class="separator"></div> <!> <!></div>');function Pe(P,$){Y($,!0);let j=M($,"attrs",27,()=>r([])),s=M($,"scope",31,()=>r({})),c=m(""),f=m(!1),w=m(void 0),_=m(!1),S=m(r([]));ee(()=>{a(f)&&t(w,r(setTimeout(()=>{t(f,!1),$.onSave()},2e3)))}),ee(()=>{j()&&t(S,r(j().map(o=>o.name)))}),Z(()=>(t(_,r(ve(s().name))),()=>clearTimeout(a(w))));let T=m(r({}));const C=se().shape({name:re().trim().matches(ie,"Can only contain: 'a-z0-9-_/:*', length: 2-64")});async function b(){if(t(c,""),!await i()){t(c,"Invalid input");return}let o={scope:s().name.trim()};s().attr_include_access.length>0&&(o.attr_include_access=s().attr_include_access),s().attr_include_id.length>0&&(o.attr_include_id=s().attr_include_id);let A=await fe(s().id,o);if(A.ok)t(f,!0);else{let x=await A.json();t(c,r(x.message))}}async function i(){try{return await C.validate(s(),{abortEarly:!1}),t(T,r({})),!0}catch(o){return t(T,r(ne(o))),!1}}var d=Ae(),k=E(d),u=g(E(k),2),D=E(u,!0);y(u),y(k);var n=g(k,2);oe(n,{autocomplete:"off",placeholder:"Scope Name",get disabled(){return a(_)},get value(){return s().name},set value(o){s(s().name=o,!0)},get error(){return a(T).name},set error(o){a(T).name=o},$$events:{input:i},children:(o,A)=>{q();var x=F("SCOPE NAME");v(o,x)},$$slots:{default:!0}});var h=g(n,4);{var O=o=>{var A=Ie();v(o,A)},e=o=>{var A=je(),x=g(X(A),2);le(x,"margin-top","-3px");var Q=g(E(x),2);de(Q,{get options(){return a(S)},searchThreshold:4,get items(){return s().attr_include_access},set items(W){s(s().attr_include_access=W,!0)}}),y(x);var V=g(x,2);le(V,"margin-top","-3px");var J=g(E(V),2);de(J,{get options(){return a(S)},searchThreshold:4,get items(){return s().attr_include_id},set items(W){s(s().attr_include_id=W,!0)}}),y(V),v(o,A)};N(h,o=>{a(_)?o(O):o(e,!1)})}var l=g(h,2);{var I=o=>{var A=Te(),x=X(A);ae(x,{level:1,width:"4rem",$$events:{click:b},children:(L,K)=>{q();var R=F("SAVE");v(L,R)},$$slots:{default:!0}});var Q=g(x,2);{var V=L=>{var K=ke();v(L,K)};N(Q,L=>{a(f)&&L(V)})}var J=g(Q,2);{var W=L=>{var K=xe(),R=E(K,!0);y(K),z(()=>G(R,a(c))),v(L,K)};N(J,L=>{a(c)&&L(W)})}v(o,A)};N(l,o=>{a(_)||o(I)})}y(d),z(()=>G(D,s().id)),v(P,d),B()}var Ne=p('<div class="label svelte-1jljqe9">OpenID default scopes cannot be deleted</div>'),Oe=p('<div class="err svelte-1jljqe9"> </div>'),Le=p('<div class="label svelte-1jljqe9">Are you sure, you want to delete this scope?</div> <!> <!>',1),qe=p('<div class="container svelte-1jljqe9"><!></div>');function ze(P,$){Y($,!0);let j=M($,"scope",19,()=>({})),s=m(!1),c=m("");async function f(){t(c,""),t(s,!0);let C=await he(j().id);if(C.ok)$.onSave();else{let b=await C.json();t(c,r(b.message))}t(s,!1)}var w=qe(),_=E(w);{var S=C=>{var b=Ne();v(C,b)},T=C=>{var b=Le(),i=g(X(b),2);ae(i,{level:1,get isLoading(){return a(s)},set isLoading(u){t(s,r(u))},$$events:{click:f},children:(u,D)=>{q();var n=F("DELETE");v(u,n)},$$slots:{default:!0}});var d=g(i,2);{var k=u=>{var D=Oe(),n=E(D,!0);y(D),z(()=>G(n,a(c))),v(u,D)};N(d,u=>{a(c)&&u(k)})}v(C,b)};N(_,C=>{ve(j().name)?C(S):C(T,!1)})}y(w),v(P,w),B()}var Ge=p('<div class="data font-mono svelte-115hohv"> </div>'),Me=p('<div class="data svelte-115hohv"> </div>'),Ke=p('<div class="header svelte-115hohv"><!> <!></div>'),Ve=p("<div><!></div>"),We=p("<div><!></div>"),Ye=p("<div><!> <!></div>");function Be(P,$){Y($,!0);let j=M($,"attrs",15),s=M($,"scope",31,()=>r({})),c=M($,"onSave",15),f=m(void 0);const w=["Config","Delete"];let _=m(r(w[0]));const S=200,T=S/2;function C(){t(f,!1),c()()}te(P,{get show(){return a(f)},set show(b){t(f,r(b))},header:b=>{var i=Ke(),d=E(i);ce(d,{text:"Scope ID",children:(u,D)=>{var n=Ge(),h=E(n,!0);y(n),z(()=>G(h,s().id)),v(u,n)},$$slots:{default:!0}});var k=g(d,2);ce(k,{text:"Scope Name",children:(u,D)=>{var n=Me(),h=E(n,!0);y(n),z(()=>G(h,s().name)),v(u,n)},$$slots:{default:!0}}),y(i),v(b,i)},body:b=>{var i=Ye(),d=E(i);be(d,{labels:w,get selected(){return a(_)},set selected(n){t(_,r(n))}});var k=g(d,2);{var u=n=>{var h=Ve(),O=E(h);Pe(O,{get attrs(){return j()},set attrs(e){j(e)},get scope(){return s()},set scope(e){s(e)},get onSave(){return c()},set onSave(e){c(e)}}),y(h),U(5,h,()=>H,()=>({delay:T,duration:S})),U(6,h,()=>H,()=>({duration:S})),v(n,h)},D=n=>{var h=me(),O=X(h);{var e=l=>{var I=We(),o=E(I);ze(o,{get scope(){return s()},onSave:C}),y(I),U(5,I,()=>H,()=>({delay:T,duration:S})),U(6,I,()=>H,()=>({duration:S})),v(l,I)};N(O,l=>{a(_)==="Delete"&&l(e)},!0)}v(n,h)};N(k,n=>{a(_)==="Config"?n(u):n(D,!1)})}y(i),v(b,i)},$$slots:{header:!0,body:!0}}),B()}var Xe=p('<div class="svelte-15sc49d"><!></div>'),Fe=p(' <div class="content"><!> <!> <div id="scopes" class="svelte-15sc49d"></div> <!> <div style="height: 20px"></div></div>',1);function Qe(P,$){Y($,!0);let j=m(r([])),s=m(""),c=m(r([])),f=m(r([])),w=m(r([])),_=m(""),S=[{label:"Name",callback:(e,l)=>e.name.toLowerCase().includes(l.toLowerCase())},{label:"ID",callback:(e,l)=>e.id.toLowerCase().includes(l.toLowerCase())}],T=[{label:"Name",callback:(e,l)=>e.name.localeCompare(l.name)},{label:"ID",callback:(e,l)=>e.id.localeCompare(l.id)}];Z(()=>{b(),C(),t(_,"")});async function C(){let e=await ge();if(!e.ok)t(s,"Error fetching attributes: "+e.body.message);else{let l=await e.json();t(j,r([...l.values]))}}async function b(){let e=await we(),l=await e.json();e.ok?t(c,r([...l])):t(s,r(l.message))}function i(){b()}q();var d=Fe(),k=X(d),u=g(k),D=E(u);$e(D,{get items(){return a(c)},searchOptions:S,orderOptions:T,get resItems(){return a(f)},set resItems(e){t(f,r(e))},get search(){return a(_)},set search(e){t(_,r(e))}});var n=g(D,2);De(n,{onSave:i});var h=g(n,2);ue(h,23,()=>a(w),e=>e.id,(e,l,I)=>{var o=Xe(),A=E(o);Be(A,{onSave:i,get attrs(){return a(j)},set attrs(x){t(j,r(x))},get scope(){return a(w)[a(I)]},set scope(x){a(w)[a(I)]=x}}),y(o),v(e,o)}),y(h);var O=g(h,2);ye(O,{get items(){return a(f)},set items(e){t(f,r(e))},get resItems(){return a(w)},set resItems(e){t(w,r(e))}}),q(2),y(u),z(()=>G(k,`${a(s)??""} `)),v(P,d),B()}function Ue(P){Qe(P,{})}export{Ue as component};

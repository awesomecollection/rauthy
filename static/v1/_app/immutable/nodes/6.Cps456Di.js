import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.BVESbwbj.js";import{p as X,s as y,c as n,u as t,r as v,t as R,a as F,O as J,f as Z,w as _,ap as Y,v as i}from"../chunks/runtime.BONl2e88.js";import{d as oe,e as ee,s as H,k as fe}from"../chunks/render.AqJWcVDb.js";import{i as P}from"../chunks/if.DS90EFHs.js";import{e as te,i as ie}from"../chunks/each.Bce--_O8.js";import{a as f,t as D,e as ae,d as V}from"../chunks/template.B7ldVCvc.js";import{d as he,a as W,c as B,b as le,e as ge}from"../chunks/index.BJiFQ8Di.js";import{p as b}from"../chunks/proxy.0BECmVET.js";import{o as se}from"../chunks/index-client.Bjp_k6xO.js";import{O as xe}from"../chunks/OrderSearchBar.DcBjpUC6.js";import{P as ye}from"../chunks/Pagination.DjghmVzr.js";import{B as Q}from"../chunks/Button.JPJkNEUa.js";import{G as we,H as be,I as $e,J as Ke,K as Se}from"../chunks/OptionSelect.TkTfcdPh.js";import{p as U,r as Ie}from"../chunks/props.BlbrNjWf.js";import{r as re}from"../chunks/legacy-client.D71ZcBDy.js";import{I as ne}from"../chunks/Input.KbCPDMgh.js";import{c as Ee,a as Ae}from"../chunks/index.esm.B2KJ0uBO.js";import{a2 as ke,y as ce,l as je,z as _e}from"../chunks/helpers.CQGRRstl.js";import{S as de}from"../chunks/Switch.DtMymIQe.js";import{a as ze,b as De}from"../chunks/input.DulBaC0z.js";import{E as Oe}from"../chunks/ExpandContainer.2O3yvOBK.js";import{T as Me}from"../chunks/Tooltip.BZNUXfH5.js";import{T as qe}from"../chunks/TabBar.u0W3le5w.js";import{I as Te,a as Ne,b as Pe,P as Ce}from"../chunks/PasswordInput.gsJfcUzM.js";var Ue=D('<div role="button" tabindex="0" class="cell pointer svelte-lgl56a"> </div>'),Ge=D('<div class="cell svelte-lgl56a"><input class="pointer svelte-lgl56a" type="checkbox"></div>'),Re=D('<div class="mr svelte-lgl56a"><div role="button" tabindex="0" class="label pointer svelte-lgl56a"> </div> <!></div>'),Ye=D('<div class="matrix svelte-lgl56a"><b>Access Rights</b> <div class="mr svelte-lgl56a"><div class="label svelte-lgl56a"></div> <!></div> <!></div>');function pe(N,p){X(p,!0);let u=U(p,"accessMatrix",15);U(p,"finalize",15)(o);const l=["Blacklist","Clients","Events","Generic","Groups","Roles","Secrets","Sessions","Scopes","UserAttributes","Users"],h=["create","read","update","delete"];let $=new Array(l.length).fill(!1),w=new Array(h.length).fill(!1);se(()=>{var s;S(),(s=p.apiKey)!=null&&s.access&&M()});function S(){let s=new Array(l.length);for(let d=0;d<l.length;d++){s[d]={group:l[d]};for(let r of h)s[d][r]=!1}u(s)}function M(){for(let s of p.apiKey.access){let d=l.findIndex(r=>r===s.group);for(let r of s.access_rights){let g=h.findIndex(k=>k===r);u(u()[d][h[g]]=!0,!0)}}}function o(){let s=[];for(let d=0;d<l.length;d++){let r=[];for(let g of h)u()[d][g]&&r.push(g);r.length>0&&s.push({group:l[d],access_rights:r})}return s}function c(s){$[s]=!$[s];const d=$[s];let r=u()[s];for(let g=0;g<h.length;g++)for(let k of Object.keys(r))k!=="group"&&(r[k]=d);u(u()[s]=r,!0)}function A(s){w[s]=!w[s];const d=w[s];for(let r=0;r<l.length;r++)u(u()[r][h[s]]=d,!0)}var j=Ye(),z=y(n(j),2),I=y(n(z),2);te(I,17,()=>h,ie,(s,d,r)=>{var g=Ue(),k=J(()=>A.bind(this,r));g.__click=function(...E){var e;(e=t(k))==null||e.apply(this,E)};var K=J(()=>A.bind(this,r)),T=n(g,!0);v(g),R(()=>H(T,h[r])),ee("keypress",g,function(...E){var e;(e=t(K))==null||e.apply(this,E)}),f(s,g)}),v(z);var O=y(z,2);{var m=s=>{var d=ae(),r=Z(d);te(r,17,()=>l,ie,(g,k,K)=>{var T=Re(),E=n(T),e=J(()=>c.bind(this,K));E.__click=function(...G){var C;(C=t(e))==null||C.apply(this,G)};var a=J(()=>c.bind(this,K)),x=n(E,!0);v(E);var q=y(E,2);te(q,17,()=>h,ie,(G,C)=>{var L=Ge(),ve=n(L);he(ve),v(L),ze(ve,()=>u()[K][t(C)],me=>u(u()[K][t(C)]=me,!0)),f(G,L)}),v(T),R(()=>H(x,l[K])),ee("keypress",E,function(...G){var C;(C=t(a))==null||C.apply(this,G)}),f(g,T)}),f(s,d)};P(O,s=>{u()&&s(m)})}return v(j),f(N,j),F({finalizeMatrix:o})}oe(["click"]);var He=D("<div><!></div>"),We=D('<div class="container svelte-ubtepy"><!> <div class="switch svelte-ubtepy">Key Expires: <!></div> <!> <!> <div class="saveBtn svelte-ubtepy"><!></div> <div class="err svelte-ubtepy"> </div></div>');function Be(N,p){X(p,!0);const u=new Date().toISOString().split(".")[0];let l=U(p,"apiKeys",19,()=>[]),h=U(p,"onSave",3,()=>{}),$=_(""),w=_(!1),S=_(void 0),M=_(void 0),o=b({name:"",exp:""}),c=_(b({}));const A=Ee().shape({name:Ae().required("Name is required").min(2).max(24).matches(ke,"Format: [a-zA-Z0-9_/-]{2,24}")});re(()=>{t(w)&&(o.exp=new Date().toISOString().split(".")[0])});async function j(){if(i($,""),!await z())return;let e={name:o.name,access:t(S)()};if(e.access.length===0){i($,"Grant the new API Key at least one permission");return}if(t(w)){let x=ce(o.exp);if(!x){i($,"Invalid Date Input: User Expires");return}e.exp=x}let a=await we(e);if(a.ok)h()();else{let x=await a.json();i($,b(x.message))}}async function z(){try{await A.validate(o,{abortEarly:!1}),i(c,b({}))}catch(e){return i(c,b(je(e))),!1}for(let e of l())if(e.name===o.name)return t(c).name="Name already exists",!1;return!0}var I=We(),O=n(I);ne(O,{width:"18rem",autocomplete:"off",placeholder:"Name",get value(){return o.name},set value(e){o.name=e},get error(){return t(c).name},set error(e){t(c).name=e},children:(e,a)=>{Y();var x=V("NAME");f(e,x)},$$slots:{default:!0}});var m=y(O,2),s=y(n(m));de(s,{get selected(){return t(w)},set selected(e){i(w,b(e))}}),v(m);var d=y(m,2);{var r=e=>{var a=He(),x=n(a);ne(x,{type:"datetime-local",step:"60",width:"18rem",min:u,max:"2099-01-01T00:00",get value(){return o.exp},set value(q){o.exp=q},children:(q,G)=>{Y();var C=V("EXPIRES");f(q,C)},$$slots:{default:!0}}),v(a),W(3,a,()=>B),f(e,a)};P(d,e=>{t(w)&&e(r)})}var g=y(d,2);pe(g,{get accessMatrix(){return t(M)},set accessMatrix(e){i(M,b(e))},get finalize(){return t(S)},set finalize(e){i(S,b(e))}});var k=y(g,2),K=n(k);Q(K,{level:1,$$events:{click:j},children:(e,a)=>{Y();var x=V("SAVE");f(e,x)},$$slots:{default:!0}}),v(k);var T=y(k,2),E=n(T,!0);v(T),v(I),R(()=>H(E,t($))),f(N,I),F()}var Ve=D("<div><!></div>"),Xe=D('<div class="success svelte-1a3jnb3">Success</div>'),Fe=D('<div class="mainErr err svelte-1a3jnb3"> </div>'),Le=D('<div class="container svelte-1a3jnb3"><div class="unit svelte-1a3jnb3"><div class="label svelte-1a3jnb3">Name</div> <div class="value svelte-1a3jnb3"> </div></div> <div class="switch svelte-1a3jnb3">Key Expires: <!></div> <!> <!> <!> <!> <!></div>');function Ze(N,p){X(p,!0);const u=new Date().toISOString().split(".")[0];let l=U(p,"apiKey",27,()=>b({})),h=_(""),$=_(!1),w=_(void 0),S=_(!!l().expires),M=_(void 0),o=_(void 0);re(()=>{t($)&&i(w,b(setTimeout(()=>{i($,!1),p.onSave()},2e3)))}),se(()=>()=>clearTimeout(t(w)));let c=b({exp:""});re(()=>{t(S)&&(c.exp=new Date().toISOString().split(".")[0])});async function A(){i(h,"");let a={name:l().name,access:t(o)()};if(a.access.length===0){i(h,"Grant the API Key at least one permission");return}if(t(S)){let q=ce(c.exp);if(!q){i(h,"Invalid Date Input: User Expires");return}a.exp=q}let x=await be(a);if(x.ok)p.onSave(),i($,!0);else{let q=await x.json();i(h,b(q.message))}}var j=Le(),z=n(j),I=y(n(z),2),O=n(I,!0);v(I),v(z);var m=y(z,2),s=y(n(m));de(s,{get selected(){return t(S)},set selected(a){i(S,b(a))}}),v(m);var d=y(m,2);{var r=a=>{var x=Ve(),q=n(x);ne(q,{type:"datetime-local",step:"60",width:"18rem",min:u,max:"2099-01-01T00:00",get value(){return c.exp},set value(G){c.exp=G},children:(G,C)=>{Y();var L=V("EXPIRES");f(G,L)},$$slots:{default:!0}}),v(x),W(3,x,()=>B),f(a,x)};P(d,a=>{t(S)&&a(r)})}var g=y(d,2);pe(g,{get apiKey(){return l()},get accessMatrix(){return t(M)},set accessMatrix(a){i(M,b(a))},get finalize(){return t(o)},set finalize(a){i(o,b(a))}});var k=y(g,2);Q(k,{level:1,width:"4rem",$$events:{click:A},children:(a,x)=>{Y();var q=V("SAVE");f(a,q)},$$slots:{default:!0}});var K=y(k,2);{var T=a=>{var x=Xe();f(a,x)};P(K,a=>{t($)&&a(T)})}var E=y(K,2);{var e=a=>{var x=Fe(),q=n(x,!0);v(x),R(()=>H(q,t(h))),f(a,x)};P(E,a=>{t(h)&&a(e)})}v(j),R(()=>H(O,l().name)),f(N,j),F()}var Je=D('<div class="err svelte-1jljqe9"> </div>'),Qe=D('<div class="container svelte-1jljqe9"><div class="label svelte-1jljqe9">Are you sure, you want to delete this ApiKey?</div> <!> <!></div>');function et(N,p){X(p,!0);let u=U(p,"apiKey",19,()=>({})),l=_("");async function h(){i(l,"");let o=await $e(u().name);if(o.ok)p.onSave();else{let c=await o.json();i(l,b(c.message))}}var $=Qe(),w=y(n($),2);Q(w,{level:1,$$events:{click:h},children:(o,c)=>{Y();var A=V("DELETE");f(o,A)},$$slots:{default:!0}});var S=y(w,2);{var M=o=>{var c=Je(),A=n(c,!0);v(c),R(()=>H(A,t(l))),f(o,c)};P(S,o=>{t(l)&&o(M)})}v($),f(N,$),F()}var tt=D('<div><div class="iconsOuter svelte-s24qr4"><div class="iconsInner svelte-s24qr4"><div role="button" tabindex="0" class="show svelte-s24qr4"><!></div> <div role="button" tabindex="0"><!></div></div></div> <textarea></textarea></div>');function ue(N,p){X(p,!0);let u=U(p,"value",3,""),l=U(p,"rows",3,10),h=U(p,"cols",3,60),$=U(p,"name",3,"default"),w=U(p,"show",15,!1),S=U(p,"width",3,"40rem"),M=Ie(p,["$$slots","$$events","$$legacy","value","rows","cols","name","show","width"]),o=_(""),c=_("");re(()=>{w()?i(c,u()):i(c,b(t(o)))}),se(()=>{for(let E=0;E<u().length;E++)i(o,t(o)+"*");i(c,b(t(o)))});function A(){navigator.clipboard.writeText(u())}function j(){w(!w())}var z=tt(),I=n(z),O=n(I),m=n(O);m.__click=j;var s=n(m);{var d=E=>{Ne(E,{width:22})},r=E=>{Pe(E,{width:22})};P(s,E=>{w()?E(d):E(r,!1)})}v(m);var g=y(m,2);g.__click=A;var k=n(g);Te(k,{}),v(g),v(O),v(I);var K=y(I,2);fe(K);let T;v(z),R(()=>{le(z,"width",`${S()}`),T=ge(K,T,{disabled:!0,name:$(),rows:l(),cols:h(),...M},"svelte-s24qr4"),le(K,"width",`${S()}`),le(K,"padding-right","2.75rem")}),ee("keypress",m,j),ee("keypress",g,A),De(K,()=>t(c),E=>i(c,E)),f(N,z),F()}oe(["click"]);var at=D(`<div class="secret font-mono svelte-1vixcxf"><!></div> <p class="svelte-1vixcxf">An API Key must be provided in the HTTP <span class="headerCodeSmall svelte-1vixcxf"><code>Authorization</code></span> header in the following format:</p> <p class="svelte-1vixcxf"><span class="headerCode svelte-1vixcxf"><b><code>API-Key YourSecretApiKeyHere</code></b></span></p> <p class="svelte-1vixcxf">You can use the following <code>curl</code> request to test your new Key:</p> <!> <p class="svelte-1vixcxf">If you don't have <code>jq</code> installed and the above fails:</p> <!>`,1),st=D(`<div class="container svelte-1vixcxf"><p class="svelte-1vixcxf">You Can generate a new secret for this API Key here.</p> <p class="svelte-1vixcxf">You will only see this secret once after the generation.
        When a new one has been generated, the old secret will be overridden permanently.
        This operation cannot be reverted!</p> <!> <!> <div class="err svelte-1vixcxf"> </div></div>`);function rt(N,p){X(p,!0);let u=_(""),l=_(""),h=_(""),$=_("");async function w(){let I=await Ke(p.apiKey.name);if(I.ok)i(l,b(await I.text())),i(h,`curl -s -H 'Authorization: API-Key ${t(l)}' ${window.location.origin}/auth/v1/api_keys/${p.apiKey.name}/test`),i($,`${t(h)} | jq`);else{let O=await I.json();i(u,b(O.message))}}var S=st(),M=y(n(S),4),o=J(()=>t(l)?3:1);Q(M,{get level(){return t(o)},width:"130px",$$events:{click:w},children:(I,O)=>{Y();var m=V("GENERATE NEW");f(I,m)},$$slots:{default:!0}});var c=y(M,2);{var A=I=>{var O=at(),m=Z(O),s=n(m);Ce(s,{autocomplete:"off",disabled:!0,showCopy:!0,width:"inherit",maxWidth:"800px",get value(){return t(l)},set value(g){i(l,b(g))},children:(g,k)=>{Y();var K=V("API KEY");f(g,K)},$$slots:{default:!0}}),v(m);var d=y(m,8);ue(d,{name:"id",rows:3,get value(){return t($)}});var r=y(d,4);ue(r,{name:"id",rows:3,get value(){return t(h)}}),W(3,m,()=>B),f(I,O)};P(c,I=>{t(l)&&I(A)})}var j=y(c,2),z=n(j,!0);v(j),v(S),R(()=>H(z,t(u))),f(N,S),F()}var it=D('<div class="data svelte-115hohv"> </div>'),lt=D('<div class="header svelte-115hohv"><div class="data svelte-115hohv"> </div> <!></div>'),nt=D("<div><!></div>"),vt=D("<div><!></div>"),ot=D("<div><!></div>"),ct=D("<div><!> <!></div>");function dt(N,p){X(p,!0);let u=U(p,"apiKey",31,()=>b({})),l=U(p,"onSave",11,()=>{}),h=_(void 0);const $=["Config","Secret","Delete"];let w=_(b($[0]));const S=200,M=S/2;function o(){i(h,!1),l()()}Oe(N,{get show(){return t(h)},set show(c){i(h,b(c))},header:c=>{var A=lt(),j=n(A),z=n(j,!0);v(j);var I=y(j,2);{var O=m=>{Me(m,{text:"Expiry",children:(s,d)=>{var r=it(),g=n(r,!0);R(()=>H(g,_e(u().expires))),v(r),f(s,r)},$$slots:{default:!0}})};P(I,m=>{u().expires&&m(O)})}v(A),R(()=>H(z,u().name)),f(c,A)},body:c=>{var A=ct(),j=n(A);qe(j,{labels:$,get selected(){return t(w)},set selected(m){i(w,b(m))}});var z=y(j,2);{var I=m=>{var s=nt(),d=n(s);Ze(d,{get onSave(){return l()},get apiKey(){return u()},set apiKey(r){u(r)}}),v(s),W(1,s,()=>B,()=>({delay:M,duration:S})),W(2,s,()=>B,()=>({duration:S})),f(m,s)},O=m=>{var s=ae(),d=Z(s);{var r=k=>{var K=vt(),T=n(K);rt(T,{get apiKey(){return u()}}),v(K),W(1,K,()=>B,()=>({delay:M,duration:S})),W(2,K,()=>B,()=>({duration:S})),f(k,K)},g=k=>{var K=ae(),T=Z(K);{var E=e=>{var a=ot(),x=n(a);et(x,{get apiKey(){return u()},onSave:o}),v(a),W(1,a,()=>B,()=>({delay:M,duration:S})),W(2,a,()=>B,()=>({duration:S})),f(e,a)};P(T,e=>{t(w)==="Delete"&&e(E)},!0)}f(k,K)};P(d,k=>{t(w)==="Secret"?k(r):k(g,!1)},!0)}f(m,s)};P(z,m=>{t(w)==="Config"?m(I):m(O,!1)})}v(A),f(c,A)},$$slots:{header:!0,body:!0}}),F()}var pt=D("<div><!></div>"),ut=D('<div class="svelte-1fzx60h">No Api Keys</div>'),mt=D(' <div class="content"><div class="top svelte-1fzx60h"><!> <div class="addNew svelte-1fzx60h"><!></div></div> <!> <div id="keys" class="svelte-1fzx60h"><!></div> <!> <div style="height: 20px"></div></div>',1);function ft(N,p){X(p,!0);let u=_(""),l=_(b([])),h=_(b([])),$=_(b([])),w=_(!1);const S=[{label:"Name",callback:(e,a)=>e.name.includes(a)}];let M=[{label:"Name",callback:(e,a)=>e.name.localeCompare(a.name)}];se(()=>{o()});async function o(){let e=await Se(),a=await e.json();e.ok?(i(l,b(a.keys)),i(w,!1)):i(u,b(a.message))}Y();var c=mt(),A=Z(c),j=y(A),z=n(j),I=n(z);xe(I,{get items(){return t(l)},searchOptions:S,orderOptions:M,get resItems(){return t(h)},set resItems(e){i(h,b(e))}});var O=y(I,2),m=n(O);Q(m,{level:3,$$events:{click:()=>i(w,!t(w))},children:(e,a)=>{Y();var x=V("NEW KEY");f(e,x)},$$slots:{default:!0}}),v(O),v(z);var s=y(z,2);{var d=e=>{var a=pt(),x=n(a);Be(x,{onSave:o,get apiKeys(){return t(l)}}),v(a),W(3,a,()=>B),f(e,a)};P(s,e=>{t(w)&&e(d)})}var r=y(s,2),g=n(r);{var k=e=>{var a=ut();f(e,a)},K=e=>{var a=ae(),x=Z(a);te(x,19,()=>t($),q=>q.name,(q,G,C)=>{dt(q,{onSave:o,get apiKey(){return t($)[t(C)]},set apiKey(L){t($)[t(C)]=L}})}),f(e,a)};P(g,e=>{t(l).length===0?e(k):e(K,!1)})}v(r);var T=y(r,2);{var E=e=>{ye(e,{get items(){return t(h)},set items(a){i(h,b(a))},get resItems(){return t($)},set resItems(a){i($,b(a))}})};P(T,e=>{t(l).length>0&&e(E)})}Y(2),v(j),R(()=>H(A,`${t(u)??""} `)),f(N,c),F()}function ht(N){ft(N,{})}export{ht as component};

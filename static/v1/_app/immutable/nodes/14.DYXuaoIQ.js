import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.Dmu0D13_.js";import{p as se,ap as ie,f as F,t as f,a as oe,z as u,s,y as e,A as T,c as o,r as n,ar as ne}from"../chunks/index-client.CVQra9Cu.js";import{s as m}from"../chunks/render.CkKFmY3E.js";import{i as z}from"../chunks/if._4yhN2kP.js";import{a as v,t as b,e as ce,d as de}from"../chunks/template.4ZWi6dE6.js";import{p as J}from"../chunks/proxy.Dc6q2r8X.js";import{B as ue}from"../chunks/Button.B6DffihK.js";import{I as c}from"../chunks/Input.kE1yFgI6.js";import{f as pe,d as _e}from"../chunks/fetch.B_P4c8fm.js";import{F as me}from"../chunks/Form.9PZRDz5w.js";import{u as ve}from"../chunks/i18n_admin.svelte.CtFnAESg.js";import{u as ye}from"../chunks/i18n.svelte.DVZudxvm.js";var ge=b('<div class="success svelte-maj8s4">Success</div>'),we=b('<div class="err"> </div>'),he=b('<div class="row svelte-maj8s4"><!> <!></div> <div class="row svelte-maj8s4"><!> <!></div> <div class="row svelte-maj8s4"><!> <!></div> <p> <br> </p> <div class="row svelte-maj8s4"><!> <!></div> <!> <!> <!>',1),fe=b("<h2> </h2> <p> </p> <!>",1);function be(P,O){se(O,!0);const i="160px";let l=ye(),y=ve(),p=T(""),x=T(!1),a=T(void 0);ie(async()=>{let d=await pe("/auth/v1/password_policy");if(d.body){let t=d.body;t.include_lower_case||(t.include_lower_case=0),t.include_upper_case||(t.include_upper_case=0),t.include_digits||(t.include_digits=0),t.include_special||(t.include_special=0),t.not_recently_used||(t.not_recently_used=0),t.valid_days||(t.valid_days=0),u(a,J(t))}else console.error(d.error)});async function Q(d,t){if(u(p,""),!e(a))return;if(e(a).length_max<e(a).length_min)return u(p,"Max Length cannot be lower than Min Length"),!1;if((e(a).include_digits||0)+(e(a).include_lower_case||0)+(e(a).include_upper_case||0)+(e(a).include_special||0)>e(a).length_max)return u(p,"The sum of all includes does not fit into Max Length"),!1;let g={length_min:e(a).length_min,length_max:e(a).length_max,not_recently_used:e(a).not_recently_used?e(a).not_recently_used:void 0,valid_days:e(a).valid_days?e(a).valid_days:void 0,include_digits:e(a).include_digits?e(a).include_digits:void 0,include_lower_case:e(a).include_lower_case?e(a).include_lower_case:void 0,include_upper_case:e(a).include_upper_case?e(a).include_upper_case:void 0,include_special:e(a).include_special?e(a).include_special:void 0},w=await _e(d.action,g);w.error?u(p,J(w.error.message)):(u(x,!0),setTimeout(()=>{u(x,!1)},3e3))}var A=fe(),M=F(A),U=o(M,!0);n(M);var j=s(M,2),V=o(j,!0);n(j);var W=s(j,2);me(W,{action:"/auth/v1/password_policy",onSubmit:Q,children:(d,t)=>{var g=ce(),w=F(g);{var X=$=>{var B=he(),D=F(B),I=o(D);c(I,{typ:"number",get label(){return l.passwordPolicy.lengthMin},get placeholder(){return l.passwordPolicy.lengthMin},autocomplete:"off",min:"8",max:"128",required:!0,width:i,get value(){return e(a).length_min},set value(r){e(a).length_min=r}});var Y=s(I,2);c(Y,{typ:"number",get label(){return l.passwordPolicy.lengthMax},get placeholder(){return l.passwordPolicy.lengthMax},autocomplete:"off",min:"8",max:"128",required:!0,width:i,get value(){return e(a).length_max},set value(r){e(a).length_max=r}}),n(D);var L=s(D,2),N=o(L);c(N,{typ:"number",get label(){return l.passwordPolicy.lowercaseMin},get placeholder(){return l.passwordPolicy.lowercaseMin},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).include_lower_case},set value(r){e(a).include_lower_case=r}});var Z=s(N,2);c(Z,{typ:"number",get label(){return l.passwordPolicy.uppercaseMin},get placeholder(){return l.passwordPolicy.uppercaseMin},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).include_upper_case},set value(r){e(a).include_upper_case=r}}),n(L);var R=s(L,2),k=o(R);c(k,{typ:"number",get label(){return l.passwordPolicy.digitsMin},get placeholder(){return l.passwordPolicy.digitsMin},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).include_digits},set value(r){e(a).include_digits=r}});var K=s(k,2);c(K,{typ:"number",get label(){return l.passwordPolicy.specialMin},get placeholder(){return l.passwordPolicy.specialMin},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).include_special},set value(r){e(a).include_special=r}}),n(R);var S=s(R,2),C=o(S,!0),ee=s(C,2);n(S);var q=s(S,2),E=o(q);c(E,{typ:"number",get label(){return l.passwordPolicy.notRecent},get placeholder(){return l.passwordPolicy.notRecent},autocomplete:"off",min:"0",max:"32",width:i,get value(){return e(a).not_recently_used},set value(r){e(a).not_recently_used=r}});var ae=s(E,2);c(ae,{typ:"number",get label(){return y.passwordPolicy.validForDays},get placeholder(){return y.passwordPolicy.validForDays},autocomplete:"off",min:"0",max:"3650",width:i,get value(){return e(a).valid_days},set value(r){e(a).valid_days=r}}),n(q);var G=s(q,2);ue(G,{type:"submit",children:(r,_)=>{ne();var h=de();f(()=>m(h,l.common.save)),v(r,h)},$$slots:{default:!0}});var H=s(G,2);{var re=r=>{var _=ge();v(r,_)};z(H,r=>{e(x)&&r(re)})}var le=s(H,2);{var te=r=>{var _=we(),h=o(_,!0);n(_),f(()=>m(h,e(p))),v(r,_)};z(le,r=>{e(p)&&r(te)})}f(()=>{m(C,y.passwordPolicy.validityNew),m(ee,` ${y.passwordPolicy.resetSet0??""}`)}),v($,B)};z(w,$=>{e(a)&&$(X)})}v(d,g)},$$slots:{default:!0}}),f(()=>{m(U,l.passwordPolicy.passwordPolicy),m(V,y.passwordPolicy.configDesc)}),v(P,A),oe()}function Pe(P){be(P,{})}export{Pe as component};

import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.Dmu0D13_.js";import{p as Y,a6 as _,y as e,f as q,z as n,s as D,t as x,a as j,A as $,c as k,ar as H,r as z,ab as V,ap as re}from"../chunks/index-client.CVQra9Cu.js";import{s as E}from"../chunks/render.CkKFmY3E.js";import{i as M}from"../chunks/if._4yhN2kP.js";import{e as oe}from"../chunks/each.D7w_Y1pv.js";import{d as J,a as d,t as I,e as te}from"../chunks/template.4ZWi6dE6.js";import{a as ae}from"../chunks/index.CkVfMYgG.js";import{p as i}from"../chunks/proxy.Dc6q2r8X.js";import{u as K}from"../chunks/i18n_admin.svelte.DBF4IRUg.js";import{B as se}from"../chunks/ButtonAddModal.B1jk33x3.js";import{C as ne}from"../chunks/ContentAdmin.p5jUo2m-.js";import{N as ie}from"../chunks/NavButtonTile.B87bIUim.js";import{N as ue}from"../chunks/NavSub.CPeQMNZ5.js";import{O as me}from"../chunks/OrderSearchBar.BK-vyt5G.js";import{b as le,d as ve,c as de,f as ce}from"../chunks/fetch.BnpwKXAn.js";import{u as pe}from"../chunks/param.svelte.CAlaz0Tl.js";import{B as X}from"../chunks/Button.B6DffihK.js";import{I as Z}from"../chunks/Input.E2qlCEoO.js";import{d as ge}from"../chunks/patterns.CpCrQ-Dx.js";import{F as P}from"../chunks/Form.BiuDxuNH.js";import{u as U}from"../chunks/i18n.svelte.DVZudxvm.js";import{T as fe}from"../chunks/Tabs.BGGYqHwk.js";import{I as he}from"../chunks/IconCheck.jhQYM7vu.js";import{L as $e}from"../chunks/LabeledValue.DfaotEKr.js";var be=I('<div class="err"> </div>'),ye=I("<!> <!> <!>",1),we=I('<div class="container svelte-s1196z"><!></div>');function Se(N,t){Y(t,!0);let O=U(),f=K(),l=$(void 0),o=$(""),m=$("");_(()=>{requestAnimationFrame(()=>{var g;(g=e(l))==null||g.focus()})});async function y(g,w){var c;if(t.groups.find(F=>F.name===e(m))){n(o,i(f.common.nameExistsAlready));return}n(o,"");let s={group:e(m)},r=await le(g.action,s);r.body?t.onSave(r.body.id):n(o,i(((c=r.error)==null?void 0:c.message)||"Error"))}var h=we(),b=k(h);P(b,{action:"/auth/v1/groups",onSubmit:y,children:(g,w)=>{var s=ye(),r=q(s);Z(r,{autocomplete:"off",get label(){return f.groups.name},get placeholder(){return f.groups.name},required:!0,pattern:ge,get ref(){return e(l)},set ref(p){n(l,i(p))},get value(){return e(m)},set value(p){n(m,i(p))}});var c=D(r,2);X(c,{type:"submit",children:(p,L)=>{H();var v=J();x(()=>E(v,O.common.save)),d(p,v)},$$slots:{default:!0}});var F=D(c,2);{var R=p=>{var L=be(),v=k(L,!0);z(L),x(()=>E(v,e(o))),d(p,L)};M(F,p=>{e(o)&&p(R)})}d(g,s)},$$slots:{default:!0}}),z(h),d(N,h),j()}var Te=I('<div class="err"> </div>'),Ce=I("<!> <!> <!> <!> <!>",1);function De(N,t){Y(t,!0);let O=U(),f=K(),l=$(""),o=$(!1),m=$(i(t.group.name));_(()=>{t.group.id&&n(m,i(t.group.name))});async function y(b,g){if(n(l,""),t.groups.find(r=>r.name===e(m))){n(l,i(f.common.nameExistsAlready));return}let w={group:e(m)},s=await ve(b.action,w);s.error?n(l,i(s.error.message)):(n(o,!0),setTimeout(()=>{n(o,!1),t.onSave()},2e3))}var h=V(()=>`/auth/v1/groups/${t.group.id}`);P(N,{get action(){return e(h)},onSubmit:y,children:(b,g)=>{var w=Ce(),s=q(w);$e(s,{label:"ID",mono:!0,children:(v,a)=>{H();var u=J();x(()=>E(u,t.group.id)),d(v,u)},$$slots:{default:!0}});var r=D(s,2);Z(r,{autocomplete:"off",get label(){return f.groups.name},get placeholder(){return f.groups.name},width:"14.5rem",get value(){return e(m)},set value(v){n(m,i(v))}});var c=D(r,2);X(c,{type:"submit",children:(v,a)=>{H();var u=J();x(()=>E(u,O.common.save)),d(v,u)},$$slots:{default:!0}});var F=D(c,2);{var R=v=>{he(v,{})};M(F,v=>{e(o)&&v(R)})}var p=D(F,2);{var L=v=>{var a=Te(),u=k(a,!0);z(a),x(()=>E(u,e(l))),d(v,a)};M(p,v=>{e(l)&&v(L)})}d(b,w)},$$slots:{default:!0}}),j()}var Ie=I('<div class="err"> </div>'),Ne=I("<p> </p> <!> <!>",1);function Oe(N,t){Y(t,!0);let O=U(),f=K(),l=$("");async function o(){n(l,"");let s=await de(`/auth/v1/groups/${t.group.id}`);s.error?n(l,i(s.error.message)):t.onSave()}var m=Ne(),y=q(m),h=k(y,!0);z(y);var b=D(y,2);X(b,{level:-1,onclick:o,children:(s,r)=>{H();var c=J();x(()=>E(c,O.common.delete)),d(s,c)},$$slots:{default:!0}});var g=D(b,2);{var w=s=>{var r=Ie(),c=k(r,!0);z(r),x(()=>E(c,e(l))),d(s,r)};M(g,s=>{e(l)&&s(w)})}x(()=>E(h,f.groups.delete1)),d(N,m),j()}var Ae=I('<div class="flex"><!></div> <!>',1);function Fe(N,t){Y(t,!0);let O=U(),f=K();const l=[f.nav.config,O.common.delete];let o=$(i(l[0])),m=$(void 0);_(()=>{t.group.id&&requestAnimationFrame(()=>{var r;(r=e(m))==null||r()})});var y=Ae(),h=q(y),b=k(h);fe(b,{tabs:l,get selected(){return e(o)},set selected(r){n(o,i(r))},get focusFirst(){return e(m)},set focusFirst(r){n(m,i(r))}}),z(h);var g=D(h,2);{var w=r=>{De(r,{get group(){return t.group},get groups(){return t.groups},get onSave(){return t.onSave}})},s=r=>{var c=te(),F=q(c);{var R=p=>{Oe(p,{get group(){return t.group},get onSave(){return t.onSave}})};M(F,p=>{e(o)===O.common.delete&&p(R)},!0)}d(r,c)};M(g,r=>{e(o)===f.nav.config?r(w):r(s,!1)})}d(N,y),j()}var xe=I("<div></div> <!>",1),Ee=I("<!> <!>",1),Le=I('<div class="err"> </div>'),qe=I('<!> <div id="groups"><!></div>',1),Be=I("<!> <!>",1);function Ge(N,t){Y(t,!0);let O=K(),f=$(void 0),l=$(""),o=$(i([])),m=$(i([])),y=$(void 0),h=pe("gid");const b=[O.common.name,"ID"];let g=$(i(b[0])),w=$("");const s=[O.common.name,"ID"];re(()=>{r()}),_(()=>{n(y,i(e(o).find(a=>a.id===h.get())))}),_(()=>{let a=e(w).toLowerCase();a?e(g)===b[0]?n(m,i(e(o).filter(u=>{var S;return(S=u.name)==null?void 0:S.toLowerCase().includes(a)}))):e(g)===b[1]&&n(m,i(e(o).filter(u=>u.id.toLowerCase().includes(a)))):n(m,i(e(o)))});async function r(){var u;let a=await ce("/auth/v1/groups");a.body?n(o,i(a.body)):n(l,i(((u=a.error)==null?void 0:u.message)||"Error"))}function c(a,u){let S=u==="up";a===s[0]?e(o).sort((T,C)=>S?T.name.localeCompare(C.name):C.name.localeCompare(T.name)):a===s[1]&&e(o).sort((T,C)=>S?T.id.localeCompare(C.id):C.id.localeCompare(T.id))}function F(){r()}async function R(a){var u;(u=e(f))==null||u(),await r(),h.set(a)}var p=Be(),L=q(p);ue(L,{paddingTop:"2.1rem",buttonTilesAriaControls:"groups",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:a=>{var u=xe(),S=q(u);ae(S,"height",".5rem");var T=D(S,2);oe(T,17,()=>e(m),C=>C.id,(C,B)=>{var A=V(()=>h.get()===e(B).id);ie(C,{onclick:()=>h.set(e(B).id),get selected(){return e(A)},children:(Q,G)=>{H();var W=J();x(()=>E(W,e(B).name)),d(Q,W)},$$slots:{default:!0}})}),d(a,u)},children:(a,u)=>{var S=Ee(),T=q(S),C=V(()=>e(o).length===0?1:2);se(T,{get level(){return e(C)},alignRight:!0,get closeModal(){return e(f)},set closeModal(A){n(f,i(A))},children:(A,Q)=>{Se(A,{onSave:R,get groups(){return e(o)}})},$$slots:{default:!0}});var B=D(T,2);me(B,{searchOptions:b,orderOptions:s,onChangeOrder:c,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(g)},set searchOption(A){n(g,i(A))},get value(){return e(w)},set value(A){n(w,i(A))}}),d(a,S)},$$slots:{buttonTiles:!0,default:!0}});var v=D(L,2);ne(v,{children:(a,u)=>{var S=qe(),T=q(S);{var C=G=>{var W=Le(),ee=k(W,!0);z(W),x(()=>E(ee,e(l))),d(G,W)};M(T,G=>{e(l)&&G(C)})}var B=D(T,2),A=k(B);{var Q=G=>{Fe(G,{get group(){return e(y)},get groups(){return e(o)},onSave:F})};M(A,G=>{e(y)&&G(Q)})}z(B),d(a,S)},$$slots:{default:!0}}),d(N,p),j()}function ke(N){Ge(N,{})}export{ke as component};

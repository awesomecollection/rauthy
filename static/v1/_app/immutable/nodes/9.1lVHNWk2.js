import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DUFkTaXF.js";import{p as de,i as u,ao as ce,f as G,t as D,a as ne,h as r,s as v,g as t,aq as w,c as l,r as o}from"../chunks/index-client.CzvcfCLI.js";import{d as me,e as fe,s as N}from"../chunks/render.BJBkrb2f.js";import{i as L}from"../chunks/if.Dlf0zx3_.js";import{e as ue}from"../chunks/each.BtetwUOf.js";import{a as p,t as k,d as q,e as he}from"../chunks/template.CQASMEo4.js";import{t as we,a as Ie}from"../chunks/index.CqGLefLa.js";import{p as i}from"../chunks/proxy.CHyqegA9.js";import{r as ge}from"../chunks/legacy-client.CQT_jR_Y.js";import{a as xe,T as $e,P as ke}from"../chunks/Pagination.B865uVVG.js";import{g as ye,p as Pe,d as be}from"../chunks/dataFetchingAdmin.D6QJ_imf.js";import{B as H}from"../chunks/Button.BMVss8ej.js";import{c as Se,a as Ee,I as J}from"../chunks/Input.BmqIhqeF.js";import{A as Be,B as De,o as Ne,k as qe}from"../chunks/helpers.kNqlWGzE.js";import{I as Ae}from"../chunks/IconStop.COW-Xmqv.js";var Oe=k('<div class="addNewInputs svelte-1fhw572"><!> <!> <div class="saveBtn svelte-1fhw572"><!></div> <div class="err svelte-1fhw572"> </div></div>'),Te=k('<div class="svelte-1fhw572">No blacklisted IPs</div>'),_e=(y,A,P)=>A(t(P).ip),je=k('<div role="button" tabindex="0" class="delete svelte-1fhw572"><!></div>'),Ce=k('<div class="blacklisted svelte-1fhw572"><div class="ip svelte-1fhw572"> </div> <div class="exp svelte-1fhw572"> </div> <!></div>'),Le=k(' <div class="content"><div class="top svelte-1fhw572"><!> <div class="addNew svelte-1fhw572"><!></div></div> <!> <div id="blacklist" class="svelte-1fhw572"><!></div> <!> <div style="height: 20px"></div></div>',1);function Ve(y,A){de(A,!0);let P=u(""),I=u(""),b=u(i([])),S=u(i([])),O=u(i([])),g=u(!1),d=i({ip:"",exp:""}),E=u(i({}));const M=Se().shape({ip:Ee().required("IP is required").matches(Be,"Invalid IPv4")}),Q=new Date().toISOString().split(".")[0],W=[{label:"IP",callback:(e,a)=>e.ip.includes(a)}];let Y=[{label:"IP",callback:(e,a)=>e.ip.localeCompare(a.ip)}];ge(()=>{t(g)&&(r(I,""),d.exp=new Date().toISOString().split(".")[0])}),ce(()=>{T()});async function T(){let e=await ye(),a=await e.json();e.ok?r(b,i(a.ips)):r(P,i(a.message))}async function Z(){if(r(I,""),!await ee())return;let e=De(d.exp);if(!e){r(I,"Invalid Date Input: User Expires");return}let a={ip:d.ip,exp:e},c=await Pe(a);if(c.ok)r(g,!1),d.ip="",await T();else{let n=await c.json();r(I,i(n.message))}}async function V(e){(await be(e)).ok&&await T()}async function ee(){try{return await M.validate(d,{abortEarly:!1}),r(E,i({})),!0}catch(e){return r(E,i(Ne(e))),!1}}w();var F=Le(),K=G(F),R=v(K),_=l(R),U=l(_);xe(U,{get items(){return t(b)},searchOptions:W,orderOptions:Y,get resItems(){return t(S)},set resItems(e){r(S,i(e))}});var X=v(U,2),ae=l(X);H(ae,{level:3,$$events:{click:()=>r(g,!t(g))},children:(e,a)=>{w();var c=q("BLACKLIST IP");p(e,c)},$$slots:{default:!0}}),o(X),o(_);var z=v(_,2);{var te=e=>{var a=Oe(),c=l(a);J(c,{width:"9.5rem",autocomplete:"off",placeholder:"IP",get value(){return d.ip},set value(s){d.ip=s},get error(){return t(E).ip},set error(s){t(E).ip=s},children:(s,B)=>{w();var f=q("IP");p(s,f)},$$slots:{default:!0}});var n=v(c,2);J(n,{type:"datetime-local",step:"60",width:"18rem",min:Q,max:"2099-01-01T00:00",get value(){return d.exp},set value(s){d.exp=s},children:(s,B)=>{w();var f=q("EXPIRES");p(s,f)},$$slots:{default:!0}});var m=v(n,2),x=l(m);H(x,{level:1,$$events:{click:Z},children:(s,B)=>{w();var f=q("SAVE");p(s,f)},$$slots:{default:!0}}),o(m);var h=v(m,2),C=l(h,!0);o(h),o(a),D(()=>N(C,t(I))),we(3,a,()=>Ie),p(e,a)};L(z,e=>{t(g)&&e(te)})}var j=v(z,2),se=l(j);{var re=e=>{var a=Te();p(e,a)},ie=e=>{var a=he(),c=G(a);ue(c,17,()=>t(O),n=>n.ip,(n,m)=>{var x=Ce(),h=l(x),C=l(h,!0);o(h);var s=v(h,2),B=l(s,!0);D(()=>N(B,qe(t(m).exp))),o(s);var f=v(s,2);$e(f,{text:"Delete IP",children:(ve,Ke)=>{var $=je();$.__click=[_e,V,m];var pe=l($);Ae(pe,{color:"var(--col-err)"}),o($),fe("keypress",$,()=>V(t(m).ip)),p(ve,$)},$$slots:{default:!0}}),o(x),D(()=>N(C,t(m).ip)),p(n,x)}),p(e,a)};L(se,e=>{t(b).length===0?e(re):e(ie,!1)})}o(j);var le=v(j,2);{var oe=e=>{ke(e,{get items(){return t(S)},set items(a){r(S,i(a))},get resItems(){return t(O)},set resItems(a){r(O,i(a))}})};L(le,e=>{t(b).length>0&&e(oe)})}w(2),o(R),D(()=>N(K,`${t(P)??""} `)),p(y,F),ne()}me(["click"]);function Fe(y){Ve(y,{})}export{Fe as component};

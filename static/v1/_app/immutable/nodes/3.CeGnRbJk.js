import"../chunks/disclose-version.BDr9Qe-U.js";import{a6 as D,a4 as se,p as Se,b as qe,a7 as i,a5 as c,a9 as o,a as Le,g as n,h as fe,a8 as Ee,a3 as q,j as m,d as ga,o as wa,$ as or}from"../chunks/index-client.Bsb9hq-M.js";import{h as ir}from"../chunks/svelte-head.YbFS2hoE.js";import{a as v,n as aa,c as Ie,t as x,b as Ce}from"../chunks/template.D54H5ZkF.js";import{i as A}from"../chunks/if.Mw_hWmq0.js";import{p as C}from"../chunks/proxy.DclUEOHG.js";import{d as Sa,e as Ze,s as w,r as lr,k as cr}from"../chunks/render.Cl_nSOQQ.js";import{I as La,h as ot,u as it,T as dr,S as lt,D as ct,b as vr}from"../chunks/Devices.Boz3jaXn.js";import{p as $}from"../chunks/props.CcMnSFiY.js";import{E as ta,Q as Na,_ as ur,P as mr,F as hr,y as dt,K as pr,v as fr,S as gr,z as wr,r as yr}from"../chunks/helpers.Cfg4Q1a_.js";import{B as Me,d as br,e as ra,a as ya,g as kr,h as Mr,i as ba,b as Ta,c as vt,f as va,T as xr}from"../chunks/ThemeSwitch.Zeh_8WtX.js";import{a as z,e as oe,g as ie,r as ut,b as Be,c as ja,f as na,t as Ra,s as ua}from"../chunks/index.DiuQmtU3.js";import{s as mt}from"../chunks/snippet.DdpBggvk.js";import{b as Pa}from"../chunks/this.C8ORjxiC.js";import{u as Ne}from"../chunks/i18n.svelte.B0RF3bDg.js";import{I as We,b as Ua,c as _r,d as ht,e as Dr}from"../chunks/patterns.CYl4_uw6.js";import{f as $r}from"../chunks/pow.C5_7nj9T.js";import{P as Ir,O as pt,L as zr}from"../chunks/LangSelector.4aRmjdrU.js";import{m as Er,j as Cr,n as Ar}from"../chunks/dataFetching.D_YOETHp.js";import{b as Ka,a as qa,W as ft}from"../chunks/WebauthnRequest.CFGMqx9K.js";import{P as Sr}from"../chunks/PasswordPolicy.0ZfnAjGI.js";import{C as Lr}from"../chunks/CheckIcon.BZFKcvGC.js";import{r as Nr}from"../chunks/legacy-client.QbOhT8wP.js";import{B as Tr}from"../chunks/Button.BbZR8hhL.js";import"../chunks/legacy.CyS2OsSI.js";import{T as jr}from"../chunks/Template.CCszvfWi.js";import{u as Rr}from"../chunks/param.svelte.CjFurolb.js";import{M as Pr,C as Ur}from"../chunks/ContentCenter.Dpb8rCa1.js";var Kr=aa('<svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path></svg>');function Ba(a,e){let t=$(e,"opacity",3,.9),r=$(e,"width",3,"1.5rem"),l=$(e,"color",3,"hsl(var(--action))");var s=Kr();z(s,"stroke-width",2),D(()=>{z(s,"width",r()),z(s,"color",l()),z(s,"opacity",t())}),v(a,s)}function Wa(a,e){var t=Ie(),r=se(t);{var l=d=>{Ba(d,{color:"hsl(var(--action))"})},s=d=>{La(d,{color:"hsl(var(--error))"})};A(r,d=>{e.checked?d(l):d(s,!1)})}v(a,t)}function qr(a,e,t){e()||t()}function Br(a){a.stopPropagation()}var Wr=x('<span class="closeIcon svelte-utq0b0"><!></span>'),Vr=x('<div class="relative"><div class="absolute close svelte-utq0b0"><!></div></div>'),Yr=x('<dialog aria-modal="true" class="svelte-utq0b0"><div role="none" class="svelte-utq0b0"><!> <!></div></dialog>');function Fr(a,e){Se(e,!0);let t=$(e,"showModal",15),r=$(e,"closeModal",15),l=$(e,"strict",3,!1),s=$(e,"prerender",3,!1),d=Ne(),h;qe(()=>{r(u)}),qe(()=>{t()&&(h==null||h.showModal())});function u(b){b==null||b.preventDefault(),h==null||h.close(),t(!1)}var f=Yr();f.__click=[qr,l,u];var g=i(f);g.__click=[Br];var R=i(g);{var _=b=>{var P=Vr(),F=i(P),K=i(F);Me(K,{get ariaLabel(){return d.common.close},invisible:!0,onclick:u,children:(Y,J)=>{var N=Wr(),G=i(N);La(G,{color:"currentColor",width:"1.2rem"}),o(N),v(Y,N)},$$slots:{default:!0}}),o(F),o(P),v(b,P)};A(R,b=>{l()||b(_)})}var L=c(R,2);{var E=b=>{var P=Ie(),F=se(P);mt(F,()=>e.children),v(b,P)};A(L,b=>{(s()||t())&&b(E)})}o(g),o(f),Pa(f,b=>h=b,()=>h),D(()=>z(f,"data-strict",l())),Ze("close",f,()=>{var b;t(!1),(b=e.onClose)==null||b.call(e)}),v(a,f),Le()}Sa(["click"]);var Or=x('<div class="link-err value svelte-gmszts"> </div>'),Jr=x('<div class="fed-btn svelte-gmszts"><!> <!></div>'),Qr=x('<img alt="" width="20" height="20">'),Zr=x('<div class="flex-inline svelte-gmszts"><!> <span class="provider-name svelte-gmszts"> </span></div>'),Hr=x('<h3> </h3> <p> </p> <div class="providers svelte-gmszts"></div>',1),Xr=x("<!> <!>",1),Gr=x('<div><div> </div> <span class="value svelte-gmszts"> </span></div>'),en=x('<div><div> </div> <span class="value svelte-gmszts"> </span></div>'),an=x('<div><div><b>WebID:</b></div> <span class="value svelte-gmszts"><a target="_blank"><!></a></span></div>'),tn=x('<div><div><div> </div> <span class="value svelte-gmszts"> </span></div> <div><div> </div> <span class="value svelte-gmszts"> </span></div> <div><div> </div> <span class="value svelte-gmszts"> </span></div> <div><div> </div> <span class="value svelte-gmszts"> </span></div> <div><div> </div> <div><div class="value svelte-gmszts"> </div> <!></div></div> <div><div> </div> <span class="value svelte-gmszts"> </span></div> <div><div> </div> <span class="value svelte-gmszts"> </span></div> <div><div> </div> <!></div> <div><div> </div> <!></div> <div><div> </div> <!></div> <!> <div><div> </div> <span class="value svelte-gmszts"> </span></div> <div><div> </div> <span class="value svelte-gmszts"> </span></div> <!> <!></div>');function gt(a,e){Se(e,!0);let t=$(e,"user",15),r=Ne(),l=q(!1),s=q(!1),d=fe(()=>{var te;return(te=t().account_type)==null?void 0:te.startsWith("federated")}),h=fe(()=>{var te;return n(d)?`${t().account_type}: ${((te=e.authProvider)==null?void 0:te.name)||""}`:t().account_type}),u=fe(()=>e.viewModePhone?"rowPhone":"row"),f=fe(()=>e.viewModePhone?"labelPhone":"label"),g={};function R(te){ur(64,(pe,{challenge:ye,verifier:ze})=>{pe||(localStorage.setItem(mr,ze),_(te,ye))})}async function _(te,pe){let ye={email:t().email,client_id:"rauthy",redirect_uri:window.location.href,provider_id:te,pkce_challenge:pe},ze=await ya(`/auth/v1/providers/${te}/link`,ye);if(ze.text){hr(ze.text);let $e=ze.headers.get("location");$e&&(window.location.href=$e)}else console.error(ze.error)}async function L(){let te=await br("/auth/v1/providers/link");te.body?t(te.body):(console.error(te.error),m(l,!0))}var E=tn(),b=i(E),P=i(b),F=i(P,!0);o(P);var K=c(P,2),Y=i(K,!0);o(K),o(b);var J=c(b,2),N=i(J),G=i(N,!0);o(N);var ne=c(N,2),he=i(ne,!0);o(ne),o(J);var S=c(J,2),T=i(S),ve=i(T,!0);o(T);var Z=c(T,2),re=i(Z,!0);o(Z),o(S);var B=c(S,2),ee=i(B),ue=i(ee);o(ee);var M=c(ee,2),p=i(M,!0);o(M),o(B);var I=c(B,2),V=i(I),ae=i(V,!0);o(V);var Q=c(V,2),O=i(Q),ce=i(O,!0);o(O);var xe=c(O,2);{var H=te=>{var pe=Jr(),ye=i(pe);Me(ye,{get ariaLabel(){return r.account.providerUnlink},level:3,onclick:L,children:(Ae,Qe)=>{Ee();var Ge=Ce();D(()=>w(Ge,r.account.providerUnlink)),v(Ae,Ge)},$$slots:{default:!0}});var ze=c(ye,2);{var $e=Ae=>{var Qe=Or(),Ge=i(Qe,!0);o(Qe),D(()=>w(Ge,r.account.providerUnlinkDesc)),v(Ae,Qe)};A(ze,Ae=>{n(l)&&Ae($e)})}o(pe),v(te,pe)},y=te=>{var pe=Ie(),ye=se(pe);{var ze=$e=>{var Ae=Xr(),Qe=se(Ae);Me(Qe,{level:2,onclick:()=>m(s,!0),children:(ca,Gt)=>{Ee();var da=Ce();D(()=>w(da,r.account.providerLink)),v(ca,da)},$$slots:{default:!0}});var Ge=c(Qe,2);Fr(Ge,{get showModal(){return n(s)},set showModal(ca){m(s,C(ca))},children:(ca,Gt)=>{var da=Hr(),Ia=se(da),er=i(Ia,!0);o(Ia);var za=c(Ia,2),ar=i(za,!0);o(za);var rt=c(za,2);ra(rt,21,()=>e.providers,Ea=>Ea.id,(Ea,ea)=>{var tr=fe(()=>`${r.account.providerLink}: ${n(ea).name}`);Me(Ea,{get ariaLabel(){return n(tr)},onclick:()=>R(n(ea).id),level:2,children:(rr,Qs)=>{var Ca=Zr(),nt=i(Ca);{var nr=Aa=>{var fa=Qr();D(()=>z(fa,"src",`/auth/v1/providers/${n(ea).id}/img`)),Ze("load",fa,()=>g[n(ea).id]=!0),lr(fa),v(Aa,fa)};A(nt,Aa=>{g[n(ea).id]&&Aa(nr)})}var st=c(nt,2),sr=i(st,!0);o(st),o(Ca),D(()=>w(sr,n(ea).name)),v(rr,Ca)},$$slots:{default:!0}})}),o(rt),D(()=>{w(er,r.account.providerLink),w(ar,r.account.providerLinkDesc)}),v(ca,da)},$$slots:{default:!0}}),v($e,Ae)};A(ye,$e=>{e.providers.length>0&&$e(ze)},!0)}v(te,pe)};A(xe,te=>{n(d)?te(H):te(y,!1)})}o(Q),o(I);var j=c(I,2),k=i(j),U=i(k,!0);o(k);var X=c(k,2),W=i(X,!0);o(X),o(j);var le=c(j,2),me=i(le),we=i(me,!0);o(me);var ge=c(me,2),de=i(ge,!0);o(ge),o(le);var ke=c(le,2),_e=i(ke),Te=i(_e,!0);o(_e);var je=c(_e,2),Re=fe(()=>!!t().webauthn_user_id);Wa(je,{get checked(){return n(Re)}}),o(ke);var be=c(ke,2),Ue=i(be),He=i(Ue,!0);o(Ue);var ia=c(Ue,2);Wa(ia,{get checked(){return t().enabled}}),o(be);var Pe=c(be,2),Je=i(Pe),De=i(Je,!0);o(Je);var Ke=c(Je,2);Wa(Ke,{get checked(){return t().email_verified}}),o(Pe);var Xe=c(Pe,2);{var Ve=te=>{var pe=Gr(),ye=i(pe),ze=i(ye,!0);o(ye);var $e=c(ye,2),Ae=i($e,!0);D(()=>w(Ae,ta(t().last_login))),o($e),o(pe),D(()=>{oe(pe,ie(n(u)),"svelte-gmszts"),oe(ye,ie(n(f)),"svelte-gmszts"),w(ze,r.account.lastLogin)}),v(te,pe)};A(Xe,te=>{t().last_login&&te(Ve)})}var Ye=c(Xe,2),la=i(Ye),ma=i(la,!0);o(la);var et=c(la,2),Ot=i(et,!0);D(()=>w(Ot,t().password_expires&&ta(t().password_expires)||r.common.never)),o(et),o(Ye);var ha=c(Ye,2),pa=i(ha),Jt=i(pa,!0);o(pa);var at=c(pa,2),Qt=i(at,!0);D(()=>w(Qt,ta(t().created_at))),o(at),o(ha);var tt=c(ha,2);{var Zt=te=>{var pe=en(),ye=i(pe),ze=i(ye,!0);o(ye);var $e=c(ye,2),Ae=i($e,!0);D(()=>w(Ae,ta(t().user_expires))),o($e),o(pe),D(()=>{oe(pe,ie(n(u)),"svelte-gmszts"),oe(ye,ie(n(f)),"svelte-gmszts"),w(ze,r.account.userExpiry)}),v(te,pe)};A(tt,te=>{t().user_expires&&te(Zt)})}var Ht=c(tt,2);{var Xt=te=>{var pe=an(),ye=i(pe),ze=c(ye,2),$e=i(ze);D(()=>z($e,"href",Na(t().id)));var Ae=i($e);ot(Ae,()=>Na(t().id).replace("/auth/","/auth/<wbr/>")),o($e),o(ze),o(pe),D(()=>{oe(pe,ie(n(u)),"svelte-gmszts"),oe(ye,ie(n(f)),"svelte-gmszts")}),v(te,pe)};A(Ht,te=>{e.webIdData&&te(Xt)})}o(E),D(()=>{oe(b,ie(n(u)),"svelte-gmszts"),oe(P,ie(n(f)),"svelte-gmszts"),w(F,r.common.email),w(Y,t().email),oe(J,ie(n(u)),"svelte-gmszts"),oe(N,ie(n(f)),"svelte-gmszts"),w(G,r.account.givenName),w(he,t().given_name),oe(S,ie(n(u)),"svelte-gmszts"),oe(T,ie(n(f)),"svelte-gmszts"),w(ve,r.account.familyName),w(re,t().family_name),oe(B,ie(n(u)),"svelte-gmszts"),oe(ee,ie(n(f)),"svelte-gmszts"),w(ue,`${r.account.user??""} ID`),w(p,t().id),oe(I,ie(n(u)),"svelte-gmszts"),oe(V,ie(n(f)),"svelte-gmszts"),w(ae,r.account.accType),w(ce,n(h)||""),oe(j,ie(n(u)),"svelte-gmszts"),oe(k,ie(n(f)),"svelte-gmszts"),w(U,r.account.roles),w(W,t().roles||"None"),oe(le,ie(n(u)),"svelte-gmszts"),oe(me,ie(n(f)),"svelte-gmszts"),w(we,r.account.groups),w(de,t().groups||"None"),oe(ke,ie(n(u)),"svelte-gmszts"),oe(_e,ie(n(f)),"svelte-gmszts"),w(Te,r.account.mfaActivated),oe(be,ie(n(u)),"svelte-gmszts"),oe(Ue,ie(n(f)),"svelte-gmszts"),w(He,r.account.userEnabled),oe(Pe,ie(n(u)),"svelte-gmszts"),oe(Je,ie(n(f)),"svelte-gmszts"),w(De,r.account.emailVerified),oe(Ye,ie(n(u)),"svelte-gmszts"),oe(la,ie(n(f)),"svelte-gmszts"),w(ma,r.account.passwordExpiry),oe(ha,ie(n(u)),"svelte-gmszts"),oe(pa,ie(n(f)),"svelte-gmszts"),w(Jt,r.account.userCreated)}),v(a,E),Le()}function Va(a,e){return a-e*Math.floor(a/e)}const wt=1721426;function ka(a,e,t,r){e=Ya(a,e);let l=e-1,s=-2;return t<=2?s=0:Ma(e)&&(s=-1),wt-1+365*l+Math.floor(l/4)-Math.floor(l/100)+Math.floor(l/400)+Math.floor((367*t-362)/12+s+r)}function Ma(a){return a%4===0&&(a%100!==0||a%400===0)}function Ya(a,e){return a==="BC"?1-e:e}function rn(a){let e="AD";return a<=0&&(e="BC",a=1-a),[e,a]}const nn={standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]};class xa{fromJulianDay(e){let t=e,r=t-wt,l=Math.floor(r/146097),s=Va(r,146097),d=Math.floor(s/36524),h=Va(s,36524),u=Math.floor(h/1461),f=Va(h,1461),g=Math.floor(f/365),R=l*400+d*100+u*4+g+(d!==4&&g!==4?1:0),[_,L]=rn(R),E=t-ka(_,L,1,1),b=2;t<ka(_,L,3,1)?b=0:Ma(L)&&(b=1);let P=Math.floor(((E+b)*12+373)/367),F=t-ka(_,L,P,1)+1;return new oa(_,L,P,F)}toJulianDay(e){return ka(e.era,e.year,e.month,e.day)}getDaysInMonth(e){return nn[Ma(e.year)?"leapyear":"standard"][e.month-1]}getMonthsInYear(e){return 12}getDaysInYear(e){return Ma(e.year)?366:365}getYearsInEra(e){return 9999}getEras(){return["BC","AD"]}isInverseEra(e){return e.era==="BC"}balanceDate(e){e.year<=0&&(e.era=e.era==="BC"?"AD":"BC",e.year=1-e.year)}constructor(){this.identifier="gregory"}}const sn={"001":1,AD:1,AE:6,AF:6,AI:1,AL:1,AM:1,AN:1,AR:1,AT:1,AU:1,AX:1,AZ:1,BA:1,BE:1,BG:1,BH:6,BM:1,BN:1,BY:1,CH:1,CL:1,CM:1,CN:1,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DZ:6,EC:1,EE:1,EG:6,ES:1,FI:1,FJ:1,FO:1,FR:1,GB:1,GE:1,GF:1,GP:1,GR:1,HR:1,HU:1,IE:1,IQ:6,IR:6,IS:1,IT:1,JO:6,KG:1,KW:6,KZ:1,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MK:1,MN:1,MQ:1,MV:5,MY:1,NL:1,NO:1,NZ:1,OM:6,PL:1,QA:6,RE:1,RO:1,RS:1,RU:1,SD:6,SE:1,SI:1,SK:1,SM:1,SY:6,TJ:1,TM:1,TR:1,UA:1,UY:1,UZ:1,VA:1,VN:1,XK:1};function _a(a,e,t){let r=a.calendar.toJulianDay(a),l=dn(e),s=Math.ceil(r+1-l)%7;return s<0&&(s+=7),s}function yt(a,e){return a.calendar.toJulianDay(a)-e.calendar.toJulianDay(e)}function on(a,e){return bt(a)-bt(e)}function bt(a){return a.hour*36e5+a.minute*6e4+a.second*1e3+a.millisecond}let Fa=null;function kt(){return Fa==null&&(Fa=new Intl.DateTimeFormat().resolvedOptions().timeZone),Fa}function ln(a){return a.subtract({days:a.day-1})}function cn(a,e,t){let r=_a(a,e);return a.subtract({days:r})}const Mt=new Map;function xt(a){if(Intl.Locale){let t=Mt.get(a);return t||(t=new Intl.Locale(a).maximize().region,t&&Mt.set(a,t)),t}let e=a.split("-")[1];return e==="u"?void 0:e}function dn(a){let e=xt(a);return e&&sn[e]||0}const vn={AF:[4,5],AE:[5,6],BH:[5,6],DZ:[5,6],EG:[5,6],IL:[5,6],IQ:[5,6],IR:[5,5],JO:[5,6],KW:[5,6],LY:[5,6],OM:[5,6],QA:[5,6],SA:[5,6],SD:[5,6],SY:[5,6],YE:[5,6]};function un(a,e){let t=a.calendar.toJulianDay(a),r=Math.ceil(t+1)%7;r<0&&(r+=7);let l=xt(e),[s,d]=vn[l]||[6,0];return r===s||r===d}function _t(a){a=Oa(a,new xa);let e=Ya(a.era,a.year);return Dt(e,a.month,a.day,a.hour,a.minute,a.second,a.millisecond)}function Dt(a,e,t,r,l,s,d){let h=new Date;return h.setUTCHours(r,l,s,d),h.setUTCFullYear(a,e-1,t),h.getTime()}function $t(a,e){if(e==="UTC")return 0;if(a>0&&e===kt())return new Date(a).getTimezoneOffset()*-6e4;let{year:t,month:r,day:l,hour:s,minute:d,second:h}=zt(a,e);return Dt(t,r,l,s,d,h,0)-Math.floor(a/1e3)*1e3}const It=new Map;function zt(a,e){let t=It.get(e);t||(t=new Intl.DateTimeFormat("en-US",{timeZone:e,hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),It.set(e,t));let r=t.formatToParts(new Date(a)),l={};for(let s of r)s.type!=="literal"&&(l[s.type]=s.value);return{year:l.era==="BC"||l.era==="B"?-l.year+1:+l.year,month:+l.month,day:+l.day,hour:l.hour==="24"?0:+l.hour,minute:+l.minute,second:+l.second}}const Et=864e5;function mn(a,e,t,r){return(t===r?[t]:[t,r]).filter(l=>hn(a,e,l))}function hn(a,e,t){let r=zt(t,e);return a.year===r.year&&a.month===r.month&&a.day===r.day&&a.hour===r.hour&&a.minute===r.minute&&a.second===r.second}function pn(a,e,t="compatible"){let r=At(a);if(e==="UTC")return _t(r);if(e===kt()&&t==="compatible"){r=Oa(r,new xa);let u=new Date,f=Ya(r.era,r.year);return u.setFullYear(f,r.month-1,r.day),u.setHours(r.hour,r.minute,r.second,r.millisecond),u.getTime()}let l=_t(r),s=$t(l-Et,e),d=$t(l+Et,e),h=mn(r,e,l-s,l-d);if(h.length===1)return h[0];if(h.length>1)switch(t){case"compatible":case"earlier":return h[0];case"later":return h[h.length-1];case"reject":throw new RangeError("Multiple possible absolute times found")}switch(t){case"earlier":return Math.min(l-s,l-d);case"compatible":case"later":return Math.max(l-s,l-d);case"reject":throw new RangeError("No such absolute time found")}}function Ct(a,e,t="compatible"){return new Date(pn(a,e,t))}function At(a,e){let t=0,r=0,l=0,s=0;if("timeZone"in a)({hour:t,minute:r,second:l,millisecond:s}=a);else if("hour"in a&&!e)return a;return e&&({hour:t,minute:r,second:l,millisecond:s}=e),new $a(a.calendar,a.era,a.year,a.month,a.day,t,r,l,s)}function Oa(a,e){if(a.calendar.identifier===e.identifier)return a;let t=e.fromJulianDay(a.calendar.toJulianDay(a)),r=a.copy();return r.calendar=e,r.era=t.era,r.year=t.year,r.month=t.month,r.day=t.day,sa(r),r}function Ja(a,e){let t=a.copy(),r="hour"in t?kn(t,e):0;Qa(t,e.years||0),t.calendar.balanceYearMonth&&t.calendar.balanceYearMonth(t,a),t.month+=e.months||0,Za(t),St(t),t.day+=(e.weeks||0)*7,t.day+=e.days||0,t.day+=r,fn(t),t.calendar.balanceDate&&t.calendar.balanceDate(t),t.year<1&&(t.year=1,t.month=1,t.day=1);let l=t.calendar.getYearsInEra(t);if(t.year>l){var s,d;let u=(s=(d=t.calendar).isInverseEra)===null||s===void 0?void 0:s.call(d,t);t.year=l,t.month=u?1:t.calendar.getMonthsInYear(t),t.day=u?1:t.calendar.getDaysInMonth(t)}t.month<1&&(t.month=1,t.day=1);let h=t.calendar.getMonthsInYear(t);return t.month>h&&(t.month=h,t.day=t.calendar.getDaysInMonth(t)),t.day=Math.max(1,Math.min(t.calendar.getDaysInMonth(t),t.day)),t}function Qa(a,e){var t,r;!((t=(r=a.calendar).isInverseEra)===null||t===void 0)&&t.call(r,a)&&(e=-e),a.year+=e}function Za(a){for(;a.month<1;)Qa(a,-1),a.month+=a.calendar.getMonthsInYear(a);let e=0;for(;a.month>(e=a.calendar.getMonthsInYear(a));)a.month-=e,Qa(a,1)}function fn(a){for(;a.day<1;)a.month--,Za(a),a.day+=a.calendar.getDaysInMonth(a);for(;a.day>a.calendar.getDaysInMonth(a);)a.day-=a.calendar.getDaysInMonth(a),a.month++,Za(a)}function St(a){a.month=Math.max(1,Math.min(a.calendar.getMonthsInYear(a),a.month)),a.day=Math.max(1,Math.min(a.calendar.getDaysInMonth(a),a.day))}function sa(a){a.calendar.constrainDate&&a.calendar.constrainDate(a),a.year=Math.max(1,Math.min(a.calendar.getYearsInEra(a),a.year)),St(a)}function gn(a){let e={};for(let t in a)typeof a[t]=="number"&&(e[t]=-a[t]);return e}function Lt(a,e){return Ja(a,gn(e))}function Nt(a,e){let t=a.copy();return e.era!=null&&(t.era=e.era),e.year!=null&&(t.year=e.year),e.month!=null&&(t.month=e.month),e.day!=null&&(t.day=e.day),sa(t),t}function wn(a,e){let t=a.copy();return e.hour!=null&&(t.hour=e.hour),e.minute!=null&&(t.minute=e.minute),e.second!=null&&(t.second=e.second),e.millisecond!=null&&(t.millisecond=e.millisecond),bn(t),t}function yn(a){a.second+=Math.floor(a.millisecond/1e3),a.millisecond=Da(a.millisecond,1e3),a.minute+=Math.floor(a.second/60),a.second=Da(a.second,60),a.hour+=Math.floor(a.minute/60),a.minute=Da(a.minute,60);let e=Math.floor(a.hour/24);return a.hour=Da(a.hour,24),e}function bn(a){a.millisecond=Math.max(0,Math.min(a.millisecond,1e3)),a.second=Math.max(0,Math.min(a.second,59)),a.minute=Math.max(0,Math.min(a.minute,59)),a.hour=Math.max(0,Math.min(a.hour,23))}function Da(a,e){let t=a%e;return t<0&&(t+=e),t}function kn(a,e){return a.hour+=e.hours||0,a.minute+=e.minutes||0,a.second+=e.seconds||0,a.millisecond+=e.milliseconds||0,yn(a)}function Tt(a,e,t,r){let l=a.copy();switch(e){case"era":{let h=a.calendar.getEras(),u=h.indexOf(a.era);if(u<0)throw new Error("Invalid era: "+a.era);u=Fe(u,t,0,h.length-1,r==null?void 0:r.round),l.era=h[u],sa(l);break}case"year":var s,d;!((s=(d=l.calendar).isInverseEra)===null||s===void 0)&&s.call(d,l)&&(t=-t),l.year=Fe(a.year,t,-1/0,9999,r==null?void 0:r.round),l.year===-1/0&&(l.year=1),l.calendar.balanceYearMonth&&l.calendar.balanceYearMonth(l,a);break;case"month":l.month=Fe(a.month,t,1,a.calendar.getMonthsInYear(a),r==null?void 0:r.round);break;case"day":l.day=Fe(a.day,t,1,a.calendar.getDaysInMonth(a),r==null?void 0:r.round);break;default:throw new Error("Unsupported field "+e)}return a.calendar.balanceDate&&a.calendar.balanceDate(l),sa(l),l}function Mn(a,e,t,r){let l=a.copy();switch(e){case"hour":{let s=a.hour,d=0,h=23;if((r==null?void 0:r.hourCycle)===12){let u=s>=12;d=u?12:0,h=u?23:11}l.hour=Fe(s,t,d,h,r==null?void 0:r.round);break}case"minute":l.minute=Fe(a.minute,t,0,59,r==null?void 0:r.round);break;case"second":l.second=Fe(a.second,t,0,59,r==null?void 0:r.round);break;case"millisecond":l.millisecond=Fe(a.millisecond,t,0,999,r==null?void 0:r.round);break;default:throw new Error("Unsupported field "+e)}return l}function Fe(a,e,t,r,l=!1){if(l){a+=Math.sign(e),a<t&&(a=r);let s=Math.abs(e);e>0?a=Math.ceil(a/s)*s:a=Math.floor(a/s)*s,a>r&&(a=t)}else a+=e,a<t?a=r-(t-a-1):a>r&&(a=t+(a-r-1));return a}const xn=/^([+-]\d{6}|\d{4})-(\d{2})-(\d{2})$/;function Oe(a){let e=a.match(xn);if(!e)throw new Error("Invalid ISO 8601 date string: "+a);let t=new oa(Ha(e[1],0,9999),Ha(e[2],1,12),1);return t.day=Ha(e[3],0,t.calendar.getDaysInMonth(t)),t}function Ha(a,e,t){let r=Number(a);if(r<e||r>t)throw new RangeError(`Value out of range: ${e} <= ${r} <= ${t}`);return r}function _n(a){return`${String(a.hour).padStart(2,"0")}:${String(a.minute).padStart(2,"0")}:${String(a.second).padStart(2,"0")}${a.millisecond?String(a.millisecond/1e3).slice(1):""}`}function jt(a){let e=Oa(a,new xa),t;return e.era==="BC"?t=e.year===1?"0000":"-"+String(Math.abs(1-e.year)).padStart(6,"00"):t=String(e.year).padStart(4,"0"),`${t}-${String(e.month).padStart(2,"0")}-${String(e.day).padStart(2,"0")}`}function Dn(a){return`${jt(a)}T${_n(a)}`}function $n(a,e){if(e.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rt(a,e,t){$n(a,e),e.set(a,t)}function Pt(a){let e=typeof a[0]=="object"?a.shift():new xa,t;if(typeof a[0]=="string")t=a.shift();else{let d=e.getEras();t=d[d.length-1]}let r=a.shift(),l=a.shift(),s=a.shift();return[e,t,r,l,s]}var In=new WeakMap;class oa{copy(){return this.era?new oa(this.calendar,this.era,this.year,this.month,this.day):new oa(this.calendar,this.year,this.month,this.day)}add(e){return Ja(this,e)}subtract(e){return Lt(this,e)}set(e){return Nt(this,e)}cycle(e,t,r){return Tt(this,e,t,r)}toDate(e){return Ct(this,e)}toString(){return jt(this)}compare(e){return yt(this,e)}constructor(...e){Rt(this,In,{writable:!0,value:void 0});let[t,r,l,s,d]=Pt(e);this.calendar=t,this.era=r,this.year=l,this.month=s,this.day=d,sa(this)}}var zn=new WeakMap;class $a{copy(){return this.era?new $a(this.calendar,this.era,this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond):new $a(this.calendar,this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond)}add(e){return Ja(this,e)}subtract(e){return Lt(this,e)}set(e){return Nt(wn(this,e),e)}cycle(e,t,r){switch(e){case"era":case"year":case"month":case"day":return Tt(this,e,t,r);default:return Mn(this,e,t,r)}}toDate(e,t){return Ct(this,e,t)}toString(){return Dn(this)}compare(e){let t=yt(this,e);return t===0?on(this,At(e)):t}constructor(...e){Rt(this,zn,{writable:!0,value:void 0});let[t,r,l,s,d]=Pt(e);this.calendar=t,this.era=r,this.year=l,this.month=s,this.day=d,this.hour=e.shift()||0,this.minute=e.shift()||0,this.second=e.shift()||0,this.millisecond=e.shift()||0,sa(this)}}function En(a){let e=Date.parse(a);if(!isNaN(e))return e/1e3}function Ut(a){return`${a.year}-${a.month>9?a.month:"0"+a.month}-${a.day>9?a.day:"0"+a.day}`}function Cn(a,e){const t=a.month;a=ln(a),a=cn(a,e);let r=[];const l=u=>{u.push({day:a.day,month:a.month,year:a.year,isWeekend:un(a,e)}),a=a.add({days:1})},s=()=>{let u={days:[]};for(let f=0;f<7;f++)l(u.days);r.push(u)};for(s();a.month===t;)s();let d=r[r.length-1],h=_a(a,e);for(;h>0;)l(d.days),h=_a(a,e);return r[r.length-1]=d,r}function Xa(a){const e=a||new Date;let t=e.getDate();t<10&&(t="0"+t);let r=e.getMonth()+1;return r<10&&(r="0"+r),`${e.getUTCFullYear()}-${r}-${t}`}var An=x("<form><!></form>");function Sn(a,e){Se(e,!0);let t=$(e,"method",3,"POST"),r=$(e,"isError",15),l=$(e,"convertDateToTs",19,()=>[]);async function s(u){var L;u.preventDefault();const f=u.currentTarget;if(f.reportValidity())r(!1);else{r(!0);return}const g=new FormData(f);for(let E of l()){let b=((L=g.get(E))==null?void 0:L.toString())||"",P=En(b)||"";g.set(E,(P==null?void 0:P.toString())||"")}if(e.withPowAs){let E=await $r();g.set(e.withPowAs,E||"")}let R,_=new URLSearchParams;if(g.forEach((E,b)=>{_.append(b,E.toString())}),e.onSubmit){e.onSubmit(f,_);return}R=await kr(f,_),R&&(R.ok?e.onResponse&&(e.onResponse(R),e.resetOnSubmit&&R.ok&&f.reset()):await Mr(R))}var d=An(),h=i(d);mt(h,()=>e.children),o(d),D(()=>{z(d,"action",e.action),z(d,"method",t())}),Ze("submit",d,s),v(a,d),Le()}var Ln=aa(`<svg fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21
            7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25
            0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>`);function Nn(a,e){let t=$(e,"opacity",3,.9),r=$(e,"width",3,"1.5rem"),l=$(e,"color",3,"currentColor");var s=Ln();z(s,"stroke-width",2),D(()=>{z(s,"stroke",l()),z(s,"width",r()),z(s,"opacity",t())}),v(a,s)}function Tn(a,e){var t,r,l,s,d;switch(a.code){case"Enter":(t=e.onEnter)==null||t.call(e);break;case"ArrowUp":(r=e.onUp)==null||r.call(e);break;case"ArrowDown":(l=e.onDown)==null||l.call(e);break;case"ArrowLeft":(s=e.onLeft)==null||s.call(e);break;case"ArrowRight":(d=e.onRight)==null||d.call(e);break}}var jn=x('<span class="pointer"><!></span>'),Rn=x('<div class="day font-label weekLabel svelte-1j6kibo"> </div>'),Pn=x('<time class="svelte-1j6kibo"> </time>'),Un=x('<div class="day svelte-1j6kibo"><!></div>'),Kn=x('<div class="week svelte-1j6kibo"></div>'),qn=x('<div class="popup svelte-1j6kibo"><div class="flex space-between"><div><!></div> <div><!></div></div> <div class="week svelte-1j6kibo"></div> <div class="month svelte-1j6kibo"></div></div>'),Bn=x('<div class="error svelte-1j6kibo"> </div>'),Wn=x('<div><div class="flex"><input type="date" step="any" class="svelte-1j6kibo"> <div class="relative"><div class="absolute patch svelte-1j6kibo"></div> <div class="absolute indicator svelte-1j6kibo"><!></div></div></div> <div class="label svelte-1j6kibo"><label class="font-label noselect svelte-1j6kibo"> </label> <!></div></div>');function Vn(a,e){Se(e,!0);let t=$(e,"id",19,dt),r=$(e,"value",31,()=>C(Xa())),l=$(e,"label",3,""),s=$(e,"title",3,""),d=$(e,"min",3,"1900-01-01"),h=$(e,"max",3,"2100-01-01");const u=Oe(Xa(new Date)),f=u.toString();let g=Ne(),R=q(!1),_=q(void 0),L,E=q(void 0),b=q(void 0),P=q(void 0),F=fe(()=>r()?Oe(r()):u),K=fe(()=>Oe(d())),Y=fe(()=>Oe(h())),J=q(C(ga(()=>g.common.months[n(F).month-1]))),N=fe(()=>g.common.months.findIndex(y=>y===n(J))+1),G=q(C(ga(()=>n(F).year))),ne=q(C([ga(()=>n(G))])),he=fe(()=>Cn(n(F),g.lang));qe(()=>{let y=Number.parseInt(d().slice(0,4)),j=Number.parseInt(h().slice(0,4)),k=[];for(let U=y;U<=j;U++)k.push(U);m(ne,C(k))}),qe(()=>{if(r()){let y=ga(()=>Oe(r()));y=y.set({year:n(G),month:n(N)}),r(y.toString())}}),qe(()=>{n(P)&&r()&&requestAnimationFrame(()=>{var j,k,U;let y=((j=n(P))==null?void 0:j.getElementsByTagName("time"))||[];for(let X of y)if(X.getAttribute("datetime")===r()){(U=(k=X.parentElement)==null?void 0:k.parentElement)==null||U.focus();break}})});function S(y){let j=Oe(Ut(y));return j.compare(n(K))<0||j.compare(n(Y))>0?!1:n(N)===y.month}function T(){r(new oa(n(G),n(N),1).toString())}function ve(y){y.preventDefault(),m(R,!0)}function Z(y,j){var k;y.preventDefault(),r(j),(k=n(_))==null||k()}function re(y,j){var X,W;let k=Oe(j),U=Oe(j);switch(y){case"left":U=k.subtract({days:1});break;case"right":U=k.add({days:1});break;case"up":U=k.subtract({weeks:1});break;case"down":U=k.add({weeks:1});break}U.month!==k.month?_a(U,g.lang)<4?(X=n(E))==null||X.focus():(W=n(b))==null||W.focus():r(U.toString())}function B(y){switch(y){case"open":r()||(r(f),requestAnimationFrame(()=>ee()));break;case"closed":m(P,void 0);break}}function ee(){m(R,!(L!=null&&L.reportValidity()))}var ue=Wn(),M=i(ue),p=i(M);ut(p),p.__keydown=[Tn,e],Pa(p,y=>L=y,()=>L);var I=c(p,2),V=c(i(I),2),ae=i(V);Ir(ae,{ariaLabel:"Show Popover Example",offsetLeft:"-7.5rem",offsetTop:"-.2rem",onToggle:B,btnInvisible:!0,lazy:!0,get close(){return n(_)},set close(y){m(_,C(y))},button:y=>{var j=jn(),k=i(j);Nn(k,{color:"hsl(var(--text)",width:"1.2rem"}),o(j),v(y,j)},children:(y,j)=>{var k=qn(),U=i(k),X=i(U),W=i(X);pt(W,{get ariaLabel(){return g.common.month},get options(){return g.common.months},maxHeight:"13rem",borderless:!0,onRight:()=>{var de;return(de=n(b))==null?void 0:de.focus()},onDown:T,get ref(){return n(E)},set ref(de){m(E,C(de))},get value(){return n(J)},set value(de){m(J,C(de))}}),o(X);var le=c(X,2),me=i(le);pt(me,{get ariaLabel(){return g.common.year},get options(){return n(ne)},maxHeight:"13rem",borderless:!0,onLeft:()=>{var de;return(de=n(E))==null?void 0:de.focus()},onDown:T,get ref(){return n(b)},set ref(de){m(b,C(de))},get value(){return n(G)},set value(de){m(G,C(de))}}),o(le),o(U);var we=c(U,2);ra(we,21,()=>g.common.weekDaysShort,ba,(de,ke)=>{var _e=Rn(),Te=i(_e,!0);o(_e),D(()=>w(Te,n(ke))),v(de,_e)}),o(we);var ge=c(we,2);ra(ge,21,()=>n(he),ba,(de,ke)=>{var _e=Kn();ra(_e,21,()=>n(ke).days,ba,(Te,je)=>{var Re=Un();const be=fe(()=>Ut(n(je))),Ue=fe(()=>S(n(je)));var He=i(Re),ia=fe(()=>!n(Ue));Me(He,{onclick:Pe=>Z(Pe,n(be)),get isDisabled(){return n(ia)},invisible:!0,onLeft:()=>re("left",n(be)),onRight:()=>re("right",n(be)),onUp:()=>re("up",n(be)),onDown:()=>re("down",n(be)),children:(Pe,Je)=>{var De=Pn(),Ke=i(De,!0);o(De),D(()=>{z(De,"data-today",n(be)===f),z(De,"data-active",n(Ue)),z(De,"data-selected",n(be)===r()),z(De,"data-weekend",n(je).isWeekend),z(De,"datetime",n(be)),w(Ke,n(je).day)}),v(Pe,De)},$$slots:{default:!0}}),o(Re),v(Te,Re)}),o(_e),v(de,_e)}),o(ge),Pa(ge,de=>m(P,de),()=>n(P)),o(k),v(y,k)},$$slots:{button:!0,default:!0}}),o(V),o(I),o(M);var Q=c(M,2),O=i(Q),ce=i(O,!0);o(O);var xe=c(O,2);{var H=y=>{var j=Bn(),k=i(j,!0);o(j),D(()=>w(k,s())),Be(3,j,()=>ja),v(y,j)};A(xe,y=>{n(R)&&y(H)})}o(Q),o(ue),D(()=>{z(p,"id",t()),z(p,"name",e.name),z(p,"title",s()),z(p,"aria-label",s()),p.disabled=e.disabled,z(p,"aria-disabled",e.disabled),p.required=e.required,z(p,"aria-required",e.required||!1),z(p,"aria-invalid",n(R)),z(p,"min",d()),z(p,"max",h()),z(O,"for",t()),z(O,"data-required",e.required),w(ce,l())}),Ze("invalid",p,ve),Ze("blur",p,()=>ee()),Ta(p,r),v(a,ue),Le()}Sa(["keydown"]);var Yn=x("<span><!></span>"),Fn=x('<div class="delete svelte-1gnpmkt"><!></div>'),On=x('<div class="container svelte-1gnpmkt"><!> <!></div>');function Jn(a,e){Se(e,!0);let t=$(e,"id",19,dt),r=$(e,"value",31,()=>C(Xa())),l=$(e,"label",3,""),s=$(e,"title",3,""),d=$(e,"min",3,"1900-01-01"),h=$(e,"max",3,"2100-01-01"),u=Ne();var f=On(),g=i(f);Vn(g,{get id(){return t()},get name(){return e.name},get label(){return l()},get title(){return s()},get disabled(){return e.disabled},get min(){return d()},get max(){return h()},get required(){return e.required},get onEnter(){return e.onEnter},get onLeft(){return e.onLeft},get onRight(){return e.onRight},get onUp(){return e.onUp},get onDown(){return e.onDown},get value(){return r()},set value(L){r(L)}});var R=c(g,2);{var _=L=>{var E=Fn(),b=i(E);Me(b,{get ariaLabel(){return u.common.delete},invisible:!0,onclick:()=>r(""),children:(P,F)=>{var K=Yn(),Y=i(K);La(Y,{color:"hsla(var(--error) / .8)",width:"1.2rem"}),o(K),D(()=>z(K,"title",u.common.delete)),v(P,K)},$$slots:{default:!0}}),o(E),v(L,E)};A(R,L=>{e.withDelete&&L(_)})}o(f),v(a,f),Le()}var Qn=x("<p> </p>"),Zn=x('<div class="success svelte-19s6k1f"><!> <!></div>'),Hn=x('<div class="err"> </div>'),Xn=x('<div class="formInner svelte-19s6k1f"><div><!> <!> <!> <!></div> <div><!> <!> <!> <!> <!></div></div> <div class="bottom svelte-19s6k1f"><div><!></div> <!></div>',1),Gn=x('<div class="wrapper svelte-19s6k1f"><div class="container svelte-19s6k1f"><!></div></div>');function Kt(a,e){var _;Se(e,!0);let t=$(e,"user",15);(_=t().user_values)!=null&&_.birthdate||t(t().user_values.birthdate="",!0);let r=Ne(),l=q(""),s=q(!1),d=q(!1);async function h(L,E){var ve;const b=E.get("email"),P=E.get("family_name"),F=E.get("given_name")||void 0,K=E.get("birthdate")||void 0,Y=((ve=E.get("phone"))==null?void 0:ve.replaceAll(" ",""))||void 0,J=E.get("street")||void 0,N=E.get("zip")||void 0,G=N?Number.parseInt(N):void 0,ne=E.get("city")||void 0,he=E.get("country")||void 0;let S={email:b,family_name:P,given_name:F,user_values:{birthdate:K,phone:Y,street:J,zip:G,city:ne,country:he}},T=await vt(`/auth/v1/users/${t().id}/self`,S);T.body?(m(s,!0),t(T.body),T.status===202&&m(d,!0),setTimeout(()=>{m(s,!1)},3e3)):T.error&&(console.error(T.error),m(l,C(T.error.message)))}var u=Gn(),f=i(u),g=i(f),R=fe(()=>`/auth/v1/users/${t().id}/self`);Sn(g,{get action(){return n(R)},onSubmit:h,children:(L,E)=>{var b=Xn(),P=se(b),F=i(P),K=i(F);We(K,{typ:"email",name:"email",get label(){return r.common.email},get placeholder(){return r.common.email},get value(){return t().email},required:!0});var Y=c(K,2);We(Y,{name:"given_name",autocomplete:"given-name",get label(){return r.account.givenName},get placeholder(){return r.account.givenName},get value(){return t().given_name},required:!0,maxLength:32,pattern:Ua});var J=c(Y,2);We(J,{name:"family_name",autocomplete:"family-name",get label(){return r.account.familyName},get placeholder(){return r.account.familyName},get value(){return t().family_name},maxLength:32,pattern:Ua});var N=c(J,2);Jn(N,{name:"birthdate",get label(){return r.account.birthdate},withDelete:!0,get value(){return t().user_values.birthdate},set value(p){t(t().user_values.birthdate=p,!0)}}),o(F);var G=c(F,2),ne=i(G);We(ne,{name:"street",autocomplete:"street-address",get label(){return r.account.street},get placeholder(){return r.account.street},get value(){return t().user_values.street},maxLength:48,pattern:_r});var he=c(ne,2);We(he,{typ:"number",name:"zip",autocomplete:"postal-code",get label(){return r.account.zip},get placeholder(){return r.account.zip},get value(){return t().user_values.zip},min:"1000",max:"9999999"});var S=c(he,2);We(S,{name:"city",autocomplete:"address-level2",get label(){return r.account.city},get placeholder(){return r.account.city},get value(){return t().user_values.city},maxLength:48,pattern:ht});var T=c(S,2);We(T,{name:"country",autocomplete:"country",get label(){return r.account.country},get placeholder(){return r.account.country},get value(){return t().user_values.country},maxLength:48,pattern:ht});var ve=c(T,2);We(ve,{name:"phone",autocomplete:"tel",get label(){return r.account.phone},get placeholder(){return r.account.phone},get value(){return t().user_values.phone},maxLength:32,pattern:Dr}),o(G),o(P);var Z=c(P,2),re=i(Z),B=i(re);Me(B,{type:"submit",children:(p,I)=>{Ee();var V=Ce();D(()=>w(V,r.common.save)),v(p,V)},$$slots:{default:!0}}),o(re);var ee=c(re,2);{var ue=p=>{var I=Zn(),V=i(I);Ba(V,{});var ae=c(V,2);{var Q=O=>{var ce=Qn(),xe=i(ce,!0);o(ce),D(()=>w(xe,r.account.emailUpdateConfirm)),v(O,ce)};A(ae,O=>{n(d)&&O(Q)})}o(I),Be(3,I,()=>na),v(p,I)},M=p=>{var I=Ie(),V=se(I);{var ae=Q=>{var O=Hn(),ce=i(O,!0);o(O),D(()=>w(ce,n(l))),Be(3,O,()=>na),v(Q,O)};A(V,Q=>{n(l)&&Q(ae)},!0)}v(p,I)};A(ee,p=>{n(s)?p(ue):p(M,!1)})}o(Z),v(L,b)},$$slots:{default:!0}}),o(f),o(u),v(a,u),Le()}var es=aa('<svg fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M7.864 4.243A7.5 7.5 0 0119.5 10.5c0 2.92-.556 5.709-1.568 8.268M5.742 6.364A7.465 7.465 0 004.5 10.5a7.464 7.464 0 01-1.15 3.993m1.989 3.559A11.209 11.209 0 008.25 10.5a3.75 3.75 0 117.5 0c0 .527-.021 1.049-.064 1.565M12 10.5a14.94 14.94 0 01-3.6 9.75m6.633-4.596a18.666 18.666 0 01-2.485 5.33"></path></svg>');function as(a,e){let t=$(e,"opacity",3,.9),r=$(e,"width",3,24),l=$(e,"color",3,"currentColor");var s=es();z(s,"stroke-width",2),D(()=>{z(s,"stroke",l()),z(s,"width",r()),z(s,"opacity",t())}),v(a,s)}async function ts(a,e,t,r){let l={passkey_name:e},s=await ya(`/auth/v1/users/${a}/webauthn/register/start`,l);if(!s.body)return{error:s.error.message||"did not receive any registration data"};let d=s.body;if(!d.publicKey){let _="no publicKey in options from the backend";return console.error(_),{error:_}}if(d.publicKey.challenge=Ka(d.publicKey.challenge),d.publicKey.user.id=Ka(d.publicKey.user.id),d.publicKey.excludeCredentials)for(let _ of d.publicKey.excludeCredentials)_.id=Ka(_.id);let h=(d.publicKey.timeout||6e4)-1e3;const u=new Date().getTime()+h;let f;try{const _=await pr(navigator.credentials.create(d),h);if(_)f=_;else return{error:t}}catch{return{error:new Date().getTime()>=u?r:t}}let g={passkey_name:e,data:{id:f.id,rawId:qa(f.rawId),response:{attestationObject:qa(f.response.attestationObject),clientDataJSON:qa(f.response.clientDataJSON)},extensions:f.getClientExtensionResults(),type:f.type}},R=await ya(`/auth/v1/users/${a}/webauthn/register/finish`,g);return R.status===201?{}:{error:R.error.message||"Registration failed"}}var rs=x('<div class="err svelte-ea3bti"><b>Your browser does not support Webauthn credentials and must be updated.</b></div>'),ns=x('<!> <div class="regBtns svelte-ea3bti"><!> <!></div>',1),ss=x('<div class="regNewBtn svelte-ea3bti"><!></div>'),os=x('<div class="keysHeader svelte-ea3bti"> </div>'),is=x("<div><!></div>"),ls=x('<div class="row svelte-ea3bti"><div></div> <div class="deleteBtn svelte-ea3bti"><!></div></div>'),cs=x('<div class="keyContainer svelte-ea3bti"><div class="row svelte-ea3bti"><span class="label svelte-ea3bti"> </span> <div class="nameUv svelte-ea3bti"><b> </b> <!></div></div> <div class="row svelte-ea3bti"><span class="label svelte-ea3bti"> </span> <span class="font-mono"> </span></div> <div class="row svelte-ea3bti"><span class="label svelte-ea3bti"> </span> <span class="font-mono"> </span></div> <!></div>'),ds=x('<div class="button svelte-ea3bti"><!></div>'),vs=x('<!> <p class="svelte-ea3bti"> <br><br> </p> <!> <!> <div class="keysContainer svelte-ea3bti"></div> <!> <div class="svelte-ea3bti"> </div>',1),us=x('<div class="container svelte-ea3bti"><!></div>');function qt(a,e){Se(e,!0);const t="credentials"in navigator;let r=Ne(),l=it("account"),s=fe(()=>{var S;return(S=l.get())==null?void 0:S.user_id}),d=q(void 0),h=q(!1),u=q(""),f=q(!1),g=q(e.user.account_type==="password"),R=q(void 0),_=q(""),L=q(!1),E=q(C([]));wa(()=>{P()}),qe(()=>{n(E).length>0&&e.user.account_type==="passkey"&&m(g,n(E).length>1)}),qe(()=>{var S;(S=n(d))==null||S.focus()});function b(){m(h,!1),m(u,"")}async function P(){var T;let S=await va(`/auth/v1/users/${(T=l.get())==null?void 0:T.user_id}/webauthn`);S.body?m(E,C(S.body)):console.error(S.error)}async function F(){if(b(),n(L)||!n(s))return;if(n(_).length<1){m(h,!0),m(u,C(r.mfa.passkeyNameErr));return}let S=await ts(n(s),n(_));S.error?(m(h,!0),m(u,`${r.mfa.errorReg} - ${S.error}`)):(m(f,!1),m(_,""),await P())}async function K(S){let T=await Er(e.user.id,S);if(T.status===200)await P();else{let ve=await T.json();m(h,!0),m(u,C(ve.message))}}function Y(S){m(R,void 0),m(h,!0),m(u,C(S)),setTimeout(()=>{m(h,!1),m(u,"")},5e3)}function J(S){m(R,void 0),m(u,C(r.mfa.testSuccess))}var N=us(),G=i(N);{var ne=S=>{var T=rs();v(S,T)},he=S=>{var T=vs(),ve=se(T);{var Z=H=>{ft(H,{get userId(){return e.user.id},get purpose(){return n(R)},onSuccess:J,onError:Y})};A(ve,H=>{n(R)&&H(Z)})}var re=c(ve,2),B=i(re),ee=c(B,3);o(re);var ue=c(re,2);{var M=H=>{var y=ns(),j=se(y);We(j,{autocomplete:"off",get label(){return r.mfa.passkeyName},get placeholder(){return r.mfa.passkeyName},maxLength:32,pattern:Ua,onEnter:F,get ref(){return n(d)},set ref(W){m(d,C(W))},get value(){return n(_)},set value(W){m(_,C(W))},get isError(){return n(L)},set isError(W){m(L,C(W))}});var k=c(j,2),U=i(k);Me(U,{onclick:F,children:(W,le)=>{Ee();var me=Ce();D(()=>w(me,r.mfa.register)),v(W,me)},$$slots:{default:!0}});var X=c(U,2);Me(X,{level:3,onclick:()=>m(f,!1),children:(W,le)=>{Ee();var me=Ce();D(()=>w(me,r.common.cancel)),v(W,me)},$$slots:{default:!0}}),o(k),v(H,y)},p=H=>{var y=ss(),j=i(y),k=fe(()=>n(E).length===0?1:2);Me(j,{get level(){return n(k)},onclick:()=>m(f,!0),children:(U,X)=>{Ee();var W=Ce();D(()=>w(W,r.mfa.registerNew)),v(U,W)},$$slots:{default:!0}}),o(y),v(H,y)};A(ue,H=>{n(f)?H(M):H(p,!1)})}var I=c(ue,2);{var V=H=>{var y=os(),j=i(y,!0);o(y),D(()=>w(j,r.mfa.registerdKeys)),v(H,y)};A(I,H=>{n(E).length>0&&H(V)})}var ae=c(I,2);ra(ae,21,()=>n(E),H=>H.name,(H,y)=>{var j=cs(),k=i(j),U=i(k),X=i(U,!0);o(U);var W=c(U,2),le=i(W),me=i(le,!0);o(le);var we=c(le,2);{var ge=De=>{dr(De,{get text(){return r.account.userVerifiedTooltip},children:(Ke,Xe)=>{var Ve=is();ua(Ve,"margin-bottom","-.25rem");var Ye=i(Ve);as(Ye,{width:18,color:"var(--col-acnt)"}),o(Ve),v(Ke,Ve)},$$slots:{default:!0}})};A(we,De=>{n(y).user_verified&&De(ge)})}o(W),o(k);var de=c(k,2),ke=i(de),_e=i(ke,!0);o(ke);var Te=c(ke,2),je=i(Te,!0);D(()=>w(je,ta(n(y).registered))),o(Te),o(de);var Re=c(de,2),be=i(Re),Ue=i(be,!0);o(be);var He=c(be,2),ia=i(He,!0);D(()=>w(ia,ta(n(y).last_used))),o(He),o(Re);var Pe=c(Re,2);{var Je=De=>{var Ke=ls(),Xe=c(i(Ke),2),Ve=i(Xe);Me(Ve,{level:-3,onclick:()=>K(n(y).name),children:(Ye,la)=>{Ee();var ma=Ce();D(()=>w(ma,r.common.delete)),v(Ye,ma)},$$slots:{default:!0}}),o(Xe),o(Ke),v(De,Ke)};A(Pe,De=>{n(g)&&De(Je)})}o(j),D(()=>{w(X,r.mfa.passkeyName),w(me,n(y).name),w(_e,r.mfa.registerd),w(Ue,r.mfa.lastUsed)}),v(H,j)}),o(ae);var Q=c(ae,2);{var O=H=>{var y=ds(),j=i(y);Me(j,{onclick:()=>m(R,"Test"),children:(k,U)=>{Ee();var X=Ce();D(()=>w(X,r.mfa.test)),v(k,X)},$$slots:{default:!0}}),o(y),v(H,y)};A(Q,H=>{n(E).length>0&&H(O)})}var ce=c(Q,2),xe=i(ce,!0);o(ce),D(()=>{w(B,`${r.mfa.p1??""} `),w(ee,` ${r.mfa.p2??""}`),Ra(ce,"success",!n(h)),Ra(ce,"err",n(h)),w(xe,n(u))}),v(S,T)};A(G,S=>{t?S(he,!1):S(ne)})}o(N),v(a,N),Le()}var ms=aa('<svg fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z"></path></svg>');function hs(a,e){let t=$(e,"opacity",3,.9),r=$(e,"width",3,"1.5rem"),l=$(e,"color",3,"currentColor");var s=ms();z(s,"stroke-width",2),D(()=>{z(s,"stroke",l()),z(s,"width",r()),z(s,"opacity",t())}),v(a,s)}var ps=aa('<svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88"></path></svg>');function fs(a,e){let t=$(e,"opacity",3,.9),r=$(e,"width",3,"1.5rem"),l=$(e,"color",3,"hsl(var(--error))");var s=ps();z(s,"stroke-width",2),D(()=>{z(s,"width",r()),z(s,"color",l()),z(s,"opacity",t())}),v(a,s)}var gs=aa('<svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>');function ws(a,e){let t=$(e,"opacity",3,.9),r=$(e,"width",3,"1.5rem"),l=$(e,"color",3,"currentColor");var s=gs();z(s,"stroke-width",2),D(()=>{z(s,"width",r()),z(s,"color",l()),z(s,"opacity",t())}),v(a,s)}function Bt(a,e){navigator.clipboard?navigator.clipboard.writeText(e()):console.error("Copy to clipboard is only available in secure contexts")}function Wt(a,e){e()==="password"?e("text"):e("password")}function ys(a,e){var t;(t=e.onInput)==null||t.call(e)}function bs(a){a.code}var ks=x('<div role="button" tabindex="0" class="btn clip svelte-11t06s4"><!></div>'),Ms=x('<div class="nolabel svelte-11t06s4"></div>'),xs=x('<div class="error svelte-11t06s4"><!> </div>'),_s=x('<div><div class="input-row svelte-11t06s4"><input> <div class="rel svelte-11t06s4"><!> <div role="button" tabindex="0" class="btn show svelte-11t06s4"><!></div></div></div></div> <div class="label svelte-11t06s4"><label class="font-label noselect svelte-11t06s4"> </label> <!></div>',1);function Ga(a,e){Se(e,!0);let t=$(e,"type",7,"password"),r=$(e,"name",3,"password"),l=$(e,"value",15,""),s=$(e,"label",3,"Password"),d=$(e,"ariaLabel",3,"Password"),h=$(e,"autocomplete",3,"current-password"),u=$(e,"placeholder",3,"Password"),f=$(e,"disabled",3,!1),g=$(e,"maxLength",3,128),R=$(e,"required",3,!0),_=$(e,"width",3,"inherit"),L=$(e,"showCopy",3,!1),E=Ne(),b=q(!1);function P(p){var V,ae;const I=(V=p==null?void 0:p.currentTarget)==null?void 0:V.reportValidity();m(b,!I),(ae=e.onBlur)==null||ae.call(e)}function F(p){p.preventDefault(),m(b,!0)}var K=_s(),Y=se(K),J=i(Y),N=i(J);ut(N),N.__input=[ys,e],N.__keydown=[bs];var G=c(N,2),ne=i(G);{var he=p=>{var I=ks();I.__click=[Bt,l],I.__keydown=[Bt,l];var V=i(I);hs(V,{}),o(I),v(p,I)};A(ne,p=>{L()&&p(he)})}var S=c(ne,2);S.__click=[Wt,t],S.__keydown=[Wt,t];var T=i(S);{var ve=p=>{fs(p,{})},Z=p=>{ws(p,{})};A(T,p=>{t()==="password"?p(ve):p(Z,!1)})}o(S),o(G),o(J),o(Y);var re=c(Y,2),B=i(re),ee=i(B,!0);o(B);var ue=c(B,2);{var M=p=>{var I=xs(),V=i(I);{var ae=O=>{var ce=Ms();v(O,ce)};A(V,O=>{s()||O(ae)})}var Q=c(V);o(I),D(()=>w(Q,` ${(e.errMsg||E.common.invalidInput)??""}`)),Be(3,I,()=>ja),v(p,I)};A(ue,p=>{n(b)&&p(M)})}o(re),D(()=>{ua(Y,"width",_()),z(N,"type",t()),z(N,"id",e.id),z(N,"name",r()),z(N,"aria-label",d()),z(N,"autocomplete",h()),z(N,"placeholder",u()),N.disabled=f(),N.required=R()||void 0,z(N,"maxlength",g()||void 0),z(N,"pattern",e.pattern||void 0),ua(N,"padding-right",L()?"3.8rem":"2.2rem"),z(B,"for",e.id),z(B,"data-required",R()),w(ee,s())}),Ze("invalid",N,F),Ze("blur",N,P),Ta(N,l),v(a,K),Le()}Sa(["input","keydown","click"]);var Ds=x('<div class="container svelte-ue7bk2"><!> <!> <!> <!> <div class="btn svelte-ue7bk2"><!></div> <div class="err svelte-ue7bk2"> </div></div>');function $s(a,e){Se(e,!0);let t=$(e,"passwords",15),r=$(e,"hideCurrentPassword",3,!1),l=$(e,"isValid",15),s=Ne();l(g);let d=q(!1),h=q(""),u=q(void 0),f=fe(()=>{var b;return((b=t().new)==null?void 0:b.length)>6&&t().new===t().newConfirm});wa(async()=>{let b=await va("/auth/v1/password_policy");b.body?m(u,C(b.body)):console.error(b.error)});function g(){return m(h,""),!r()&&!t().current?(m(h,C(s.account.passwordCurrReq)),!1):t().new?t().newConfirm?n(d)?t().new.length>256?(m(h,"max 256"),!1):t().new!==t().newConfirm?(m(h,C(s.account.passwordNoMatch)),!1):!0:(m(h,C(s.account.passwordPolicyFollow)),!1):(m(h,C(s.account.passwordNewReq)),!1):(m(h,C(s.account.passwordNewReq)),!1)}function R(){if(m(h,""),n(u)){let b=fr(n(u));t(t().new=b,!0),t(t().newConfirm=b,!0)}}var _=Ie(),L=se(_);{var E=b=>{var P=Ds(),F=i(P);Sr(F,{get policy(){return n(u)},get password(){return t().new},get accepted(){return n(d)},set accepted(T){m(d,C(T))}});var K=c(F,2);{var Y=T=>{Ga(T,{autocomplete:"current-password",get label(){return s.account.passwordCurr},get placeholder(){return s.account.passwordCurr},onInput:g,get width(){return e.inputWidth},get value(){return t().current},set value(ve){t(t().current=ve,!0)}})};A(K,T=>{r()||T(Y)})}var J=c(K,2);Ga(J,{autocomplete:"new-password",get label(){return s.account.passwordNew},get placeholder(){return s.account.passwordNew},onInput:g,get showCopy(){return n(f)},get width(){return e.inputWidth},get value(){return t().new},set value(T){t(t().new=T,!0)}});var N=c(J,2);Ga(N,{autocomplete:"new-password",get label(){return s.account.passwordConfirm},get placeholder(){return s.account.passwordConfirm},onInput:g,get showCopy(){return n(f)},get width(){return e.inputWidth},get value(){return t().newConfirm},set value(T){t(t().newConfirm=T,!0)}});var G=c(N,2),ne=i(G);Me(ne,{onclick:R,level:2,children:(T,ve)=>{Ee();var Z=Ce();D(()=>w(Z,s.account.generateRandom)),v(T,Z)},$$slots:{default:!0}}),o(G);var he=c(G,2),S=i(he,!0);o(he),o(P),D(()=>w(S,n(h))),v(b,P)};A(L,b=>{n(u)&&b(E)})}return v(a,_),Le({isPwdValid:g})}var Is=x('<div class="m-05 svelte-1l5u0ph"><p class="svelte-1l5u0ph"> </p> <p class="svelte-1l5u0ph"><b> </b></p> <p class="svelte-1l5u0ph"> </p> <!></div>'),zs=x('<p class="svelte-1l5u0ph"> </p> <p class="svelte-1l5u0ph"> </p> <p class="svelte-1l5u0ph"> </p> <div><!></div>',1),Es=x('<div class="success svelte-1l5u0ph"><!></div>'),Cs=x('<div class="err"> </div>'),As=x('<div class="cancel"><!></div>'),Ss=x('<div class="convertPasskey svelte-1l5u0ph"><h3> </h3> <p class="svelte-1l5u0ph"> </p> <!></div>'),Ls=x('<div><!> <div class="save svelte-1l5u0ph"><!> <!></div></div> <!>',1),Ns=x('<div class="wrapper svelte-1l5u0ph"><div class="container svelte-1l5u0ph"><!> <!> <!> <!></div></div>');function Vt(a,e){Se(e,!0);let t=$(e,"user",15),r=Ne(),l=fe(()=>e.viewModePhone?"calc(100vw - 1.5rem)":"300px"),s=q(C(t().account_type)),d=q(C([])),h=q(void 0),u=q(!1),f=q(!1),g=q(""),R=q(!1),_=q(void 0),L=q(C({current:"",new:"",newConfirm:""})),E=fe(()=>n(d).filter(M=>M.user_verified).length>0);wa(()=>{b()});async function b(){let M=await va(`/auth/v1/users/${t().id}/webauthn`);M.body?m(d,C(M.body)):console.error("error fetching passkeys: "+M.error)}async function P(){let M=await ya(`/auth/v1/users/${t().id}/self/convert_passkey`);M.error?console.error("error fetching passkeys: "+M.error):window.location.reload()}async function F(){m(g,""),n(d).length>0?await K():await Y()}async function K(){var M;if(!((M=n(h))!=null&&M())){m(g,C(r.common.invalidInput));return}m(_,"PasswordNew")}async function Y(M){var V,ae;if(!((V=n(h))!=null&&V())){m(g,C(r.common.invalidInput));return}m(f,!0);let p={password_new:n(L).new};M?p.mfa_code=M:p.password_current=n(L).current;let I=await vt(`/auth/v1/users/${t().id}/self`,p);I.body?(m(R,!0),m(L,C({current:"",new:"",newConfirm:""})),t(I.body),m(s,C(I.body.account_type)),setTimeout(()=>{m(R,!1),m(u,!1)},3e3)):m(g,C(((ae=I.error)==null?void 0:ae.message)||"Error")),m(f,!1)}function J(M){m(_,void 0),m(g,C(M)),setTimeout(()=>{m(g,"")},5e3)}function N(M){m(_,void 0),M&&Y(M.code)}async function G(){let M=await Cr({email:t().email});if(M.ok)m(R,!0);else{let p=await M.json();m(g,C(p.message))}}var ne=Ns(),he=i(ne),S=i(he);{var T=M=>{ft(M,{get userId(){return t().id},get purpose(){return n(_)},onSuccess:N,onError:J})};A(S,M=>{n(_)&&M(T)})}var ve=c(S,2);{var Z=M=>{var p=Is(),I=i(p),V=i(I,!0);o(I);var ae=c(I,2),Q=i(ae),O=i(Q,!0);o(Q),o(ae);var ce=c(ae,2),xe=i(ce,!0);o(ce);var H=c(ce,2);{var y=k=>{Lr(k,{check:!0})},j=k=>{Me(k,{level:3,onclick:G,children:(U,X)=>{Ee();var W=Ce();D(()=>w(W,r.account.passwordReset)),v(U,W)},$$slots:{default:!0}})};A(H,k=>{n(R)?k(y):k(j,!1)})}o(p),D(()=>{var k;w(V,r.account.federatedConvertPassword1),w(O,((k=e.authProvider)==null?void 0:k.name)||"UNKNOWN"),w(xe,r.account.federatedConvertPassword2)}),v(M,p)};A(ve,M=>{n(s)==="federated"&&M(Z)})}var re=c(ve,2);{var B=M=>{var p=zs(),I=se(p),V=i(I,!0);o(I);var ae=c(I,2),Q=i(ae,!0);o(ae);var O=c(ae,2),ce=i(O,!0);o(O);var xe=c(O,2),H=i(xe);Me(H,{level:2,onclick:()=>m(u,!0),children:(y,j)=>{Ee();var k=Ce();D(()=>w(k,r.account.convertAccount)),v(y,k)},$$slots:{default:!0}}),o(xe),D(()=>{w(V,r.account.accTypePasskeyText1),w(Q,r.account.accTypePasskeyText2),w(ce,r.account.accTypePasskeyText3)}),v(M,p)};A(re,M=>{(n(s)==="passkey"||n(s)==="federated_passkey")&&!n(u)&&M(B)})}var ee=c(re,2);{var ue=M=>{var p=Ls(),I=se(p),V=i(I),ae=fe(()=>!(n(s)==="password"&&n(d).length<1));$s(V,{get inputWidth(){return n(l)},get hideCurrentPassword(){return n(ae)},get passwords(){return n(L)},set passwords(k){m(L,C(k))},get isValid(){return n(h)},set isValid(k){m(h,C(k))}});var Q=c(V,2),O=i(Q);Me(O,{onclick:F,level:1,get isLoading(){return n(f)},children:(k,U)=>{Ee();var X=Ce();D(()=>w(X,r.common.save)),v(k,X)},$$slots:{default:!0}});var ce=c(O,2);{var xe=k=>{var U=Es(),X=i(U);Ba(X,{}),o(U),Be(3,U,()=>na),v(k,U)},H=k=>{var U=Ie(),X=se(U);{var W=me=>{var we=Cs(),ge=i(we,!0);o(we),D(()=>w(ge,n(g))),Be(3,we,()=>na),v(me,we)},le=me=>{var we=Ie(),ge=se(we);{var de=ke=>{var _e=As(),Te=i(_e);Me(Te,{level:3,onclick:()=>m(u,!1),children:(je,Re)=>{Ee();var be=Ce();D(()=>w(be,r.common.cancel)),v(je,be)},$$slots:{default:!0}}),o(_e),v(ke,_e)};A(ge,ke=>{n(u)&&!n(f)&&ke(de)},!0)}v(me,we)};A(X,me=>{n(g)?me(W):me(le,!1)},!0)}v(k,U)};A(ce,k=>{n(R)?k(xe):k(H,!1)})}o(Q),o(I);var y=c(I,2);{var j=k=>{var U=Ss(),X=i(U),W=i(X,!0);o(X);var le=c(X,2),me=i(le,!0);o(le);var we=c(le,2);Me(we,{level:2,onclick:P,children:(ge,de)=>{Ee();var ke=Ce();D(()=>w(ke,r.account.convertAccount)),v(ge,ke)},$$slots:{default:!0}}),o(U),D(()=>{w(W,r.account.convertAccount),w(me,r.account.convertAccountP1)}),v(k,U)};A(y,k=>{!n(u)&&n(E)&&k(j)})}v(M,p)};A(ee,M=>{(n(s)==="password"||n(s)==="federated_password"||n(u))&&M(ue)})}o(he),o(ne),v(a,ne),Le()}var Ts=x('<div><p class="svelte-naxx27"> </p>    <textarea class="font-mono text svelte-naxx27"></textarea></div>'),js=x('<div class="success svelte-naxx27">Update successful</div>'),Rs=x('<div class="err svelte-naxx27"> </div>'),Ps=x('<div class="wrapper svelte-naxx27"><div class="container svelte-naxx27"><p class="svelte-naxx27"> </p> <p class="svelte-naxx27"><a target="_blank"><!></a></p> <div class="row svelte-naxx27"><div class="label svelte-naxx27">E-Mail</div> <!></div> <div class="row svelte-naxx27"><div class="label svelte-naxx27"> </div> <!></div> <!> <!> <div class="bottom svelte-naxx27"><!></div></div></div>');function Yt(a,e){Se(e,!0);let t=$(e,"webIdData",15),r=Ne();const l="12rem";let s=q(""),d=q(!1),h=q(!!t().custom_triples),u=Na(t().user_id);Nr(()=>{n(d)&&setTimeout(()=>{m(d,!1)},3e3)});async function f(){m(s,"");let B=await Ar(t().user_id,t());if(B.ok)m(d,!0);else{let ee=await B.json();m(s,C(ee.message))}}var g=Ps(),R=i(g),_=i(R),L=i(_,!0);o(_);var E=c(_,2),b=i(E);z(b,"href",u);var P=i(b);ot(P,()=>u.replace("/auth/","/auth/<wbr/>")),o(b),o(E);var F=c(E,2),K=c(i(F),2);lt(K,{get selected(){return t().expose_email},set selected(B){t(t().expose_email=B,!0)}}),o(F);var Y=c(F,2),J=i(Y),N=i(J,!0);o(J);var G=c(J,2);lt(G,{get selected(){return n(h)},set selected(B){m(h,C(B))}}),o(Y);var ne=c(Y,2);{var he=B=>{var ee=Ts(),ue=i(ee),M=i(ue,!0);o(ue);var p=c(ue,2);cr(p),z(p,"rows",15),z(p,"cols",40),o(ee),D(()=>w(M,r.account.webIdDescData)),Ta(p,()=>t().custom_triples,I=>t(t().custom_triples=I,!0)),Be(3,ee,()=>ja),v(B,ee)};A(ne,B=>{n(h)&&B(he)})}var S=c(ne,2);Tr(S,{width:l,level:1,$$events:{click:f},children:(B,ee)=>{Ee();var ue=Ce();D(()=>w(ue,r.common.save)),v(B,ue)},$$slots:{default:!0}});var T=c(S,2),ve=i(T);{var Z=B=>{var ee=js();Be(3,ee,()=>na),v(B,ee)},re=B=>{var ee=Ie(),ue=se(ee);{var M=p=>{var I=Rs(),V=i(I,!0);o(I),D(()=>w(V,n(s))),Be(3,I,()=>na),v(p,I)};A(ue,p=>{n(s)&&p(M)},!0)}v(B,ee)};A(ve,B=>{n(d)?B(Z):B(re,!1)})}o(T),o(R),o(g),D(()=>{w(L,r.account.webIdDesc),w(N,r.account.webIdExpertMode)}),v(a,g),Le()}function Us(a){ct(a,{viewMode:"account"})}var Ks=x('<span class="font-label tab svelte-mkcuiv"> </span>'),qs=x('<div class="tabs svelte-mkcuiv"></div>');function Ft(a,e){Se(e,!0);let t=$(e,"selected",15,""),r=$(e,"borderRadius",3,"5px"),l=$(e,"center",3,!1),s=$(e,"width",3,"inherit");e.tabs.length>0&&t()===""&&t(e.tabs[0]);var d=qs();ra(d,21,()=>e.tabs,ba,(h,u)=>{var f=fe(()=>n(u)===t()?"step":void 0);Me(h,{get ariaCurrent(){return n(f)},invisible:!0,onclick:()=>t(n(u)),children:(g,R)=>{var _=Ks(),L=i(_,!0);o(_),D(()=>{z(_,"data-selected",n(u)===t()),w(L,n(u))}),v(g,_)},$$slots:{default:!0}})}),o(d),D(()=>{Ra(d,"center",l()),ua(d,"border-radius",r()),ua(d,"width",s())}),v(a,d),Le()}var Bs=x("<h3> </h3>"),Ws=x('<div class="headerPhone svelte-6pjzk1"><!></div> <div class="container svelte-6pjzk1"><!> <div class="innerPhone svelte-6pjzk1"><!></div></div>',1),Vs=x('<div class="header svelte-6pjzk1"><!></div> <div class="container svelte-6pjzk1"><!> <div class="inner svelte-6pjzk1"><!></div></div>',1),Ys=x('<!> <div class="wrapper svelte-6pjzk1"><!></div>',1);function Fs(a,e){Se(e,!0);const t=K=>{var Y=Bs(),J=i(Y,!0);o(Y),D(()=>w(J,`${r().given_name} ${r().family_name||""}`)),v(K,Y)};let r=$(e,"user",15),l=$(e,"webIdData",15),s=Ne(),d=q(void 0),h=q(C([])),u=fe(()=>{var K;if((K=r().account_type)!=null&&K.startsWith("federated"))return n(h).filter(Y=>Y.id===r().auth_provider_id)[0]}),f=fe(()=>n(d)&&n(d)<500),g=q(C(s.account.navInfo)),R=C(l()?[s.account.navInfo,s.account.navEdit,s.common.password,s.account.navMfa,"WebID",s.account.devices,s.account.navLogout]:[s.account.navInfo,s.account.navEdit,s.common.password,s.account.navMfa,s.account.devices,s.account.navLogout]);wa(()=>{Rr("v").get()==="devices"&&m(g,C(s.account.devices))}),qe(()=>{n(g)===s.account.navLogout&&gr()});var _=Ys(),L=se(_);jr(L,{id:wr,get value(){return n(h)},set value(K){m(h,C(K))}});var E=c(L,2),b=i(E);{var P=K=>{var Y=Ws(),J=se(Y),N=i(J);t(N),o(J);var G=c(J,2),ne=i(G);Ft(ne,{get tabs(){return R},get selected(){return n(g)},set selected(Z){m(g,C(Z))}});var he=c(ne,2),S=i(he);{var T=Z=>{gt(Z,{get providers(){return n(h)},get authProvider(){return n(u)},viewModePhone:!0,get webIdData(){return l()},get user(){return r()},set user(re){r(re)}})},ve=Z=>{var re=Ie(),B=se(re);{var ee=M=>{Kt(M,{viewModePhone:!0,get user(){return r()},set user(p){r(p)}})},ue=M=>{var p=Ie(),I=se(p);{var V=Q=>{Vt(Q,{get user(){return r()},get authProvider(){return n(u)},viewModePhone:!0})},ae=Q=>{var O=Ie(),ce=se(O);{var xe=y=>{qt(y,{get user(){return r()}})},H=y=>{var j=Ie(),k=se(j);{var U=W=>{Yt(W,{get webIdData(){return l()},set webIdData(le){l(le)}})},X=W=>{var le=Ie(),me=se(le);{var we=ge=>{ct(ge,{})};A(me,ge=>{n(g)===s.account.devices&&ge(we)},!0)}v(W,le)};A(k,W=>{n(g)==="WebID"?W(U):W(X,!1)},!0)}v(y,j)};A(ce,y=>{n(g)===s.account.navMfa?y(xe):y(H,!1)},!0)}v(Q,O)};A(I,Q=>{n(g)===s.common.password?Q(V):Q(ae,!1)},!0)}v(M,p)};A(B,M=>{n(g)===s.account.navEdit?M(ee):M(ue,!1)},!0)}v(Z,re)};A(S,Z=>{n(g)===s.account.navInfo?Z(T):Z(ve,!1)})}o(he),o(G),v(K,Y)},F=K=>{var Y=Vs(),J=se(Y),N=i(J);t(N),o(J);var G=c(J,2),ne=i(G);Ft(ne,{get tabs(){return R},center:!0,get selected(){return n(g)},set selected(Z){m(g,C(Z))}});var he=c(ne,2),S=i(he);{var T=Z=>{gt(Z,{get webIdData(){return l()},get providers(){return n(h)},get authProvider(){return n(u)},get user(){return r()},set user(re){r(re)}})},ve=Z=>{var re=Ie(),B=se(re);{var ee=M=>{Kt(M,{get user(){return r()},set user(p){r(p)}})},ue=M=>{var p=Ie(),I=se(p);{var V=Q=>{Vt(Q,{get user(){return r()},get authProvider(){return n(u)}})},ae=Q=>{var O=Ie(),ce=se(O);{var xe=y=>{qt(y,{get user(){return r()}})},H=y=>{var j=Ie(),k=se(j);{var U=W=>{Yt(W,{get webIdData(){return l()},set webIdData(le){l(le)}})},X=W=>{var le=Ie(),me=se(le);{var we=ge=>{Us(ge)};A(me,ge=>{n(g)===s.account.devices&&ge(we)},!0)}v(W,le)};A(k,W=>{n(g)==="WebID"?W(U):W(X,!1)},!0)}v(y,j)};A(ce,y=>{n(g)===s.account.navMfa?y(xe):y(H,!1)},!0)}v(Q,O)};A(I,Q=>{n(g)===s.common.password?Q(V):Q(ae,!1)},!0)}v(M,p)};A(B,M=>{n(g)===s.account.navEdit?M(ee):M(ue,!1)},!0)}v(Z,re)};A(S,Z=>{n(g)===s.account.navInfo?Z(T):Z(ve,!1)})}o(he),o(G),v(K,Y)};A(b,K=>{n(f)?K(P):K(F,!1)})}o(E),vr("innerWidth",K=>m(d,C(K))),v(a,_),Le()}var Os=x("<!> <!> <!>",1);function Js(a,e){Se(e,!0);let t=Ne(),r=it("account"),l=q(void 0),s=q(void 0),d=q(!1);qe(()=>{let u=r.get();u&&h(u)});async function h(u){const f=u.user_id;if(f){let g=await Promise.all([va(`/auth/v1/users/${f}`),va(`/auth/v1/users/${f}/webid/data`)]);g[0].body?m(l,C(g[0].body)):yr("account"),g[1].body?m(s,C(g[1].body)):g[1].status===404&&m(s,C({user_id:f,expose_email:!1})),m(d,!0)}else console.error("no user_id in session")}ir(u=>{D(()=>{var f;return or.title=`${((t==null?void 0:t.account.account)||"Account")??""} ${((f=n(l))==null?void 0:f.email)??""}`})}),Pr(a,{children:(u,f)=>{Ur(u,{children:(g,R)=>{var _=Os(),L=se(_);{var E=F=>{Fs(F,{get user(){return n(l)},set user(K){m(l,C(K))},get webIdData(){return n(s)},set webIdData(K){m(s,C(K))}})};A(L,F=>{n(d)&&r&&n(l)&&F(E)})}var b=c(L,2);xr(b,{absolute:!0});var P=c(b,2);zr(P,{absolute:!0}),v(g,_)},$$slots:{default:!0}})},$$slots:{default:!0}}),Le()}export{Js as component};

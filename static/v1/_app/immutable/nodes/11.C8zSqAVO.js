import{a as $,t as N,e as Lt}from"../chunks/disclose-version.BP4T4xdV.js";import{a as rt,c as s,r as a,a7 as U,s as t,t as A,j as o,p as it,l as V,f as nt,k as n,a9 as ht,a5 as jt}from"../chunks/index-client.hxMyB_b4.js";import{s as r}from"../chunks/render.yNX9q8-B.js";import{i as ot}from"../chunks/if.BeBa1Kxb.js";import{h as z}from"../chunks/html.704f8A94.js";import{p as _}from"../chunks/proxy.DaVNR9vk.js";import{a as qt}from"../chunks/window.VkMEdvit.js";import{B as Dt}from"../chunks/Button.BR1gOfNn.js";import{e as Ut,i as At}from"../chunks/each.BUp7aLCc.js";import{u as vt}from"../chunks/i18n_admin.svelte.lt3dD7TQ.js";import{I as lt}from"../chunks/pow.BMnvYon0.js";import{F as Et}from"../chunks/Form.BnvI_UPN.js";import{b as Ft,f as Gt}from"../chunks/fetch.Bq59EV_b.js";var Jt=N('<div class="row svelte-1v63e3g"><div class="svelte-1v63e3g"> </div> <div class="svelte-1v63e3g"> </div> <div class="svelte-1v63e3g"> </div> <div class="svelte-1v63e3g"> </div></div>'),Kt=N('<div><div class="row header font-label svelte-1v63e3g"><div class="svelte-1v63e3g"> </div> <div class="svelte-1v63e3g">t_cost</div> <div class="svelte-1v63e3g">m_cost</div> <div class="svelte-1v63e3g">p_cost</div></div> <!> <div style="height: 1.5rem"></div></div>');function Mt(B,k){rt(k,!0);let e=vt();var v=Kt(),h=s(v),g=s(h),y=s(g);a(g),U(6),a(h);var C=t(h,2);Ut(C,17,()=>k.res,At,(l,u)=>{var m=Jt(),w=s(m),j=s(w,!0);a(w);var b=t(w,2),q=s(b,!0);a(b);var T=t(b,2),H=s(T,!0);a(T);var i=t(T,2),d=s(i,!0);a(i),a(m),A(()=>{r(j,o(u).time_taken),r(q,o(u).t_cost),r(H,o(u).m_cost),r(d,o(u).p_cost)}),$(l,m)}),U(2),a(v),A(()=>r(y,`${e.common.time??""} (ms)`)),$(B,v),it()}var Ot=N("<!> <!> <!> <!>",1),Pt=N('<div class="result svelte-d61iiz"><!></div>'),Rt=N('<div class="err"> </div>'),Wt=N('<div class="wrapper svelte-d61iiz"><div class="container svelte-d61iiz"><!></div> <!> <!></div>');function Yt(B,k){rt(k,!0);const e="10rem";let v=vt(),h=V(!1),g=V(""),y=V(_([])),C=V(void 0),l=_({targetTime:"1000",mCost:k.params.m_cost.toString()||"32768",pCost:k.params.p_cost.toString()||"2"});async function u(i,d){var I;n(h,!0),n(y,_([]));const c={target_time:Number.parseInt(l.targetTime),m_cost:Number.parseInt(l.mCost),p_cost:Number.parseInt(l.pCost)};let x=await Ft(i.action,c);x.body?(n(y,_(x.body.results)),n(g,""),setTimeout(()=>{n(C,_(window.innerHeight))},50)):n(g,_(((I=x.error)==null?void 0:I.message)||"Error")),n(h,!1)}var m=Wt(),w=s(m),j=s(w);Et(j,{action:"/auth/v1/password_hash_times",onSubmit:u,children:(i,d)=>{var c=Ot(),x=nt(c),I=ht(()=>`${v.docs.hashing.targetTime} (ms)`),E=ht(()=>`${v.docs.hashing.targetTime} (ms)`);lt(x,{typ:"number",autocomplete:"off",get label(){return o(I)},get placeholder(){return o(E)},min:"500",max:"99999",required:!0,width:e,get value(){return l.targetTime},set value(f){l.targetTime=f}});var S=t(x,2);lt(S,{typ:"number",autocomplete:"off",label:"m_cost (kB)",placeholder:"m_cost (kB)",min:"32768",width:e,get value(){return l.mCost},set value(f){l.mCost=f}});var L=t(S,2);lt(L,{typ:"number",autocomplete:"off",label:"p_cost",placeholder:"p_cost",min:"2",max:"256",width:e,get value(){return l.pCost},set value(f){l.pCost=f}});var F=t(L,2);Dt(F,{type:"submit",get isLoading(){return o(h)},children:(f,dt)=>{U();var D=Lt();A(()=>r(D,v.docs.hashing.calculate)),$(f,D)},$$slots:{default:!0}}),$(i,c)},$$slots:{default:!0}}),a(w);var b=t(w,2);{var q=i=>{var d=Pt(),c=s(d);Mt(c,{get res(){return o(y)}}),a(d),$(i,d)};ot(b,i=>{o(y).length>0&&i(q)})}var T=t(b,2);{var H=i=>{var d=Rt(),c=s(d,!0);a(d),A(()=>r(c,o(g))),$(i,d)};ot(T,i=>{o(g)&&i(H)})}a(m),qt("y",()=>o(C),i=>n(C,_(i))),$(B,m),it()}var Qt=N('<h3>Argon2ID - Password Hashing</h3> <p> </p><p></p><p><b> </b><br> </p> <p> </p> <ul><li><b>m_cost</b> <p><!></p> <p><!></p> <p><!></p></li> <li><b>p_cost</b> <p><!></p> <p><!></p></li> <li><b>t_cost</b> <p><!></p> <p><!></p></li></ul> <br> <h3> </h3> <p> </p> <p> </p> <br> <h3> </h3> <p> </p> <div><div class="flex"><div class="label svelte-klhp01">m_cost:</div> </div> <div class="flex"><div class="label svelte-klhp01">p_cost:</div> </div> <div class="flex"><div class="label svelte-klhp01">t_cost:</div> </div> <br> <div class="flex"><div class="label svelte-klhp01">Login Time:</div> </div> <p> </p> <b> </b> <br></div> <br> <h3> </h3> <p> </p> <p><!></p> <!> <div style="height: 1.5rem"></div>',1);function Xt(B,k){rt(k,!0);let e=vt(),v=V(void 0),h=V(void 0),g=V(void 0);jt(async()=>{let p=await Gt("/auth/v1/login_time");p.body?(n(v,_(p.body.argon2_params)),n(h,_(p.body.login_time)),n(g,_(p.body.num_cpus))):console.error(p.error)});var y=Qt(),C=t(nt(y),2),l=s(C,!0);a(C);var u=t(C,2),m=s(u),w=s(m,!0);a(m);var j=t(m,2);a(u);var b=t(u,2),q=s(b,!0);a(b);var T=t(b,2),H=s(T),i=t(s(H),2),d=s(i);z(d,()=>e.docs.hashing.mCost1),a(i);var c=t(i,2),x=s(c);z(x,()=>e.docs.hashing.mCost2),a(c);var I=t(c,2),E=s(I);z(E,()=>e.docs.hashing.mCost3),a(I),a(H);var S=t(H,2),L=t(s(S),2),F=s(L);z(F,()=>e.docs.hashing.pCost1),a(L);var f=t(L,2),dt=s(f);z(dt,()=>e.docs.hashing.pCost2),a(f),a(S);var D=t(S,2),G=t(s(D),2),gt=s(G);z(gt,()=>e.docs.hashing.tCost1),a(G);var ct=t(G,2),ut=s(ct);z(ut,()=>e.docs.hashing.tCost2),a(ct),a(D),a(T);var J=t(T,4),bt=s(J,!0);a(J);var K=t(J,2),ft=s(K,!0);a(K);var M=t(K,2),_t=s(M,!0);a(M);var O=t(M,4),yt=s(O,!0);a(O);var P=t(O,2),Ct=s(P,!0);a(P);var R=t(P,2),W=s(R),wt=t(s(W));a(W);var Y=t(W,2),Tt=t(s(Y));a(Y);var Q=t(Y,2),kt=t(s(Q));a(Q);var X=t(Q,4),xt=t(s(X));a(X);var Z=t(X,2),$t=s(Z,!0);a(Z);var tt=t(Z,2),zt=s(tt,!0);a(tt);var Bt=t(tt);U(),a(R);var st=t(R,4),Ht=s(st,!0);a(st);var at=t(st,2),It=s(at,!0);a(at);var et=t(at,2),Nt=s(et);z(Nt,()=>e.docs.hashing.utility2),a(et);var Vt=t(et,2);{var St=p=>{Yt(p,{get params(){return o(v)}})};ot(Vt,p=>{o(v)&&p(St)})}U(2),A(()=>{var p,pt,mt;r(l,e.docs.hashing.pUtility),r(w,e.docs.hashing.tune),r(j,` ${e.docs.hashing.pTune??""}`),r(q,e.docs.hashing.pDetials),r(bt,e.docs.hashing.loginTimeHead),r(ft,e.docs.hashing.loginTime1),r(_t,e.docs.hashing.loginTime2),r(yt,e.docs.hashing.currValuesHead),r(Ct,e.docs.hashing.currValues1),r(wt,` ${((p=o(v))==null?void 0:p.m_cost)??""} kB`),r(Tt,` ${((pt=o(v))==null?void 0:pt.p_cost)??""} threads`),r(kt,` ${((mt=o(v))==null?void 0:mt.t_cost)??""}`),r(xt,` ${o(h)??""} ms`),r($t,e.docs.hashing.currValuesNote),r(zt,e.docs.hashing.currValuesThreadsAccess),r(Bt,`: ${o(g)??""}`),r(Ht,e.docs.hashing.utilityHead),r(It,e.docs.hashing.utility1)}),$(B,y),it()}function Zt(B){Xt(B,{})}export{Zt as component};

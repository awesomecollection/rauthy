import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.Dmu0D13_.js";import{p as Pe,A as d,ap as Ie,a6 as le,f as k,t as C,a as ke,y as e,z as t,s as h,ar as Y,c as g,ab as Ce,r as b,K as Te}from"../chunks/index-client.CVQra9Cu.js";import{s as T}from"../chunks/render.CkKFmY3E.js";import{i as Z}from"../chunks/if._4yhN2kP.js";import{e as me}from"../chunks/each.D7w_Y1pv.js";import{a as o,t as y,d as ve,e as _}from"../chunks/template.4ZWi6dE6.js";import{a as Ee}from"../chunks/index.CkVfMYgG.js";import{p as r}from"../chunks/proxy.Dc6q2r8X.js";import{O as De}from"../chunks/OrderSearchBar.BAXBsyAw.js";import{B as H}from"../chunks/Button.B6DffihK.js";import{I as Me}from"../chunks/Input.kE1yFgI6.js";import{A as Se,l as ze}from"../chunks/helpers.B0e_YzoL.js";import{u as Ae}from"../chunks/i18n.svelte.DVZudxvm.js";import{u as Be}from"../chunks/i18n_admin.svelte.CtFnAESg.js";import{I as Fe}from"../chunks/InputDateTimeCombo.Rc-MRb7l.js";import{f as ne,a as Le}from"../chunks/form.DekAF1-C.js";import{I as Oe}from"../chunks/IconStop.DlqoW6sr.js";import{f as Ve,b as je,c as qe}from"../chunks/fetch.B_P4c8fm.js";import{C as Ke}from"../chunks/ContentAdmin.p5jUo2m-.js";import{B as Ne}from"../chunks/ButtonAddModal.W1tXC5iJ.js";import{b as Ue}from"../chunks/patterns.DpOwmcHv.js";import{F as We}from"../chunks/Form.9PZRDz5w.js";import{T as pe}from"../chunks/Tooltip.Q92keWA_.js";import{P as Ge}from"../chunks/Pagination.CjMKhC5k.js";var Je=y('<!> <!> <div></div> <!> <div class="err"> </div>',1),Qe=y('<div class="addNew svelte-1v7phw9"><!></div>'),Re=y("<div> </div>"),Xe=y('<div class="ip svelte-1v7phw9"><!></div>'),Ye=y('<div class="delete svelte-1v7phw9"><!></div>'),Ze=y('<div class="blacklisted svelte-1v7phw9"><!> <div class="date svelte-1v7phw9"> </div> <!></div>'),_e=y('<div class="top svelte-1v7phw9"><!> <!></div> <div id="blacklist"><!></div> <!>',1),He=y(" <!>",1);function er(O,de){Pe(de,!0);let V=Ae(),ce=Be();const ee=30;let j=d(void 0),q=d(void 0),K=d(""),z=d(""),P=d(r([])),E=d(r([])),N=d(r([])),A=d(""),U=d(r(ne())),W=d(r(Le())),G=d(""),re=["IP"];Ie(()=>{J()}),le(()=>{var a;(a=e(j))==null||a.focus()}),le(()=>{let a=e(G).toLowerCase();a?t(E,r(e(P).filter(m=>{var c;return(c=m.ip)==null?void 0:c.includes(a)}))):t(E,r(e(P)))});async function J(){var m;let a=await Ve("/auth/v1/blacklist");a.body?t(P,r(a.body.ips)):t(K,r(((m=a.error)==null?void 0:m.message)||"Error"))}async function fe(a,m){var B;t(z,"");let c=Se(e(U),e(W));if(!c){t(z,"Invalid Date Input: User Expires");return}let w={ip:e(A),exp:c},$=await je(a.action,w);$.error?t(z,r($.error.message)):(t(A,""),(B=e(q))==null||B(),await J())}async function ue(a){let m=await qe(`/auth/v1/blacklist/${a}`);m.error?t(K,r(m.error.message)):await J()}function he(a,m){let c=m==="up";a===re[0]&&e(P).sort((w,$)=>c?w.ip.localeCompare($.ip):$.ip.localeCompare(w.ip))}Y();var ae=He(),te=k(ae),ge=h(te);Ke(ge,{children:(a,m)=>{var c=_e(),w=k(c),$=g(w);De($,{orderOptions:re,onChangeOrder:he,searchWidth:"min(15.75rem, calc(100dvw - 1rem))",get value(){return e(G)},set value(i){t(G,r(i))}});var B=h($,2);Ne(B,{level:1,get closeModal(){return e(q)},set closeModal(i){t(q,r(i))},children:(i,v)=>{var x=Qe(),R=g(x);We(R,{action:"/auth/v1/blacklist",onSubmit:fe,children:(X,ie)=>{var n=Je(),s=k(n);Me(s,{autocomplete:"off",label:"IP",placeholder:"IPv4",errMsg:"IPv4",required:!0,maxLength:15,pattern:Ue,get ref(){return e(j)},set ref(p){t(j,r(p))},get value(){return e(A)},set value(p){t(A,r(p))}});var f=h(s,2),l=Ce(ne);Fe(f,{label:"Expiry",get min(){return e(l)},withTime:!0,get value(){return e(U)},set value(p){t(U,r(p))},get timeValue(){return e(W)},set timeValue(p){t(W,r(p))}});var u=h(f,2);Ee(u,"height",".5rem");var F=h(u,2);H(F,{type:"submit",children:(p,I)=>{Y();var M=ve();C(()=>T(M,V.common.save)),o(p,M)},$$slots:{default:!0}});var L=h(F,2),D=g(L,!0);b(L),C(()=>T(D,e(z))),o(X,n)},$$slots:{default:!0}}),b(x),o(i,x)},$$slots:{default:!0}}),b(w);var Q=h(w,2),be=g(Q);{var we=i=>{var v=Re(),x=g(v,!0);b(v),C(()=>T(x,ce.common.noEntries)),o(i,v)},$e=i=>{var v=_();const x=(n,s=Te)=>{var f=Ze(),l=g(f);H(l,{invisible:!0,onclick:()=>navigator.clipboard.writeText(s().ip),children:(D,p)=>{var I=Xe(),M=g(I);pe(M,{get text(){return V.common.copyToClip},children:(S,se)=>{Y();var oe=ve();C(()=>T(oe,s().ip)),o(S,oe)},$$slots:{default:!0}}),b(I),o(D,I)},$$slots:{default:!0}});var u=h(l,2),F=g(u,!0);C(()=>T(F,ze(s().exp))),b(u);var L=h(u,2);H(L,{invisible:!0,onclick:()=>ue(s().ip),children:(D,p)=>{pe(D,{get text(){return V.common.delete},children:(I,M)=>{var S=Ye(),se=g(S);Oe(se,{width:"1.25rem"}),b(S),o(I,S)},$$slots:{default:!0}})},$$slots:{default:!0}}),b(f),o(n,f)};var R=k(v);{var X=n=>{var s=_(),f=k(s);me(f,17,()=>e(N),l=>l.ip,(l,u)=>{x(l,()=>e(u))}),o(n,s)},ie=n=>{var s=_(),f=k(s);me(f,17,()=>e(E),l=>l.ip,(l,u)=>{x(l,()=>e(u))}),o(n,s)};Z(R,n=>{e(P).length>ee?n(X):n(ie,!1)})}o(i,v)};Z(be,i=>{e(P).length===0?i(we):i($e,!1)})}b(Q);var xe=h(Q,2);{var ye=i=>{Ge(i,{pageSize:30,get items(){return e(E)},set items(v){t(E,r(v))},get itemsPaginated(){return e(N)},set itemsPaginated(v){t(N,r(v))}})};Z(xe,i=>{e(P).length>ee&&i(ye)})}o(a,c)},$$slots:{default:!0}}),C(()=>T(te,`${e(K)??""} `)),o(O,ae),ke()}function rr(O){er(O,{})}export{rr as component};

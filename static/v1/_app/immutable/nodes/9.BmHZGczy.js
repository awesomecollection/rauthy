import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.pqhLE6I2.js";import{p as ye,w as d,ao as Ie,a4 as le,f as k,t as C,a as ke,u as e,v as t,s as h,aq as Y,c as g,a9 as Ce,r as w,F as Ee}from"../chunks/index-client.ChFmlJin.js";import{s as E}from"../chunks/render.D821es-0.js";import{i as Z}from"../chunks/if.DhkeN2Rc.js";import{e as ve}from"../chunks/each.QTCItWz3.js";import{a as o,t as P,d as me,e as _}from"../chunks/template.DOaMAhd6.js";import{a as Te}from"../chunks/index.BCW953sO.js";import{p as r}from"../chunks/proxy.DVTQVrWW.js";import{O as De}from"../chunks/OrderSearchBar.B1t7qsWa.js";import{B as J}from"../chunks/Button.DAsYf-wl.js";import{I as Me}from"../chunks/Input.1-DRzlwb.js";import{A as Se,l as qe}from"../chunks/helpers.BweJi6s8.js";import{u as Be}from"../chunks/i18n.svelte.CKzx-KOG.js";import{u as Fe}from"../chunks/i18n_admin.svelte.DaAJojhX.js";import{I as Le}from"../chunks/InputDateTimeCombo.D5LtiRAE.js";import{f as pe,a as Oe}from"../chunks/form.DekAF1-C.js";import{I as Ve}from"../chunks/IconStop.Bd6MwChf.js";import{f as ze,b as Ae,c as He}from"../chunks/fetch.BnpwKXAn.js";import{C as Ne}from"../chunks/ContentAdmin.DzfHDjJm.js";import{B as Ue}from"../chunks/ButtonAddModal.B27JWl2h.js";import{b as We}from"../chunks/patterns.C8SwZZE-.js";import{F as je}from"../chunks/Form.CETj1VzV.js";import{T as ne}from"../chunks/Tooltip.BAwoG0FP.js";import{P as Ge}from"../chunks/Pagination.Cj3Ui_po.js";var Ke=P('<!> <!> <div></div> <!> <div class="err"> </div>',1),Qe=P('<div class="addNew svelte-1v7phw9"><!></div>'),Re=P("<div> </div>"),Xe=P('<div class="ip svelte-1v7phw9"><!></div>'),Ye=P('<div class="delete svelte-1v7phw9"><!></div>'),Ze=P('<div class="blacklisted svelte-1v7phw9"><!> <div class="date svelte-1v7phw9"> </div> <!></div>'),_e=P('<div class="top svelte-1v7phw9"><!> <!></div> <div id="blacklist"><!></div> <!>',1),Je=P(" <!>",1);function er(V,de){ye(de,!0);let z=Be(),ce=Fe();const ee=30;let A=d(void 0),H=d(void 0),N=d(""),q=d(""),y=d(r([])),T=d(r([])),U=d(r([])),B=d(""),W=d(r(pe())),j=d(r(Oe())),G=d(""),re=["IP"];Ie(()=>{K()}),le(()=>{var a;(a=e(A))==null||a.focus()}),le(()=>{let a=e(G).toLowerCase();a?t(T,r(e(y).filter(v=>{var c;return(c=v.ip)==null?void 0:c.includes(a)}))):t(T,r(e(y)))});async function K(){var v;let a=await ze("/auth/v1/blacklist");a.body?t(y,r(a.body.ips)):t(N,r(((v=a.error)==null?void 0:v.message)||"Error"))}async function ue(a,v){var F;t(q,"");let c=Se(e(W),e(j));if(!c){t(q,"Invalid Date Input: User Expires");return}let b={ip:e(B),exp:c},$=await Ae(a.action,b);$.error?t(q,r($.error.message)):(t(B,""),(F=e(H))==null||F(),await K())}async function fe(a){let v=await He(`/auth/v1/blacklist/${a}`);v.error?t(N,r(v.error.message)):await K()}function he(a,v){let c=v==="up";a===re[0]&&e(y).sort((b,$)=>c?b.ip.localeCompare($.ip):$.ip.localeCompare(b.ip))}Y();var ae=Je(),te=k(ae),ge=h(te);Ne(ge,{children:(a,v)=>{var c=_e(),b=k(c),$=g(b);De($,{orderOptions:re,onChangeOrder:he,searchWidth:"min(15.75rem, calc(100dvw - 1rem))",get value(){return e(G)},set value(i){t(G,r(i))}});var F=h($,2);Ue(F,{level:1,get closeModal(){return e(H)},set closeModal(i){t(H,r(i))},children:(i,m)=>{var x=Qe(),R=g(x);je(R,{action:"/auth/v1/blacklist",onSubmit:ue,children:(X,ie)=>{var p=Ke(),s=k(p);Me(s,{autocomplete:"off",label:"IP",placeholder:"IPv4",errMsg:"IPv4",required:!0,maxLength:15,pattern:We,get ref(){return e(A)},set ref(n){t(A,r(n))},get value(){return e(B)},set value(n){t(B,r(n))}});var u=h(s,2),l=Ce(pe);Le(u,{label:"Expiry",get min(){return e(l)},withTime:!0,get value(){return e(W)},set value(n){t(W,r(n))},get timeValue(){return e(j)},set timeValue(n){t(j,r(n))}});var f=h(u,2);Te(f,"height",".5rem");var L=h(f,2);J(L,{type:"submit",children:(n,I)=>{Y();var M=me();C(()=>E(M,z.common.save)),o(n,M)},$$slots:{default:!0}});var O=h(L,2),D=g(O,!0);w(O),C(()=>E(D,e(q))),o(X,p)},$$slots:{default:!0}}),w(x),o(i,x)},$$slots:{default:!0}}),w(b);var Q=h(b,2),we=g(Q);{var be=i=>{var m=Re(),x=g(m,!0);w(m),C(()=>E(x,ce.common.noEntries)),o(i,m)},$e=i=>{var m=_();const x=(p,s=Ee)=>{var u=Ze(),l=g(u);J(l,{invisible:!0,onclick:()=>navigator.clipboard.writeText(s().ip),children:(D,n)=>{var I=Xe(),M=g(I);ne(M,{get text(){return z.common.copyToClip},children:(S,se)=>{Y();var oe=me();C(()=>E(oe,s().ip)),o(S,oe)},$$slots:{default:!0}}),w(I),o(D,I)},$$slots:{default:!0}});var f=h(l,2),L=g(f,!0);C(()=>E(L,qe(s().exp))),w(f);var O=h(f,2);J(O,{invisible:!0,onclick:()=>fe(s().ip),children:(D,n)=>{ne(D,{get text(){return z.common.delete},children:(I,M)=>{var S=Ye(),se=g(S);Ve(se,{width:"1.25rem"}),w(S),o(I,S)},$$slots:{default:!0}})},$$slots:{default:!0}}),w(u),o(p,u)};var R=k(m);{var X=p=>{var s=_(),u=k(s);ve(u,17,()=>e(U),l=>l.ip,(l,f)=>{x(l,()=>e(f))}),o(p,s)},ie=p=>{var s=_(),u=k(s);ve(u,17,()=>e(T),l=>l.ip,(l,f)=>{x(l,()=>e(f))}),o(p,s)};Z(R,p=>{e(y).length>ee?p(X):p(ie,!1)})}o(i,m)};Z(we,i=>{e(y).length===0?i(be):i($e,!1)})}w(Q);var xe=h(Q,2);{var Pe=i=>{Ge(i,{pageSize:30,get items(){return e(T)},set items(m){t(T,r(m))},get itemsPaginated(){return e(U)},set itemsPaginated(m){t(U,r(m))}})};Z(xe,i=>{e(y).length>ee&&i(Pe)})}o(a,c)},$$slots:{default:!0}}),C(()=>E(te,`${e(N)??""} `)),o(V,ae),ke()}function rr(V){er(V,{})}export{rr as component};

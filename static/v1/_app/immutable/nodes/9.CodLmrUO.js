import{a as o,t as k,e as le,d as Y}from"../chunks/disclose-version.BP4T4xdV.js";import{l as d,a5 as xe,aa as ve,f as I,t as C,p as ye,a as Ie,j as e,k as t,s as h,a7 as Z,c as g,a9 as Ce,r as w,a8 as Ee}from"../chunks/index-client.hxMyB_b4.js";import{s as E}from"../chunks/render.yNX9q8-B.js";import{i as _}from"../chunks/if.BeBa1Kxb.js";import{e as me}from"../chunks/each.BUp7aLCc.js";import{a as Te,B as J}from"../chunks/Button.BR1gOfNn.js";import{p as a}from"../chunks/proxy.DaVNR9vk.js";import{O as Be}from"../chunks/OrderSearchBar.wIdu7A5l.js";import{I as De}from"../chunks/pow.BMnvYon0.js";import{B as Me,k as Se}from"../chunks/helpers.CchIKxjM.js";import{u as Le}from"../chunks/i18n.svelte.Ci9wvqOq.js";import{u as Oe}from"../chunks/i18n_admin.svelte.lt3dD7TQ.js";import{I as Ve}from"../chunks/InputDateTimeCombo.VZN-6SG8.js";import{f as ne,a as je}from"../chunks/form.DekAF1-C.js";import{I as qe}from"../chunks/IconStop.DLLup3H7.js";import{f as ze,b as Ae,c as Fe}from"../chunks/fetch.Bq59EV_b.js";import{C as He}from"../chunks/ContentAdmin.YSUtpxca.js";import{B as Ne}from"../chunks/ButtonAddModal.DsDc6nUh.js";import{c as Ue}from"../chunks/patterns.BRCxk8by.js";import{F as We}from"../chunks/Form.BnvI_UPN.js";import{T as pe}from"../chunks/Tooltip.ChiKoAQF.js";import{P as Ge}from"../chunks/Pagination.uHeQM-o2.js";var Ke=k('<!> <!> <div></div> <!> <div class="err"> </div>',1),Qe=k('<div class="addNew svelte-1v7phw9"><!></div>'),Re=k("<div> </div>"),Xe=k('<div class="ip svelte-1v7phw9"><!></div>'),Ye=k('<div class="delete svelte-1v7phw9"><!></div>'),Ze=k('<div class="blacklisted svelte-1v7phw9"><!> <div class="date svelte-1v7phw9"> </div> <!></div>'),_e=k('<div class="top svelte-1v7phw9"><!> <!></div> <div id="blacklist"><!></div> <!>',1),Je=k(" <!>",1);function ea(q,de){Ie(de,!0);let z=Le(),ce=Oe();const ee=30;let A=d(void 0),F=d(void 0),H=d(""),S=d(""),x=d(a([])),T=d(a([])),N=d(a([])),L=d(""),U=d(a(ne())),W=d(a(je())),G=d(""),ae=["IP"];xe(()=>{K()}),ve(()=>{var r;(r=e(A))==null||r.focus()}),ve(()=>{let r=e(G).toLowerCase();r?t(T,a(e(x).filter(v=>{var c;return(c=v.ip)==null?void 0:c.includes(r)}))):t(T,a(e(x)))});async function K(){var v;let r=await ze("/auth/v1/blacklist");r.body?t(x,a(r.body.ips)):t(H,a(((v=r.error)==null?void 0:v.message)||"Error"))}async function ue(r,v){var O;t(S,"");let c=Me(e(U),e(W));if(!c){t(S,"Invalid Date Input: User Expires");return}let $={ip:e(L),exp:c},b=await Ae(r.action,$);b.error?t(S,a(b.error.message)):(t(L,""),(O=e(F))==null||O(),await K())}async function fe(r){let v=await Fe(`/auth/v1/blacklist/${r}`);v.error?t(H,a(v.error.message)):await K()}function he(r,v){let c=v==="up";r===ae[0]&&e(x).sort(($,b)=>c?$.ip.localeCompare(b.ip):b.ip.localeCompare($.ip))}Z();var re=Je(),te=I(re),ge=h(te);He(ge,{children:(r,v)=>{var c=_e(),$=I(c),b=g($);Be(b,{orderOptions:ae,onChangeOrder:he,searchWidth:"min(15.75rem, calc(100dvw - 1rem))",get value(){return e(G)},set value(s){t(G,a(s))}});var O=h(b,2);Ne(O,{level:1,get closeModal(){return e(F)},set closeModal(s){t(F,a(s))},children:(s,m)=>{var P=Qe(),R=g(P);We(R,{action:"/auth/v1/blacklist",onSubmit:ue,children:(X,se)=>{var n=Ke(),i=I(n);De(i,{autocomplete:"off",label:"IP",placeholder:"IPv4",errMsg:"IPv4",required:!0,maxLength:15,pattern:Ue,get ref(){return e(A)},set ref(p){t(A,a(p))},get value(){return e(L)},set value(p){t(L,a(p))}});var u=h(i,2),l=Ce(ne);Ve(u,{label:"Expiry",get min(){return e(l)},withTime:!0,get value(){return e(U)},set value(p){t(U,a(p))},get timeValue(){return e(W)},set timeValue(p){t(W,a(p))}});var f=h(u,2);Te(f,"height",".5rem");var V=h(f,2);J(V,{type:"submit",children:(p,y)=>{Z();var D=le();C(()=>E(D,z.common.save)),o(p,D)},$$slots:{default:!0}});var j=h(V,2),B=g(j,!0);w(j),C(()=>E(B,e(S))),o(X,n)},$$slots:{default:!0}}),w(P),o(s,P)},$$slots:{default:!0}}),w($);var Q=h($,2),we=g(Q);{var $e=s=>{var m=Re(),P=g(m,!0);w(m),C(()=>E(P,ce.common.noEntries)),o(s,m)},be=s=>{var m=Y();const P=(n,i=Ee)=>{var u=Ze(),l=g(u);J(l,{invisible:!0,onclick:()=>navigator.clipboard.writeText(i().ip),children:(B,p)=>{var y=Xe(),D=g(y);pe(D,{get text(){return z.common.copyToClip},children:(M,ie)=>{Z();var oe=le();C(()=>E(oe,i().ip)),o(M,oe)},$$slots:{default:!0}}),w(y),o(B,y)},$$slots:{default:!0}});var f=h(l,2),V=g(f,!0);C(()=>E(V,Se(i().exp))),w(f);var j=h(f,2);J(j,{invisible:!0,onclick:()=>fe(i().ip),children:(B,p)=>{pe(B,{get text(){return z.common.delete},children:(y,D)=>{var M=Ye(),ie=g(M);qe(ie,{width:"1.25rem"}),w(M),o(y,M)},$$slots:{default:!0}})},$$slots:{default:!0}}),w(u),o(n,u)};var R=I(m);{var X=n=>{var i=Y(),u=I(i);me(u,17,()=>e(N),l=>l.ip,(l,f)=>{P(l,()=>e(f))}),o(n,i)},se=n=>{var i=Y(),u=I(i);me(u,17,()=>e(T),l=>l.ip,(l,f)=>{P(l,()=>e(f))}),o(n,i)};_(R,n=>{e(x).length>ee?n(X):n(se,!1)})}o(s,m)};_(we,s=>{e(x).length===0?s($e):s(be,!1)})}w(Q);var Pe=h(Q,2);{var ke=s=>{Ge(s,{pageSize:30,get items(){return e(T)},set items(m){t(T,a(m))},get itemsPaginated(){return e(N)},set itemsPaginated(m){t(N,a(m))}})};_(Pe,s=>{e(x).length>ee&&s(ke)})}o(r,c)},$$slots:{default:!0}}),C(()=>E(te,`${e(H)??""} `)),o(q,re),ye()}function aa(q){ea(q,{})}export{aa as component};

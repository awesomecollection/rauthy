import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.C93jtn63.js";import{p as ne,i as v,ao as ce,a4 as ee,f as L,t as P,a as fe,g as e,h as i,s as d,aq as J,c as f,a9 as ue,r as u}from"../chunks/index-client.ijM6xFk7.js";import{s as T}from"../chunks/render.BjVgqyVR.js";import{i as ge}from"../chunks/if.BunKWniS.js";import{e as $e}from"../chunks/each.K_FVK-xy.js";import{a as l,t as g,d as re,e as he}from"../chunks/template.DOyJZ41v.js";import{s as be}from"../chunks/index.R935SZZb.js";import{p as a}from"../chunks/proxy.DmesnD8z.js";import{O as we}from"../chunks/OrderSearchBar.CVNQJ5N_.js";import{B as K}from"../chunks/Button.BiyjpsYY.js";import{I as xe}from"../chunks/Input.CkQq4XIG.js";import{A as Ie,k as ke}from"../chunks/helpers.DMpx17S8.js";import{u as ye}from"../chunks/i18n.svelte.BPV29n6k.js";import{I as Ce}from"../chunks/InputDateTimeCombo.D1xfODfa.js";import{f as ae,a as Pe}from"../chunks/form.DekAF1-C.js";import{I as Te}from"../chunks/IconStop.Dx0ylcy1.js";import{f as Me,b as Ae,c as Ee}from"../chunks/fetch.1g3fgaWW.js";import{C as Fe}from"../chunks/ContentAdmin.CgzUYsIz.js";import{B as qe}from"../chunks/ButtonAddModal.C8A2jA2D.js";import{b as Be}from"../chunks/patterns.C8SwZZE-.js";import{F as De}from"../chunks/Form.CYrY4weL.js";import{T as te}from"../chunks/Tooltip.Cn4hj8_1.js";var Le=g('<!> <!> <div></div> <!> <div class="err"> </div>',1),Ne=g('<div class="addNew svelte-m901do"><!></div>'),Oe=g("<div>No blacklisted IPs</div>"),Ve=g('<div class="ip svelte-m901do"><!></div>'),_e=g('<div class="delete svelte-m901do"><!></div>'),ze=g('<div class="blacklisted svelte-m901do"><!> <div class="date svelte-m901do"> </div> <!></div>'),Se=g('<div class="top svelte-m901do"><!> <!></div> <div id="blacklist"><!></div>',1),Ue=g(" <!>",1);function je(N,ie){ne(ie,!0);let O=ye(),V=v(void 0),_=v(void 0),z=v(""),M=v(""),w=v(a([])),S=v(a([])),A=v(""),U=v(a(ae())),j=v(a(Pe())),G=v(""),Q=["IP"];ce(()=>{R()}),ee(()=>{var r;(r=e(V))==null||r.focus()}),ee(()=>{let r=e(G).toLowerCase();r?i(S,a(e(w).filter(o=>{var m;return(m=o.ip)==null?void 0:m.includes(r)}))):i(S,a(e(w)))});async function R(){var o;let r=await Me("/auth/v1/blacklist");r.body?i(w,a(r.body.ips)):i(z,a(((o=r.error)==null?void 0:o.message)||"Error"))}async function se(r,o){var E;i(M,"");let m=Ie(e(U),e(j));if(!m){i(M,"Invalid Date Input: User Expires");return}let p={ip:e(A),exp:m},n=await Ae(r.action,p);n.error?i(M,a(n.error.message)):(i(A,""),(E=e(_))==null||E(),await R())}async function oe(r){let o=await Ee(`/auth/v1/blacklist/${r}`);o.error?i(z,a(o.error.message)):await R()}function le(r,o){let m=o==="up";r===Q[0]&&e(w).sort((p,n)=>m?p.ip.localeCompare(n.ip):n.ip.localeCompare(p.ip))}J();var X=Ue(),Y=L(X),me=d(Y);Fe(me,{children:(r,o)=>{var m=Se(),p=L(m),n=f(p);we(n,{orderOptions:Q,onChangeOrder:le,searchWidth:"min(15.75rem, calc(100dvw - 1rem))",get value(){return e(G)},set value(s){i(G,a(s))}});var E=d(n,2);qe(E,{level:1,get closeModal(){return e(_)},set closeModal(s){i(_,a(s))},children:(s,x)=>{var I=Ne(),k=f(I);De(k,{action:"/auth/v1/blacklist",onSubmit:se,children:($,F)=>{var y=Le(),h=L(y);xe(h,{autocomplete:"off",label:"IP",placeholder:"IPv4",errMsg:"IPv4",required:!0,maxLength:15,pattern:Be,get ref(){return e(V)},set ref(t){i(V,a(t))},get value(){return e(A)},set value(t){i(A,a(t))}});var q=d(h,2),W=ue(ae);Ce(q,{label:"Expiry",get min(){return e(W)},withTime:!0,get value(){return e(U)},set value(t){i(U,a(t))},get timeValue(){return e(j)},set timeValue(t){i(j,a(t))}});var b=d(q,2);be(b,"height",".5rem");var B=d(b,2);K(B,{type:"submit",children:(t,H)=>{J();var C=re();P(()=>T(C,O.common.save)),l(t,C)},$$slots:{default:!0}});var c=d(B,2),D=f(c,!0);u(c),P(()=>T(D,e(M))),l($,y)},$$slots:{default:!0}}),u(I),l(s,I)},$$slots:{default:!0}}),u(p);var Z=d(p,2),ve=f(Z);{var de=s=>{var x=Oe();l(s,x)},pe=s=>{var x=he(),I=L(x);$e(I,17,()=>e(S),k=>k.ip,(k,$)=>{var F=ze(),y=f(F);K(y,{invisible:!0,onclick:()=>navigator.clipboard.writeText(e($).ip),children:(b,B)=>{var c=Ve(),D=f(c);te(D,{get text(){return O.common.copyToClip},children:(t,H)=>{J();var C=re();P(()=>T(C,e($).ip)),l(t,C)},$$slots:{default:!0}}),u(c),l(b,c)},$$slots:{default:!0}});var h=d(y,2),q=f(h,!0);P(()=>T(q,ke(e($).exp))),u(h);var W=d(h,2);K(W,{invisible:!0,onclick:()=>oe(e($).ip),children:(b,B)=>{te(b,{get text(){return O.common.delete},children:(c,D)=>{var t=_e(),H=f(t);Te(H,{width:"1.25rem"}),u(t),l(c,t)},$$slots:{default:!0}})},$$slots:{default:!0}}),u(F),l(k,F)}),l(s,x)};ge(ve,s=>{e(w).length===0?s(de):s(pe,!1)})}u(Z),l(r,m)},$$slots:{default:!0}}),P(()=>T(Y,`${e(z)??""} `)),l(N,X),fe()}function Ge(N){je(N,{})}export{Ge as component};

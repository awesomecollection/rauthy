import"../chunks/disclose-version.BDr9Qe-U.js";import{t as _,f as ie,p as Le,k as qe,c as i,s as c,r as s,a as Ne,g as n,y as fe,a9 as Ee,d as Y,b as v,q as vt,o as ut,$ as Ba}from"../chunks/index-client.B6iEebqi.js";import{h as qa}from"../chunks/svelte-head.BZpVhBz3.js";import{a as d,n as Mt,c as _e,t as $,b as Pe}from"../chunks/template.BMDtqFuO.js";import{i as E}from"../chunks/if.1XSPtMho.js";import{p as x}from"../chunks/proxy.CjI65D-A.js";import{d as Ot,e as $t,s as f,k as Wa}from"../chunks/render.Bsso_k3p.js";import{I as xt,h as Xt,u as Qt,T as Ra,S as Vt,D as Gt,b as Fa}from"../chunks/Devices.CHOZ2tDU.js";import{p as q}from"../chunks/props.C6aLk1Bq.js";import{y as Ke,M as _t,_ as Ja,P as Oa,z as Xa,t as Ht,H as Qa,N as Va,u as Ga,r as Ha}from"../chunks/helpers.Cbcu7vP_.js";import{B as De,h as Ka,e as Ze,a as Kt,i as ht,b as Zt,g as ea,f as it,T as Za}from"../chunks/ThemeSwitch.CRSTiBZD.js";import{s as Q,e as ae,g as re,r as er,t as Je,d as ta,f as et,b as Dt,c as It}from"../chunks/index.CmB1UnQy.js";import{s as tr}from"../chunks/snippet.CTHg_e8y.js";import{b as Ct}from"../chunks/this.D3iU5zny.js";import{u as Te}from"../chunks/i18n.svelte.CSnrsaW1.js";import{B as ar}from"../chunks/ButtonAuthProvider.DuFgUSOU.js";import{I as We}from"../chunks/Input.Bd9f6bUF.js";import{$ as aa,a as ra,b as rr,f as Et,g as nr,c as sr,d as na,F as or}from"../chunks/Form.2JZBppzc.js";import{a as Pt,c as ir,d as sa,e as lr}from"../chunks/patterns.BdncpE46.js";import{P as cr,O as oa,L as dr}from"../chunks/LangSelector.BbriGzIU.js";import{w as vr,d as ur,e as hr}from"../chunks/dataFetching.BAtorGRX.js";import{w as mr}from"../chunks/registration.76Y1Y4TV.js";import{W as ia}from"../chunks/WebauthnRequest.B12HRIW8.js";import{P as pr}from"../chunks/PasswordPolicy.D0S-eDD0.js";import{I as St}from"../chunks/InputPassword.DGTcf7PR.js";import{C as fr,B as gr}from"../chunks/Button.CukofQdZ.js";import{r as br}from"../chunks/legacy-client.BZkWSPYd.js";import"../chunks/legacy.BDl8PDwo.js";import{T as yr}from"../chunks/Template.C8mYZqXV.js";import{u as wr}from"../chunks/param.svelte.BdhMoRpL.js";import{M as kr,C as Mr}from"../chunks/ContentCenter.CrmYuxhV.js";var $r=Mt('<svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path></svg>');function jt(a,e){let t=q(e,"opacity",3,.9),r=q(e,"width",3,"1.5rem"),l=q(e,"color",3,"hsl(var(--action))");var o=$r();Q(o,"stroke-width",2),_(()=>{Q(o,"width",r()),Q(o,"color",l()),Q(o,"opacity",t())}),d(a,o)}function Lt(a,e){var t=_e(),r=ie(t);{var l=h=>{jt(h,{color:"hsl(var(--action))"})},o=h=>{xt(h,{color:"hsl(var(--error))"})};E(r,h=>{e.checked?h(l):h(o,!1)})}d(a,t)}function xr(a,e,t){e()||t()}function _r(a){a.stopPropagation()}var Dr=$('<span class="closeIcon svelte-utq0b0"><!></span>'),Ir=$('<div class="relative"><div class="absolute close svelte-utq0b0"><!></div></div>'),Cr=$('<dialog aria-modal="true" class="svelte-utq0b0"><div role="none" class="svelte-utq0b0"><!> <!></div></dialog>');function Er(a,e){Le(e,!0);let t=q(e,"showModal",15),r=q(e,"closeModal",15),l=q(e,"strict",3,!1),o=q(e,"prerender",3,!1),h=Te(),m;qe(()=>{r(u)}),qe(()=>{t()&&(m==null||m.showModal())});function u(M){M==null||M.preventDefault(),m==null||m.close(),t(!1)}var k=Cr();k.__click=[xr,l,u];var g=i(k);g.__click=[_r];var W=i(g);{var j=M=>{var z=Ir(),A=i(z),T=i(A);De(T,{get ariaLabel(){return h.common.close},invisible:!0,onclick:u,children:(B,O)=>{var ne=Dr(),Z=i(ne);xt(Z,{color:"currentColor",width:"1.2rem"}),s(ne),d(B,ne)},$$slots:{default:!0}}),s(A),s(z),d(M,z)};E(W,M=>{l()||M(j)})}var P=c(W,2);{var C=M=>{var z=_e(),A=ie(z);tr(A,()=>e.children),d(M,z)};E(P,M=>{(o()||t())&&M(C)})}s(g),s(k),Ct(k,M=>m=M,()=>m),_(()=>Q(k,"data-strict",l())),$t("close",k,()=>{var M;t(!1),(M=e.onClose)==null||M.call(e)}),d(a,k),Ne()}Ot(["click"]);var Pr=$('<div class="link-err value svelte-238dgs"> </div>'),Sr=$('<div class="fed-btn svelte-238dgs"><!> <!></div>'),jr=$('<h3> </h3> <p> </p> <div class="providers svelte-238dgs"></div>',1),Lr=$("<!> <!>",1),Nr=$('<div><div> </div> <span class="value svelte-238dgs"> </span></div>'),Ur=$('<div><div> </div> <span class="value svelte-238dgs"> </span></div>'),Tr=$('<div><div><b>WebID:</b></div> <span class="value svelte-238dgs"><a target="_blank"><!></a></span></div>'),Yr=$('<div><div><div> </div> <span class="value svelte-238dgs"> </span></div> <div><div> </div> <span class="value svelte-238dgs"> </span></div> <div><div> </div> <span class="value svelte-238dgs"> </span></div> <div><div> </div> <span class="value svelte-238dgs"> </span></div> <div><div> </div> <div><div class="value svelte-238dgs"> </div> <!></div></div> <div><div> </div> <span class="value svelte-238dgs"> </span></div> <div><div> </div> <span class="value svelte-238dgs"> </span></div> <div><div> </div> <!></div> <div><div> </div> <!></div> <div><div> </div> <!></div> <!> <div><div> </div> <span class="value svelte-238dgs"> </span></div> <div><div> </div> <span class="value svelte-238dgs"> </span></div> <!> <!></div>');function la(a,e){Le(e,!0);let t=q(e,"user",15),r=Te(),l=Y(!1),o=Y(!1),h=fe(()=>{var H;return(H=t().account_type)==null?void 0:H.startsWith("federated")}),m=fe(()=>{var H;return n(h)?`${t().account_type}: ${((H=e.authProvider)==null?void 0:H.name)||""}`:t().account_type}),u=fe(()=>e.viewModePhone?"rowPhone":"row"),k=fe(()=>e.viewModePhone?"labelPhone":"label");function g(H){Ja(64,(me,{challenge:ye,verifier:Ie})=>{me||(localStorage.setItem(Oa,Ie),W(H,ye))})}async function W(H,me){let ye={email:t().email,client_id:"rauthy",redirect_uri:window.location.href,provider_id:H,pkce_challenge:me},Ie=await Kt(`/auth/v1/providers/${H}/link`,ye);if(Ie.text){Xa(Ie.text);let xe=Ie.headers.get("location");xe&&(window.location.href=xe)}else console.error(Ie.error)}async function j(){let H=await Ka("/auth/v1/providers/link");H.body?t(H.body):(console.error(H.error),v(l,!0))}var P=Yr(),C=i(P),M=i(C),z=i(M,!0);s(M);var A=c(M,2),T=i(A,!0);s(A),s(C);var B=c(C,2),O=i(B),ne=i(O,!0);s(O);var Z=c(O,2),de=i(Z,!0);s(Z),s(B);var ce=c(B,2),S=i(ce),N=i(S,!0);s(S);var ve=c(S,2),V=i(ve,!0);s(ve),s(ce);var K=c(ce,2),R=i(K),le=i(R);s(R);var ue=c(R,2),w=i(ue,!0);s(ue),s(K);var b=c(K,2),L=i(b),te=i(L,!0);s(L);var se=c(L,2),F=i(se),G=i(F,!0);s(F);var he=c(F,2);{var Me=H=>{var me=Sr(),ye=i(me);De(ye,{get ariaLabel(){return r.account.providerUnlink},level:3,onclick:j,children:(Se,Qe)=>{Ee();var He=Pe();_(()=>f(He,r.account.providerUnlink)),d(Se,He)},$$slots:{default:!0}});var Ie=c(ye,2);{var xe=Se=>{var Qe=Pr(),He=i(Qe,!0);s(Qe),_(()=>f(He,r.account.providerUnlinkDesc)),d(Se,Qe)};E(Ie,Se=>{n(l)&&Se(xe)})}s(me),d(H,me)},J=H=>{var me=_e(),ye=ie(me);{var Ie=xe=>{var Se=Lr(),Qe=ie(Se);De(Qe,{level:2,onclick:()=>v(o,!0),children:(st,Ta)=>{Ee();var ot=Pe();_(()=>f(ot,r.account.providerLink)),d(st,ot)},$$slots:{default:!0}});var He=c(Qe,2);Er(He,{get showModal(){return n(o)},set showModal(st){v(o,x(st))},children:(st,Ta)=>{var ot=jr(),yt=ie(ot),Ya=i(yt,!0);s(yt);var wt=c(yt,2),za=i(wt,!0);s(wt);var Ft=c(wt,2);Ze(Ft,21,()=>e.providers,kt=>kt.id,(kt,Jt)=>{var Aa=fe(()=>`${r.account.providerLink}: ${n(Jt).name}`);ar(kt,{get ariaLabel(){return n(Aa)},get provider(){return n(Jt)},onclick:g})}),s(Ft),_(()=>{f(Ya,r.account.providerLink),f(za,r.account.providerLinkDesc)}),d(st,ot)},$$slots:{default:!0}}),d(xe,Se)};E(ye,xe=>{e.providers.length>0&&xe(Ie)},!0)}d(H,me)};E(he,H=>{n(h)?H(Me):H(J,!1)})}s(se),s(b);var p=c(b,2),D=i(p),y=i(D,!0);s(D);var I=c(D,2),X=i(I,!0);s(I),s(p);var U=c(p,2),oe=i(U),pe=i(oe,!0);s(oe);var ge=c(oe,2),be=i(ge,!0);s(ge),s(U);var ee=c(U,2),ke=i(ee),Ce=i(ke,!0);s(ke);var Ye=c(ke,2),ze=fe(()=>!!t().webauthn_user_id);Lt(Ye,{get checked(){return n(ze)}}),s(ee);var je=c(ee,2),we=i(je),Ve=i(we,!0);s(we);var Ge=c(we,2);Lt(Ge,{get checked(){return t().enabled}}),s(je);var Re=c(je,2),Ae=i(Re),lt=i(Ae,!0);s(Ae);var $e=c(Ae,2);Lt($e,{get checked(){return t().email_verified}}),s(Re);var Be=c(Re,2);{var rt=H=>{var me=Nr(),ye=i(me),Ie=i(ye,!0);s(ye);var xe=c(ye,2),Se=i(xe,!0);_(()=>f(Se,Ke(t().last_login))),s(xe),s(me),_(()=>{ae(me,re(n(u)),"svelte-238dgs"),ae(ye,re(n(k)),"svelte-238dgs"),f(Ie,r.account.lastLogin)}),d(H,me)};E(Be,H=>{t().last_login&&H(rt)})}var Ue=c(Be,2),Fe=i(Ue),qt=i(Fe,!0);s(Fe);var nt=c(Fe,2),Pa=i(nt,!0);_(()=>f(Pa,t().password_expires&&Ke(t().password_expires)||r.common.never)),s(nt),s(Ue);var ct=c(Ue,2),dt=i(ct),Sa=i(dt,!0);s(dt);var Wt=c(dt,2),ja=i(Wt,!0);_(()=>f(ja,Ke(t().created_at))),s(Wt),s(ct);var Rt=c(ct,2);{var La=H=>{var me=Ur(),ye=i(me),Ie=i(ye,!0);s(ye);var xe=c(ye,2),Se=i(xe,!0);_(()=>f(Se,Ke(t().user_expires))),s(xe),s(me),_(()=>{ae(me,re(n(u)),"svelte-238dgs"),ae(ye,re(n(k)),"svelte-238dgs"),f(Ie,r.account.userExpiry)}),d(H,me)};E(Rt,H=>{t().user_expires&&H(La)})}var Na=c(Rt,2);{var Ua=H=>{var me=Tr(),ye=i(me),Ie=c(ye,2),xe=i(Ie);_(()=>Q(xe,"href",_t(t().id)));var Se=i(xe);Xt(Se,()=>_t(t().id).replace("/auth/","/auth/<wbr/>")),s(xe),s(Ie),s(me),_(()=>{ae(me,re(n(u)),"svelte-238dgs"),ae(ye,re(n(k)),"svelte-238dgs")}),d(H,me)};E(Na,H=>{e.webIdData&&H(Ua)})}s(P),_(()=>{ae(C,re(n(u)),"svelte-238dgs"),ae(M,re(n(k)),"svelte-238dgs"),f(z,r.common.email),f(T,t().email),ae(B,re(n(u)),"svelte-238dgs"),ae(O,re(n(k)),"svelte-238dgs"),f(ne,r.account.givenName),f(de,t().given_name),ae(ce,re(n(u)),"svelte-238dgs"),ae(S,re(n(k)),"svelte-238dgs"),f(N,r.account.familyName),f(V,t().family_name),ae(K,re(n(u)),"svelte-238dgs"),ae(R,re(n(k)),"svelte-238dgs"),f(le,`${r.account.user??""} ID`),f(w,t().id),ae(b,re(n(u)),"svelte-238dgs"),ae(L,re(n(k)),"svelte-238dgs"),f(te,r.account.accType),f(G,n(m)||""),ae(p,re(n(u)),"svelte-238dgs"),ae(D,re(n(k)),"svelte-238dgs"),f(y,r.account.roles),f(X,t().roles||"None"),ae(U,re(n(u)),"svelte-238dgs"),ae(oe,re(n(k)),"svelte-238dgs"),f(pe,r.account.groups),f(be,t().groups||"None"),ae(ee,re(n(u)),"svelte-238dgs"),ae(ke,re(n(k)),"svelte-238dgs"),f(Ce,r.account.mfaActivated),ae(je,re(n(u)),"svelte-238dgs"),ae(we,re(n(k)),"svelte-238dgs"),f(Ve,r.account.userEnabled),ae(Re,re(n(u)),"svelte-238dgs"),ae(Ae,re(n(k)),"svelte-238dgs"),f(lt,r.account.emailVerified),ae(Ue,re(n(u)),"svelte-238dgs"),ae(Fe,re(n(k)),"svelte-238dgs"),f(qt,r.account.passwordExpiry),ae(ct,re(n(u)),"svelte-238dgs"),ae(dt,re(n(k)),"svelte-238dgs"),f(Sa,r.account.userCreated)}),d(a,P),Ne()}function Nt(a,e){return a-e*Math.floor(a/e)}const ca=1721426;function mt(a,e,t,r){e=Ut(a,e);let l=e-1,o=-2;return t<=2?o=0:pt(e)&&(o=-1),ca-1+365*l+Math.floor(l/4)-Math.floor(l/100)+Math.floor(l/400)+Math.floor((367*t-362)/12+o+r)}function pt(a){return a%4===0&&(a%100!==0||a%400===0)}function Ut(a,e){return a==="BC"?1-e:e}function zr(a){let e="AD";return a<=0&&(e="BC",a=1-a),[e,a]}const Ar={standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]};class ft{fromJulianDay(e){let t=e,r=t-ca,l=Math.floor(r/146097),o=Nt(r,146097),h=Math.floor(o/36524),m=Nt(o,36524),u=Math.floor(m/1461),k=Nt(m,1461),g=Math.floor(k/365),W=l*400+h*100+u*4+g+(h!==4&&g!==4?1:0),[j,P]=zr(W),C=t-mt(j,P,1,1),M=2;t<mt(j,P,3,1)?M=0:pt(P)&&(M=1);let z=Math.floor(((C+M)*12+373)/367),A=t-mt(j,P,z,1)+1;return new at(j,P,z,A)}toJulianDay(e){return mt(e.era,e.year,e.month,e.day)}getDaysInMonth(e){return Ar[pt(e.year)?"leapyear":"standard"][e.month-1]}getMonthsInYear(e){return 12}getDaysInYear(e){return pt(e.year)?366:365}getYearsInEra(e){return 9999}getEras(){return["BC","AD"]}isInverseEra(e){return e.era==="BC"}balanceDate(e){e.year<=0&&(e.era=e.era==="BC"?"AD":"BC",e.year=1-e.year)}constructor(){this.identifier="gregory"}}function da(a){a=Tt(a,new ft);let e=Ut(a.era,a.year);return va(e,a.month,a.day,a.hour,a.minute,a.second,a.millisecond)}function va(a,e,t,r,l,o,h){let m=new Date;return m.setUTCHours(r,l,o,h),m.setUTCFullYear(a,e-1,t),m.getTime()}function ua(a,e){if(e==="UTC")return 0;if(a>0&&e===aa())return new Date(a).getTimezoneOffset()*-6e4;let{year:t,month:r,day:l,hour:o,minute:h,second:m}=ma(a,e);return va(t,r,l,o,h,m,0)-Math.floor(a/1e3)*1e3}const ha=new Map;function ma(a,e){let t=ha.get(e);t||(t=new Intl.DateTimeFormat("en-US",{timeZone:e,hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),ha.set(e,t));let r=t.formatToParts(new Date(a)),l={};for(let o of r)o.type!=="literal"&&(l[o.type]=o.value);return{year:l.era==="BC"||l.era==="B"?-l.year+1:+l.year,month:+l.month,day:+l.day,hour:l.hour==="24"?0:+l.hour,minute:+l.minute,second:+l.second}}const pa=864e5;function Br(a,e,t,r){return(t===r?[t]:[t,r]).filter(l=>qr(a,e,l))}function qr(a,e,t){let r=ma(t,e);return a.year===r.year&&a.month===r.month&&a.day===r.day&&a.hour===r.hour&&a.minute===r.minute&&a.second===r.second}function Wr(a,e,t="compatible"){let r=ga(a);if(e==="UTC")return da(r);if(e===aa()&&t==="compatible"){r=Tt(r,new ft);let u=new Date,k=Ut(r.era,r.year);return u.setFullYear(k,r.month-1,r.day),u.setHours(r.hour,r.minute,r.second,r.millisecond),u.getTime()}let l=da(r),o=ua(l-pa,e),h=ua(l+pa,e),m=Br(r,e,l-o,l-h);if(m.length===1)return m[0];if(m.length>1)switch(t){case"compatible":case"earlier":return m[0];case"later":return m[m.length-1];case"reject":throw new RangeError("Multiple possible absolute times found")}switch(t){case"earlier":return Math.min(l-o,l-h);case"compatible":case"later":return Math.max(l-o,l-h);case"reject":throw new RangeError("No such absolute time found")}}function fa(a,e,t="compatible"){return new Date(Wr(a,e,t))}function ga(a,e){let t=0,r=0,l=0,o=0;if("timeZone"in a)({hour:t,minute:r,second:l,millisecond:o}=a);else if("hour"in a&&!e)return a;return e&&({hour:t,minute:r,second:l,millisecond:o}=e),new bt(a.calendar,a.era,a.year,a.month,a.day,t,r,l,o)}function Tt(a,e){if(a.calendar.identifier===e.identifier)return a;let t=e.fromJulianDay(a.calendar.toJulianDay(a)),r=a.copy();return r.calendar=e,r.era=t.era,r.year=t.year,r.month=t.month,r.day=t.day,tt(r),r}function Yt(a,e){let t=a.copy(),r="hour"in t?Qr(t,e):0;zt(t,e.years||0),t.calendar.balanceYearMonth&&t.calendar.balanceYearMonth(t,a),t.month+=e.months||0,At(t),ba(t),t.day+=(e.weeks||0)*7,t.day+=e.days||0,t.day+=r,Rr(t),t.calendar.balanceDate&&t.calendar.balanceDate(t),t.year<1&&(t.year=1,t.month=1,t.day=1);let l=t.calendar.getYearsInEra(t);if(t.year>l){var o,h;let u=(o=(h=t.calendar).isInverseEra)===null||o===void 0?void 0:o.call(h,t);t.year=l,t.month=u?1:t.calendar.getMonthsInYear(t),t.day=u?1:t.calendar.getDaysInMonth(t)}t.month<1&&(t.month=1,t.day=1);let m=t.calendar.getMonthsInYear(t);return t.month>m&&(t.month=m,t.day=t.calendar.getDaysInMonth(t)),t.day=Math.max(1,Math.min(t.calendar.getDaysInMonth(t),t.day)),t}function zt(a,e){var t,r;!((t=(r=a.calendar).isInverseEra)===null||t===void 0)&&t.call(r,a)&&(e=-e),a.year+=e}function At(a){for(;a.month<1;)zt(a,-1),a.month+=a.calendar.getMonthsInYear(a);let e=0;for(;a.month>(e=a.calendar.getMonthsInYear(a));)a.month-=e,zt(a,1)}function Rr(a){for(;a.day<1;)a.month--,At(a),a.day+=a.calendar.getDaysInMonth(a);for(;a.day>a.calendar.getDaysInMonth(a);)a.day-=a.calendar.getDaysInMonth(a),a.month++,At(a)}function ba(a){a.month=Math.max(1,Math.min(a.calendar.getMonthsInYear(a),a.month)),a.day=Math.max(1,Math.min(a.calendar.getDaysInMonth(a),a.day))}function tt(a){a.calendar.constrainDate&&a.calendar.constrainDate(a),a.year=Math.max(1,Math.min(a.calendar.getYearsInEra(a),a.year)),ba(a)}function Fr(a){let e={};for(let t in a)typeof a[t]=="number"&&(e[t]=-a[t]);return e}function ya(a,e){return Yt(a,Fr(e))}function wa(a,e){let t=a.copy();return e.era!=null&&(t.era=e.era),e.year!=null&&(t.year=e.year),e.month!=null&&(t.month=e.month),e.day!=null&&(t.day=e.day),tt(t),t}function Jr(a,e){let t=a.copy();return e.hour!=null&&(t.hour=e.hour),e.minute!=null&&(t.minute=e.minute),e.second!=null&&(t.second=e.second),e.millisecond!=null&&(t.millisecond=e.millisecond),Xr(t),t}function Or(a){a.second+=Math.floor(a.millisecond/1e3),a.millisecond=gt(a.millisecond,1e3),a.minute+=Math.floor(a.second/60),a.second=gt(a.second,60),a.hour+=Math.floor(a.minute/60),a.minute=gt(a.minute,60);let e=Math.floor(a.hour/24);return a.hour=gt(a.hour,24),e}function Xr(a){a.millisecond=Math.max(0,Math.min(a.millisecond,1e3)),a.second=Math.max(0,Math.min(a.second,59)),a.minute=Math.max(0,Math.min(a.minute,59)),a.hour=Math.max(0,Math.min(a.hour,23))}function gt(a,e){let t=a%e;return t<0&&(t+=e),t}function Qr(a,e){return a.hour+=e.hours||0,a.minute+=e.minutes||0,a.second+=e.seconds||0,a.millisecond+=e.milliseconds||0,Or(a)}function ka(a,e,t,r){let l=a.copy();switch(e){case"era":{let m=a.calendar.getEras(),u=m.indexOf(a.era);if(u<0)throw new Error("Invalid era: "+a.era);u=Oe(u,t,0,m.length-1,r==null?void 0:r.round),l.era=m[u],tt(l);break}case"year":var o,h;!((o=(h=l.calendar).isInverseEra)===null||o===void 0)&&o.call(h,l)&&(t=-t),l.year=Oe(a.year,t,-1/0,9999,r==null?void 0:r.round),l.year===-1/0&&(l.year=1),l.calendar.balanceYearMonth&&l.calendar.balanceYearMonth(l,a);break;case"month":l.month=Oe(a.month,t,1,a.calendar.getMonthsInYear(a),r==null?void 0:r.round);break;case"day":l.day=Oe(a.day,t,1,a.calendar.getDaysInMonth(a),r==null?void 0:r.round);break;default:throw new Error("Unsupported field "+e)}return a.calendar.balanceDate&&a.calendar.balanceDate(l),tt(l),l}function Vr(a,e,t,r){let l=a.copy();switch(e){case"hour":{let o=a.hour,h=0,m=23;if((r==null?void 0:r.hourCycle)===12){let u=o>=12;h=u?12:0,m=u?23:11}l.hour=Oe(o,t,h,m,r==null?void 0:r.round);break}case"minute":l.minute=Oe(a.minute,t,0,59,r==null?void 0:r.round);break;case"second":l.second=Oe(a.second,t,0,59,r==null?void 0:r.round);break;case"millisecond":l.millisecond=Oe(a.millisecond,t,0,999,r==null?void 0:r.round);break;default:throw new Error("Unsupported field "+e)}return l}function Oe(a,e,t,r,l=!1){if(l){a+=Math.sign(e),a<t&&(a=r);let o=Math.abs(e);e>0?a=Math.ceil(a/o)*o:a=Math.floor(a/o)*o,a>r&&(a=t)}else a+=e,a<t?a=r-(t-a-1):a>r&&(a=t+(a-r-1));return a}const Gr=/^([+-]\d{6}|\d{4})-(\d{2})-(\d{2})$/;function Xe(a){let e=a.match(Gr);if(!e)throw new Error("Invalid ISO 8601 date string: "+a);let t=new at(Bt(e[1],0,9999),Bt(e[2],1,12),1);return t.day=Bt(e[3],0,t.calendar.getDaysInMonth(t)),t}function Bt(a,e,t){let r=Number(a);if(r<e||r>t)throw new RangeError(`Value out of range: ${e} <= ${r} <= ${t}`);return r}function Hr(a){return`${String(a.hour).padStart(2,"0")}:${String(a.minute).padStart(2,"0")}:${String(a.second).padStart(2,"0")}${a.millisecond?String(a.millisecond/1e3).slice(1):""}`}function Ma(a){let e=Tt(a,new ft),t;return e.era==="BC"?t=e.year===1?"0000":"-"+String(Math.abs(1-e.year)).padStart(6,"00"):t=String(e.year).padStart(4,"0"),`${t}-${String(e.month).padStart(2,"0")}-${String(e.day).padStart(2,"0")}`}function Kr(a){return`${Ma(a)}T${Hr(a)}`}function Zr(a,e){if(e.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $a(a,e,t){Zr(a,e),e.set(a,t)}function xa(a){let e=typeof a[0]=="object"?a.shift():new ft,t;if(typeof a[0]=="string")t=a.shift();else{let h=e.getEras();t=h[h.length-1]}let r=a.shift(),l=a.shift(),o=a.shift();return[e,t,r,l,o]}var en=new WeakMap;class at{copy(){return this.era?new at(this.calendar,this.era,this.year,this.month,this.day):new at(this.calendar,this.year,this.month,this.day)}add(e){return Yt(this,e)}subtract(e){return ya(this,e)}set(e){return wa(this,e)}cycle(e,t,r){return ka(this,e,t,r)}toDate(e){return fa(this,e)}toString(){return Ma(this)}compare(e){return ra(this,e)}constructor(...e){$a(this,en,{writable:!0,value:void 0});let[t,r,l,o,h]=xa(e);this.calendar=t,this.era=r,this.year=l,this.month=o,this.day=h,tt(this)}}var tn=new WeakMap;class bt{copy(){return this.era?new bt(this.calendar,this.era,this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond):new bt(this.calendar,this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond)}add(e){return Yt(this,e)}subtract(e){return ya(this,e)}set(e){return wa(Jr(this,e),e)}cycle(e,t,r){switch(e){case"era":case"year":case"month":case"day":return ka(this,e,t,r);default:return Vr(this,e,t,r)}}toDate(e,t){return fa(this,e,t)}toString(){return Kr(this)}compare(e){let t=ra(this,e);return t===0?rr(this,ga(e)):t}constructor(...e){$a(this,tn,{writable:!0,value:void 0});let[t,r,l,o,h]=xa(e);this.calendar=t,this.era=r,this.year=l,this.month=o,this.day=h,this.hour=e.shift()||0,this.minute=e.shift()||0,this.second=e.shift()||0,this.millisecond=e.shift()||0,tt(this)}}var an=Mt(`<svg fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21
            7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25
            0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"></path></svg>`);function rn(a,e){let t=q(e,"opacity",3,.9),r=q(e,"width",3,"1.5rem"),l=q(e,"color",3,"currentColor");var o=an();Q(o,"stroke-width",2),_(()=>{Q(o,"stroke",l()),Q(o,"width",r()),Q(o,"opacity",t())}),d(a,o)}function nn(a,e){var t,r,l,o,h;switch(a.code){case"Enter":(t=e.onEnter)==null||t.call(e);break;case"ArrowUp":(r=e.onUp)==null||r.call(e);break;case"ArrowDown":(l=e.onDown)==null||l.call(e);break;case"ArrowLeft":(o=e.onLeft)==null||o.call(e);break;case"ArrowRight":(h=e.onRight)==null||h.call(e);break}}var sn=$('<span class="pointer"><!></span>'),on=$('<div class="day font-label weekLabel svelte-1j6kibo"> </div>'),ln=$('<time class="svelte-1j6kibo"> </time>'),cn=$('<div class="day svelte-1j6kibo"><!></div>'),dn=$('<div class="week svelte-1j6kibo"></div>'),vn=$('<div class="popup svelte-1j6kibo"><div class="flex space-between"><div><!></div> <div><!></div></div> <div class="week svelte-1j6kibo"></div> <div class="month svelte-1j6kibo"></div></div>'),un=$('<div class="error svelte-1j6kibo"> </div>'),hn=$('<div><div class="flex"><input type="date" step="any" class="svelte-1j6kibo"> <div class="relative"><div class="absolute patch svelte-1j6kibo"></div> <div class="absolute indicator svelte-1j6kibo"><!></div></div></div> <div class="label svelte-1j6kibo"><label class="font-label noselect svelte-1j6kibo"> </label> <!></div></div>');function mn(a,e){Le(e,!0);let t=q(e,"id",19,Ht),r=q(e,"value",31,()=>x(Et())),l=q(e,"label",3,""),o=q(e,"title",3,""),h=q(e,"min",3,"1900-01-01"),m=q(e,"max",3,"2100-01-01");const u=Xe(Et(new Date)),k=u.toString();let g=Te(),W=Y(!1),j=Y(void 0),P,C=Y(void 0),M=Y(void 0),z=Y(void 0),A=fe(()=>r()?Xe(r()):u),T=fe(()=>Xe(h())),B=fe(()=>Xe(m())),O=Y(x(vt(()=>g.common.months[n(A).month-1]))),ne=fe(()=>g.common.months.findIndex(p=>p===n(O))+1),Z=Y(x(vt(()=>n(A).year))),de=Y(x([vt(()=>n(Z))])),ce=fe(()=>nr(n(A),g.lang));qe(()=>{let p=Number.parseInt(h().slice(0,4)),D=Number.parseInt(m().slice(0,4)),y=[];for(let I=p;I<=D;I++)y.push(I);v(de,x(y))}),qe(()=>{if(r()){let p=vt(()=>Xe(r()));p=p.set({year:n(Z),month:n(ne)}),r(p.toString())}}),qe(()=>{n(z)&&r()&&requestAnimationFrame(()=>{var D,y,I;let p=((D=n(z))==null?void 0:D.getElementsByTagName("time"))||[];for(let X of p)if(X.getAttribute("datetime")===r()){(I=(y=X.parentElement)==null?void 0:y.parentElement)==null||I.focus();break}})});function S(p){let D=Xe(na(p));return D.compare(n(T))<0||D.compare(n(B))>0?!1:n(ne)===p.month}function N(){r(new at(n(Z),n(ne),1).toString())}function ve(p){p.preventDefault(),v(W,!0)}function V(p,D){var y;p.preventDefault(),r(D),(y=n(j))==null||y()}function K(p,D){var X,U;let y=Xe(D),I=Xe(D);switch(p){case"left":I=y.subtract({days:1});break;case"right":I=y.add({days:1});break;case"up":I=y.subtract({weeks:1});break;case"down":I=y.add({weeks:1});break}I.month!==y.month?sr(I,g.lang)<4?(X=n(C))==null||X.focus():(U=n(M))==null||U.focus():r(I.toString())}function R(p){switch(p){case"open":r()||(r(k),requestAnimationFrame(()=>le()));break;case"closed":v(z,void 0);break}}function le(){v(W,!(P!=null&&P.reportValidity()))}var ue=hn(),w=i(ue),b=i(w);er(b),b.__keydown=[nn,e],Ct(b,p=>P=p,()=>P);var L=c(b,2),te=c(i(L),2),se=i(te);cr(se,{ariaLabel:"Show Popover Example",offsetLeft:"-7.5rem",offsetTop:"-.2rem",onToggle:R,btnInvisible:!0,lazy:!0,get close(){return n(j)},set close(p){v(j,x(p))},button:p=>{var D=sn(),y=i(D);rn(y,{color:"hsl(var(--text)",width:"1.2rem"}),s(D),d(p,D)},children:(p,D)=>{var y=vn(),I=i(y),X=i(I),U=i(X);oa(U,{get ariaLabel(){return g.common.month},get options(){return g.common.months},maxHeight:"13rem",borderless:!0,onRight:()=>{var ee;return(ee=n(M))==null?void 0:ee.focus()},onDown:N,get ref(){return n(C)},set ref(ee){v(C,x(ee))},get value(){return n(O)},set value(ee){v(O,x(ee))}}),s(X);var oe=c(X,2),pe=i(oe);oa(pe,{get ariaLabel(){return g.common.year},get options(){return n(de)},maxHeight:"13rem",borderless:!0,onLeft:()=>{var ee;return(ee=n(C))==null?void 0:ee.focus()},onDown:N,get ref(){return n(M)},set ref(ee){v(M,x(ee))},get value(){return n(Z)},set value(ee){v(Z,x(ee))}}),s(oe),s(I);var ge=c(I,2);Ze(ge,21,()=>g.common.weekDaysShort,ht,(ee,ke)=>{var Ce=on(),Ye=i(Ce,!0);s(Ce),_(()=>f(Ye,n(ke))),d(ee,Ce)}),s(ge);var be=c(ge,2);Ze(be,21,()=>n(ce),ht,(ee,ke)=>{var Ce=dn();Ze(Ce,21,()=>n(ke).days,ht,(Ye,ze)=>{var je=cn();const we=fe(()=>na(n(ze))),Ve=fe(()=>S(n(ze)));var Ge=i(je),Re=fe(()=>!n(Ve));De(Ge,{onclick:Ae=>V(Ae,n(we)),get isDisabled(){return n(Re)},invisible:!0,onLeft:()=>K("left",n(we)),onRight:()=>K("right",n(we)),onUp:()=>K("up",n(we)),onDown:()=>K("down",n(we)),children:(Ae,lt)=>{var $e=ln(),Be=i($e,!0);s($e),_(()=>{Q($e,"data-today",n(we)===k),Q($e,"data-active",n(Ve)),Q($e,"data-selected",n(we)===r()),Q($e,"data-weekend",n(ze).isWeekend),Q($e,"datetime",n(we)),f(Be,n(ze).day)}),d(Ae,$e)},$$slots:{default:!0}}),s(je),d(Ye,je)}),s(Ce),d(ee,Ce)}),s(be),Ct(be,ee=>v(z,ee),()=>n(z)),s(y),d(p,y)},$$slots:{button:!0,default:!0}}),s(te),s(L),s(w);var F=c(w,2),G=i(F),he=i(G,!0);s(G);var Me=c(G,2);{var J=p=>{var D=un(),y=i(D,!0);s(D),_(()=>f(y,o())),Je(3,D,()=>ta),d(p,D)};E(Me,p=>{n(W)&&p(J)})}s(F),s(ue),_(()=>{Q(b,"id",t()),Q(b,"name",e.name),Q(b,"title",o()),Q(b,"aria-label",o()),b.disabled=e.disabled,Q(b,"aria-disabled",e.disabled),b.required=e.required,Q(b,"aria-required",e.required||!1),Q(b,"aria-invalid",n(W)),Q(b,"min",h()),Q(b,"max",m()),Q(G,"for",t()),Q(G,"data-required",e.required),f(he,l())}),$t("invalid",b,ve),$t("blur",b,()=>le()),Zt(b,r),d(a,ue),Ne()}Ot(["keydown"]);var pn=$("<span><!></span>"),fn=$('<div class="delete svelte-1gnpmkt"><!></div>'),gn=$('<div class="container svelte-1gnpmkt"><!> <!></div>');function bn(a,e){Le(e,!0);let t=q(e,"id",19,Ht),r=q(e,"value",31,()=>x(Et())),l=q(e,"label",3,""),o=q(e,"title",3,""),h=q(e,"min",3,"1900-01-01"),m=q(e,"max",3,"2100-01-01"),u=Te();var k=gn(),g=i(k);mn(g,{get id(){return t()},get name(){return e.name},get label(){return l()},get title(){return o()},get disabled(){return e.disabled},get min(){return h()},get max(){return m()},get required(){return e.required},get onEnter(){return e.onEnter},get onLeft(){return e.onLeft},get onRight(){return e.onRight},get onUp(){return e.onUp},get onDown(){return e.onDown},get value(){return r()},set value(P){r(P)}});var W=c(g,2);{var j=P=>{var C=fn(),M=i(C);De(M,{get ariaLabel(){return u.common.delete},invisible:!0,onclick:()=>r(""),children:(z,A)=>{var T=pn(),B=i(T);xt(B,{color:"hsla(var(--error) / .8)",width:"1.2rem"}),s(T),_(()=>Q(T,"title",u.common.delete)),d(z,T)},$$slots:{default:!0}}),s(C),d(P,C)};E(W,P=>{e.withDelete&&P(j)})}s(k),d(a,k),Ne()}var yn=$("<p> </p>"),wn=$('<div class="success svelte-19s6k1f"><!> <!></div>'),kn=$('<div class="err"> </div>'),Mn=$('<div class="formInner svelte-19s6k1f"><div><!> <!> <!> <!></div> <div><!> <!> <!> <!> <!></div></div> <div class="bottom svelte-19s6k1f"><div><!></div> <!></div>',1),$n=$('<div class="wrapper svelte-19s6k1f"><div class="container svelte-19s6k1f"><!></div></div>');function _a(a,e){var j;Le(e,!0);let t=q(e,"user",15);(j=t().user_values)!=null&&j.birthdate||t(t().user_values.birthdate="",!0);let r=Te(),l=Y(""),o=Y(!1),h=Y(!1);async function m(P,C){var ve;const M=C.get("email"),z=C.get("family_name"),A=C.get("given_name")||void 0,T=C.get("birthdate")||void 0,B=((ve=C.get("phone"))==null?void 0:ve.replaceAll(" ",""))||void 0,O=C.get("street")||void 0,ne=C.get("zip")||void 0,Z=ne?Number.parseInt(ne):void 0,de=C.get("city")||void 0,ce=C.get("country")||void 0;let S={email:M,family_name:z,given_name:A,user_values:{birthdate:T,phone:B,street:O,zip:Z,city:de,country:ce}},N=await ea(`/auth/v1/users/${t().id}/self`,S);N.body?(v(o,!0),t(N.body),N.status===202&&v(h,!0),setTimeout(()=>{v(o,!1)},3e3)):N.error&&(console.error(N.error),v(l,x(N.error.message)))}var u=$n(),k=i(u),g=i(k),W=fe(()=>`/auth/v1/users/${t().id}/self`);or(g,{get action(){return n(W)},onSubmit:m,children:(P,C)=>{var M=Mn(),z=ie(M),A=i(z),T=i(A);We(T,{typ:"email",name:"email",get label(){return r.common.email},get placeholder(){return r.common.email},get value(){return t().email},required:!0});var B=c(T,2);We(B,{name:"given_name",autocomplete:"given-name",get label(){return r.account.givenName},get placeholder(){return r.account.givenName},get value(){return t().given_name},required:!0,maxLength:32,pattern:Pt});var O=c(B,2);We(O,{name:"family_name",autocomplete:"family-name",get label(){return r.account.familyName},get placeholder(){return r.account.familyName},get value(){return t().family_name},maxLength:32,pattern:Pt});var ne=c(O,2);bn(ne,{name:"birthdate",get label(){return r.account.birthdate},withDelete:!0,get value(){return t().user_values.birthdate},set value(b){t(t().user_values.birthdate=b,!0)}}),s(A);var Z=c(A,2),de=i(Z);We(de,{name:"street",autocomplete:"street-address",get label(){return r.account.street},get placeholder(){return r.account.street},get value(){return t().user_values.street},maxLength:48,pattern:ir});var ce=c(de,2);We(ce,{typ:"number",name:"zip",autocomplete:"postal-code",get label(){return r.account.zip},get placeholder(){return r.account.zip},get value(){return t().user_values.zip},min:"1000",max:"9999999"});var S=c(ce,2);We(S,{name:"city",autocomplete:"address-level2",get label(){return r.account.city},get placeholder(){return r.account.city},get value(){return t().user_values.city},maxLength:48,pattern:sa});var N=c(S,2);We(N,{name:"country",autocomplete:"country",get label(){return r.account.country},get placeholder(){return r.account.country},get value(){return t().user_values.country},maxLength:48,pattern:sa});var ve=c(N,2);We(ve,{name:"phone",autocomplete:"tel",get label(){return r.account.phone},get placeholder(){return r.account.phone},get value(){return t().user_values.phone},maxLength:32,pattern:lr}),s(Z),s(z);var V=c(z,2),K=i(V),R=i(K);De(R,{type:"submit",children:(b,L)=>{Ee();var te=Pe();_(()=>f(te,r.common.save)),d(b,te)},$$slots:{default:!0}}),s(K);var le=c(K,2);{var ue=b=>{var L=wn(),te=i(L);jt(te,{});var se=c(te,2);{var F=G=>{var he=yn(),Me=i(he,!0);s(he),_(()=>f(Me,r.account.emailUpdateConfirm)),d(G,he)};E(se,G=>{n(h)&&G(F)})}s(L),Je(3,L,()=>et),d(b,L)},w=b=>{var L=_e(),te=ie(L);{var se=F=>{var G=kn(),he=i(G,!0);s(G),_(()=>f(he,n(l))),Je(3,G,()=>et),d(F,G)};E(te,F=>{n(l)&&F(se)},!0)}d(b,L)};E(le,b=>{n(o)?b(ue):b(w,!1)})}s(V),d(P,M)},$$slots:{default:!0}}),s(k),s(u),d(a,u),Ne()}var xn=Mt('<svg fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M7.864 4.243A7.5 7.5 0 0119.5 10.5c0 2.92-.556 5.709-1.568 8.268M5.742 6.364A7.465 7.465 0 004.5 10.5a7.464 7.464 0 01-1.15 3.993m1.989 3.559A11.209 11.209 0 008.25 10.5a3.75 3.75 0 117.5 0c0 .527-.021 1.049-.064 1.565M12 10.5a14.94 14.94 0 01-3.6 9.75m6.633-4.596a18.666 18.666 0 01-2.485 5.33"></path></svg>');function _n(a,e){let t=q(e,"opacity",3,.9),r=q(e,"width",3,24),l=q(e,"color",3,"currentColor");var o=xn();Q(o,"stroke-width",2),_(()=>{Q(o,"stroke",l()),Q(o,"width",r()),Q(o,"opacity",t())}),d(a,o)}var Dn=$('<div class="err svelte-ea3bti"><b>Your browser does not support Webauthn credentials and must be updated.</b></div>'),In=$('<!> <div class="regBtns svelte-ea3bti"><!> <!></div>',1),Cn=$('<div class="regNewBtn svelte-ea3bti"><!></div>'),En=$('<div class="keysHeader svelte-ea3bti"> </div>'),Pn=$("<div><!></div>"),Sn=$('<div class="row svelte-ea3bti"><div></div> <div class="deleteBtn svelte-ea3bti"><!></div></div>'),jn=$('<div class="keyContainer svelte-ea3bti"><div class="row svelte-ea3bti"><span class="label svelte-ea3bti"> </span> <div class="nameUv svelte-ea3bti"><b> </b> <!></div></div> <div class="row svelte-ea3bti"><span class="label svelte-ea3bti"> </span> <span class="font-mono"> </span></div> <div class="row svelte-ea3bti"><span class="label svelte-ea3bti"> </span> <span class="font-mono"> </span></div> <!></div>'),Ln=$('<div class="button svelte-ea3bti"><!></div>'),Nn=$('<!> <p class="svelte-ea3bti"> <br><br> </p> <!> <!> <div class="keysContainer svelte-ea3bti"></div> <!> <div class="svelte-ea3bti"> </div>',1),Un=$('<div class="container svelte-ea3bti"><!></div>');function Da(a,e){Le(e,!0);const t="credentials"in navigator;let r=Te(),l=Qt("account"),o=fe(()=>{var S;return(S=l.get())==null?void 0:S.user_id}),h=Y(void 0),m=Y(!1),u=Y(""),k=Y(!1),g=Y(e.user.account_type==="password"),W=Y(void 0),j=Y(""),P=Y(!1),C=Y(x([]));ut(()=>{z()}),qe(()=>{n(C).length>0&&e.user.account_type==="passkey"&&v(g,n(C).length>1)}),qe(()=>{var S;(S=n(h))==null||S.focus()});function M(){v(m,!1),v(u,"")}async function z(){var N;let S=await it(`/auth/v1/users/${(N=l.get())==null?void 0:N.user_id}/webauthn`);S.body?v(C,x(S.body)):console.error(S.error)}async function A(){if(M(),n(P)||!n(o))return;if(n(j).length<1){v(m,!0),v(u,x(r.mfa.passkeyNameErr));return}let S=await mr(n(o),n(j),r.authorize.invalidKeyUsed,r.authorize.requestExpired);S.error?(v(m,!0),v(u,`${r.mfa.errorReg} - ${S.error}`)):(v(k,!1),v(j,""),await z())}async function T(S){let N=await vr(e.user.id,S);if(N.status===200)await z();else{let ve=await N.json();v(m,!0),v(u,x(ve.message))}}function B(S){v(W,void 0),v(m,!0),v(u,x(S)),setTimeout(()=>{v(m,!1),v(u,"")},5e3)}function O(S){v(W,void 0),v(u,x(r.mfa.testSuccess))}var ne=Un(),Z=i(ne);{var de=S=>{var N=Dn();d(S,N)},ce=S=>{var N=Nn(),ve=ie(N);{var V=J=>{ia(J,{get userId(){return e.user.id},get purpose(){return n(W)},onSuccess:O,onError:B})};E(ve,J=>{n(W)&&J(V)})}var K=c(ve,2),R=i(K),le=c(R,3);s(K);var ue=c(K,2);{var w=J=>{var p=In(),D=ie(p);We(D,{autocomplete:"off",get label(){return r.mfa.passkeyName},get placeholder(){return r.mfa.passkeyName},maxLength:32,pattern:Pt,onEnter:A,get ref(){return n(h)},set ref(U){v(h,x(U))},get value(){return n(j)},set value(U){v(j,x(U))},get isError(){return n(P)},set isError(U){v(P,x(U))}});var y=c(D,2),I=i(y);De(I,{onclick:A,children:(U,oe)=>{Ee();var pe=Pe();_(()=>f(pe,r.mfa.register)),d(U,pe)},$$slots:{default:!0}});var X=c(I,2);De(X,{level:3,onclick:()=>v(k,!1),children:(U,oe)=>{Ee();var pe=Pe();_(()=>f(pe,r.common.cancel)),d(U,pe)},$$slots:{default:!0}}),s(y),d(J,p)},b=J=>{var p=Cn(),D=i(p),y=fe(()=>n(C).length===0?1:2);De(D,{get level(){return n(y)},onclick:()=>v(k,!0),children:(I,X)=>{Ee();var U=Pe();_(()=>f(U,r.mfa.registerNew)),d(I,U)},$$slots:{default:!0}}),s(p),d(J,p)};E(ue,J=>{n(k)?J(w):J(b,!1)})}var L=c(ue,2);{var te=J=>{var p=En(),D=i(p,!0);s(p),_(()=>f(D,r.mfa.registerdKeys)),d(J,p)};E(L,J=>{n(C).length>0&&J(te)})}var se=c(L,2);Ze(se,21,()=>n(C),J=>J.name,(J,p)=>{var D=jn(),y=i(D),I=i(y),X=i(I,!0);s(I);var U=c(I,2),oe=i(U),pe=i(oe,!0);s(oe);var ge=c(oe,2);{var be=$e=>{Ra($e,{get text(){return r.account.userVerifiedTooltip},children:(Be,rt)=>{var Ue=Pn();It(Ue,"margin-bottom","-.25rem");var Fe=i(Ue);_n(Fe,{width:18,color:"var(--col-acnt)"}),s(Ue),d(Be,Ue)},$$slots:{default:!0}})};E(ge,$e=>{n(p).user_verified&&$e(be)})}s(U),s(y);var ee=c(y,2),ke=i(ee),Ce=i(ke,!0);s(ke);var Ye=c(ke,2),ze=i(Ye,!0);_(()=>f(ze,Ke(n(p).registered))),s(Ye),s(ee);var je=c(ee,2),we=i(je),Ve=i(we,!0);s(we);var Ge=c(we,2),Re=i(Ge,!0);_(()=>f(Re,Ke(n(p).last_used))),s(Ge),s(je);var Ae=c(je,2);{var lt=$e=>{var Be=Sn(),rt=c(i(Be),2),Ue=i(rt);De(Ue,{level:-3,onclick:()=>T(n(p).name),children:(Fe,qt)=>{Ee();var nt=Pe();_(()=>f(nt,r.common.delete)),d(Fe,nt)},$$slots:{default:!0}}),s(rt),s(Be),d($e,Be)};E(Ae,$e=>{n(g)&&$e(lt)})}s(D),_(()=>{f(X,r.mfa.passkeyName),f(pe,n(p).name),f(Ce,r.mfa.registerd),f(Ve,r.mfa.lastUsed)}),d(J,D)}),s(se);var F=c(se,2);{var G=J=>{var p=Ln(),D=i(p);De(D,{onclick:()=>v(W,"Test"),children:(y,I)=>{Ee();var X=Pe();_(()=>f(X,r.mfa.test)),d(y,X)},$$slots:{default:!0}}),s(p),d(J,p)};E(F,J=>{n(C).length>0&&J(G)})}var he=c(F,2),Me=i(he,!0);s(he),_(()=>{f(R,`${r.mfa.p1??""} `),f(le,` ${r.mfa.p2??""}`),Dt(he,"success",!n(m)),Dt(he,"err",n(m)),f(Me,n(u))}),d(S,N)};E(Z,S=>{t?S(ce,!1):S(de)})}s(ne),d(a,ne),Ne()}var Tn=$('<div class="container svelte-ue7bk2"><!> <!> <!> <!> <div class="btn svelte-ue7bk2"><!></div> <div class="err svelte-ue7bk2"> </div></div>');function Yn(a,e){Le(e,!0);let t=q(e,"passwords",15),r=q(e,"hideCurrentPassword",3,!1),l=q(e,"isValid",15),o=Te();l(g);let h=Y(!1),m=Y(""),u=Y(void 0),k=fe(()=>{var M;return((M=t().new)==null?void 0:M.length)>6&&t().new===t().newConfirm});ut(async()=>{let M=await it("/auth/v1/password_policy");M.body?v(u,x(M.body)):console.error(M.error)});function g(){return v(m,""),!r()&&!t().current?(v(m,x(o.account.passwordCurrReq)),!1):t().new?t().newConfirm?n(h)?t().new.length>256?(v(m,"max 256"),!1):t().new!==t().newConfirm?(v(m,x(o.account.passwordNoMatch)),!1):!0:(v(m,x(o.account.passwordPolicyFollow)),!1):(v(m,x(o.account.passwordNewReq)),!1):(v(m,x(o.account.passwordNewReq)),!1)}function W(){if(v(m,""),n(u)){let M=Qa(n(u));t(t().new=M,!0),t(t().newConfirm=M,!0)}}var j=_e(),P=ie(j);{var C=M=>{var z=Tn(),A=i(z);pr(A,{get policy(){return n(u)},get password(){return t().new},get accepted(){return n(h)},set accepted(N){v(h,x(N))}});var T=c(A,2);{var B=N=>{St(N,{autocomplete:"current-password",get label(){return o.account.passwordCurr},get placeholder(){return o.account.passwordCurr},onInput:g,get width(){return e.inputWidth},get value(){return t().current},set value(ve){t(t().current=ve,!0)}})};E(T,N=>{r()||N(B)})}var O=c(T,2);St(O,{autocomplete:"new-password",get label(){return o.account.passwordNew},get placeholder(){return o.account.passwordNew},onInput:g,get showCopy(){return n(k)},get width(){return e.inputWidth},get value(){return t().new},set value(N){t(t().new=N,!0)}});var ne=c(O,2);St(ne,{autocomplete:"new-password",get label(){return o.account.passwordConfirm},get placeholder(){return o.account.passwordConfirm},onInput:g,get showCopy(){return n(k)},get width(){return e.inputWidth},get value(){return t().newConfirm},set value(N){t(t().newConfirm=N,!0)}});var Z=c(ne,2),de=i(Z);De(de,{onclick:W,level:2,children:(N,ve)=>{Ee();var V=Pe();_(()=>f(V,o.account.generateRandom)),d(N,V)},$$slots:{default:!0}}),s(Z);var ce=c(Z,2),S=i(ce,!0);s(ce),s(z),_(()=>f(S,n(m))),d(M,z)};E(P,M=>{n(u)&&M(C)})}return d(a,j),Ne({isPwdValid:g})}var zn=$('<div class="m-05 svelte-1l5u0ph"><p class="svelte-1l5u0ph"> </p> <p class="svelte-1l5u0ph"><b> </b></p> <p class="svelte-1l5u0ph"> </p> <!></div>'),An=$('<p class="svelte-1l5u0ph"> </p> <p class="svelte-1l5u0ph"> </p> <p class="svelte-1l5u0ph"> </p> <div><!></div>',1),Bn=$('<div class="success svelte-1l5u0ph"><!></div>'),qn=$('<div class="err"> </div>'),Wn=$('<div class="cancel"><!></div>'),Rn=$('<div class="convertPasskey svelte-1l5u0ph"><h3> </h3> <p class="svelte-1l5u0ph"> </p> <!></div>'),Fn=$('<div><!> <div class="save svelte-1l5u0ph"><!> <!></div></div> <!>',1),Jn=$('<div class="wrapper svelte-1l5u0ph"><div class="container svelte-1l5u0ph"><!> <!> <!> <!></div></div>');function Ia(a,e){Le(e,!0);let t=q(e,"user",15),r=Te(),l=fe(()=>e.viewModePhone?"calc(100vw - 1.5rem)":"300px"),o=Y(x(t().account_type)),h=Y(x([])),m=Y(void 0),u=Y(!1),k=Y(!1),g=Y(""),W=Y(!1),j=Y(void 0),P=Y(x({current:"",new:"",newConfirm:""})),C=fe(()=>n(h).filter(w=>w.user_verified).length>0);ut(()=>{M()});async function M(){let w=await it(`/auth/v1/users/${t().id}/webauthn`);w.body?v(h,x(w.body)):console.error("error fetching passkeys: "+w.error)}async function z(){let w=await Kt(`/auth/v1/users/${t().id}/self/convert_passkey`);w.error?console.error("error fetching passkeys: "+w.error):window.location.reload()}async function A(){v(g,""),n(h).length>0?await T():await B()}async function T(){var w;if(!((w=n(m))!=null&&w())){v(g,x(r.common.invalidInput));return}v(j,"PasswordNew")}async function B(w){var te,se;if(!((te=n(m))!=null&&te())){v(g,x(r.common.invalidInput));return}v(k,!0);let b={password_new:n(P).new};w?b.mfa_code=w:b.password_current=n(P).current;let L=await ea(`/auth/v1/users/${t().id}/self`,b);L.body?(v(W,!0),v(P,x({current:"",new:"",newConfirm:""})),t(L.body),v(o,x(L.body.account_type)),setTimeout(()=>{v(W,!1),v(u,!1)},3e3)):v(g,x(((se=L.error)==null?void 0:se.message)||"Error")),v(k,!1)}function O(w){v(j,void 0),v(g,x(w)),setTimeout(()=>{v(g,"")},5e3)}function ne(w){v(j,void 0),w&&"code"in w&&B(w.code)}async function Z(){let w=await ur({email:t().email});if(w.ok)v(W,!0);else{let b=await w.json();v(g,x(b.message))}}var de=Jn(),ce=i(de),S=i(ce);{var N=w=>{ia(w,{get userId(){return t().id},get purpose(){return n(j)},onSuccess:ne,onError:O})};E(S,w=>{n(j)&&w(N)})}var ve=c(S,2);{var V=w=>{var b=zn(),L=i(b),te=i(L,!0);s(L);var se=c(L,2),F=i(se),G=i(F,!0);s(F),s(se);var he=c(se,2),Me=i(he,!0);s(he);var J=c(he,2);{var p=y=>{fr(y,{check:!0})},D=y=>{De(y,{level:3,onclick:Z,children:(I,X)=>{Ee();var U=Pe();_(()=>f(U,r.account.passwordReset)),d(I,U)},$$slots:{default:!0}})};E(J,y=>{n(W)?y(p):y(D,!1)})}s(b),_(()=>{var y;f(te,r.account.federatedConvertPassword1),f(G,((y=e.authProvider)==null?void 0:y.name)||"UNKNOWN"),f(Me,r.account.federatedConvertPassword2)}),d(w,b)};E(ve,w=>{n(o)==="federated"&&w(V)})}var K=c(ve,2);{var R=w=>{var b=An(),L=ie(b),te=i(L,!0);s(L);var se=c(L,2),F=i(se,!0);s(se);var G=c(se,2),he=i(G,!0);s(G);var Me=c(G,2),J=i(Me);De(J,{level:2,onclick:()=>v(u,!0),children:(p,D)=>{Ee();var y=Pe();_(()=>f(y,r.account.convertAccount)),d(p,y)},$$slots:{default:!0}}),s(Me),_(()=>{f(te,r.account.accTypePasskeyText1),f(F,r.account.accTypePasskeyText2),f(he,r.account.accTypePasskeyText3)}),d(w,b)};E(K,w=>{(n(o)==="passkey"||n(o)==="federated_passkey")&&!n(u)&&w(R)})}var le=c(K,2);{var ue=w=>{var b=Fn(),L=ie(b),te=i(L),se=fe(()=>!(n(o)==="password"&&n(h).length<1));Yn(te,{get inputWidth(){return n(l)},get hideCurrentPassword(){return n(se)},get passwords(){return n(P)},set passwords(y){v(P,x(y))},get isValid(){return n(m)},set isValid(y){v(m,x(y))}});var F=c(te,2),G=i(F);De(G,{onclick:A,level:1,get isLoading(){return n(k)},children:(y,I)=>{Ee();var X=Pe();_(()=>f(X,r.common.save)),d(y,X)},$$slots:{default:!0}});var he=c(G,2);{var Me=y=>{var I=Bn(),X=i(I);jt(X,{}),s(I),Je(3,I,()=>et),d(y,I)},J=y=>{var I=_e(),X=ie(I);{var U=pe=>{var ge=qn(),be=i(ge,!0);s(ge),_(()=>f(be,n(g))),Je(3,ge,()=>et),d(pe,ge)},oe=pe=>{var ge=_e(),be=ie(ge);{var ee=ke=>{var Ce=Wn(),Ye=i(Ce);De(Ye,{level:3,onclick:()=>v(u,!1),children:(ze,je)=>{Ee();var we=Pe();_(()=>f(we,r.common.cancel)),d(ze,we)},$$slots:{default:!0}}),s(Ce),d(ke,Ce)};E(be,ke=>{n(u)&&!n(k)&&ke(ee)},!0)}d(pe,ge)};E(X,pe=>{n(g)?pe(U):pe(oe,!1)},!0)}d(y,I)};E(he,y=>{n(W)?y(Me):y(J,!1)})}s(F),s(L);var p=c(L,2);{var D=y=>{var I=Rn(),X=i(I),U=i(X,!0);s(X);var oe=c(X,2),pe=i(oe,!0);s(oe);var ge=c(oe,2);De(ge,{level:2,onclick:z,children:(be,ee)=>{Ee();var ke=Pe();_(()=>f(ke,r.account.convertAccount)),d(be,ke)},$$slots:{default:!0}}),s(I),_(()=>{f(U,r.account.convertAccount),f(pe,r.account.convertAccountP1)}),d(y,I)};E(p,y=>{!n(u)&&n(C)&&y(D)})}d(w,b)};E(le,w=>{(n(o)==="password"||n(o)==="federated_password"||n(u))&&w(ue)})}s(ce),s(de),d(a,de),Ne()}var On=$('<div><p class="svelte-naxx27"> </p>    <textarea class="font-mono text svelte-naxx27"></textarea></div>'),Xn=$('<div class="success svelte-naxx27">Update successful</div>'),Qn=$('<div class="err svelte-naxx27"> </div>'),Vn=$('<div class="wrapper svelte-naxx27"><div class="container svelte-naxx27"><p class="svelte-naxx27"> </p> <p class="svelte-naxx27"><a target="_blank"><!></a></p> <div class="row svelte-naxx27"><div class="label svelte-naxx27">E-Mail</div> <!></div> <div class="row svelte-naxx27"><div class="label svelte-naxx27"> </div> <!></div> <!> <!> <div class="bottom svelte-naxx27"><!></div></div></div>');function Ca(a,e){Le(e,!0);let t=q(e,"webIdData",15),r=Te();const l="12rem";let o=Y(""),h=Y(!1),m=Y(!!t().custom_triples),u=_t(t().user_id);br(()=>{n(h)&&setTimeout(()=>{v(h,!1)},3e3)});async function k(){v(o,"");let R=await hr(t().user_id,t());if(R.ok)v(h,!0);else{let le=await R.json();v(o,x(le.message))}}var g=Vn(),W=i(g),j=i(W),P=i(j,!0);s(j);var C=c(j,2),M=i(C);Q(M,"href",u);var z=i(M);Xt(z,()=>u.replace("/auth/","/auth/<wbr/>")),s(M),s(C);var A=c(C,2),T=c(i(A),2);Vt(T,{get selected(){return t().expose_email},set selected(R){t(t().expose_email=R,!0)}}),s(A);var B=c(A,2),O=i(B),ne=i(O,!0);s(O);var Z=c(O,2);Vt(Z,{get selected(){return n(m)},set selected(R){v(m,x(R))}}),s(B);var de=c(B,2);{var ce=R=>{var le=On(),ue=i(le),w=i(ue,!0);s(ue);var b=c(ue,2);Wa(b),Q(b,"rows",15),Q(b,"cols",40),s(le),_(()=>f(w,r.account.webIdDescData)),Zt(b,()=>t().custom_triples,L=>t(t().custom_triples=L,!0)),Je(3,le,()=>ta),d(R,le)};E(de,R=>{n(m)&&R(ce)})}var S=c(de,2);gr(S,{width:l,level:1,$$events:{click:k},children:(R,le)=>{Ee();var ue=Pe();_(()=>f(ue,r.common.save)),d(R,ue)},$$slots:{default:!0}});var N=c(S,2),ve=i(N);{var V=R=>{var le=Xn();Je(3,le,()=>et),d(R,le)},K=R=>{var le=_e(),ue=ie(le);{var w=b=>{var L=Qn(),te=i(L,!0);s(L),_(()=>f(te,n(o))),Je(3,L,()=>et),d(b,L)};E(ue,b=>{n(o)&&b(w)},!0)}d(R,le)};E(ve,R=>{n(h)?R(V):R(K,!1)})}s(N),s(W),s(g),_(()=>{f(P,r.account.webIdDesc),f(ne,r.account.webIdExpertMode)}),d(a,g),Ne()}function Gn(a){Gt(a,{viewMode:"account"})}var Hn=$('<span class="font-label tab svelte-mkcuiv"> </span>'),Kn=$('<div class="tabs svelte-mkcuiv"></div>');function Ea(a,e){Le(e,!0);let t=q(e,"selected",15,""),r=q(e,"borderRadius",3,"5px"),l=q(e,"center",3,!1),o=q(e,"width",3,"inherit");e.tabs.length>0&&t()===""&&t(e.tabs[0]);var h=Kn();Ze(h,21,()=>e.tabs,ht,(m,u)=>{var k=fe(()=>n(u)===t()?"step":void 0);De(m,{get ariaCurrent(){return n(k)},invisible:!0,onclick:()=>t(n(u)),children:(g,W)=>{var j=Hn(),P=i(j,!0);s(j),_(()=>{Q(j,"data-selected",n(u)===t()),f(P,n(u))}),d(g,j)},$$slots:{default:!0}})}),s(h),_(()=>{Dt(h,"center",l()),It(h,"border-radius",r()),It(h,"width",o())}),d(a,h),Ne()}var Zn=$("<h3> </h3>"),es=$('<div class="headerPhone svelte-6pjzk1"><!></div> <div class="container svelte-6pjzk1"><!> <div class="innerPhone svelte-6pjzk1"><!></div></div>',1),ts=$('<div class="header svelte-6pjzk1"><!></div> <div class="container svelte-6pjzk1"><!> <div class="inner svelte-6pjzk1"><!></div></div>',1),as=$('<!> <div class="wrapper svelte-6pjzk1"><!></div>',1);function rs(a,e){Le(e,!0);const t=T=>{var B=Zn(),O=i(B,!0);s(B),_(()=>f(O,`${r().given_name} ${r().family_name||""}`)),d(T,B)};let r=q(e,"user",15),l=q(e,"webIdData",15),o=Te(),h=Y(void 0),m=Y(x([])),u=fe(()=>{var T;if((T=r().account_type)!=null&&T.startsWith("federated"))return n(m).filter(B=>B.id===r().auth_provider_id)[0]}),k=fe(()=>n(h)&&n(h)<500),g=Y(x(o.account.navInfo)),W=x(l()?[o.account.navInfo,o.account.navEdit,o.common.password,o.account.navMfa,"WebID",o.account.devices,o.account.navLogout]:[o.account.navInfo,o.account.navEdit,o.common.password,o.account.navMfa,o.account.devices,o.account.navLogout]);ut(()=>{wr("v").get()==="devices"&&v(g,x(o.account.devices))}),qe(()=>{n(g)===o.account.navLogout&&Va()});var j=as(),P=ie(j);yr(P,{id:Ga,get value(){return n(m)},set value(T){v(m,x(T))}});var C=c(P,2),M=i(C);{var z=T=>{var B=es(),O=ie(B),ne=i(O);t(ne),s(O);var Z=c(O,2),de=i(Z);Ea(de,{get tabs(){return W},get selected(){return n(g)},set selected(V){v(g,x(V))}});var ce=c(de,2),S=i(ce);{var N=V=>{la(V,{get providers(){return n(m)},get authProvider(){return n(u)},viewModePhone:!0,get webIdData(){return l()},get user(){return r()},set user(K){r(K)}})},ve=V=>{var K=_e(),R=ie(K);{var le=w=>{_a(w,{viewModePhone:!0,get user(){return r()},set user(b){r(b)}})},ue=w=>{var b=_e(),L=ie(b);{var te=F=>{Ia(F,{get user(){return r()},get authProvider(){return n(u)},viewModePhone:!0})},se=F=>{var G=_e(),he=ie(G);{var Me=p=>{Da(p,{get user(){return r()}})},J=p=>{var D=_e(),y=ie(D);{var I=U=>{Ca(U,{get webIdData(){return l()},set webIdData(oe){l(oe)}})},X=U=>{var oe=_e(),pe=ie(oe);{var ge=be=>{Gt(be,{viewMode:"account"})};E(pe,be=>{n(g)===o.account.devices&&be(ge)},!0)}d(U,oe)};E(y,U=>{n(g)==="WebID"?U(I):U(X,!1)},!0)}d(p,D)};E(he,p=>{n(g)===o.account.navMfa?p(Me):p(J,!1)},!0)}d(F,G)};E(L,F=>{n(g)===o.common.password?F(te):F(se,!1)},!0)}d(w,b)};E(R,w=>{n(g)===o.account.navEdit?w(le):w(ue,!1)},!0)}d(V,K)};E(S,V=>{n(g)===o.account.navInfo?V(N):V(ve,!1)})}s(ce),s(Z),d(T,B)},A=T=>{var B=ts(),O=ie(B),ne=i(O);t(ne),s(O);var Z=c(O,2),de=i(Z);Ea(de,{get tabs(){return W},center:!0,get selected(){return n(g)},set selected(V){v(g,x(V))}});var ce=c(de,2),S=i(ce);{var N=V=>{la(V,{get webIdData(){return l()},get providers(){return n(m)},get authProvider(){return n(u)},get user(){return r()},set user(K){r(K)}})},ve=V=>{var K=_e(),R=ie(K);{var le=w=>{_a(w,{get user(){return r()},set user(b){r(b)}})},ue=w=>{var b=_e(),L=ie(b);{var te=F=>{Ia(F,{get user(){return r()},get authProvider(){return n(u)}})},se=F=>{var G=_e(),he=ie(G);{var Me=p=>{Da(p,{get user(){return r()}})},J=p=>{var D=_e(),y=ie(D);{var I=U=>{Ca(U,{get webIdData(){return l()},set webIdData(oe){l(oe)}})},X=U=>{var oe=_e(),pe=ie(oe);{var ge=be=>{Gn(be)};E(pe,be=>{n(g)===o.account.devices&&be(ge)},!0)}d(U,oe)};E(y,U=>{n(g)==="WebID"?U(I):U(X,!1)},!0)}d(p,D)};E(he,p=>{n(g)===o.account.navMfa?p(Me):p(J,!1)},!0)}d(F,G)};E(L,F=>{n(g)===o.common.password?F(te):F(se,!1)},!0)}d(w,b)};E(R,w=>{n(g)===o.account.navEdit?w(le):w(ue,!1)},!0)}d(V,K)};E(S,V=>{n(g)===o.account.navInfo?V(N):V(ve,!1)})}s(ce),s(Z),d(T,B)};E(M,T=>{n(k)?T(z):T(A,!1)})}s(C),Fa("innerWidth",T=>v(h,x(T))),d(a,j),Ne()}var ns=$("<!> <!> <!>",1);function ss(a,e){Le(e,!0);let t=Te(),r=Qt("account"),l=Y(void 0),o=Y(void 0),h=Y(!1);qe(()=>{let u=r.get();u&&m(u)});async function m(u){const k=u.user_id;if(k){let g=await Promise.all([it(`/auth/v1/users/${k}`),it(`/auth/v1/users/${k}/webid/data`)]);g[0].body?v(l,x(g[0].body)):Ha("account"),g[1].body?v(o,x(g[1].body)):g[1].status===404&&v(o,x({user_id:k,expose_email:!1})),v(h,!0)}else console.error("no user_id in session")}qa(u=>{_(()=>{var k;return Ba.title=`${((t==null?void 0:t.account.account)||"Account")??""} ${((k=n(l))==null?void 0:k.email)??""}`})}),kr(a,{children:(u,k)=>{Mr(u,{children:(g,W)=>{var j=ns(),P=ie(j);{var C=A=>{rs(A,{get user(){return n(l)},set user(T){v(l,x(T))},get webIdData(){return n(o)},set webIdData(T){v(o,x(T))}})};E(P,A=>{n(h)&&r&&n(l)&&A(C)})}var M=c(P,2);Za(M,{absolute:!0});var z=c(M,2);dr(z,{absolute:!0}),d(g,j)},$$slots:{default:!0}})},$$slots:{default:!0}}),Ne()}export{ss as component};

import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.Dmu0D13_.js";import{p as W,a6 as Z,y as e,f as P,z as s,s as C,t as _,a as j,A as p,c as k,ar as J,r as B,ab as V,ap as re}from"../chunks/index-client.CVQra9Cu.js";import{s as I}from"../chunks/render.CkKFmY3E.js";import{i as z}from"../chunks/if._4yhN2kP.js";import{e as oe}from"../chunks/each.D7w_Y1pv.js";import{d as K,a as g,t as O,e as se}from"../chunks/template.4ZWi6dE6.js";import{a as ne}from"../chunks/index.CkVfMYgG.js";import{p as o}from"../chunks/proxy.Dc6q2r8X.js";import{u as G}from"../chunks/i18n_admin.svelte.CtFnAESg.js";import{B as ie}from"../chunks/ButtonAddModal.W1tXC5iJ.js";import{C as me}from"../chunks/ContentAdmin.p5jUo2m-.js";import{N as le}from"../chunks/NavButtonTile.B87bIUim.js";import{N as ve}from"../chunks/NavSub.BqNuX9Je.js";import{O as ue}from"../chunks/OrderSearchBar.BAXBsyAw.js";import{b as ce,d as de,c as fe,f as pe}from"../chunks/fetch.B_P4c8fm.js";import{u as ge}from"../chunks/param.svelte.CY-AzddN.js";import{B as X}from"../chunks/Button.B6DffihK.js";import{I as Q}from"../chunks/Input.kE1yFgI6.js";import{d as Y,e as ee}from"../chunks/patterns.DpOwmcHv.js";import{F as te}from"../chunks/Form.9PZRDz5w.js";import{u as U}from"../chunks/i18n.svelte.DVZudxvm.js";import{T as he}from"../chunks/Tabs.BGGYqHwk.js";import{I as be}from"../chunks/IconCheck.jhQYM7vu.js";var $e=O('<div class="err"> </div>'),ye=O("<!> <!> <!> <!>",1),we=O('<div class="container svelte-s1196z"><!></div>');function Ce(x,r){W(r,!0);let A=U(),u=G(),l=p(void 0),n=p(""),m=p(""),d=p("");Z(()=>{requestAnimationFrame(()=>{var h;(h=e(l))==null||h.focus()})});async function y(h,c){var S;if(r.attrs.find(F=>F.name===e(m))){s(n,o(u.common.nameExistsAlready));return}s(n,"");let t={name:e(m),desc:e(d)||void 0},v=await ce(h.action,t);v.body?r.onSave(v.body.name):s(n,o(((S=v.error)==null?void 0:S.message)||"Error"))}var w=we(),T=k(w);te(T,{action:"/auth/v1/users/attr",onSubmit:y,children:(h,c)=>{var t=ye(),v=P(t);Q(v,{autocomplete:"off",get label(){return u.attrs.name},get placeholder(){return u.attrs.name},required:!0,pattern:Y,get ref(){return e(l)},set ref(b){s(l,o(b))},get value(){return e(m)},set value(b){s(m,o(b))}});var S=C(v,2);Q(S,{autocomplete:"off",get label(){return u.attrs.desc},get placeholder(){return u.attrs.desc},pattern:ee,get value(){return e(d)},set value(b){s(d,o(b))}});var F=C(S,2);X(F,{type:"submit",children:(b,i)=>{J();var a=K();_(()=>I(a,A.common.save)),g(b,a)},$$slots:{default:!0}});var E=C(F,2);{var R=b=>{var i=$e(),a=k(i,!0);B(i),_(()=>I(a,e(n))),g(b,i)};z(E,b=>{e(n)&&b(R)})}g(h,t)},$$slots:{default:!0}}),B(w),g(x,w),j()}var Te=O('<div class="err"> </div>'),Se=O('<!> <!> <div class="flex gap-05"><!> <!></div> <!>',1);function Oe(x,r){W(r,!0);let A=U(),u=G(),l=p(""),n=p(!1),m=p(o(r.attr.name)),d=p(o(r.attr.desc));Z(()=>{r.attr.name&&(s(m,o(r.attr.name)),s(d,o(r.attr.desc)))});async function y(T,h){if(s(l,""),e(m)!==r.attr.name&&r.attrs.find(v=>v.name===e(m))){s(l,o(u.common.nameExistsAlready));return}let c={name:e(m),desc:e(d)||void 0},t=await de(T.action,c);t.error?s(l,o(t.error.message)):(s(n,!0),r.onSave(),setTimeout(()=>{s(n,!1)},2e3))}var w=V(()=>`/auth/v1/users/attr/${r.attr.name}`);te(x,{get action(){return e(w)},onSubmit:y,children:(T,h)=>{var c=Se(),t=P(c);Q(t,{autocomplete:"off",get label(){return u.attrs.name},get placeholder(){return u.attrs.name},width:"14.5rem",required:!0,pattern:Y,get value(){return e(m)},set value(a){s(m,o(a))}});var v=C(t,2);Q(v,{autocomplete:"off",get label(){return u.attrs.desc},get placeholder(){return u.attrs.desc},width:"14.5rem",pattern:ee,get value(){return e(d)},set value(a){s(d,o(a))}});var S=C(v,2),F=k(S);X(F,{type:"submit",children:(a,f)=>{J();var $=K();_(()=>I($,A.common.save)),g(a,$)},$$slots:{default:!0}});var E=C(F,2);{var R=a=>{be(a,{})};z(E,a=>{e(n)&&a(R)})}B(S);var b=C(S,2);{var i=a=>{var f=Te(),$=k(f,!0);B(f),_(()=>I($,e(l))),g(a,f)};z(b,a=>{e(l)&&a(i)})}g(T,c)},$$slots:{default:!0}}),j()}var xe=O('<div class="err"> </div>'),Ae=O("<p> </p> <!> <!>",1);function Fe(x,r){W(r,!0);let A=U(),u=G(),l=p("");async function n(){s(l,"");let c=await fe(`/auth/v1/users/attr/${r.attr.name}`);c.error?s(l,o(c.error.message)):r.onSave()}var m=Ae(),d=P(m),y=k(d,!0);B(d);var w=C(d,2);X(w,{level:-1,onclick:n,children:(c,t)=>{J();var v=K();_(()=>I(v,A.common.delete)),g(c,v)},$$slots:{default:!0}});var T=C(w,2);{var h=c=>{var t=xe(),v=k(t,!0);B(t),_(()=>I(v,e(l))),g(c,t)};z(T,c=>{e(l)&&c(h)})}_(()=>I(y,u.attrs.delete1)),g(x,m),j()}var Ne=O('<div class="flex"><!></div> <!>',1);function Ee(x,r){W(r,!0);let A=U(),u=G();const l=[u.nav.config,A.common.delete];let n=p(o(l[0])),m=p(void 0);Z(()=>{r.attr.name&&requestAnimationFrame(()=>{var t;(t=e(m))==null||t()})});var d=Ne(),y=P(d),w=k(y);he(w,{tabs:l,get selected(){return e(n)},set selected(t){s(n,o(t))},get focusFirst(){return e(m)},set focusFirst(t){s(m,o(t))}}),B(y);var T=C(y,2);{var h=t=>{Oe(t,{get attr(){return r.attr},get attrs(){return r.attrs},get onSave(){return r.onSave}})},c=t=>{var v=se(),S=P(v);{var F=E=>{Fe(E,{get attr(){return r.attr},get onSave(){return r.onSave}})};z(S,E=>{e(n)===A.common.delete&&E(F)},!0)}g(t,v)};z(T,t=>{e(n)===u.nav.config?t(h):t(c,!1)})}g(x,d),j()}var qe=O("<div></div> <!>",1),Pe=O("<!> <!>",1),_e=O('<div class="err"> </div>'),ke=O('<!> <div id="groups"><!></div>',1),Be=O("<!> <!>",1);function Ie(x,r){W(r,!0);let A=G(),u=p(void 0),l=p(""),n=p(o([])),m=p(o([])),d=p(void 0),y=ge("an");const w=[A.common.name];let T=p(o(w[0])),h=p("");const c=[A.common.name];re(()=>{t()}),Z(()=>{s(d,o(e(n).find(i=>i.name===y.get())))}),Z(()=>{let i=e(h).toLowerCase();i?e(T)===w[0]&&s(m,o(e(n).filter(a=>{var f;return(f=a.name)==null?void 0:f.toLowerCase().includes(i)}))):s(m,o(e(n)))});async function t(){var a;let i=await pe("/auth/v1/users/attr");i.body?s(n,o(i.body.values)):s(l,o(((a=i.error)==null?void 0:a.message)||"Error"))}function v(i,a){let f=a==="up";i===c[0]&&e(n).sort(($,q)=>f?$.name.localeCompare(q.name):q.name.localeCompare($.name))}function S(){t()}async function F(i){var a;(a=e(u))==null||a(),await t(),y.set(i)}var E=Be(),R=P(E);ve(R,{paddingTop:"2.1rem",buttonTilesAriaControls:"groups",width:"min(20rem, 100dvw)",thresholdNavSub:700,buttonTiles:i=>{var a=qe(),f=P(a);ne(f,"height",".5rem");var $=C(f,2);oe($,17,()=>e(m),q=>q.name,(q,L)=>{var N=V(()=>y.get()===e(L).name);le(q,{onclick:()=>y.set(e(L).name),get selected(){return e(N)},children:(H,M)=>{J();var D=K();_(()=>I(D,e(L).name)),g(H,D)},$$slots:{default:!0}})}),g(i,a)},children:(i,a)=>{var f=Pe(),$=P(f),q=V(()=>e(n).length===0?1:2);ie($,{get level(){return e(q)},alignRight:!0,get closeModal(){return e(u)},set closeModal(N){s(u,o(N))},children:(N,H)=>{Ce(N,{onSave:F,get attrs(){return e(n)}})},$$slots:{default:!0}});var L=C($,2);ue(L,{searchOptions:w,orderOptions:c,onChangeOrder:v,searchWidth:"min(19.5rem, 100dvw - .5rem)",get searchOption(){return e(T)},set searchOption(N){s(T,o(N))},get value(){return e(h)},set value(N){s(h,o(N))}}),g(i,f)},$$slots:{buttonTiles:!0,default:!0}});var b=C(R,2);me(b,{children:(i,a)=>{var f=ke(),$=P(f);{var q=M=>{var D=_e(),ae=k(D,!0);B(D),_(()=>I(ae,e(l))),g(M,D)};z($,M=>{e(l)&&M(q)})}var L=C($,2),N=k(L);{var H=M=>{Ee(M,{get attr(){return e(d)},get attrs(){return e(n)},onSave:S})};z(N,M=>{e(d)&&M(H)})}B(L),g(i,f)},$$slots:{default:!0}}),g(x,E),j()}function Le(x){Ie(x,{})}export{Le as component};

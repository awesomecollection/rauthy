import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.BVESbwbj.js";import{p as m,a as d,$ as f}from"../chunks/runtime.BONl2e88.js";import{h as l}from"../chunks/svelte-head.DBtDtmZn.js";import{i as _}from"../chunks/lifecycle.B_FNgRVT.js";import{o as u}from"../chunks/index-client.Bjp_k6xO.js";import{C as w,g,s as h,b as k,c as v,d as C,R as b,e as j}from"../chunks/helpers.CQGRRstl.js";import{g as y,a as P}from"../chunks/dataFetching.CUoxx_U8.js";import{u as i}from"../chunks/param.svelte.BwWxV1Sm.js";function R(S,n){m(n,!1);let c=i("code"),p=i("state");u(async()=>{const a=new URLSearchParams;let t=b,o=p.get();o&&(o==="account"?t=j:o.startsWith("device")&&(t=`/auth/v1/${o}`));let s=c.get();if(!s){console.error("no `code` given");return}a.append("grant_type","authorization_code"),a.append("code",s),a.append("redirect_uri",t),a.append("client_id",w),a.append("code_verifier",g());let r=await y(a),e=await r.json();h(e.access_token),k(e.id_token),r=await P(e.access_token),e=await r.json(),v(e.csrf_token),C(),window.location.replace(t)}),_(),l(a=>{f.title="Callback"}),d()}export{R as component};

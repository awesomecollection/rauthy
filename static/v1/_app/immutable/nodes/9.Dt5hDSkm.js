import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.DJEB66nf.js";import{p as Pe,A as d,ap as Ie,a6 as le,f as k,t as C,a as ke,y as e,z as t,s as h,ar as Y,c as g,ab as Ce,r as b,K as Te}from"../chunks/index-client.Di99sPv0.js";import{s as T}from"../chunks/render.Cjc4CIr8.js";import{i as Z}from"../chunks/if.DgeUjMU2.js";import{e as me}from"../chunks/each.DxtmCefA.js";import{a as o,t as y,d as ve,e as _}from"../chunks/template.BEKX6jgL.js";import{a as Be}from"../chunks/index.BnJsthXQ.js";import{p as r}from"../chunks/proxy.BQ2dmY0t.js";import{O as Ee}from"../chunks/OrderSearchBar.CS_Hs5DC.js";import{B as H}from"../chunks/Button.D-14suAe.js";import{I as Me}from"../chunks/Input.-lhBsjDF.js";import{D as Se,l as ze}from"../chunks/helpers.D3KrX4pz.js";import{u as De}from"../chunks/i18n.svelte.Bc6aINkd.js";import{u as Fe}from"../chunks/i18n_admin.svelte.DI6l2V4l.js";import{I as Le}from"../chunks/InputDateTimeCombo.C0589-57.js";import{f as ne,a as Oe}from"../chunks/form.DekAF1-C.js";import{I as Ve}from"../chunks/IconStop.8S4C4V3m.js";import{f as je,b as qe,c as Ae}from"../chunks/fetch.DxJS_Pk_.js";import{C as Ke}from"../chunks/ContentAdmin.BWiTVMIY.js";import{B as Ne}from"../chunks/ButtonAddModal.DLvLHw-v.js";import{b as Ue}from"../chunks/patterns.BDQXnG3O.js";import{F as We}from"../chunks/Form.C0Yvca1O.js";import{T as pe}from"../chunks/Tooltip.59ZAsezP.js";import{P as Ge}from"../chunks/Pagination.CzQK1Fhb.js";var Je=y('<!> <!> <div></div> <!> <div class="err"> </div>',1),Qe=y('<div class="addNew svelte-1v7phw9"><!></div>'),Re=y("<div> </div>"),Xe=y('<div class="ip svelte-1v7phw9"><!></div>'),Ye=y('<div class="delete svelte-1v7phw9"><!></div>'),Ze=y('<div class="blacklisted svelte-1v7phw9"><!> <div class="date svelte-1v7phw9"> </div> <!></div>'),_e=y('<div class="top svelte-1v7phw9"><!> <!></div> <div id="blacklist"><!></div> <!>',1),He=y(" <!>",1);function er(V,de){Pe(de,!0);let j=De(),ce=Fe();const ee=30;let q=d(void 0),A=d(void 0),K=d(""),z=d(""),P=d(r([])),B=d(r([])),N=d(r([])),D=d(""),U=d(r(ne())),W=d(r(Oe())),G=d(""),re=["IP"];Ie(()=>{J()}),le(()=>{var a;(a=e(q))==null||a.focus()}),le(()=>{let a=e(G).toLowerCase();a?t(B,r(e(P).filter(m=>{var c;return(c=m.ip)==null?void 0:c.includes(a)}))):t(B,r(e(P)))});async function J(){var m;let a=await je("/auth/v1/blacklist");a.body?t(P,r(a.body.ips)):t(K,r(((m=a.error)==null?void 0:m.message)||"Error"))}async function fe(a,m){var F;t(z,"");let c=Se(e(U),e(W));if(!c){t(z,"Invalid Date Input: User Expires");return}let w={ip:e(D),exp:c},$=await qe(a.action,w);$.error?t(z,r($.error.message)):(t(D,""),(F=e(A))==null||F(),await J())}async function ue(a){let m=await Ae(`/auth/v1/blacklist/${a}`);m.error?t(K,r(m.error.message)):await J()}function he(a,m){let c=m==="up";a===re[0]&&e(P).sort((w,$)=>c?w.ip.localeCompare($.ip):$.ip.localeCompare(w.ip))}Y();var ae=He(),te=k(ae),ge=h(te);Ke(ge,{children:(a,m)=>{var c=_e(),w=k(c),$=g(w);Ee($,{orderOptions:re,onChangeOrder:he,searchWidth:"min(15.75rem, calc(100dvw - 1rem))",get value(){return e(G)},set value(i){t(G,r(i))}});var F=h($,2);Ne(F,{level:1,get closeModal(){return e(A)},set closeModal(i){t(A,r(i))},children:(i,v)=>{var x=Qe(),R=g(x);We(R,{action:"/auth/v1/blacklist",onSubmit:fe,children:(X,ie)=>{var n=Je(),s=k(n);Me(s,{autocomplete:"off",label:"IP",placeholder:"IPv4",errMsg:"IPv4",required:!0,maxLength:15,pattern:Ue,get ref(){return e(q)},set ref(p){t(q,r(p))},get value(){return e(D)},set value(p){t(D,r(p))}});var f=h(s,2),l=Ce(ne);Le(f,{label:"Expiry",get min(){return e(l)},withTime:!0,get value(){return e(U)},set value(p){t(U,r(p))},get timeValue(){return e(W)},set timeValue(p){t(W,r(p))}});var u=h(f,2);Be(u,"height",".5rem");var L=h(u,2);H(L,{type:"submit",children:(p,I)=>{Y();var M=ve();C(()=>T(M,j.common.save)),o(p,M)},$$slots:{default:!0}});var O=h(L,2),E=g(O,!0);b(O),C(()=>T(E,e(z))),o(X,n)},$$slots:{default:!0}}),b(x),o(i,x)},$$slots:{default:!0}}),b(w);var Q=h(w,2),be=g(Q);{var we=i=>{var v=Re(),x=g(v,!0);b(v),C(()=>T(x,ce.common.noEntries)),o(i,v)},$e=i=>{var v=_();const x=(n,s=Te)=>{var f=Ze(),l=g(f);H(l,{invisible:!0,onclick:()=>navigator.clipboard.writeText(s().ip),children:(E,p)=>{var I=Xe(),M=g(I);pe(M,{get text(){return j.common.copyToClip},children:(S,se)=>{Y();var oe=ve();C(()=>T(oe,s().ip)),o(S,oe)},$$slots:{default:!0}}),b(I),o(E,I)},$$slots:{default:!0}});var u=h(l,2),L=g(u,!0);C(()=>T(L,ze(s().exp))),b(u);var O=h(u,2);H(O,{invisible:!0,onclick:()=>ue(s().ip),children:(E,p)=>{pe(E,{get text(){return j.common.delete},children:(I,M)=>{var S=Ye(),se=g(S);Ve(se,{width:"1.25rem"}),b(S),o(I,S)},$$slots:{default:!0}})},$$slots:{default:!0}}),b(f),o(n,f)};var R=k(v);{var X=n=>{var s=_(),f=k(s);me(f,17,()=>e(N),l=>l.ip,(l,u)=>{x(l,()=>e(u))}),o(n,s)},ie=n=>{var s=_(),f=k(s);me(f,17,()=>e(B),l=>l.ip,(l,u)=>{x(l,()=>e(u))}),o(n,s)};Z(R,n=>{e(P).length>ee?n(X):n(ie,!1)})}o(i,v)};Z(be,i=>{e(P).length===0?i(we):i($e,!1)})}b(Q);var xe=h(Q,2);{var ye=i=>{Ge(i,{pageSize:30,get items(){return e(B)},set items(v){t(B,r(v))},get itemsPaginated(){return e(N)},set itemsPaginated(v){t(N,r(v))}})};Z(xe,i=>{e(P).length>ee&&i(ye)})}o(a,c)},$$slots:{default:!0}}),C(()=>T(te,`${e(K)??""} `)),o(V,ae),ke()}function rr(V){er(V,{})}export{rr as component};

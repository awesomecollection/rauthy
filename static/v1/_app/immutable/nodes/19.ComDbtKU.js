import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.pqhLE6I2.js";import{p as O,u as e,v as t,ao as B,w,c as E,s as I,r as y,aq as N,t as A,a as z,a9 as ee,f as Q}from"../chunks/index-client.ChFmlJin.js";import{s as q}from"../chunks/render.D821es-0.js";import{e as ae}from"../chunks/each.QTCItWz3.js";import{d as M,a as n,t as b,e as te}from"../chunks/template.DOaMAhd6.js";import{p as l}from"../chunks/proxy.DVTQVrWW.js";import{i as re,j as se,k as le,l as ie}from"../chunks/dataFetchingAdmin.CWfMXXPM.js";import{i as R}from"../chunks/if.DhkeN2Rc.js";import{t as V,s as W}from"../chunks/index.BCW953sO.js";import{p as P}from"../chunks/props.B17NqqFW.js";import{E as G,T as H,a as oe,O as ne,P as ve}from"../chunks/Pagination.CbuOAm9_.js";import{r as J}from"../chunks/legacy-client.CNC41JPz.js";import{c as K,a as U,I as X,B as F}from"../chunks/Input.mueckHaA.js";import{W as Y,q as Z}from"../chunks/helpers.BweJi6s8.js";var de=b('<div class="success svelte-17in7jd">Success</div>'),ce=b('<div class="mainErr err svelte-17in7jd"> </div>'),ue=b('<div class="container svelte-17in7jd"><div class="unit svelte-17in7jd"><div class="label font-label svelte-17in7jd">ID</div> <div class="value font-mono svelte-17in7jd"> </div></div> <!> <!> <!> <!></div>');function me(T,S){O(S,!0);let u=P(S,"role",31,()=>l({})),m=w(""),o=w(!1),k=w(void 0);J(()=>{e(o)&&t(k,l(setTimeout(()=>{t(o,!1),S.onSave()},2e3)))}),B(()=>()=>clearTimeout(e(k)));let h=w(l({}));const C=K().shape({name:U().trim().matches(Y,"Can only contain: 'a-z0-9-_/:*', length: 2-64")});async function L(){if(t(m,""),!await _()){t(m,"Invalid input");return}let a={role:u().name.trim()},$=await re(u().id,a);if($.ok)t(o,!0);else{let D=await $.json();t(m,l(D.message))}}async function _(){try{return await C.validate(u(),{abortEarly:!1}),t(h,l({})),!0}catch(a){return t(h,l(Z(a))),!1}}var v=ue(),d=E(v),i=I(E(d),2),j=E(i,!0);y(i),y(d);var x=I(d,2),g=ee(()=>u().name==="rauthy_admin");X(x,{autocomplete:"off",placeholder:"Role Name",get disabled(){return e(g)},get value(){return u().name},set value(a){u(u().name=a,!0)},get error(){return e(h).name},set error(a){e(h).name=a},$$events:{input:_},children:(a,$)=>{N();var D=M("ROLE NAME");n(a,D)},$$slots:{default:!0}});var r=I(x,2);F(r,{level:1,width:"4rem",$$events:{click:L},children:(a,$)=>{N();var D=M("SAVE");n(a,D)},$$slots:{default:!0}});var f=I(r,2);{var s=a=>{var $=de();n(a,$)};R(f,a=>{e(o)&&a(s)})}var p=I(f,2);{var c=a=>{var $=ce(),D=E($,!0);y($),A(()=>q(D,e(m))),n(a,$)};R(p,a=>{e(m)&&a(c)})}y(v),A(()=>q(j,u().id)),n(T,v),z()}var fe=b('<div class="label svelte-1jljqe9">Anti-Lockout Rule: The rauthy_admin role cannot be deleted.</div>'),he=b('<div class="err svelte-1jljqe9"> </div>'),pe=b('<div class="label svelte-1jljqe9">Are you sure, you want to delete this role?</div> <!> <!>',1),$e=b('<div class="container svelte-1jljqe9"><!></div>');function ge(T,S){O(S,!0);let u=P(S,"role",19,()=>({})),m=w(!1),o=w("");async function k(){t(o,""),t(m,!0);let v=await se(u().id);if(v.ok)S.onSave();else{let d=await v.json();t(o,l(d.message))}t(m,!1)}var h=$e(),C=E(h);{var L=v=>{var d=fe();n(v,d)},_=v=>{var d=pe(),i=I(Q(d),2);F(i,{level:1,get isLoading(){return e(m)},set isLoading(g){t(m,l(g))},$$events:{click:k},children:(g,r)=>{N();var f=M("DELETE");n(g,f)},$$slots:{default:!0}});var j=I(i,2);{var x=g=>{var r=he(),f=E(r,!0);y(r),A(()=>q(f,e(o))),n(g,r)};R(j,g=>{e(o)&&g(x)})}n(v,d)};R(C,v=>{u().name==="rauthy_admin"?v(L):v(_,!1)})}y(h),n(T,h),z()}var we=b('<div class="data font-mono svelte-115hohv"> </div>'),be=b('<div class="data svelte-115hohv"> </div>'),je=b('<div class="header svelte-115hohv"><!> <!></div>'),Se=b("<div><!></div>"),ke=b("<div><!></div>"),ye=b("<div><!> <!></div>");function xe(T,S){O(S,!0);let u=P(S,"role",31,()=>l({})),m=P(S,"onSave",15),o=w(void 0);const k=["Config","Delete"];let h=w(l(k[0]));const C=200,L=C/2;function _(){t(o,!1),m()()}G(T,{get show(){return e(o)},set show(v){t(o,l(v))},header:v=>{var d=je(),i=E(d);H(i,{text:"Role ID",children:(x,g)=>{var r=we(),f=E(r,!0);y(r),A(()=>q(f,u().id)),n(x,r)},$$slots:{default:!0}});var j=I(i,2);H(j,{text:"Role Name",children:(x,g)=>{var r=be(),f=E(r,!0);y(r),A(()=>q(f,u().name)),n(x,r)},$$slots:{default:!0}}),y(d),n(v,d)},body:v=>{var d=ye(),i=E(d);oe(i,{labels:k,get selected(){return e(h)},set selected(r){t(h,l(r))}});var j=I(i,2);{var x=r=>{var f=Se(),s=E(f);me(s,{get role(){return u()},set role(p){u(p)},get onSave(){return m()},set onSave(p){m(p)}}),y(f),V(5,f,()=>W,()=>({delay:L,duration:C})),V(6,f,()=>W,()=>({duration:C})),n(r,f)},g=r=>{var f=te(),s=Q(f);{var p=c=>{var a=ke(),$=E(a);ge($,{get role(){return u()},onSave:_}),y(a),V(5,a,()=>W,()=>({delay:L,duration:C})),V(6,a,()=>W,()=>({duration:C})),n(c,a)};R(s,c=>{e(h)==="Delete"&&c(p)},!0)}n(r,f)};R(j,r=>{e(h)==="Config"?r(x):r(g,!1)})}y(d),n(v,d)},$$slots:{header:!0,body:!0}}),z()}var Ee=b('<div class="header font-label svelte-r30xs6">ADD NEW ROLE</div>'),Ie=b('<div class="success svelte-r30xs6">Success</div>'),Ce=b('<div class="err svelte-r30xs6"> </div>'),Le=b('<div class="container svelte-r30xs6"><!> <!> <!> <!></div>');function Te(T,S){O(S,!0);let u=P(S,"idx",31,()=>-1),m=w(void 0),o=w(l({role:""})),k=w(""),h=w(!1),C=w(void 0),L=w(l({}));const _=K().shape({role:U().trim().matches(Y,"Can only contain: 'a-z0-9-_/:*', length: 2-64")});J(()=>{e(h)&&t(C,l(setTimeout(()=>{t(h,!1),t(o,l({role:""})),t(m,!1),S.onSave()},1500)))}),B(()=>()=>clearTimeout(e(C)));async function v(){if(t(k,""),!await d()){t(k,"Invalid input");return}e(o).role=e(o).role.trim();let i=await le(e(o));if(i.ok)t(h,!0);else{let j=await i.json();t(k,l(j.message))}}async function d(){try{return await _.validate(e(o),{abortEarly:!1}),t(L,l({})),!0}catch(i){return t(L,l(Z(i))),!1}}G(T,{get idx(){return u()},set idx(i){u(i)},get show(){return e(m)},set show(i){t(m,l(i))},header:i=>{var j=Ee();n(i,j)},body:i=>{var j=Le(),x=E(j);X(x,{autocomplete:"off",placeholder:"Role Name",get value(){return e(o).role},set value(c){e(o).role=c},get error(){return e(L).role},set error(c){e(L).role=c},$$events:{input:d},children:(c,a)=>{N();var $=M("ROLE NAME");n(c,$)},$$slots:{default:!0}});var g=I(x,2);F(g,{level:1,width:"4rem",$$events:{click:v},children:(c,a)=>{N();var $=M("SAVE");n(c,$)},$$slots:{default:!0}});var r=I(g,2);{var f=c=>{var a=Ie();n(c,a)};R(r,c=>{e(h)&&c(f)})}var s=I(r,2);{var p=c=>{var a=Ce(),$=E(a,!0);y(a),A(()=>q($,e(k))),n(c,a)};R(s,c=>{e(k)&&c(p)})}y(j),n(i,j)},$$slots:{header:!0,body:!0}}),z()}var _e=b('<div class="svelte-db30dl"><!></div>'),De=b(' <div class="content"><!> <!> <div id="roles" class="svelte-db30dl"></div> <!> <div style="height: 20px"></div></div>',1);function Re(T,S){O(S,!0);let u=w(""),m=w(l([])),o=w(l([])),k=w(l([])),h=w(""),C=[{label:"Name",callback:(s,p)=>s.name.toLowerCase().includes(p.toLowerCase())},{label:"ID",callback:(s,p)=>s.id.toLowerCase().includes(p.toLowerCase())}],L=[{label:"Name",callback:(s,p)=>s.name.localeCompare(p.name)},{label:"ID",callback:(s,p)=>s.id.localeCompare(p.id)}];B(async()=>{_()});async function _(){let s=await ie(),p=await s.json();s.ok?t(m,l([...p])):t(u,l(p.message))}function v(){_(),t(h,"")}N();var d=De(),i=Q(d),j=I(i),x=E(j);ne(x,{get items(){return e(m)},searchOptions:C,orderOptions:L,get resItems(){return e(o)},set resItems(s){t(o,l(s))},get search(){return e(h)},set search(s){t(h,l(s))}});var g=I(x,2);Te(g,{onSave:v});var r=I(g,2);ae(r,23,()=>e(k),s=>s.id,(s,p,c)=>{var a=_e(),$=E(a);xe($,{onSave:v,get role(){return e(m)[e(c)]},set role(D){e(m)[e(c)]=D}}),y(a),n(s,a)}),y(r);var f=I(r,2);ve(f,{get items(){return e(o)},set items(s){t(o,l(s))},get resItems(){return e(k)},set resItems(s){t(k,l(s))}}),N(2),y(j),A(()=>q(i,`${e(u)??""} `)),n(T,d),z()}function Ne(T){Re(T,{})}export{Ne as component};

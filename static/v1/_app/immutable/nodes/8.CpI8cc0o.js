import"../chunks/disclose-version.BDr9Qe-U.js";import"../chunks/legacy.pqhLE6I2.js";import{p as x,w as $,a as V,u as r,v as s,s as y,c as N,aq as _,r as A,t as L,ao as K,f as J}from"../chunks/index-client.ChFmlJin.js";import{s as O}from"../chunks/render.D821es-0.js";import{e as X}from"../chunks/each.QTCItWz3.js";import{a as d,d as k,t as b,e as ee}from"../chunks/template.DOaMAhd6.js";import{p as n}from"../chunks/proxy.DVTQVrWW.js";import{a as ae,b as te,d as re,g as se}from"../chunks/dataFetchingAdmin.CWfMXXPM.js";import{E as W,T as ie,a as ne,O as oe,P as le}from"../chunks/Pagination.CbuOAm9_.js";import{i as q}from"../chunks/if.DhkeN2Rc.js";import{p as z}from"../chunks/props.B17NqqFW.js";import{c as Y,a as M,I as R,B as Z}from"../chunks/Input.mueckHaA.js";import{U as F,V as G,q as H}from"../chunks/helpers.BweJi6s8.js";import{t as P,s as U}from"../chunks/index.BCW953sO.js";import{r as ve}from"../chunks/legacy-client.CNC41JPz.js";var ce=b('<div class="header font-label svelte-1mi5990">ADD NEW USER ATTRIBUTE</div>'),de=b('<div class="mainErr err svelte-1mi5990"> </div>'),ue=b('<div class="container svelte-1mi5990"><div class="desc svelte-1mi5990">You can add a new custom user attribute.<br> These attributes can be set for every user and mapped to an existing scope.<br> They are simple Key / JsonValue pairs.</div> <!> <!> <!> <!> <!></div>');function me(I,h){x(h,!0);let w=z(h,"idx",31,()=>-1),v=$(""),c=$(void 0),m=n({name:"",desc:""}),o=$(n({}));const u=Y().shape({name:M().trim().required("Name is required").matches(F,"Invalid characters: [a-z0-9-_/]{2,32}"),desc:M().trim().matches(G,"Invalid characters: [a-zA-Z0-9\\-_/\\s]{0,128}")});async function C(){if(!await T())return;s(v,"");let t=await ae(m);if(t.ok)s(c,!1),h.onSave();else{let i=await t.json();s(v,n(i.message))}}async function T(){try{return await u.validate(m,{abortEarly:!1}),s(o,n({})),!0}catch(t){return s(o,n(H(t))),!1}}W(I,{get idx(){return w()},set idx(t){w(t)},get show(){return r(c)},set show(t){s(c,n(t))},header:t=>{var i=ce();d(t,i)},body:t=>{var i=ue(),g=y(N(i),2);R(g,{autocomplete:"off",placeholder:"Name",get value(){return m.name},set value(e){m.name=e},get error(){return r(o).name},set error(e){r(o).name=e},$$events:{input:T},children:(e,a)=>{_();var l=k("NAME");d(e,l)},$$slots:{default:!0}});var j=y(g,2);R(j,{autocomplete:"off",placeholder:"Description",get value(){return m.desc},set value(e){m.desc=e},get error(){return r(o).desc},set error(e){r(o).desc=e},$$events:{input:T},children:(e,a)=>{_();var l=k("DESCRIPTION");d(e,l)},$$slots:{default:!0}});var D=y(j,2);Z(D,{level:1,$$events:{click:C},children:(e,a)=>{_();var l=k("SAVE");d(e,l)},$$slots:{default:!0}});var E=y(D,2);q(E,e=>{});var p=y(E,2);{var S=e=>{var a=de(),l=N(a,!0);A(a),L(()=>O(l,r(v))),d(e,a)};q(p,e=>{r(v)&&e(S)})}A(i),d(t,i)},$$slots:{header:!0,body:!0}}),V()}var fe=b('<div class="success svelte-2o3w7i">Success</div>'),pe=b('<div class="mainErr err svelte-2o3w7i"> </div>'),he=b('<div class="container svelte-2o3w7i"><!> <!> <!> <!> <!></div>');function ge(I,h){x(h,!0);let w=z(h,"attr",19,()=>({})),v=$(""),c=$(!1),m=$(void 0);ve(()=>{r(c)&&s(m,n(setTimeout(()=>{s(c,!1),h.onSave()},2e3)))}),K(()=>()=>clearTimeout(r(m)));let o=$(n({})),u=n({});const C=Y().shape({name:M().trim().required("Name is required").matches(F,"Valid characters: [a-z0-9-_/]{2,32}"),desc:M().nullable().trim().matches(G,"Valid characters: [a-zA-Z0-9\\-_/\\s]{0,128}")});K(()=>{u.name=w().name,u.desc=w().desc});async function T(){if(s(v,""),!await t()){s(v,"Invalid input");return}let a={name:u.name,desc:u.desc},l=await te(w().name,a);if(l.ok)s(c,!0);else{let f=await l.json();s(v,n(f.message))}}async function t(){try{return await C.validate(u,{abortEarly:!1}),s(o,n({})),!0}catch(a){return s(o,n(H(a))),!1}}var i=he(),g=N(i);R(g,{autocomplete:"off",placeholder:"Name",get value(){return u.name},set value(a){u.name=a},get error(){return r(o).name},set error(a){r(o).name=a},$$events:{input:t},children:(a,l)=>{_();var f=k("NAME");d(a,f)},$$slots:{default:!0}});var j=y(g,2);R(j,{autocomplete:"off",placeholder:"Description",get value(){return u.desc},set value(a){u.desc=a},get error(){return r(o).desc},set error(a){r(o).desc=a},$$events:{input:t},children:(a,l)=>{_();var f=k("DESCRIPTION");d(a,f)},$$slots:{default:!0}});var D=y(j,2);Z(D,{level:1,width:"4rem",$$events:{click:T},children:(a,l)=>{_();var f=k("SAVE");d(a,f)},$$slots:{default:!0}});var E=y(D,2);{var p=a=>{var l=fe();d(a,l)};q(E,a=>{r(c)&&a(p)})}var S=y(E,2);{var e=a=>{var l=pe(),f=N(l,!0);A(l),L(()=>O(f,r(v))),d(a,l)};q(S,a=>{r(v)&&a(e)})}A(i),d(I,i),V()}var $e=b('<div class="err svelte-1jljqe9"> </div>'),ye=b('<div class="container svelte-1jljqe9"><div class="label svelte-1jljqe9">Are you sure, you want to delete this custom attribute?</div> <!> <!></div>');function we(I,h){x(h,!0);let w=z(h,"attr",19,()=>({})),v=$(!1),c=$("");async function m(){s(c,""),s(v,!0);let t=await re(w().name);if(t.ok)h.onSave();else{let i=await t.json();s(c,n(i.message))}s(v,!1)}var o=ye(),u=y(N(o),2);Z(u,{level:1,get isLoading(){return r(v)},set isLoading(t){s(v,n(t))},$$events:{click:m},children:(t,i)=>{_();var g=k("DELETE");d(t,g)},$$slots:{default:!0}});var C=y(u,2);{var T=t=>{var i=$e(),g=N(i,!0);A(i),L(()=>O(g,r(c))),d(t,i)};q(C,t=>{r(c)&&t(T)})}A(o),d(I,o),V()}var be=b('<div class="data svelte-115hohv"> </div>'),Ee=b('<div class="header svelte-115hohv"><!></div>'),Se=b("<div><!></div>"),Ae=b("<div><!></div>"),Ne=b("<div><!> <!></div>");function Te(I,h){x(h,!0);let w=z(h,"attr",27,()=>n({})),v=z(h,"onSave",15),c=$(void 0);const m=["Config","Delete"];let o=$(n(m[0]));const u=200,C=u/2;function T(){s(c,!1),v()()}W(I,{get show(){return r(c)},set show(t){s(c,n(t))},header:t=>{var i=Ee(),g=N(i);ie(g,{text:"Custom Attribute Name",children:(j,D)=>{var E=be(),p=N(E,!0);A(E),L(()=>O(p,w().name)),d(j,E)},$$slots:{default:!0}}),A(i),d(t,i)},body:t=>{var i=Ne(),g=N(i);ne(g,{labels:m,get selected(){return r(o)},set selected(p){s(o,n(p))}});var j=y(g,2);{var D=p=>{var S=Se(),e=N(S);ge(e,{get attr(){return w()},get onSave(){return v()},set onSave(a){v(a)}}),A(S),P(5,S,()=>U,()=>({delay:C,duration:u})),P(6,S,()=>U,()=>({duration:u})),d(p,S)},E=p=>{var S=ee(),e=J(S);{var a=l=>{var f=Ae(),B=N(f);we(B,{get attr(){return w()},onSave:T}),A(f),P(5,f,()=>U,()=>({delay:C,duration:u})),P(6,f,()=>U,()=>({duration:u})),d(l,f)};q(e,l=>{r(o)==="Delete"&&l(a)},!0)}d(p,S)};q(j,p=>{r(o)==="Config"?p(D):p(E,!1)})}A(i),d(t,i)},$$slots:{header:!0,body:!0}}),V()}var je=b('<div class="svelte-mjg702"><!></div>'),Ie=b(' <div class="content"><!> <!> <div id="attrs" class="svelte-mjg702"></div> <!> <div style="height: 20px"></div></div>',1);function De(I,h){x(h,!0);let w=$(""),v=$(n([])),c=$(n([])),m=$(n([])),o=$(""),u=[{label:"NAME",callback:(e,a)=>e.name.toLowerCase().includes(a.toLowerCase())}],C=[{label:"NAME",callback:(e,a)=>e.name.localeCompare(a.name)}];K(()=>{T()});async function T(){let e=await se();if(!e.ok)s(w,"Error fetching user attr: "+e.body.message);else{let a=await e.json();s(v,n([...a.values]))}}function t(){r(v).length<2&&(s(v,n([])),s(c,n([])),s(m,n([]))),T(),s(o,"")}_();var i=Ie(),g=J(i),j=y(g),D=N(j);oe(D,{get items(){return r(v)},searchOptions:u,orderOptions:C,get resItems(){return r(c)},set resItems(e){s(c,n(e))},get search(){return r(o)},set search(e){s(o,n(e))}});var E=y(D,2);me(E,{onSave:t});var p=y(E,2);X(p,23,()=>r(m),e=>e.name,(e,a,l)=>{var f=je(),B=N(f);Te(B,{onSave:t,get attr(){return r(m)[r(l)]},set attr(Q){r(m)[r(l)]=Q}}),A(f),d(e,f)}),A(p);var S=y(p,2);le(S,{get items(){return r(c)},set items(e){s(c,n(e))},get resItems(){return r(m)},set resItems(e){s(m,n(e))}}),_(2),A(j),L(()=>O(g,`${r(w)??""} `)),d(I,i),V()}function Ce(I){De(I,{})}export{Ce as component};
